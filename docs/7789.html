<html>
<head>
<title>Create 9Gag Android Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建9Gag Android应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/create-9gag-android-application-a845a12b95b0?source=collection_archive---------18-----------------------#2017-11-08">https://medium.com/hackernoon/create-9gag-android-application-a845a12b95b0?source=collection_archive---------18-----------------------#2017-11-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/fbdaee6f6567c28e58e1b0ddb9176ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNBADnbM9owX0PoHXFrkKQ.png"/></div></div></figure><p id="23a0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这篇文章中，我们将学习如何创建一个<strong class="je hv"> 9Gag </strong>应用程序，从<strong class="je hv"> Go </strong>中的<strong class="je hv"> RESTful API </strong>开始，部署到<strong class="je hv"> AWS Elastic Beanstalk </strong>，构建<strong class="je hv"> Android </strong>应用程序。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ka"><img src="../Images/91ccddfad0c6278998dc1346b30130df.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/0*hKsiDTHOgWKsVzh_."/></div></figure><p id="d360" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">本演示中使用的所有代码都可以在我的Github上找到:</p><ul class=""><li id="582f" class="kf kg hu je b jf jg jj jk jn kh jr ki jv kj jz kk kl km kn dt translated"><a class="ae ko" href="https://github.com/mlabouardy/9gag-restapi" rel="noopener ugc nofollow" target="_blank"> RESTful API </a></li><li id="a4d3" class="kf kg hu je b jf kp jj kq jn kr jr ks jv kt jz kk kl km kn dt translated"><a class="ae ko" href="https://github.com/mlabouardy/9gag-clone" rel="noopener ugc nofollow" target="_blank">安卓应用</a></li></ul><p id="f50f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> 1 — RESTful API </strong></p><p id="d7ab" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了构建这个应用程序，我们需要一个<strong class="je hv"> REST API </strong>来浏览<strong class="je hv"> 9Gag </strong>网站。希望我已经写了一个<a class="ae ko" href="https://github.com/mlabouardy/9gag" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> 9Gag客户端</strong> </a>为我们做最难的任务。因此，我们唯一需要做的就是在Go  中设置一个<a class="ae ko" href="http://www.blog.labouardy.com/build-restful-api-in-go-and-mongodb/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> HTTP服务器，它公开一个端点来通过标签获取迷因。</strong></a></p><p id="fe31" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以一定要抓住包装:</p><blockquote class="ku kv kw"><p id="bc31" class="jc jd kx je b jf jg jh ji jj jk jl jm ky jo jp jq kz js jt ju la jw jx jy jz hn dt translated">去找github.com/mlabouardy/9gag，去找github.com/gorilla/mux</p></blockquote><ul class=""><li id="df1e" class="kf kg hu je b jf jg jj jk jn kh jr ki jv kj jz kk kl km kn dt translated"><a class="ae ko" href="https://github.com/mlabouardy/9gag" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> 9gag </strong> </a> : 9Gag网络爬虫</li><li id="8743" class="kf kg hu je b jf kp jj kq jn kr jr ks jv kt jz kk kl km kn dt translated"><a class="ae ko" href="https://github.com/gorilla/mux" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">mux</strong></a>:<strong class="je hv"/>请求路由器和分配器将传入的请求匹配到各自的处理程序</li></ul><p id="4bc6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">安装完依赖项后，创建一个“<strong class="je hv"> app.go </strong>”文件，内容如下:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="8ba7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们通过键入以下命令来测试一下:</p><blockquote class="ku kv kw"><p id="9911" class="jc jd kx je b jf jg jh ji jj jk jl jm ky jo jp jq kz js jt ju la jw jx jy jz hn dt translated">去运行app.go</p></blockquote><p id="bd0a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你把你最喜欢的网页浏览器(不是你IE)指向<a class="ae ko" href="http://localhost:3000/memes/geek" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">http://localhost:3000/memes/geek</strong></a>，你应该会看到:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ld"><img src="../Images/db46d761eee2a27f113fbf66757b502c.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/0*8adJ1St8aPJfYYF3."/></div></figure><p id="80e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们用不同的标签再试一次:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff le"><img src="../Images/c79d1d5ab5550d7c4544c5843859d04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/0*L8JTd6hfDGM1eCaG."/></div></figure><p id="e204" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> Android </strong>应用将消耗<strong class="je hv"> API JSON响应</strong>。因此<strong class="je hv"> API </strong>必须可以通过互联网访问。</p><p id="19f6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> 2 —在AWS弹性豆茎上展开</strong></p><p id="7b37" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意:我已经做了一个关于如何使用EB的<a class="ae ko" href="http://www.blog.labouardy.com/deploying-node-js-application-on-aws-elastic-beanstalk/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">教程</strong> </a> <strong class="je hv"> </strong>，所以请务必阅读它以了解更多细节。</p><p id="b784" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将在一个<strong class="je hv"> Docker </strong>容器中部署API。为了将服务归档，我们需要两个文件:</p><p id="d528" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> Dockerfile </strong>:创建一个<strong class="je hv"> Docker镜像</strong>，包含你的源码包:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="4116" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> Dockerrun.aws.json </strong>:在<strong class="je hv"> AWS EB </strong>上部署app，告诉EB需要暴露哪个端口。</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="30b5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们有了部署所需的所有文件。我们将使用<a class="ae ko" href="http://www.blog.labouardy.com/deploying-node-js-application-on-aws-elastic-beanstalk/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> EB CLI </strong> </a>，因此通过键入如下的“<strong class="je hv"> eb init </strong>”开始:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/2bc6f9c7ccc44ef772b2482aff783004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MWw-kG7x1tiRJrpS."/></div></div></figure><p id="6aea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，键入“<strong class="je hv"> eb create </strong>”:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/7e2c5b6da451a3f0b68aa4f2398815b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P2ywYJlCEaBH7NdG."/></div></div></figure><p id="ab39" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦展开，转到<strong class="je hv">弹性豆茎仪表板</strong>:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/cb34750dbb05cb7f6b1f9df06f499550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VF_sms2nXJWTSqCQ."/></div></div></figure><p id="956e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您将浏览器指向上面显示的应用程序url:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/853c19c03d8491dbf9ba2167376c2e7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N0EADf7p5txt-yvt."/></div></div></figure><p id="1401" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> 3 —安卓应用</strong></p><p id="1a65" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您已经创建了您的<strong class="je hv"> Android项目</strong>，那么就从下一部分开始吧。否则，在您最喜欢的<strong class="je hv"> IDE </strong>中创建一个新项目。我更喜欢使用Android Studio和Gradle作为构建系统，但是你也可以使用你选择的IDE或者Maven。</p><p id="01df" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">于是打开<strong class="je hv"> Android studio </strong>，在“<strong class="je hv">快速启动</strong>菜单下，选择“<strong class="je hv">启动一个新的Android studio项目</strong>”:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lg"><img src="../Images/40ff0259a940927bc558c5d25319df6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xj0Iu6S_OTBEtExe."/></div></div></figure><p id="c1fe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，在您的<strong class="je hv"> build.gradle </strong>文件中添加项目的库:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="6713" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将针对之前部署的<strong class="je hv"> API </strong>执行<strong class="je hv"> HTTP请求</strong>。执行来自一个<strong class="je hv"> Android </strong>应用程序的请求需要<strong class="je hv">互联网许可</strong>来打开网络套接字。因此，请确保在您的<strong class="je hv"> AndroidManifest.xml </strong>文件中要求<strong class="je hv">互联网权限</strong>:</p><blockquote class="ku kv kw"><p id="4504" class="jc jd kx je b jf jg jh ji jj jk jl jm ky jo jp jq kz js jt ju la jw jx jy jz hn dt translated"><uses-permission android:name="”android.permission.INTERNET”/"/></p></blockquote><p id="e07b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将下面的<em class="kx">字符串</em>、<em class="kx">尺寸</em>、<em class="kx">颜色</em>资源添加到<strong class="je hv"> res </strong>目录下各自的文件中:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="002a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我们开始编写代码之前，我总是从规划布局开始:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff lh"><img src="../Images/edb3fb57411579622f846cbf64741ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/0*qLxV_jPjrZTdzNWu."/></div></figure><p id="2283" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以注意到上面的<strong class="je hv"> main_activity.xml </strong>将包含<em class="kx"> ListView </em>，<em class="kx">工具栏</em><em class="kx"><em class="kx">搜索栏</em>。并且<em class="kx"> ListView </em>的每一行都会有一个<em class="kx"> TextView </em>、<em class="kx"> NetworkImageView </em>和<em class="kx"> LinearLayout </em>作为包装器来创建<em class="kx">卡片</em>效果。</em></p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="08bd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们创建一个xml布局，以定制的方式显示每个meme项目行:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="bf21" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，在<strong class="je hv">适配器</strong>包下，创建一个名为<strong class="je hv"> MemesAdapter </strong>的类，将<strong class="je hv"> Meme </strong>模型填充到<strong class="je hv"> ListView: </strong></p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="30ea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在<strong class="je hv"> utils </strong>包下创建一个名为<strong class="je hv"> BitmapLruCache </strong>的类，并添加以下代码。该类负责在磁盘上缓存网络映像以获得更好的性能:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="717a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们需要定义<strong class="je hv"> API端点</strong>。下面的代码定义了<strong class="je hv"> MemeService </strong>和方法<strong class="je hv"> findByTag </strong>来请求给定标签的memes列表。<strong class="je hv"> @GET </strong>注释声明这个请求使用了<strong class="je hv"> HTTP GET </strong>方法。代码片段还说明了<strong class="je hv">改型</strong>的路径参数替换功能的使用。在定义的方法中，当调用<strong class="je hv"> findByTag </strong>方法时，<strong class="je hv"> {tag} </strong>路径将被替换为给定的变量值。</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="d1ae" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有一个定义好的类别<strong class="je hv">模因</strong>。这个类是一个简单的<strong class="je hv"> POJO </strong>，带有<em class="kx">getter</em>和<em class="kx">setter</em>:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="f208" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意:注释<strong class="je hv"> @SerializedName </strong>用于将JSON属性映射到右边的实体字段。</p><p id="d522" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们已经有了所有需要的类。打开<strong class="je hv"> MainActivity </strong>类并添加以下代码:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="a2d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个类创建了<strong class="je hv">改进</strong> <strong class="je hv">客户端</strong>，每当用户在<strong class="je hv">搜索栏</strong>中键入新标签时调用<strong class="je hv"> MemeService </strong>，并处理结果(它将memes列表传递给<strong class="je hv"> MemesAdapter </strong>，后者填充<strong class="je hv">列表视图</strong></p><p id="b73f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">应用程序的输出如下所示:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="li lc l"/></div></figure><p id="a8fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">本教程到此结束。在接下来的教程中，我将向你展示如何用<strong class="je hv"> JUnit </strong>进行<strong class="je hv">单元测试</strong>，用<strong class="je hv"> Espresso进行<strong class="je hv"> UI测试</strong>。</strong></p></div></div>    
</body>
</html>