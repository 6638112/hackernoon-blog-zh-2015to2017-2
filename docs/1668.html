<html>
<head>
<title>Swift optionals explained simply</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单解释了Swift选项</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/swift-optionals-explained-simply-e109a4297298?source=collection_archive---------1-----------------------#2016-11-28">https://medium.com/hackernoon/swift-optionals-explained-simply-e109a4297298?source=collection_archive---------1-----------------------#2016-11-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/b783fe28bea174a274cc13e45d1ee03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*uFPUs7TGAC0OWCIhOtmEhQ.jpeg"/></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">Image made with <a class="ae jc" href="https://imgflip.com/" rel="noopener ugc nofollow" target="_blank">https://imgflip.com/</a></figcaption></figure><p id="af4a" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">你有没有和各种“？”纠结过还有“！”Swift代码中到处都是符号？或者曾经发现自己对“强制解包”、“可选绑定”、“零合并”、“隐式绑定”或“可选链接”这样的短语感到困惑吗？你来对地方了！</p><p id="e86e" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">选项是Swift语言中的一个强大功能，用于解决不存在值的问题。来自Java并经历了NPEs的地狱，我真的对Swift的这一特性感到兴奋。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div class="fe ff kb"><img src="../Images/1161997bc3fd90921313965c94d67237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*W-uwodkQgn5jVwCkSZlhLA.png"/></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">Image credit <a class="ae jc" href="http://www.raywenderlich.com" rel="noopener ugc nofollow" target="_blank">www.raywenderlich.com</a></figcaption></figure><h1 id="eb02" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">什么是选装件，我们为什么需要它们？</h1><p id="d630" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated"><em class="lj">可选</em>只是Swift语言中的一个类型，没什么花哨的。<strong class="jf hv"> Int </strong>和<strong class="jf hv"> Int？</strong>(可选Int) <strong class="jf hv"> </strong>是两种不同的类型，如果你的变量恰好是类型<strong class="jf hv"> Int </strong>你可以绝对肯定它总会有一个整数值，如果你的变量是类型<strong class="jf hv"> Int？</strong>它要么有一个整数值，要么没有任何值(换句话说，它将是<strong class="jf hv"> nil </strong>)。</p><p id="2451" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">把<em class="lj">可选的</em>看作一个包装器类型。它就像一个礼物盒，里面包裹着价值，而像现实生活中的盒子一样，<em class="lj">可选</em>可以包含一些东西，也可以是空的。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/74685eb7fca7ff7fd5a4d3f98f1663dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*ev3hnA5TmeAfVqbxnt3szg.png"/></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">An optional which contains integer value of four, as if to write <strong class="bd ll">let myOptional: Int? = 4</strong></figcaption></figure><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/ab769363c3c15f1b6757d3fad761ca42.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*ek6cTgxNJWcyROgedI1W4A.png"/></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">An optional that doesn’t contain any value, as if to write <strong class="bd ll">let myOptional: Int? = nil</strong></figcaption></figure><p id="1e4b" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">将价值包装在盒子里的高层次想法是，我们可以安全地使用盒子，而不用担心里面是什么。Swift选项背后有一个强大的函数式编程概念——单子<em class="lj">和</em>。我强烈建议深入研究单子，这样你就能对这一切有一个更大的了解。最后，我将提供一些好的原始资料。</p><p id="c64f" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">下面的<em class="lj">可选</em>类型仅仅是一个有两种情况的枚举——<strong class="jf hv">None</strong>表示没有设置值，而<strong class="jf hv"> Some </strong>表示设置了值，并且是与之相关联的值。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><h1 id="9ec9" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">强制展开</h1><p id="2c78" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated">当试图执行一些“无辜的”操作时，你见过这个恼人的编译器错误吗？乍一看，你并没有做错什么，只是试图将两个整数相加，只是第一个是可选的，但它肯定有一个整数值，所以为什么编译器一直抱怨呢？</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="fe ff lo"><img src="../Images/721a00137af6890cf67a0a518d4a560e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7aHalY6DfAst8H_TPfNLxA.png"/></div></div></figure><p id="3f25" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">因为编译器不知道如何把一个盒子加到一个整数里。为了实现这一点，我们需要<em class="lj">打开</em>选项，换句话说，我们需要打开盒子，提取里面的值。为此，我们把“！”在变量名后做标记，意思是“我确定这个盒子里包含了什么，提取那个值并使用它”。这叫做<em class="lj">强制解包。这通常是一件“危险”的事情，因为如果盒子是空的，应用程序会在运行时崩溃。一个好的做法是在打开包装前检查<strong class="jf hv">是否为零</strong>。</em></p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="618e" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">引擎盖下<em class="lj">强制解包</em>只是一个开关语句。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><h1 id="fa1c" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">可选绑定</h1><p id="6b0e" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated">像<em class="lj">强制解包一样，可选捆绑</em>是一种打开盒子的方式，但它比<em class="lj">强制解包</em>做得更巧妙，污染更少。它允许检查<em class="lj">可选</em>，并将其值提取到常量或变量中，作为单个动作的一部分。当我们需要在<em class="lj"> if </em>主体中多次使用展开的值时，这很有用。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="2f9e" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">这将被解读为“如果<strong class="jf hv"> optionalInt </strong>有值，则将该值提取到<strong class="jf hv"> constantInt </strong>中，并在<em class="lj"> if </em>主体中使用，否则打印该值为零”。注意，我们没有使用“！”用<strong class="jf hv"> constantInt </strong>，那是因为它<strong class="jf hv"> </strong>代表<strong class="jf hv"> optionalInt </strong>已经解包的值。所以我们只需打开它一次，就可以在<em class="lj"> if </em>体内多次使用。</p><p id="e55b" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">在引擎盖下<em class="lj">可选绑定</em>的工作方式类似于<em class="lj">强制展开</em>，除了在这种情况下它只是断开开关而不是抛出异常。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><h1 id="528a" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated"><strong class="ak">隐式展开选项</strong></h1><p id="215d" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated">有时候，我们真的真的确定，在第一次设置之后，我们的可选值总会有一个值。在这种情况下，没有必要在每次我们想要使用它的时候打开可选的，因为假设我们有一个值是安全的。在这种情况下，它有点像是在说“解开这个家伙一次，然后在任何你想要的地方使用这个值”。</p><p id="bfc8" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><em class="lj">隐式展开的选项</em>用“！”声明标记他们的类型。因此，对于隐式展开的字符串可选，我们将有<strong class="jf hv">字符串！</strong>为其型。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="e8a6" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">请注意，我们没有使用“！”用<strong class="jf hv">假设</strong>标记，因为它是一个<em class="lj">隐式展开的可选</em>。</p><h1 id="84db" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">零合并</h1><p id="f003" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated">有时，当可选值为零时，我们希望使用默认值。让我们来看看这个例子:</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="e25f" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">这可以通过使用三元运算符(“？”)减少到一行下面代表三元运算符)。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="f367" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">零合并允许我们进一步缩短这个时间。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="32a8" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">这仅仅意味着“如果<strong class="jf hv"> optionalInt </strong>为<strong class="jf hv"> nil </strong>则使用零，否则使用其展开值”。</p><h1 id="f067" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">可选链接</h1><p id="65c9" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated"><em class="lj">可选链接</em>是一个特性，允许调用可选的属性和方法，这些属性和方法目前可能是空的。与会导致运行时异常的<em class="lj">强制展开</em>不同，当可选链接为零时，<em class="lj">可选链接</em>会正常失败。</p><p id="a259" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">让我们来看看这个例子:一个人可能有也可能没有银行账户，而银行账户肯定有余额。因此，如果我们想获得一个人的银行账户的余额，我们可能需要首先检查他/她是否有银行账户，如果答案是肯定的，就获得其余额。这就是<em class="lj">可选链接</em>和不用打开盒子就能使用盒子的想法发挥作用的地方。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="lm ln l"/></div></figure><p id="3b92" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">而不是放“！”为了解开<strong class="jf hv">银行账户</strong>，我们把“？”在它之后说“如果这个人有银行账户，那么继续并得到它的余额，如果<strong class="jf hv">银行账户</strong>是<strong class="jf hv">零</strong>，就返回<strong class="jf hv">零</strong>作为它的<strong class="jf hv">余额</strong>”。因此，<em class="lj">可选链接</em>的结果总是一个<em class="lj">可选</em>。所以本质上<em class="lj">可选链接</em>允许我们不用担心叫做<strong class="jf hv"> bankAccount </strong>的盒子里面是什么。如果盒子是空的，我们得到一个空盒子作为结果，如果盒子有一个值，我们得到包装在另一个盒子里的预期结果。</p><h1 id="b3b6" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated"><strong class="ak">总之</strong></h1><p id="691d" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated">期权并没有那么可怕，对吧？我们刚刚了解到，它们代表一种包装器类型，它们就像一个包装一个值的盒子，盒子可以以3种不同的方式打开<br/> 1) <em class="lj">强制解包</em>(嘿，我确定盒子不是空的，请打开它，如果我错了，就通过崩溃我的应用程序来惩罚我)<br/> 2) <em class="lj">可选绑定</em>(嘿，我不确定盒子里面是什么，小心打开它，如果是空的， 不要对它执行任何操作)<br/> 3)我<em class="lj">简单地打开选项</em>(嘿，我确信一旦它第一次被设置，我就会有一个值，我不想在我的代码中到处麻烦地打开它)<br/>我们了解到，由于<em class="lj"> nil合并</em>，在空框的情况下，我们可以有一种非常简洁的方式来使用默认值。 <br/>最后我们了解了<em class="lj">可选链接</em>。我们了解到，我们并不总是需要打开盒子才能使用它，这就是<em class="lj">选装件</em>的全部魅力所在。我没有深入那个主题来谈论<em class="lj">地图</em>和<em class="lj">平面地图</em>，因为它会让初学者(本文一般针对他们)的事情变得复杂，但是现在当你理解了如何处理<em class="lj">选项时，</em>我强烈鼓励你深入。底部有一些非常棒的资源。</p><h1 id="26c5" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">参考资料和有用的来源</h1><p id="920f" class="pw-post-body-paragraph jd je hu jf b jg le ji jj jk lf jm jn jo lg jq jr js lh ju jv jw li jy jz ka hn dt translated"><strong class="jf hv">参考资料</strong> : <br/> <a class="ae jc" href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID309" rel="noopener ugc nofollow" target="_blank"> Swift编程语言指南</a> <br/> <a class="ae jc" href="http://matteomanferdini.com/complete-guide-to-swift-optionals/" rel="noopener ugc nofollow" target="_blank">理解Swift选项的完整指南</a>Matteo Manferdini著。绝对推荐看这本简书。您也可以通过电子邮件订阅获取Matteo的其他有用指南和文章。<br/> <a class="ae jc" href="https://itunes.apple.com/us/course/developing-ios-9-apps-swift/id1104579961" rel="noopener ugc nofollow" target="_blank">用Swift开发iOS 9应用——斯坦福大学课程</a></p><p id="f738" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">理解选项为单子的来源</strong> : <br/> <a class="ae jc" href="http://www.mokacoding.com/blog/functor-applicative-monads-in-pictures" rel="noopener ugc nofollow" target="_blank"> Swift函子、应用程序和图片中的单子</a> <br/> <a class="ae jc" href="https://www.youtube.com/watch?v=ZhuHCtR3xq8" rel="noopener ugc nofollow" target="_blank"> Brian Beckman:不要害怕单子</a> <br/> <a class="ae jc" href="https://www.quora.com/What-are-monads-in-functional-programming-and-why-are-they-useful" rel="noopener ugc nofollow" target="_blank">一些伟大的Quora答案</a><br/><a class="ae jc" href="http://blog.xebia.com/the-power-of-map-and-flatmap-of-swift-optionals/" rel="noopener ugc nofollow" target="_blank">Swift选项的Map和FlatMap的力量</a></p><p id="6017" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">如果您有任何问题或反馈，请不要犹豫，张贴出来，我将很高兴回答您的问题或得到您的宝贵反馈。祝您愉快地学习Swift！</p><div class="kc kd ke kf fq ab cb"><figure class="lt iv lu lv lw lx ly paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lt iv lu lv lw lx ly paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lt iv lu lv lw lx ly paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lz ma mb"><p id="f922" class="jd je lj jf b jg jh ji jj jk jl jm jn mc jp jq jr md jt ju jv me jx jy jz ka hn dt translated"><a class="ae jc" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿美族家庭的一员。我们现在<a class="ae jc" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jc" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jd je lj jf b jg jh ji jj jk jl jm jn mc jp jq jr md jt ju jv me jx jy jz ka hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jc" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jc" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="fe ff mf"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>