<html>
<head>
<title>Creating a Scripting Language with ANTLR — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用ANTLR创建脚本语言—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/creating-a-scripting-language-with-antlr-part-2-ba4d8d6eab55?source=collection_archive---------1-----------------------#2016-05-13">https://medium.com/hackernoon/creating-a-scripting-language-with-antlr-part-2-ba4d8d6eab55?source=collection_archive---------1-----------------------#2016-05-13</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c91b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第一部分中，我们学习了编译器理论的基础，以及ANTLR在计算机语言识别中的作用。现在，我们将继续使用ANTLR在代码中构建AST。</p><p id="ee38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您还没有安装ANTLR，请按照官方<a class="ae jp" href="https://github.com/antlr/antlr4/blob/master/doc/getting-started.md" rel="noopener ugc nofollow" target="_blank">入门页面</a>上的说明进行操作。</p><p id="0c60" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您不知道如何编写或阅读ANTLR 4语法，那么您可以通过非常详细的ANTLR 4文档来学习。信不信由你，这并不是关于ANTLR语法本身的教程。不管怎样，你可以在不真正了解ANTLR的情况下阅读本指南。</p></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="ac14" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们的系统上有了ANTLR，我们可以设计我们的语言和编写我们的语法了。</p><p id="ac33" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将遵循第1部分中的示例，编写一个运行这种类型代码的语法:</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="a108" class="kg kh hu kc b fv ki kj l kk kl">set sky to "blue"<br/>set roses to 3</span><span id="d997" class="kg kh hu kc b fv km kj l kk kl">say "The sky is colored ${sky}."<br/>say "I have ${roses} roses."</span></pre><p id="60a3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的语法文件可能如下所示:</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="1f31" class="kg kh hu kc b fv ki kj l kk kl">grammar Foo;</span><span id="71e4" class="kg kh hu kc b fv km kj l kk kl">compilationUnit: stmt*;<br/>stmt:<br/>    assignStmt<br/>    | invocationStmt<br/>;<br/>assignStmt: SET ID TO expr;<br/>invocationStmt: name=ID ((expr COMMA)* expr)?;</span><span id="9331" class="kg kh hu kc b fv km kj l kk kl">expr: ID | INT | STRING;</span><span id="a404" class="kg kh hu kc b fv km kj l kk kl">COMMA: ',';<br/>SAY: 'say';<br/>SET: 'set';<br/>TO: 'to';</span><span id="8a75" class="kg kh hu kc b fv km kj l kk kl">INT: [0-9]+;<br/>STRING: '"' (~('\n' | '"'))* '"';<br/>ID: [a-zA-Z_] [a-zA-Z0-9_]*;</span></pre><p id="fb3e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后我们可以简单地从命令行调用ANTLR来生成词法分析器和语法分析器。在最基本的情况下，我们只需要提供输入语法的名称，以及<em class="kn"> "-Dlanguage=JavaScript" </em>来告诉ANTLR我们想要JavaScript输出。</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="5b23" class="kg kh hu kc b fv ki kj l kk kl">antlr4 -Dlanguage=JavaScript Foo.g4</span></pre><p id="3bfc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将给你留下大约5个文件，包括<em class="kn"> FooLexer.js </em>、<em class="kn"> FooParser.js </em>和<em class="kn"> FooListener.js </em>。</p></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="eb90" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在代码中使用它非常容易。以下函数获取输入文本并返回生成的<a class="ae jp" href="https://hackernoon.com/tagged/ast" rel="noopener ugc nofollow" target="_blank"> AST </a>。</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="8bfd" class="kg kh hu kc b fv ki kj l kk kl">var antlr4 = require('antlr4');<br/>var FooLexer = require('./FooLexer').FooLexer;<br/>var FooParser = require('./FooParser').FooParser;</span><span id="2d32" class="kg kh hu kc b fv km kj l kk kl"><strong class="kc hv">function buildAst</strong>(inputText) {<br/>    <strong class="kc hv">var </strong>chars = <strong class="kc hv">new </strong>antlr4.InputStream(inputText);<br/>    <strong class="kc hv">var </strong>lexer = <strong class="kc hv">new </strong>FooLexer(chars);<br/>    <strong class="kc hv">var </strong>tokens = <strong class="kc hv">new </strong>antlr4.CommonTokenStream(lexer);<br/>    <strong class="kc hv">var </strong>parser = <strong class="kc hv">new </strong>FooParser(tokens);<br/>    parser.buildParseTrees = <strong class="kc hv">true</strong>;</span><span id="3488" class="kg kh hu kc b fv km kj l kk kl">    <strong class="kc hv">return </strong>parser.compilationUnit();<br/>}</span><span id="1e49" class="kg kh hu kc b fv km kj l kk kl">module.exports = buildAst;</span></pre></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="08f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用ANTLR，创建一个词法分析器<em class="kn">和一个解析器</em>只需要几毫秒的时间。想象一下手写这些！</p><p id="b1e4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第3部分的<a class="ae jp" rel="noopener" href="/@thosakwe/creating-a-scripting-language-with-antlr-part-2-e41fc68c60ba">中，我们将通过从我们的编译器中分离出</a><a class="ae jp" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> Javascript </a>来结束一切。敬请期待！</p><blockquote class="ko kp kq"><p id="4e74" class="ir is kn it b iu iv iw ix iy iz ja jb kr jd je jf ks jh ji jj kt jl jm jn jo hn dt translated">黑客中午是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is kn it b iu iv iw ix iy iz ja jb kr jd je jf ks jh ji jj kt jl jm jn jo hn dt translated">要了解更多信息，<a class="ae jp" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">请阅读我们的“关于”页面</a> , <a class="ae jp" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">喜欢/在脸书给我们发消息</a>，或者简单地，<a class="ae jp" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank">发推文/DM @HackerNoon。</a></p><p id="708a" class="ir is kn it b iu iv iw ix iy iz ja jb kr jd je jf ks jh ji jj kt jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jx jy jz ka fq ku"><div class="bz el l di"><div class="kv kw l"/></div></figure></div></div>    
</body>
</html>