<html>
<head>
<title>Isomorphic Javascript, let’s make it easier.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">同构Javascript，我们来简化一下。</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/isomorphic-javascript-it-just-has-to-work-b9da5b0c8035?source=collection_archive---------1-----------------------#2016-06-12">https://medium.com/hackernoon/isomorphic-javascript-it-just-has-to-work-b9da5b0c8035?source=collection_archive---------1-----------------------#2016-06-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="b19d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">同构的</strong>I so mor phic(ī'sə-môr'fĭk)<em class="jp"><br/></em>具有相似的结构或外貌但却是不同的祖先。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/df904d3d5e7e50d929d6061767b6c805.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*uAc5PB_aMuAK73M73J2htQ.png"/></div></figure><p id="c195" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">自从发明了<a class="ae jy" href="https://hackernoon.com/tagged/nodejs" rel="noopener ugc nofollow" target="_blank"> NodeJS </a>以来，人们就喜欢这样的想法，你可以在整个堆栈中“分享”你的<a class="ae jy" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>体验。这(理论上)有很多好处，包括语言之间的上下文切换更少，前端和后端之间的转换更容易，也许最有希望的好处是能够共享代码。今天我将向你展示我们已经走了多远，以及同构JavaScript的可能性。</p><p id="72ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好的，我们都知道在<a class="ae jy" href="http://browserify.org/" rel="noopener ugc nofollow" target="_blank"> browserify </a>或<a class="ae jy" href="https://webpack.github.io/" rel="noopener ugc nofollow" target="_blank"> webpac </a> k的帮助下，有可能普遍使用像Lodash这样的实用程序。<a class="ae jy" href="https://github.com/matthew-andrews/isomorphic-fetch" rel="noopener ugc nofollow" target="_blank">检查</a> —同构获取允许我们这样做。如何移动表单和文件？<a class="ae jy" href="https://github.com/form-data/isomorphic-form-data" rel="noopener ugc nofollow" target="_blank">检查</a> —同构表单数据与同构获取同样完美地工作！如果我需要能够检测我的环境呢；我不是用流星吗？！<a class="ae jy" href="https://www.npmjs.com/package/isbrowser" rel="noopener ugc nofollow" target="_blank">盖好了</a>。现在，在诸如<a class="ae jy" href="https://facebook.github.io/react/" rel="noopener ugc nofollow" target="_blank"> React </a>、<a class="ae jy" href="https://github.com/dekujs/deku" rel="noopener ugc nofollow" target="_blank"> Deku </a>和许多其他库中实现的“虚拟DOM”的帮助下，甚至可以使DOM同构。你甚至可以选择完全退出虚拟DOM，直接用诸如<a class="ae jy" href="https://github.com/patrick-steele-idem/morphdom" rel="noopener ugc nofollow" target="_blank"> morphdom </a>、<a class="ae jy" href="https://github.com/DylanPiercey/set-dom" rel="noopener ugc nofollow" target="_blank"> set-dom </a>和<a class="ae jy" href="https://github.com/tbranyen/diffhtml" rel="noopener ugc nofollow" target="_blank"> diffHTML </a>之类的工具来编写简单的“静态”html。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="jz ka l"/></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">This example, although simple, will batch send 100 emails at a time to a custom api and can work just fine in NodeJS or the browser.</figcaption></figure><p id="60db" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这开始看起来很酷了。我现在可以编写一个应用程序，在节点和浏览器中使用相同的工具、ajax和模板！嗯，我们还没到那一步。还是少了太多！我们需要路由(带重定向)、会话、cookies、状态管理等等来制作一个通用的应用程序！Node允许我们将这些任务中的大部分委托给Express和Koa等框架，并允许轻松地将功能组织到中间件中。您可以隔离功能，我可以轻松地测试它们！这是一种简单的、自顶向下的、可插拔的构建html的方法——你可以很容易地在整个应用程序中跟踪一个请求(听起来像flux anyone？).为什么我们不能以同样有组织的方式构建DOM？React拉近了我们的距离，但还是不够。React路由器拉近了我们的距离，但它陌生而笨重。</p><p id="8806" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好吧，我的朋友们，我一直在努力让同构JavaScript更有趣、更容易编写。更少的锅炉板，更少的从客户端到服务器的上下文切换，免费的渐进式增强，更快的加载时间，搜索引擎优化，最重要的是一种更简单的方式来思考web应用程序。现在有一种方法可以与node共享90%的浏览器代码。这是一个已经开发了一年多的框架，部分原因是我在<a class="ae jy" href="http://tillerdigital.ca/" rel="noopener ugc nofollow" target="_blank"> Tiller Digital </a>的亲切的雇主和无数其他致力于缩小同构工具差距的人。它的名字叫<a class="ae jy" href="https://github.com/rill-js/rill" rel="noopener ugc nofollow" target="_blank">小溪</a>。</p><h1 id="1438" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">太好了。另一个框架。它是做什么的？</h1><p id="595a" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">Rill是对我们最常用的节点部分的抽象，即<a class="ae jy" href="https://nodejs.org/api/http.html" rel="noopener ugc nofollow" target="_blank"> HTTP </a>服务器。然而，由于<a class="ae jy" href="https://github.com/rill-js/http" rel="noopener ugc nofollow" target="_blank"> @rill/http </a>，它以同构的方式公开了http api。路由、重定向、cookies、会话、刷新、错误处理，甚至是像“用户代理”、“推荐者”和“地区”这样的常见标题。您最终可以从同一个api、客户机或服务器访问关于用户或请求的所有数据，而这恰好与Node相同。</p><p id="ffa1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不过，Rill不仅仅是这样，<a class="ae jy" href="https://github.com/rill-js/http" rel="noopener ugc nofollow" target="_blank"> @rill/http </a>只是一个模块。<a class="ae jy" href="https://github.com/rill-js/rill" rel="noopener ugc nofollow" target="_blank"> Rill </a>(主库)更类似于<a class="ae jy" href="https://github.com/strongloop/express" rel="noopener ugc nofollow" target="_blank"> Express </a>或<a class="ae jy" href="https://github.com/koajs/koa" rel="noopener ugc nofollow" target="_blank"> Koa </a>，共享一个相当相似的api。它支持同构环境中的中间件，并为任何应用程序提供最终版本。数据流动的方式。你可以在这里查看<a class="ae jy" href="https://github.com/rill-js/rill/tree/master/docs/api" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="jz ka l"/></div></figure><p id="d173" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就这样，索引页面现在完全可以由浏览器或节点服务器呈现了。但这并不令人印象深刻，导航呢？那么“/离开”呢？</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="jz ka l"/></div></figure><p id="4b41" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在你可以来回导航，浏览器会处理它。请随意关闭JavaScript，因为您的服务器也完全有能力！没有尴尬的环境，没有“服务器代码”或“客户端代码”，只是渲染你的观点！</p><p id="11a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这可能很酷，但是如果我的页面只是静态内容，那么这就太过了(尽管它有一些好处)。我的CRUD应用程序呢？用户如何输入数据？好吧，答案只是另一个问题“如果没有前端JavaScript，你会怎么做？”。Rill让你假装你的浏览器是一个完全有能力的节点服务器，它甚至可以处理表单提交！让我们添加一个表单！</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="jz ka l"/></div></figure><p id="3b44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这太棒了，它可以在Node和浏览器中完美运行。我们可以像在Node中一样编程，当浏览器接管时，渐进增强变得很容易。需要一个可以在你打字时搜索的搜索输入吗？只需使用React来触发提交按钮“onClick”。它会正常工作，和手动操作一样快。额外的好处是，如果JavaScript失败，您的服务器完全知道如何“反应”！</p><p id="d92a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这只是冰山一角。这种开发风格的模块仍在工作，尚未达到极限。我个人认为像“<a class="ae jy" href="https://github.com/Automattic/node-canvas" rel="noopener ugc nofollow" target="_blank">节点画布</a>”和“<a class="ae jy" href="https://github.com/node-file-api/file-api" rel="noopener ugc nofollow" target="_blank">节点文件API </a>”这样的工具可以逐步增强图像操作。对于当前兼容Rill的中间件列表，只需<a class="ae jy" href="https://github.com/rill-js/rill/wiki" rel="noopener ugc nofollow" target="_blank">点击此处</a>，或<a class="ae jy" href="https://www.npmjs.com/search?q=rill" rel="noopener ugc nofollow" target="_blank">点击此处</a>。</p><p id="f289" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就这样。您可以获得以前习惯的“仅服务器”解决方案的表现力和简单性，并能够在可用时将大量逻辑卸载到前端。有很多东西需要理解，这当然是构建前端应用程序的一种不同方式，但也很熟悉。编写您可爱的节点代码，并让它在两个地方都能工作。在服务器中快速初始渲染，在浏览器中快速重新渲染。两全其美，JavaScript web开发的顶点，圣杯。</p><p id="86c5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">如果您对Rill、同构/通用JavaScript或如何以这种方式构建真正的应用程序有任何疑问，请访问</em> <a class="ae jy" href="https://gitter.im/rill-js/rill" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> gitter页面</em> </a> <em class="jp">。</em></p><div class="jr js jt ju fq ab cb"><figure class="li jv lj lk ll lm ln paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="li jv lj lk ll lm ln paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="li jv lj lk ll lm ln paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lo lp lq"><p id="f922" class="ir is jp it b iu iv iw ix iy iz ja jb lr jd je jf ls jh ji jj lt jl jm jn jo hn dt translated"><a class="ae jy" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jy" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jy" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jy" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb lr jd je jf ls jh ji jj lt jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jy" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jy" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><a href="https://goo.gl/Ahtev1"><div class="fe ff lu"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></a></figure><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lv ka l"/></div></figure></div></div>    
</body>
</html>