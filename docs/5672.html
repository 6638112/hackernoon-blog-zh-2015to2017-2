<html>
<head>
<title>Don’t blindly trust the Docker ping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要盲目相信码头工人</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/dont-blindly-trust-the-docker-ping-fce462944e9c?source=collection_archive---------10-----------------------#2017-08-09">https://medium.com/hackernoon/dont-blindly-trust-the-docker-ping-fce462944e9c?source=collection_archive---------10-----------------------#2017-08-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="949a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我今天在一个阿尔卑斯山的<a class="ae jt" href="https://hub.docker.com/_/alpine/" rel="noopener ugc nofollow" target="_blank">码头</a>集装箱里玩着古老的<code class="eh jp jq jr js b">ping</code>指令。我想为另一个服务执行一个小的负载测试，所以我试验了不同的包大小(<code class="eh jp jq jr js b">ping -s &lt;size in byte&gt;</code>)，这给我带来了相当多的与MTU相关的挫折(但那是另外一个故事)。</p><p id="1aaf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在docker上搜索pings的时候，我偶然发现了这个论坛的帖子。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff ju"><img src="../Images/6d81411f134a3b5444ca2720f103418d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdWcZNDO5Q4cfNdzpvPpxg.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Header of forum post about misbehaving pings in docker containers on MAC</figcaption></figure><p id="9751" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我会让你自己读这篇文章，而不是复制这里的所有内容，但本质是:<strong class="it hv"> ping数据包可能会返回给你，即使你发送ping到一个不存在的主机</strong>。</p><p id="e9ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是真的。我随机选择了一个IP地址，并确保它不能从我的桌面上ping通。</p><pre class="jv jw jx jy fq kk js kl km aw kn dt"><span id="bd5a" class="ko kp hu js b fv kq kr l ks kt">$ ping 11.12.13.14 -c 5<br/>PING 11.12.13.14 (11.12.13.14): 56 data bytes<br/>Request timeout for icmp_seq 0<br/>Request timeout for icmp_seq 1<br/>Request timeout for icmp_seq 2<br/>Request timeout for icmp_seq 3<br/>^C<br/>--- 11.12.13.14 ping statistics ---<br/>5 packets transmitted, 0 packets received, 100.0% packet loss</span></pre><p id="e356" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后在Docker容器中运行它。</p><pre class="jv jw jx jy fq kk js kl km aw kn dt"><span id="6b0d" class="ko kp hu js b fv kq kr l ks kt">$ docker run alpine ping 11.12.13.14 -c 5<br/>PING 11.12.13.14 (11.12.13.14): 56 data bytes<br/>64 bytes from 11.12.13.14: seq=0 ttl=37 time=0.447 ms<br/>64 bytes from 11.12.13.14: seq=1 ttl=37 time=0.469 ms<br/>64 bytes from 11.12.13.14: seq=2 ttl=37 time=0.524 ms<br/>64 bytes from 11.12.13.14: seq=3 ttl=37 time=0.476 ms<br/>64 bytes from 11.12.13.14: seq=4 ttl=37 time=0.461 ms</span><span id="2de6" class="ko kp hu js b fv ku kr l ks kt">--- 11.12.13.14 ping statistics ---<br/>5 packets transmitted, 5 packets received, 0% packet loss<br/>round-trip min/avg/max = 0.447/0.475/0.524 ms</span></pre><p id="3d4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是个坏消息，因为这意味着你再也不能真正信任<code class="eh jp jq jr js b">ping</code>了。您可能有一个运行状况检查，它通过pings测试到您的一个生产服务的连接性，并且即使该服务关闭了也一直报告绿色。</p><p id="9d7a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">更糟糕的是，并不是所有的假IP都会出现这种情况，论坛帖子是一年多前创建的。</p><p id="af70" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好消息是，这只发生在MAC上的Docker上(也许Windows也是)，而不是Linux上。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff kv"><img src="../Images/891a5926871928007c1cf149095e7701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIRqe157rE_qQfrWSIhSWg.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Screenshot of the “ghost ping”.</figcaption></figure><figure class="jv jw jx jy fq jz"><div class="bz el l di"><div class="kw kx l"/></div></figure></div></div>    
</body>
</html>