<html>
<head>
<title>Introducing AlloyCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AlloyCI简介</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/introducing-alloyci-a41aef2dd2f1?source=collection_archive---------12-----------------------#2017-09-13">https://medium.com/hackernoon/introducing-alloyci-a41aef2dd2f1?source=collection_archive---------12-----------------------#2017-09-13</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="0d46" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">用Elixir &amp; Phoenix编写的新的持续集成协调器</h2></div><p id="1e1e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我想学长生不老药和凤凰已经有一段时间了，几个月前我终于决定尝试一下。我开始阅读迪夫·托马斯的《编程<a class="ae kf" href="https://hackernoon.com/tagged/elixir" rel="noopener ugc nofollow" target="_blank">灵丹妙药</a> 1.3》和克里斯·麦考德等人的《编程凤凰》。艾尔。(均来自《实用主义书架》，如果想入门《仙丹与凤凰》，强烈推荐)。</p><p id="9467" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我遵循了书中的大部分代码指南，但有时仍然感觉有点陌生。我想做一些更复杂、更有挑战性的东西。我还想把它作为开源软件发布，所以它必须对更广泛的受众有用，而不仅仅是我。</p><p id="4710" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我一直喜欢CI系统和它们提供的价值，但是我还没有找到一个能提供我所需要的一切的系统。我希望它高度可配置，易于扩展，易于安装，有一个健壮的执行器，可以在多种操作系统上运行，并且是<strong class="jl hv">开源的</strong>。与此最接近的CI服务是GitLab CI，但它与GitLab本身紧密耦合，所以我不能在GitHub中使用它。我也不想安装一个完整的源代码管理系统<strong class="jl hv"> <em class="kg">只是为了它的CI服务</em> </strong>。</p><p id="cc96" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这就是创建竞争情报系统的想法的来源。我在GitLab的时候学到了很多关于CI系统应该如何工作的知识，所以我觉得这是向前迈出的正确一步。事实上，我决定使用GitLab CI Runner作为这个项目的执行者。</p><p id="e50d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">GitLab CI Runner是在<strong class="jl hv"> Go </strong>中编写的，它是实际负责运行构建的一段代码，以及执行管道所需的任何其他操作。最棒的是，它基本上是一个<strong class="jl hv">“哑盒子”</strong>，这意味着你需要做的就是告诉它以它期望的方式做什么，它就会去做！它也非常强大和可配置，它可以使用Docker来执行您的构建，并利用Docker Machine让您自动缩放它用于您的构建的机器，它可以使用Kubernetes，在Digital Ocean的虚拟机上运行，运行Xcode和Windows构建，等等。</p><p id="3462" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用一个已经存在的项目作为我的CI系统的执行程序，让我可以专注于协调程序，这是一个软件，它读取项目的配置，创建管道，构建，并以它期望的方式将所有这些信息发送给执行程序。它还收集由执行者传递的所有信息，如构建跟踪和其他工件，并以一种易于理解的方式呈现给用户。</p><p id="eee0" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因为这是一篇介绍性的文章，所以我不会详细介绍AlloyCI不同部分的实现。为此，我将创建几个独立的帖子，并尽可能详细地介绍。现在，让我告诉你它的特点。</p><p id="80a8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">(<a class="ae kf" href="https://hackernoon.com/alloyci-dev-diary-part-1-8ae564fce9f3" rel="noopener ugc nofollow" target="_blank"> AlloyCI Dev日记的第1部分是<strong class="jl hv"> live！</strong> </a>)</p><h1 id="b733" class="kh ki hu bd kj kk kl km kn ko kp kq kr ja ks jb kt jd ku je kv jg kw jh kx ky dt translated">特征</h1><p id="be6c" class="pw-post-body-paragraph jj jk hu jl b jm kz iv jo jp la iy jr js lb ju jv jw lc jy jz ka ld kc kd ke hn dt translated">请记住，这是AlloyCI的第一次公开发布，而且它只有0.1.0版本。随着时间的推移，许多功能将会得到改进，随着我们向1.0迈进，还会有更多的功能出现。你可以在这里查看1.0的路线图:<a class="ae kf" href="https://github.com/supernova32/alloy_ci/projects/1" rel="noopener ugc nofollow" target="_blank">https://github.com/AlloyCI/alloy_ci/projects/1</a>如果你想贡献点什么，请继续。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff le"><img src="../Images/179816506db988412a80202b816cde0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXQQ9U2u9W2qjy4cin-z4Q.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">User’s Dashboard</figcaption></figure><h2 id="0f41" class="lu ki hu bd kj lv lw lx kn ly lz ma kr js mb mc kt jw md me kv ka mf mg kx mh dt translated">基本配置项功能</h2><p id="6b77" class="pw-post-body-paragraph jj jk hu jl b jm kz iv jo jp la iy jr js lb ju jv jw lc jy jz ka ld kc kd ke hn dt translated">对于0.1版，目标是至少具备CI功能的最基本要素。其中包括以下内容:</p><ul class=""><li id="f50d" class="mi mj hu jl b jm jn jp jq js mk jw ml ka mm ke mn mo mp mq dt translated">解析配置文件以创建和准备构建和管道</li><li id="c695" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">支持不同的构建阶段</li><li id="2e35" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">允许构建和运行者被标记，从而允许细粒度的控制哪个运行者选择哪个构建</li><li id="2293" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">以预期的格式处理并发送构建信息到GitLab Runner</li><li id="e312" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">接受从GitLab Runner收到的关于特定构建的信息</li><li id="f1c4" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">显示每个构建的输出跟踪，并在查看活动构建时跟踪它</li><li id="d6e8" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">正确管理每个构建的状态，并且只向运行者发送应该被处理的构建</li><li id="afae" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">通过上次提交的<strong class="jl hv"> SHA </strong>引用向GitHub报告每次推送的状态</li><li id="a3c9" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">通过电子邮件和/或Slack向用户发送有关管道状态的通知</li><li id="4a25" class="mi mj hu jl b jm mr jp ms js mt jw mu ka mv ke mn mo mp mq dt translated">通过<code class="eh mw mx my mz b">deploy</code>阶段执行自动部署</li></ul><p id="da00" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">就商业上可用的CI系统而言，AlloyCI与其他CI服务提供的过多功能相比相形见绌，但这没关系。我想从简单开始，从CI体验中提炼出最必要的特性。铃声和汽笛声将随后出现😉</p><h2 id="b568" class="lu ki hu bd kj lv lw lx kn ly lz ma kr js mb mc kt jw md me kv ka mf mg kx mh dt translated">临时演员</h2><p id="3a87" class="pw-post-body-paragraph jj jk hu jl b jm kz iv jo jp la iy jr js lb ju jv jw lc jy jz ka ld kc kd ke hn dt translated">我只是为了“值得拥有”的价值添加了一些东西，即每个项目和运行者的构建统计数据。您可以看到一些漂亮的图表，描绘了过去一周的构建数量、成功或失败的数量以及处理的构建总数。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff le"><img src="../Images/696cc5311bd5d132580baef4a558cf00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJjV85CI9B1A2y5r8HJ1IA.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">Project’s Settings</figcaption></figure><p id="49cb" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">runners图表还将减少project处理的构建数量，因此您可以看到哪些runners正在处理哪些构建。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff le"><img src="../Images/ffd9cad59005f1e259a95c915456dcf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vjvHOg1Q3911Yk8YSqDkGQ.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">Runner’s Admin Settings</figcaption></figure><h1 id="aab2" class="kh ki hu bd kj kk kl km kn ko kp kq kr ja ks jb kt jd ku je kv jg kw jh kx ky dt translated">怎么才能试出来呢？</h1><p id="532c" class="pw-post-body-paragraph jj jk hu jl b jm kz iv jo jp la iy jr js lb ju jv jw lc jy jz ka ld kc kd ke hn dt translated">您可以使用Docker和Docker Compose在自己的服务器上安装AlloyCI。请按照我们的<a class="ae kf" href="https://github.com/AlloyCI/alloy_ci/tree/master/doc#installation" rel="noopener ugc nofollow" target="_blank">文档</a>开始。</p><p id="0ea7" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">试用AlloyCI最简单的方法是去<a class="ae kf" href="https://alloy-ci.com" rel="noopener ugc nofollow" target="_blank">https://alloy-ci.com</a>，用你的GitHub账户登录，然后添加一个项目。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff le"><img src="../Images/e9392040ff4ecd2de167c6e036fef751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*duDf8fQkVOubCiippouF0w.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">New Project’s View</figcaption></figure><p id="85f1" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在添加项目之前，系统会提示您在自己的帐户上安装AlloyCI集成。这样做之后，您想要添加的项目在添加之前需要有一个<code class="eh mw mx my mz b">.alloy-ci.json</code>配置文件。你可以阅读更多关于如何创建这个文件<a class="ae kf" href="https://github.com/AlloyCI/alloy_ci/tree/master/doc/json" rel="noopener ugc nofollow" target="_blank">在这里</a>。这里有一个关于灵丹妙药的简单例子:</p><pre class="lf lg lh li fq na mz nb nc aw nd dt"><span id="3fd3" class="lu ki hu mz b fv ne nf l ng nh">{<br/>  "image": "elixir:latest",<br/>  "services": [<br/>    "postgres"<br/>  ],<br/>  "before_script": [<br/>    "mix deps.get"<br/>  ],<br/>  "after_script": [<br/>    "rm secrets"<br/>  ],<br/>  "stages": [<br/>    "build",<br/>    "test",<br/>    "deploy"<br/>  ],<br/>  "mix credo": {<br/>    "stage": "build",<br/>    "script": ["mix credo"],<br/>    "tags": ["elixir"]   <br/>  },<br/>  "mix test": {<br/>    "stage": "test",<br/>    "script": ["mix test"],<br/>    "tags": ["postgres", "elixir"]   <br/>  }<br/>}</span></pre><p id="d1cc" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">一旦文件被提交到存储库中，您就可以将它添加到AlloyCI中了。添加项目并推送新代码后，您将在项目的仪表板中看到新创建的管道。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff le"><img src="../Images/77dcc99c5ec383232554d7e8221d70c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arXvTJOKVBjaIhQXWH_W3A.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">Project’s Dashboard</figcaption></figure><p id="ef7f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您单击pipeline，它会将您带到它的构建，在那里您可以跟踪它们的输出和整体状态。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff le"><img src="../Images/f6f915d5c052dc5a44566ff8c07635e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVbaMpp2uscxUcs9eQTUJQ.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">Build Job’s Output</figcaption></figure><p id="1542" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">测试服务器资源有限，并且只有2个注册的运行者来处理构建，所以处理您的管道需要一段时间。幸运的是，你可以将你自己的跑步者注册为“项目特定跑步者”，这意味着它将只从你自己的特定项目中获取构建。有关如何添加特定跑步者的说明，请转到您项目的设置。</p><h1 id="4b67" class="kh ki hu bd kj kk kl km kn ko kp kq kr ja ks jb kt jd ku je kv jg kw jh kx ky dt translated">我为什么要建造AlloyCI？</h1><p id="621e" class="pw-post-body-paragraph jj jk hu jl b jm kz iv jo jp la iy jr js lb ju jv jw lc jy jz ka ld kc kd ke hn dt translated">我之前提到过，我建AlloyCI是为了学习仙丹和凤凰。我选择了一个CI协调人，因为我对他们很熟悉，并想加入我自己对他们的看法。我也将它作为<strong class="jl hv"> GPLv3 </strong>许可开源代码发布，因为我认为其他人可能会觉得它有用。拥有一个重要的代码库是学习一门新语言的绝佳资源。我知道我的代码远非完美，但这是一个开始，我希望人们能看看它，批评它，并提供有用的反馈，这样我、<strong class="jl hv">和其他人</strong>，就可以从这个项目中学习和受益。</p><p id="1be8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我将继续开发AlloyCI一段时间。我计划在可预见的未来维护它，我甚至可能考虑在Elixir本身中编写一个新的runner/executor，这样项目就不依赖于GitLab保持GitLab Runner开源和维护的良好意图。</p><p id="f17a" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt">—</p><p id="911f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你喜欢这个项目，请把它放在GitHub上，如果你想到这个项目可以使用的东西，或者有一些建议或反馈，无论如何，请打开一个问题。我想去❤️听听你的想法。</p><figure class="lf lg lh li fq lj"><div class="bz el l di"><div class="ni nj l"/></div></figure></div></div>    
</body>
</html>