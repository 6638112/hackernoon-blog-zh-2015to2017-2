<html>
<head>
<title>Beware of dilution of DynamoDB throughput due to excessive scaling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当心由于过度扩展而导致的DynamoDB吞吐量的稀释</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/beware-of-dilution-of-dynamodb-throughput-due-to-excessive-scaling-4df51063edae?source=collection_archive---------4-----------------------#2017-05-04">https://medium.com/hackernoon/beware-of-dilution-of-dynamodb-throughput-due-to-excessive-scaling-4df51063edae?source=collection_archive---------4-----------------------#2017-05-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="ee6d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">2020年1月26日更新:自从写这篇文章以来，吞吐量稀释的问题已经通过DynamoDB的</strong> <a class="ae jp" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/bp-partition-key-design.html#bp-partition-key-partitions-adaptive" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">自适应能力</strong> </a> <strong class="it hv">特性得到了解决，该特性就是实时应用的</strong><a class="ae jp" href="https://aws.amazon.com/about-aws/whats-new/2019/05/amazon-dynamodb-adaptive-capacity-is-now-instant/" rel="noopener ugc nofollow" target="_blank"><strong class="it hv"/></a><strong class="it hv">。</strong></p><p id="3459" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">DynamoDB表中的分区数量会随着负载或存储大小的增加而增加，但永远不会减少。</p><p id="45f6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">DynamoDB非常棒，但正如我在3家不同的公司——Gamesys、JUST EAT和现在的Space Ape Games——看到的这个特殊问题，我认为这是更多人应该注意的行为。</p><p id="cd5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢AWS，他们经常在DynamoDB Deep Dive会议上讨论计算分区数量的公式。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/e028a3c6f72e751be9b44fb6d26e0397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrbiCzV5Qi4Uge-E6KMOyQ.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">the no. of partitions in a DynamoDB table is determined by read unit, write unit and total storage size</figcaption></figure><p id="3df8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，他们经常忘记提到，当您减少吞吐量单位时，DynamoDB不会减少分区的数量。在冗长的<a class="ae jp" href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GuidelinesForTables.html" rel="noopener ugc nofollow" target="_blank">最佳实践</a>指南中，这是一个严重不足的关键细节。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kg"><img src="../Images/b090d7ff81ed62aa68d4690f3c3c5e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ImR4t5ZIMXvRhOBqK5p30w.png"/></div></div></figure><p id="20d0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">考虑以下场景:</p><ul class=""><li id="6f7a" class="kh ki hu it b iu iv iy iz jc kj jg kk jk kl jo km kn ko kp dt translated">您提高了表的吞吐量，因为流量突然激增，或者您需要额外的吞吐量来运行昂贵的扫描</li><li id="f497" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">额外的吞吐量导致DynamoDB增加了分区的数量</li><li id="7209" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">您将吞吐量调低到以前的水平，但是现在您会注意到，即使您没有超过表中提供的吞吐量，一些请求也会受到抑制</li></ul><p id="d18e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">发生这种情况是因为由于分区数量的增加，每个分区的读写吞吐量单位比以前少了。这意味着在每个分区上超过读/写吞吐量的可能性更高(即使您仍然处于表的总吞吐量限制之下)。</p><p id="4df8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当这种吞吐量稀释发生时，您可以:</p><ol class=""><li id="9f5a" class="kh ki hu it b iu iv iy iz jc kj jg kk jk kl jo kv kn ko kp dt translated">迁移到新表</li><li id="a8b3" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo kv kn ko kp dt translated">指定更高的表级吞吐量，将每个分区的吞吐量提高到以前的水平</li></ol><p id="e6d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">考虑到表迁移的困难，大多数人会选择选项2，这就是为什么尽管每秒消耗接近200个写单元，但JUST EAT最终得到一个具有3000多个写吞吐量单元的表。</p><p id="0cf2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">总之，你应该<strong class="it hv">在为了应对暂时的需求而大规模扩展DynamoDB表之前仔细考虑一下，这可能会带来长期的成本影响。</strong></p></div><div class="ab cl kw kx hc ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hn ho hp hq hr"><p id="feaf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">喜欢你正在读的东西吗？查看我的视频课程<a class="ae jp" href="https://bit.ly/prod-ready-serverless" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">生产就绪无服务器</strong> </a>，学习如何在生产中运行无服务器应用。</p><p id="072d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将讨论的主题包括:</p><ul class=""><li id="0ffa" class="kh ki hu it b iu iv iy iz jc kj jg kk jk kl jo km kn ko kp dt translated">使用API网关和Cognito进行身份验证和授权</li><li id="4f2f" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">在本地测试和运行功能</li><li id="28bc" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">项目组织策略</li><li id="16b4" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">CI/CD</li><li id="d586" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">集中伐木</li><li id="e72b" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">监视</li><li id="a85b" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">X射线分布式跟踪</li><li id="5115" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">跟踪相关id</li><li id="5cf3" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">性能和成本优化</li><li id="c88e" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">错误处理</li><li id="0e03" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">配置管理</li><li id="723e" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">金丝雀部署</li><li id="81f2" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">VPC</li><li id="8aec" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">安全</li><li id="a7db" class="kh ki hu it b iu kq iy kr jc ks jg kt jk ku jo km kn ko kp dt translated">Lambda、Kinesis和API网关的最佳实践</li></ul><p id="9465" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">并包括在最近的AWS re:Invent大会上宣布的所有最新变化！</p><div class="ld le fm fo lf lg"><a href="https://bit.ly/prod-ready-serverless" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab ej"><div class="li ab lj cl cj lk"><h2 class="bd hv fv z el ll eo ep lm er et ht dt translated">生产就绪无服务器</h2><div class="ln l"><h3 class="bd b fv z el ll eo ep lm er et ek translated">看到了。动手吧。学着点！生产就绪无服务器:运营最佳实践向您介绍领先的模式和…</h3></div><div class="lo l"><p class="bd b gc z el ll eo ep lm er et ek translated">bit.ly</p></div></div><div class="lp l"><div class="lq l lr ls lt lp lu ka lg"/></div></div></a></div></div></div>    
</body>
</html>