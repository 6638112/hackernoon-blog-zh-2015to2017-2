<html>
<head>
<title>Can I use R on production?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我可以在生产中使用R吗？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/can-i-use-r-on-production-e1cc4173513e?source=collection_archive---------4-----------------------#2017-06-11">https://medium.com/hackernoon/can-i-use-r-on-production-e1cc4173513e?source=collection_archive---------4-----------------------#2017-06-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="37d7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">我运行R进行生产数据处理的经验</em></p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/894809f2967013b0236738c993fd3958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*pib-uo0Jwx20B9TYMY9PYA.png"/></div></figure><h1 id="04fb" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">使用R的动机</h1><p id="095e" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">在我当前项目的开始阶段(与此同时，我正在为<a class="ae lb" href="https://hackernoon.com/tagged/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>练习R语言，并在一组<a class="ae lb" href="http://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kagglers </a>】上使用它)，我决定尝试用R语言来处理一些数据处理任务。</p><p id="7453" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然最初的挑战是创建一些ETL作业(从Microsoft SQL Server、CSV和JSON文件中提取数据，运行一些清理和转换，并将其推回到<a class="ae lb" href="https://hackernoon.com/tagged/google" rel="noopener ugc nofollow" target="_blank"> Google </a> Cloud SQL数据库实例),但我们也看到了其他可能性，例如对数据执行一些探索性分析，并在此基础上创建一些简单的报告。</p><p id="a3cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">考虑到这一点，R和它的生态系统<a class="ae lb" href="https://hackernoon.com/tagged/tools" rel="noopener ugc nofollow" target="_blank">工具</a>如<a class="ae lb" href="http://rmarkdown.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> R Markdown </a>和<a class="ae lb" href="https://shiny.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> R Shiny </a>似乎对挑战非常有价值。</p><h1 id="4d8f" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">开局好</h1><p id="416c" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">所以“我可以在<a class="ae lb" href="https://hackernoon.com/tagged/production" rel="noopener ugc nofollow" target="_blank">生产</a>上使用R吗？”。这是一种关于解释型语言的常见问题(Python是R的自然替代品，另一种语言也是同类批评的目标)。</p><p id="9359" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个问题的答案很大程度上依赖于您对将要开发的解释型语言的处理。</p><p id="4898" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你对这种编程语言的经验仅限于编写<strong class="it hv"> <em class="jp">脚本</em> </strong>，没有日志、没有错误处理、没有单元测试、没有版本控制或DevOps实践的基础…那么答案是否定的。你不应该将这种“代码”投入生产。</p><p id="992c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是R(就像Python一样)既可以用于<strong class="it hv"> <em class="jp">脚本</em> </strong>开发(您编写用来验证想法或“非实时”数据分析的简单代码)，也可以用于创建更健壮的<strong class="it hv"> <em class="jp">应用程序</em> </strong>。</p><p id="476a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这篇文章并不打算成为一个教程，但是我已经把我用来编写一些R应用程序的一些R包(和指南)放在了一起:</p><ul class=""><li id="7630" class="lc ld hu it b iu iv iy iz jc le jg lf jk lg jo lh li lj lk dt translated"><a class="ae lb" href="http://logging.r-forge.r-project.org/" rel="noopener ugc nofollow" target="_blank">日志</a>:R的日志框架</li><li id="87ee" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated"><a class="ae lb" href="https://cran.r-project.org/web/packages/optparse/index.html" rel="noopener ugc nofollow" target="_blank"> optparse </a>:处理命令行参数，非常好用。</li><li id="07ea" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">坚持一个代码指南(我正在遵循谷歌的一个:(【https://google.github.io/styleguide/Rguide.xml】)除了节点#1，在同一个git repos上，你可以找到几乎所有语言的谷歌风格指南。</li><li id="7741" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">坚持一致的“工作目录”(例如，在你的项目的根目录下)</li><li id="8204" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">项目组织:【http://nicercode.github.io/blog/2013-04-05-projects/ T4】</li><li id="931a" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">单元测试:<a class="ae lb" href="https://cran.r-project.org/web/packages/RUnit/vignettes/RUnit.pdf" rel="noopener ugc nofollow" target="_blank">https://cran . R-project . org/web/packages/RUnit/vignettes/RUnit . pdf</a>(还有其他R的单元测试框架，但是这个对我来说非常好，我肯定也会看看<a class="ae lb" href="https://cran.r-project.org/web/packages/testthat/index.html" rel="noopener ugc nofollow" target="_blank">https://cran.r-project.org/web/packages/testthat/index.html</a></li></ul><p id="18e2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在发布R应用程序来处理日常数据之前，您确实应该将这些(类似的)包和标准放在适当的位置。</p><h1 id="e569" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">一路上的调度和调优</h1><p id="9362" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">在编写了数据处理脚本应用程序的一些流程后，您需要让它以某种方式运行。</p><p id="37b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因为我们完全控制了生产(谷歌云)环境。我们决定使用众所周知的DevOps <strong class="it hv"> Jenkins </strong>(不是开发人员用来编译系统其他部分的同一个实例，而是一个专用的生产机器)来调度我们的ETL。</p><p id="26ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们的云环境场景中，Jenkins的一个很好的特性(除了易于使用的调度和历史控制台)，是我们可以决定在哪里运行特定的作业。默认是在jenkins(主)机器上运行。但是你可以很容易地设置它在一个更健壮的从机上运行(连接到主服务器的节点)，我们可以使用简单的<a class="ae lb" href="https://cloud.google.com/compute/docs/gcloud-compute/" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv"> gcloud </strong> </a>命令按需启动和停止。这给了我们很大的灵活性，并允许我们节省一些基础设施成本(边节点#2:在Google Compute Engine上，一个实例的最小费用是10分钟，而不是像AWS中那样一个完整的小时)。</p><p id="cf82" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您已经为R代码提供了日志记录(如上所述)，那么如果您有一个Java作业，那么您应该可以获得相同级别的执行/历史信息。</p><p id="82c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几周之后，随着处理的流、表和文本文件的数量开始增加(达到每天30 GB左右)，我们不得不开始做一些调整，以保持我们的作业快速运行。</p><p id="96a6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些是真正提升应用程序性能的关键变化:</p><ol class=""><li id="a8ed" class="lc ld hu it b iu iv iy iz jc le jg lf jk lg jo lq li lj lk dt translated">使用data.table代替data.frames(它们要快得多)，也使用data.table特定的方法来读写文件——fread和fwrite，只需检查<a class="ae lb" href="https://cran.r-project.org/web/packages/data.table/data.table.pdf" rel="noopener ugc nofollow" target="_blank"> docs </a>。</li><li id="6c28" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lq li lj lk dt translated">更改您的SQL连接层，以便在数据库中批量插入数据，在每个execute语句中发送一个值列表(查看这篇<a class="ae lb" href="http://stackoverflow.com/questions/6889065/inserting-multiple-rows-in-mysql" rel="noopener ugc nofollow" target="_blank"> stackoverflow帖子</a>中的示例)。</li><li id="c259" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lq li lj lk dt translated">在一些涉及不同JSON解析库的测试之后，<a class="ae lb" href="https://cran.r-project.org/web/packages/jsonlite/index.html" rel="noopener ugc nofollow" target="_blank"> jsonlite </a>已经很好地满足了我们的需求(比rjson更快)。</li></ol><h1 id="93f2" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">结论</h1><p id="9468" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">r在生产环境中工作得很好，正如您所期望的Python一样。这实际上是一个工程工作的问题，以确保您正在推动应用程序，而不是幼稚的脚本，来处理真实的用户数据。</p><p id="976b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本文中，我不打算讨论“R vs Python ”,但是当然，语言的决定应该在很大程度上取决于项目挑战和你的团队的技能，但是我希望至少给你另一个选择:d。</p><div class="jr js jt ju fq ab cb"><figure class="lr jv ls lt lu lv lw paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lr jv ls lt lu lv lw paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lr jv ls lt lu lv lw paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lx ly lz"><p id="f922" class="ir is jp it b iu iv iw ix iy iz ja jb ma jd je jf mb jh ji jj mc jl jm jn jo hn dt translated"><a class="ae lb" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae lb" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae lb" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae lb" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb ma jd je jf mb jh ji jj mc jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae lb" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae lb" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="fe ff md"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mi mj l"/></div></figure></div></div>    
</body>
</html>