<html>
<head>
<title>Stop Writing Reactive Gherkin Scenarios. Go Outside-In!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止编写反应式小黄瓜场景。出去-进去！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/stop-writing-reactive-gherkin-scenarios-go-outside-in-5446718fc1a3?source=collection_archive---------10-----------------------#2017-02-07">https://medium.com/hackernoon/stop-writing-reactive-gherkin-scenarios-go-outside-in-5446718fc1a3?source=collection_archive---------10-----------------------#2017-02-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="4d48" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">由外向内场景大纲的简单指南</h2></div><blockquote class="jj jk jl"><p id="ab8c" class="jm jn jo jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">(文章摘自我的书，<a class="ae kj" href="https://www.manning.com/books/writing-great-specifications" rel="noopener ugc nofollow" target="_blank"> <em class="hu">写作大规范。</em> </a> <em class="hu"> </em>今天可以拿<em class="hu"> WGS </em> 39折——查看帖子结局。)</p></blockquote><p id="3957" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">熟悉<a class="ae kj" href="https://github.com/cucumber/cucumber/wiki/Gherkin" rel="noopener ugc nofollow" target="_blank">小黄瓜</a>或<a class="ae kj" href="https://cucumber.io" rel="noopener ugc nofollow" target="_blank">黄瓜</a>的人可能已经知道，<a class="ae kj" href="https://hackernoon.com/tagged/scenario" rel="noopener ugc nofollow" target="_blank">场景</a>轮廓是类似场景的模板。但是这些人<em class="jo">不知道的是，他们最可能使用的方法是被动的，而不是主动的。在本文中，我将向您展示一种用<a class="ae kj" href="https://hackernoon.com/tagged/gherkin" rel="noopener ugc nofollow" target="_blank">小黄瓜</a>编写场景大纲的主动方法。</em></p><p id="225f" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">由于有了场景大纲，您不必在您的特性文件中重复相同的假设。</p><p id="456b" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">所以如果我们有两个非常相似的场景</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="d58e" class="kw kx hu ks b fv ky kz l la lb">Feature: Shipping</span><span id="b0c0" class="kw kx hu ks b fv lc kz l la lb">  Scenario: Shipping PDFs</span><span id="a21e" class="kw kx hu ks b fv lc kz l la lb">    Given a PDF book in Simona’s cart<br/>     When she pays for it<br/>     Then the book should be sent to a mobile device</span><span id="bc46" class="kw kx hu ks b fv lc kz l la lb">  Scenario: Shipping audiobooks</span><span id="21e0" class="kw kx hu ks b fv lc kz l la lb">    Given an audiobook in Simona’s cart<br/>     When she pays for it<br/>     Then the book should be sent over email</span></pre><p id="f397" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">我们可以很容易地用两个这样的例子将它们合并成一个场景大纲</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="ad0b" class="kw kx hu ks b fv ky kz l la lb">Feature: Shipping</span><span id="b57e" class="kw kx hu ks b fv lc kz l la lb">  Scenario: Shipping methods</span><span id="19ce" class="kw kx hu ks b fv lc kz l la lb">    Given a &lt;format&gt; book in Simona’s cart<br/>     When she pays for it<br/>     Then the book should be &lt;shipped&gt;</span><span id="4085" class="kw kx hu ks b fv lc kz l la lb">    Examples:<br/>      | format    | shipped                 | <br/>      | PDF       | sent to a mobile device |<br/>      | audiobook | sent over email         | </span></pre><p id="8536" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">合并冗余场景是创建场景大纲的一种方式，但不是唯一的方式。我喜欢把另一种方法叫做<em class="jo">由外向内的方法，用于编写场景大纲。</em></p><blockquote class="ld"><p id="2abd" class="le lf hu bd lg lh li lj lk ll lm ki ek translated">一个<strong class="ak">由外向内的场景大纲</strong>是直接从团队在分析过程中收集的例子中写出来的，而不是通过合并相似的场景。</p></blockquote><p id="b047" class="pw-post-body-paragraph jm jn hu jp b jq ln iv js jt lo iy jv kk lp jy jz kl lq kc kd km lr kg kh ki hn dt translated">由外向内的方法包括两个步骤:</p><ol class=""><li id="914b" class="ls lt hu jp b jq jr jt ju kk lu kl lv km lw ki lx ly lz ma dt translated">以表格的形式为您的规范收集真实世界的示例；</li><li id="679b" class="ls lt hu jp b jq mb jt mc kk md kl me km mf ki lx ly lz ma dt translated">根据表格编写场景大纲，根据数据调整步骤和参数。</li></ol><p id="97f0" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">由外向内的方法要求你先分析例子，再写场景。您在第一步中创建的表甚至不必是小黄瓜表。它可以是在Excel中创建的简单电子表格。另一方面，只有当您注意到冗余和规范变得难以管理时，合并方法才假设将场景演进为场景大纲。从这个意义上来说，由外向内的方法比合并方法更主动——因为成为一个主动的交付团队比被动的团队更好，所以由外向内的场景大纲最终会成为您开发工作的巨大资产。</p><h2 id="18f9" class="kw kx hu bd mg mh mi mj mk ml mm mn mo kk mp mq mr kl ms mt mu km mv mw mx my dt translated">介绍一些业务背景</h2><p id="5938" class="pw-post-body-paragraph jm jn hu jp b jq mz iv js jt na iy jv kk nb jy jz kl nc kc kd km nd kg kh ki hn dt translated">出于本文的目的，假设您为一家像Amazon这样的电子商务购物应用程序公司工作。这家公司希望成为图书、电影、音乐和游戏以及电子产品、玩具、服装、运动、工具、杂货和花园用品的网上零售商。卖书是这家公司最初的目的。之后，它决定扩张，增加电子阅读器、平板电脑和耳机等产品，以适应商店的阅读环境。现在我们必须处理运输所有这些不同种类的产品。前面还有很多工作要做，而且业务已经多样化了——谢天谢地，有很多不同的例子可以用来编写场景。</p><h1 id="242d" class="ne kx hu bd mg nf ng nh mk ni nj nk mo ja nl jb mr jd nm je mu jg nn jh mx no dt translated">1.在表格中收集示例</h1><p id="99fe" class="pw-post-body-paragraph jm jn hu jp b jq mz iv js jt na iy jv kk nb jy jz kl nc kc kd km nd kg kh ki hn dt translated">为了从示例中获得场景大纲，我们首先需要一些示例。为了获得示例，我们需要实现一个新特性。幸运的是，我们理论上的公司所有者会欣然从命。该公司目前的首要任务是让更多商品进入商店，扩大市场。事实证明，与大型出版商和生产商的谈判很困难，管理层希望向既能出售新品又能出售旧品的个体商户开放商店。商人将从我们先进的运输基础设施中受益，而我们将从他们的利润中提成。</p><p id="986b" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">经过一番分析后，销售和营销部门就定价模型达成一致，该模型遵循以下规则:</p><ul class=""><li id="011e" class="ls lt hu jp b jq jr jt ju kk lu kl lv km lw ki np ly lz ma dt translated">商家可以免费创建自己的账户，列出新商品；</li><li id="89c9" class="ls lt hu jp b jq mb jt mc kk md kl me km mf ki np ly lz ma dt translated">商品成功售出后，我们会从中抽成；</li><li id="8107" class="ls lt hu jp b jq mb jt mc kk md kl me km mf ki np ly lz ma dt translated">我们的分成取决于买家的运输地点，因为由于我们的运输基础设施，商家必须付费才能访问全球客户数据库。</li></ul><p id="2232" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">现在让我们确定价格范围，并将我们的列表重新制作成示例表的草稿(表1)。佣金是根据我们的美国运营基地和我们在每个地区的基础设施的运输距离而设计的。</p><figure class="kn ko kp kq fq nq"><div class="bz el l di"><div class="nr ns l"/></div><figcaption class="nt nu fg fe ff nv nw bd b be z ek"><strong class="ak">Table 1</strong></figcaption></figure><p id="71c4" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">该表可能是来自销售和市场营销的非技术涉众与程序员、测试人员和设计人员的交付团队之间的对话结果。人们不需要任何技术技能来创建或理解它，因为还没有涉及到小黄瓜。如果您担心场景大纲过于技术性，那么您可以在您的规范研讨会期间将您的示例保持在非技术级别。这没什么不好。</p><h1 id="6ec1" class="ne kx hu bd mg nf ng nh mk ni nj nk mo ja nl jb mr jd nm je mu jg nn jh mx no dt translated">2.从收集的例子中推导出给定的何时何地</h1><p id="2029" class="pw-post-body-paragraph jm jn hu jp b jq mz iv js jt na iy jv kk nb jy jz kl nc kc kd km nd kg kh ki hn dt translated">既然我们已经有了示例表，我们就可以编写假设条件了。要做到这一点，我们需要找到一个与我们的表的结构配合得很好的场景模板。例如，您能否看到区域行就像一个问题，佣金行就像每个问题的答案？</p><ul class=""><li id="1120" class="ls lt hu jp b jq jr jt ju kk lu kl lv km lw ki np ly lz ma dt translated">北美？我们抽取购买量的10%。</li><li id="4155" class="ls lt hu jp b jq mb jt mc kk md kl me km mf ki np ly lz ma dt translated">南美？下调幅度为11.4%。</li><li id="3cde" class="ls lt hu jp b jq mb jt mc kk md kl me km mf ki np ly lz ma dt translated">欧洲和亚洲？佣金是12.9%。</li><li id="8a8e" class="ls lt hu jp b jq mb jt mc kk md kl me km mf ki np ly lz ma dt translated">非洲？准备好放弃13.5%。</li></ul><p id="c8ab" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">从技术角度来看，在我们决定收取多少佣金之前，问题定义了系统的状态，而答案则根据所选的状态定义了结果。系统状态由给定描述，结果应该写成给定。我们已经准备好写下三分之二的场景了！</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="9797" class="kw kx hu ks b fv ky kz l la lb">Given a purchase from &lt;region&gt;<br/> Then we should take &lt;commission&gt; of the price</span></pre><p id="df67" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">这看起来很有希望，但是因为这是一个关于卖家的场景，而不是买家，我们可以添加另一个给定的场景，指定商家是我们的主要参与者。例如，我们可以称小商店为快船。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="a8f7" class="kw kx hu ks b fv ky kz l la lb">Given a merchant called Quick-Ship<br/>  And a purchase from &lt;region&gt;<br/> Then we should take &lt;commission&gt; of the price</span></pre><p id="5205" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">有了这三个步骤，我们还需要一个步骤，它将指定场景的主要动作。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="750e" class="kw kx hu ks b fv ky kz l la lb">Given a merchant called Quick-Ship<br/>  And a purchase from &lt;region&gt;<br/> When Quick-Ship gets paid for the purchase<br/> Then we should take &lt;commission&gt; of the price</span></pre><h1 id="359b" class="ne kx hu bd mg nf ng nh mk ni nj nk mo ja nl jb mr jd nm je mu jg nn jh mx no dt translated">3.将该表添加到您的场景中</h1><p id="f6e7" class="pw-post-body-paragraph jm jn hu jp b jq mz iv js jt na iy jv kk nb jy jz kl nc kc kd km nd kg kh ki hn dt translated">我们需要做的最后一件事是将我们之前准备的示例表与给定的时间结合起来，并添加剩余的关键字，如特性或场景大纲。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="6455" class="kw kx hu ks b fv ky kz l la lb">Feature: Selling items through individual merchants</span><span id="154d" class="kw kx hu ks b fv lc kz l la lb">  Scenario Outline: Merchant commissions</span><span id="463f" class="kw kx hu ks b fv lc kz l la lb">    Given a merchant called Quick-Ship<br/>      And a purchase from &lt;region&gt;<br/>     When Quick-Ship gets paid for the purchase<br/>     Then we should take &lt;commission&gt; of the price</span><span id="3409" class="kw kx hu ks b fv lc kz l la lb">    Examples:<br/>      | region        | commission |<br/>      | North America | 10%        |<br/>      | South America | 11.4%      |<br/>      | Europe        | 12.9%      |<br/>      | Asia          | 12.9%      |<br/>      | Africa        | 13.5%      |</span></pre><p id="38f3" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">正如您所看到的，通过一点创造性，我们很容易就达成了一个完整的场景大纲。然而，选择例子来导出我们的轮廓是一门独立的艺术，并且需要更多的空间来适当地涵盖它——所以我们不会在本文中涉及它。但是现在，我们知道如何编写由外向内的场景大纲！</p><h1 id="6ff4" class="ne kx hu bd mg nf ng nh mk ni nj nk mo ja nl jb mr jd nm je mu jg nn jh mx no dt translated">4.利润！</h1><p id="326a" class="pw-post-body-paragraph jm jn hu jp b jq mz iv js jt na iy jv kk nb jy jz kl nc kc kd km nd kg kh ki hn dt translated">一般来说，我更喜欢由外向内的方法。通过合并得到的场景大纲通常看起来过于程序化，这使得业务人员不愿意阅读大纲。我认为这与“不要重复自己”原则有关，这是合并技术的创始原则。优雅的结构和删除冗余的代价通常是牺牲小黄瓜的自然语言，将太多的东西放入括号和参数中。相比之下，由外向内的方法强调从非小黄瓜表(任何非技术人员都可以阅读)到小黄瓜场景(如果他们阅读了示例就不需要)的逐渐演变。这种演变通常会使最终的轮廓看起来更自然。</p><figure class="kn ko kp kq fq nq fe ff paragraph-image"><div class="fe ff nx"><img src="../Images/3f9fd6f39599959e147d83e8c021f794.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*4MvQTbO_dwJJAGeV705lwA.jpeg"/></div></figure><p id="f431" class="pw-post-body-paragraph jm jn hu jp b jq jr iv js jt ju iy jv kk jx jy jz kl kb kc kd km kf kg kh ki hn dt translated">要了解更多关于场景、场景大纲、小黄瓜以及它们如何帮助您的企业像顶级企业一样运营，<strong class="jp hv">下载免费的第一章</strong> <a class="ae kj" href="https://www.manning.com/books/writing-great-specifications" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hv"> <em class="jo">编写伟大的规范</em> </strong> </a> <strong class="jp hv"> <em class="jo">。</em>T11】</strong></p><h2 id="99d6" class="kw kx hu bd mg mh mi mj mk ml mm mn mo kk mp mq mr kl ms mt mu km mv mw mx my dt translated">以三分之一的价格买下WGS！</h2><p id="cf0c" class="pw-post-body-paragraph jm jn hu jp b jq mz iv js jt na iy jv kk nb jy jz kl nc kc kd km nd kg kh ki hn dt translated">您也可以在<a class="ae kj" href="http://www.slideshare.net/thion/specifications-for-the-real-world" rel="noopener ugc nofollow" target="_blank"> Slideshare </a>上阅读我的演示文稿，找到39%的折扣代码！</p><div class="kn ko kp kq fq ab cb"><figure class="oa nq ob oc od oe of paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="oa nq ob oc od oe of paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="oa nq ob oc od oe of paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="jj jk jl"><p id="f922" class="jm jn jo jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated"><a class="ae kj" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kj" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kj" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae kj" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jm jn jo jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kj" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kj" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kn ko kp kq fq nq fe ff paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="fe ff og"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kn ko kp kq fq nq"><div class="bz el l di"><div class="ol ns l"/></div></figure></div></div>    
</body>
</html>