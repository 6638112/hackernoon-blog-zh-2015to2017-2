<html>
<head>
<title>Waithook — Testing WebHooks Behind the Router</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Waithook —测试路由器后面的WebHooks</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/waithook-testing-webhooks-behind-the-router-a0270224b620?source=collection_archive---------12-----------------------#2017-02-14">https://medium.com/hackernoon/waithook-testing-webhooks-behind-the-router-a0270224b620?source=collection_archive---------12-----------------------#2017-02-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="4634" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Waithook.com<a class="ae jp" href="http://waithook.com" rel="noopener ugc nofollow" target="_blank">是为了在开发和测试环境中轻松接收HTTP通知而构建的。它使用<strong class="it hv"> WebSockets </strong>来传递消息，因此它可以在防火墙、网络路由和代理之后工作。</a></p><p id="37f6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试来自其他服务的HTTP通知很难，通常我会设置一些从我的计算机到远程服务器的SSH隧道，或者使用一些公共服务来完成。并且每次在CI服务器上运行测试时都很难进行这样的设置。所以我想到了服务的概念:客户端将使用<a class="ae jp" href="https://hackernoon.com/tagged/websocket" rel="noopener ugc nofollow" target="_blank"> WebSocket </a>协议进行连接，我的服务将接收HTTP请求并发送给所有订户。可以把它看作HTTP回调的Pub/Sub。当不止一个开发人员同时使用它或者您的测试并行运行时，它会工作得很好，因为所有的订阅者都会收到所有的消息。</p><p id="d25a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我发现它对以下方面很有用:</p><ul class=""><li id="e5d1" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">测试与支付系统的集成</li><li id="8fa4" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">测试<a class="ae jp" href="https://hackernoon.com/tagged/github" rel="noopener ugc nofollow" target="_blank"> GitHub </a> /GitLab webhooks</li><li id="441e" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">测试传入电子邮件处理</li><li id="a79d" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">测试slack机器人</li><li id="9e70" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">测试facebook webhooks</li></ul><h1 id="1021" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">如何使用它</h1><p id="5c18" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">您需要选择您的唯一前缀，将发送服务中的通知URL更改为<code class="eh lh li lj lk b">http://waithook.com/$your_unique_path</code>(将向您发送HTTP通知的服务，如支付系统、收到的电子邮件等)。</p><p id="8405" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它还可以向其他URL发送http请求，例如您的临时服务器。为此，只需在端点URL中添加<code class="eh lh li lj lk b">?forward_url=http://example.com</code>。示例:</p><pre class="ll lm ln lo fq lp lk lq lr aw ls dt"><span id="be21" class="lt kf hu lk b fv lu lv l lw lx">http://waithook.com/foobar?forward_url=http://foobar.com/</span></pre><p id="f32c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后你应该打开WebSocket连接到<code class="eh lh li lj lk b">waithook.com/foobar</code>，具体可以看在线演示或者使用ruby库<a class="ae jp" href="https://github.com/Paxa/waithook-ruby" rel="noopener ugc nofollow" target="_blank"> waithook-ruby </a>:</p><pre class="ll lm ln lo fq lp lk lq lr aw ls dt"><span id="7c86" class="lt kf hu lk b fv lu lv l lw lx">gem install waithook<br/>waithook waithook.com/foobar --forward http://localhost:3000/notify</span></pre><p id="c315" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在你可以试着发送请求给<a class="ae jp" href="http://waithook.com/foobar" rel="noopener ugc nofollow" target="_blank">http://waithook.com/foobar</a>，它会发送同样的请求给<code class="eh lh li lj lk b">http://localhost:3000/notify</code>耶！</p></div><div class="ab cl ly lz hc ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="hn ho hp hq hr"><p id="d103" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Waithook是免费的并且<a class="ae jp" href="https://github.com/Paxa/waithook" rel="noopener ugc nofollow" target="_blank">开源</a>。我把它做得很有趣，并在工作中用来测试支付系统的webhook处理。在我的测试中，每当我期望HTTP回调到达我的系统时，我就打开新的连接，并等待直到我得到正确的消息，这样我就可以测试完整的流。</p><p id="b897" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我很高兴听到你的任何反馈！编码快乐！</p><blockquote class="mf mg mh"><p id="6252" class="ir is mi it b iu iv iw ix iy iz ja jb mj jd je jf mk jh ji jj ml jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is mi it b iu iv iw ix iy iz ja jb mj jd je jf mk jh ji jj ml jl jm jn jo hn dt translated">要了解更多信息，请<a class="ae jp" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">阅读我们的“关于”页面</a>、<a class="ae jp" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书上点赞/给我们发消息</a>，或者简单地说，<a class="ae jp" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is mi it b iu iv iw ix iy iz ja jb mj jd je jf mk jh ji jj ml jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ll lm ln lo fq mm"><div class="bz el l di"><div class="mn mo l"/></div></figure></div></div>    
</body>
</html>