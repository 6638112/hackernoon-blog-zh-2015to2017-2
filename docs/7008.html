<html>
<head>
<title>Trust Your Pipeline: Automatically Testing an End-to-End Java Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">信任您的管道:自动测试端到端Java应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/trust-your-pipeline-automatically-testing-an-end-to-end-java-application-4a33232180c3?source=collection_archive---------4-----------------------#2017-10-13">https://medium.com/hackernoon/trust-your-pipeline-automatically-testing-an-end-to-end-java-application-4a33232180c3?source=collection_archive---------4-----------------------#2017-10-13</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><blockquote class="ir is it"><p id="6512" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated"><strong class="ix hv">免责声明</strong></p><p id="ca0d" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">这篇文章是我和<a class="ae jt" href="https://www.linkedin.com/in/brjavaman/" rel="noopener ugc nofollow" target="_blank"> Bruno Souza </a>在2017年JavaOne大会上发表的同一篇演讲的一部分。</p></blockquote><p id="62d5" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">尽管极其重要，我们在这里并不谈论单元测试和集成测试，假设你已经知道它是什么并且已经应用了它，作为一个关心你的代码质量的开发者。</p><h1 id="0626" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated"><strong class="ak">测试自动化金字塔和敏捷测试象限</strong></h1><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/3aee57aa90bbf796658955a080f69229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DvqF-UJyFhI4_JXaLxYImw.png"/></div></div></figure><p id="802c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">创建测试是测试您的应用程序并确保如果出现任何bug，您将在客户之前发现它的最简单快捷的方法。</p><p id="0771" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">目前，我们不能在不谈论测试自动化的情况下谈论测试。测试自动化的应用给团队一个快速的反馈，并持续保持<a class="ae jt" href="https://en.wikipedia.org/wiki/Regression_testing" rel="noopener ugc nofollow" target="_blank"> <em class="iw">回归测试</em> </a> <em class="iw"> </em>的执行。</p><p id="c54e" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">我们可以用来加快测试自动化、执行和快速反馈速度的方法是应用<a class="ae jt" href="https://martinfowler.com/bliki/TestPyramid.html" rel="noopener ugc nofollow" target="_blank"> <em class="iw">测试金字塔</em> </a>，它是至少三个层次自动化应用的指南:<strong class="ix hv">单元</strong>、<strong class="ix hv">服务</strong>和<strong class="ix hv"> ui </strong>(用户界面)。</p><p id="30d8" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">服务层被分成三个部分:<em class="iw">组件测试</em>、<em class="iw">集成</em>测试和<em class="iw"> API测试</em>。</p><p id="09ea" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated"><strong class="ix hv">单元测试层</strong>是我们应用程序中最重要的一层，因为我们将为我们正在开发的代码创建测试，并保证其按预期工作，即使在未来的维护之后(推荐使用<em class="iw">TDD——测试驱动开发</em>)。在这一层，我们可以应用<em class="iw">代码覆盖</em>分析和<em class="iw">静态分析</em>实践，以加强对可能出现的缺陷的快速反馈。</p><p id="8068" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated"><strong class="ix hv">服务层</strong> ( <em class="iw">组件</em>、<em class="iw">集成</em>和<em class="iw"> API </em>)如今极其重要，主要关注API测试。这里我们应用<em class="iw">模拟</em>、<em class="iw">存根</em>和<em class="iw">假货</em>来提高微服务测试的执行速度。我们还需要独立的测试环境服务器，这可能是最接近生产环境的。</p><p id="a4d6" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated"><strong class="ix hv"> UI </strong>(用户界面)层也很重要，尤其是从移动测试的角度来看，当客户在应用中遇到错误时，通常会将其删除。这里最重要的技术是UI自动化测试和<em class="iw">视觉回归测试</em>。在web部分，我们需要浏览器在不同的浏览器(如Chrome、Firefox、Safari)中执行相同的测试。我们需要同样的<em class="iw">移动自动化测试</em> : iOS和Android设备，以确保我们的应用程序在这两个平台上的兼容性。</p><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/7cc55acd03ba21e89de1dd81ae22c5ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5VgZfsfSKO06511WueVS-A.png"/></div></div></figure><p id="7dae" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated"><strong class="ix hv">敏捷测试象限</strong>，由<a class="ae jt" href="http://www.exampler.com/old-blog/2003/08/22/#agile-testing-project-2" rel="noopener ugc nofollow" target="_blank"> Brian Marick </a>创建，由Lisa Crispin和Janet Gregory在他的书<em class="iw"/><a class="ae jt" href="https://www.amazon.com/Agile-Testing-Practical-Guide-Testers/dp/0321534468" rel="noopener ugc nofollow" target="_blank"><em class="iw">敏捷测试——测试人员和敏捷团队实用指南</em></a><em class="iw"/>中广泛传播，是一些可以在以活动为中心的测试开发中应用的实践。象限是一个指南:没有必要执行其中所有现有的实践，您可以根据您的环境选择一个或多个。</p><h1 id="3d6e" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated"><strong class="ak">连续输送和测试管道</strong></h1><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/ff1914a2b9d3b4fd4cdbdd36c5c10123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MsHbCKcTyD765KVDp1jYWQ.png"/></div></div></figure><p id="0622" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">没有谈到<a class="ae jt" href="https://continuousdelivery.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hv"> <em class="iw">连续交付</em> </strong> </a> (CD)就谈不上<em class="iw">DevOps</em>……没有它，我们甚至谈不上devo PS文化。</p><p id="3cb9" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">在连续交付中，基础之一是<a class="ae jt" href="https://continuousdelivery.com/foundations/test-automation/" rel="noopener ugc nofollow" target="_blank"> <em class="iw">连续测试</em> </a>，在这里我们必须测试我们开发的所有阶段(流水线),并且将最初的建议应用于单元测试和自动化验收。</p><p id="ff8e" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">持续交付支持开发、QA和运营之间的联合角色。这些角色的循证协作的一个例子是:</p><ul class=""><li id="604a" class="lh li hu ix b iy iz jc jd ju lj jv lk jw ll js lm ln lo lp dt translated">开发+ QA:在不同级别构建、部署和测试自动化</li><li id="ba46" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">QA +操作:测试自动化和通过测试执行的持续反馈，以及健全性测试执行</li><li id="84c5" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">操作+开发:自动提供任何级别测试所需的机器/容器。</li></ul><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/cb87fc03069961f58152ff76d78eaae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGwkq6gTIbYJDmwRf5HICQ.png"/></div></div></figure><p id="a9fe" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">现在，我们继续关注于测试的管道，测试可以全部或部分应用，即:</p><h2 id="42ed" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated">单元测试和集成测试</h2><p id="7dc8" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated">我们可以创建mock/fakes/stub来移除依赖关系并加速测试执行</p><h2 id="19a4" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated">ServiceTest:在服务层上(SOAP，REST)</h2><ul class=""><li id="a5aa" class="lh li hu ix b iy mj jc mk ju mo jv mp jw mq js lm ln lo lp dt translated"><strong class="ix hv"> Smoke </strong>:小执行子集，保证所有API都工作(至少返回不同于HTTP 404或HTTP 500的状态)</li><li id="c078" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated"><strong class="ix hv">契约</strong>:客户(消费者)和<a class="ae jt" href="https://hackernoon.com/tagged/api" rel="noopener ugc nofollow" target="_blank"> API </a>之间的协议(测试)集合</li><li id="527e" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated"><strong class="ix hv">功能性</strong>:测试想要保证不同业务规则下的操作(快乐路径、悲伤路径和可选流)</li><li id="9051" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated"><strong class="ix hv">验收</strong>:评估系统对业务需求的符合性，评估是否可以交付</li></ul><h2 id="8caa" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated">验收:验收测试</h2><p id="f60a" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated">侧重于用户视角和端到端测试(e2e)的测试。模拟用户在应用程序上的旅程很重要。</p><ul class=""><li id="e3cd" class="lh li hu ix b iy iz jc jd ju lj jv lk jw ll js lm ln lo lp dt translated"><strong class="ix hv">冒烟</strong>:主测试套件什么会保证你的业务运行</li></ul><h2 id="c2de" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated">功能:功能测试</h2><p id="602c" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated">根据不同的业务规则(快乐路径、悲伤/消极路径和替代流程)保证操作的测试</p><ul class=""><li id="2a27" class="lh li hu ix b iy iz jc jd ju lj jv lk jw ll js lm ln lo lp dt translated">Smoke:快乐路径、悲伤路径和可选流程的主要测试套件</li></ul><h2 id="5941" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated"><strong class="ak">非功能测试</strong></h2><p id="adb1" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated">从<em class="iw">集成</em>到<em class="iw">功能测试</em>(流水线的末端)我们不得不担心非功能测试。测试的例子是功能性的:性能、负载、安全性等…</p><p id="b5c5" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">创建一个完整的自动化测试架构来支持连续的、自动化的、尽可能少维护的运行是非常必要的:</p><ul class=""><li id="d5fa" class="lh li hu ix b iy iz jc jd ju lj jv lk jw ll js lm ln lo lp dt translated">截图证明每个测试的执行，或者当错误发生时的证据</li><li id="5a44" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">用于分析和查看发生的任何错误的日志</li><li id="4127" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">显示关于测试执行的反馈的报告</li><li id="9885" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">测试脚本中敏感数据的数据管理</li><li id="f6ca" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">参数化经常更改的数据，如URL、端点等…</li></ul><h1 id="7932" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated"><strong class="ak">自动化API、Web和移动测试工具箱</strong></h1><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/a951ee62878e7587af75d5b4bb9ae4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bfuNajXlS4d0xb2dkr2ugw.png"/></div></div></figure><p id="5248" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">为了自动化一个API、一个网页和一个移动前端，有一些开源的<a class="ae jt" href="https://hackernoon.com/tagged/tools" rel="noopener ugc nofollow" target="_blank">工具</a>可以帮助你快速方便地构建和运行测试。</p><h2 id="b60f" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated"><strong class="ak">放心</strong></h2><p id="a2f3" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated"><a class="ae jt" href="https://github.com/rest-assured/rest-assured" rel="noopener ugc nofollow" target="_blank">https://github.com/rest-assured/rest-assured</a></p><p id="a861" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">为API (REST和XML)创建自动化测试的工具。使用基于<a class="ae jt" href="https://github.com/cucumber/cucumber/wiki/Gherkin" rel="noopener ugc nofollow" target="_blank"> <em class="iw">小黄瓜</em></a>(<em class="iw">Given-When-Then</em>)的简单易懂的DSL。</p><p id="2caa" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">在下面的例子中，可以通过一个本地端点(模拟生产环境)和一个用Java Spark创建的模拟端点来查看API。通过开发API固定数据返回来创建模拟API，可以在执行和验证保护微服务测试的不同方面时提供更高的速度，尤其是关于契约测试。</p><figure class="kw kx ky kz fq la"><div class="bz el l di"><div class="mr ms l"/></div><figcaption class="mt mu fg fe ff mv mw bd b be z ek">RestAssured test script</figcaption></figure><h2 id="07b1" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated"><strong class="ak"> Selenium WebDriver </strong></h2><p id="0104" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated"><a class="ae jt" href="http://seleniumhq.org" rel="noopener ugc nofollow" target="_blank">http://seleniumhq.org</a></p><p id="6696" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">它是最著名的网页自动化工具。它还有一个简单的DSL，并基于自动化的四个步骤:</p><ul class=""><li id="da67" class="lh li hu ix b iy iz jc jd ju lj jv lk jw ll js lm ln lo lp dt translated">导航:访问网页、前进、后退和刷新等操作</li><li id="24a6" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">询问:通过id、名称、CSS选择器和其他定位器来查找web元素的方法</li><li id="f201" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">操作:一种与元素交互的方式，如点击、填充(sendKeys)、清除和获取文本</li><li id="547d" class="lh li hu ix b iy lq jc lr ju ls jv lt jw lu js lm ln lo lp dt translated">同步:等待一些异步动作的方法，比如几秒钟后出现一个元素</li></ul><p id="9dd9" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">它是一个W3C标准，在模拟真实浏览器的网络浏览器中执行动作。为此，有必要使用<a class="ae jt" href="http://www.seleniumhq.org/download/" rel="noopener ugc nofollow" target="_blank">浏览器驱动</a>。</p><figure class="kw kx ky kz fq la"><div class="bz el l di"><div class="mr ms l"/></div></figure><h2 id="6b78" class="lv jy hu bd jz lw lx ly kd lz ma mb kh ju mc md kl jv me mf kp jw mg mh kt mi dt translated"><strong class="ak"> Appium </strong></h2><p id="f926" class="pw-post-body-paragraph iu iv hu ix b iy mj ja jb jc mk je jf ju ml ji jj jv mm jm jn jw mn jq jr js hn dt translated"><a class="ae jt" href="http://appium.io" rel="noopener ugc nofollow" target="_blank"> http://appium.io </a></p><p id="4d72" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">它是一个开源工具，具有相同的Selenium DSL，但用于iOS或Android的本地或混合移动设备应用程序的自动化。</p><p id="59db" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">它支持在仿真器、真实设备或测试实验室(云)上执行，并且与Selenium Grid一起，提供了创建内部设备网格的可能性。</p><figure class="kw kx ky kz fq la"><div class="bz el l di"><div class="mr ms l"/></div></figure><h1 id="959d" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated"><strong class="ak">应用管道和GitHub Repo </strong></h1><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/26b4b11dc449f6efec92a8132db2b944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Immw4487bbNG8oUVhaD19g.png"/></div></div></figure><p id="9083" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">所有项目的代码都可以在资源库中找到:</p><div class="mx my fm fo mz na"><a href="https://github.com/eliasnogueira/test-automation-javaone-2017" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab ej"><div class="nc ab nd cl cj ne"><h2 class="bd hv fv z el nf eo ep ng er et ht dt translated">eliasnogueira/测试自动化-javaone-2017</h2><div class="nh l"><h3 class="bd b fv z el nf eo ep ng er et ek translated">测试自动化-javaone-2017 -专注于API和UI(移动和web)测试的管道完整示例。</h3></div><div class="ni l"><p class="bd b gc z el nf eo ep ng er et ek translated">github.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no lf na"/></div></div></a></div><p id="ca89" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf ju jh ji jj jv jl jm jn jw jp jq jr js hn dt translated">每个管道步骤都有测试套件。</p><figure class="kw kx ky kz fq la"><div class="bz el l di"><div class="np ms l"/></div></figure></div></div>    
</body>
</html>