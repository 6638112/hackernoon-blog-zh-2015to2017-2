<html>
<head>
<title>My Journey Into Deep learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的深度学习之旅</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/my-journey-into-deep-learning-9104057a642f?source=collection_archive---------8-----------------------#2017-05-26">https://medium.com/hackernoon/my-journey-into-deep-learning-9104057a642f?source=collection_archive---------8-----------------------#2017-05-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="5415" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我第一次读到<a class="ae jp" href="http://course.fast.ai/" rel="noopener ugc nofollow" target="_blank">程序员实用深度学习</a>时，我有点难以相信我能用7行代码训练一个神经网络。像大多数人一样，我有一个非常自然的反应。“搞什么鬼！？！那不可能！”</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/20e9f352fc65b381f7a102e1616efb34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hf_jYGxaSdFKZU26THvP4A.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Vgg-16 learning about cats and dogs.</figcaption></figure><p id="6716" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在这里，第一堂课训练<code class="eh kg kh ki kj b">VGG-16</code>已经进行了10分钟，这是一个卷积神经网络，对猫和狗的图像进行分类。这非常容易做到。事实上太容易了。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kk"><img src="../Images/d9179f71ba2dbf8a106cff5cfd0da909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vbSwweNHPpkMutOQ9fpmhg.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Okay, maybe we are getting too far ahead of ourselves.</figcaption></figure><p id="e705" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第一个时期有98%的准确率，这是令人惊讶的准确。“亚伦，你是天生的。”是的，谢谢，但是我已经知道了。</p><p id="e895" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我真的做了什么不寻常的事情吗？没有。在快速浏览了一下用于<a class="ae jp" href="http://course.fast.ai/" rel="noopener ugc nofollow" target="_blank">程序员实用深度学习</a>的剩余代码附带的<code class="eh kg kh ki kj b">Vgg16</code>类后，很明显<code class="eh kg kh ki kj b">vgg = Vgg16()</code>正在初始化一个类的实例，该类混淆了创建神经网络模型的不太好的部分。</p><p id="91d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是一个例子:</p><pre class="jr js jt ju fq kl kj km kn aw ko dt"><span id="3e0d" class="kp kq hu kj b fv kr ks l kt ku">def create(self):<br/>        model = self.model = Sequential()<br/>        model.add(<br/>            Lambda(vgg_preprocess, <br/>            input_shape=(3,224,224),    <br/>            output_shape=(3,224,224))<br/>        )</span><span id="e15f" class="kp kq hu kj b fv kv ks l kt ku">        self.ConvBlock(2, 64)<br/>        self.ConvBlock(2, 128)<br/>        self.ConvBlock(3, 256)<br/>        self.ConvBlock(3, 512)<br/>        self.ConvBlock(3, 512)</span><span id="4237" class="kp kq hu kj b fv kv ks l kt ku">        model.add(Flatten())<br/>        self.FCBlock()<br/>        self.FCBlock()<br/>        model.add(Dense(1000, activation='softmax'))</span><span id="58be" class="kp kq hu kj b fv kv ks l kt ku">        fname = 'vgg16.h5'<br/>        model.load_weights(get_file(<br/>            fname, <br/>            self.FILE_PATH+fname, <br/>            cache_subdir='models'<br/>        ))</span></pre><p id="516f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我不会假装我现在100%知道这段代码的意思，但是根据我的理解，它正在初始化一个<a class="ae jp" href="https://keras.io/models/sequential/" rel="noopener ugc nofollow" target="_blank"> Keras顺序模型</a>，然后定义该模型的输入、输出和隐藏层。它还将预训练的权重加载到模型中。</p><p id="6785" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好吧，当谈到深度学习时，也许我对自己所谓的天赋撒谎了，但我确实用训练和验证数据微调并拟合了<code class="eh kg kh ki kj b">vgg</code>模型。好吧，也许我也在撒谎…但这并不影响教我的电脑如何区分猫和狗的感觉有多棒！</p></div><div class="ab cl kw kx hc ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hn ho hp hq hr"><p id="e09d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">出于好奇，我决定在来自<a class="ae jp" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的<a class="ae jp" href="https://www.kaggle.com/c/dogs-vs-cats-redux-kernels-edition/leaderboard" rel="noopener ugc nofollow" target="_blank">狗对猫Redux </a>数据集上运行这段代码。不可否认，我的第一次投稿做得不太好。如果我早三个月参加这个比赛，我的分数会在1314名已经在排行榜上的人中排名1100左右。看到我的验证准确率是98%，我决定调查一下。</p><p id="2dd1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在花了两个小时揪我的头发后，我发现了这个讨厌的小家伙:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff ld"><img src="../Images/ebd798c9b148c16e3f04bcccc478b2e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*n1KAgp2Gwzr9odq1D_q3sQ.png"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Log loss on kaggle.</figcaption></figure><p id="8ca6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Kaggle使用这个函数对提交的内容进行排名。事实证明，在Kaggle上竞争时，当一个模特对一张照片是一只猫如此自信，以至于给它打了0分，这是一件坏事。这最终打破了Kaggle上的LogLoss函数，导致了我糟糕的分数。</p><p id="f7a9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那么我该如何让它变得更好呢？为什么不直接把0和1的极值分别强制为0.02和0.98？砰。就这样，我从1100英镑到500英镑，进入了排行榜的前50%。</p><p id="146e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好吧，你抓到我了。所以，也许我不得不依靠杰里米(教这门课的人)来认识到我过于自信的模型才是问题所在。细节细节。</p></div><div class="ab cl kw kx hc ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="hn ho hp hq hr"><p id="f611" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">总的来说，训练我的第一个CNN真的很有趣。迫不及待地想开始第2课！</p><div class="jr js jt ju fq ab cb"><figure class="le jv lf lg lh li lj paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="le jv lf lg lh li lj paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="le jv lf lg lh li lj paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lk ll lm"><p id="f922" class="ir is ln it b iu iv iw ix iy iz ja jb lo jd je jf lp jh ji jj lq jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is ln it b iu iv iw ix iy iz ja jb lo jd je jf lp jh ji jj lq jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff lr"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>