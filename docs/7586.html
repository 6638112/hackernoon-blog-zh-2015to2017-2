<html>
<head>
<title>Publishing Baller React Modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发布Baller React模块</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/publishing-baller-react-modules-2b039d84bce7?source=collection_archive---------11-----------------------#2017-11-01">https://medium.com/hackernoon/publishing-baller-react-modules-2b039d84bce7?source=collection_archive---------11-----------------------#2017-11-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="a4b9" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">用Rollup发布现代React模块的指南+样板文件</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/e127fa333d7db4583952248bd1250ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6iYTRCdbi_V47BxaArEQLA.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">React &amp; NPM living together in harmony.</figcaption></figure><p id="0d81" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">将一个开源的React / Preact组件或库发布到<a class="ae kv" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>会非常有益，但是开始设置仍然比它应该的更令人生畏，特别是与通过<a class="ae kv" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>或<a class="ae kv" href="https://github.com/just-boris/create-preact-app" rel="noopener ugc nofollow" target="_blank"> create-preact-app </a>创建React应用程序的相对简单的过程相比。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kw kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Kylo Ren attempting to publish his first React module…</figcaption></figure><p id="13eb" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">因为JS模块格式和ES特性无处不在，而且不太可能在短期内标准化，npm模块必须支持最低公分母格式(commonjs)和现代ES6模块，而不依赖于大多数React社区认为理所当然的<em class="ky">普通的</em>语言特性，如JSX和类属性。出于这个原因，很难把你为一个应用程序编写的组件直接发布到npm。</p><blockquote class="kz"><p id="8dce" class="la lb hu bd lc ld le lf lg lh li ku ek translated">本文的目的是帮助React作者轻松发布他们自己的高质量组件模块。</p></blockquote><h1 id="1a53" class="lj lk hu bd ll lm ln lo lp lq lr ls lt ja lu jb lv jd lw je lx jg ly jh lz ma dt translated">目标</h1><p id="24f5" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">有一些现有的React库样板文件，但是它们都没有达到我们要达到的目标:</p><ul class=""><li id="8565" class="mg mh hu kb b kc kd kf kg ki mi km mj kq mk ku ml mm mn mo dt translated">在开发过程中支持所有可能的JS语言特性</li><li id="0e24" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku ml mm mn mo dt translated">将源代码转换为在npm上实际使用所需的commonjs和es模块格式的构建流程</li><li id="80fb" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku ml mm mn mo dt translated">将<a class="ae kv" href="https://rollupjs.org/" rel="noopener ugc nofollow" target="_blank"> Rollup </a>用于构建过程，将<a class="ae kv" href="https://babeljs.io/" rel="noopener ugc nofollow" target="_blank"> Babel </a>用于传输(我们将在本文后面讨论Rollup vs Webpack)</li><li id="5f33" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku ml mm mn mo dt translated">必须附带一个使用<a class="ae kv" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>标准的<em class="ky">示例</em>应用程序</li><li id="f5bf" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku ml mm mn mo dt translated">允许在库中使用npm模块，作为依赖项或对等依赖项</li><li id="598d" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku ml mm mn mo dt translated">支持在你的模块中导入CSS(注意，如果你使用css-in-js方法，CSS支持将是一个noop)</li><li id="2ce6" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku ml mm mn mo dt translated">完整的文档</li></ul><p id="dce2" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">对于模块作者来说，在模块本身旁边包含一个简单、自包含的示例应用程序尤为重要，因为它有两个有用的用途:</p><ol class=""><li id="db63" class="mg mh hu kb b kc kd kf kg ki mi km mj kq mk ku mu mm mn mo dt translated">作为开发模块的本地热重装服务器</li><li id="3d8e" class="mg mh hu kb b kc mp kf mq ki mr km ms kq mt ku mu mm mn mo dt translated">容易发布到github页面，这样用户就可以快速演示你的模块(或者类似的托管选择，如<a class="ae kv" href="http://surge.sh/" rel="noopener ugc nofollow" target="_blank"> surge.sh </a>或<a class="ae kv" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank"> now.sh </a></li></ol><p id="6432" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">既然我们的目标已经明确，看看我们将要开始的<a class="ae kv" href="https://github.com/transitive-bullshit/react-modern-library-boilerplate" rel="noopener ugc nofollow" target="_blank">样板报告</a>:</p><div class="mv mw fm fo mx my"><a href="https://github.com/transitive-bullshit/react-modern-library-boilerplate" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab ej"><div class="na ab nb cl cj nc"><h2 class="bd hv fv z el nd eo ep ne er et ht dt translated">传递-废话/反应-现代-图书馆-样板文件</h2><div class="nf l"><h3 class="bd b fv z el nd eo ep ne er et ek translated">react-modern-library-Boilerplate-用Rollup发布现代React模块的样板文件</h3></div><div class="ng l"><p class="bd b gc z el nd eo ep ne er et ek translated">github.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm jt my"/></div></div></a></div><h1 id="f68b" class="lj lk hu bd ll lm ln lo lp lq lr ls lt ja nn jb lv jd no je lx jg np jh lz ma dt translated">游戏攻略</h1><p id="40e9" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">为了使用<a class="ae kv" href="https://github.com/transitive-bullshit/react-modern-library-boilerplate" rel="noopener ugc nofollow" target="_blank">样板文件</a>，我们建议按照本演练开始。如果这些步骤看起来很复杂，不要担心，因为这意味着非常冗长。</p><h2 id="ba46" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">入门指南</h2><p id="2477" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">让我们创建一个名为<code class="eh oe of og oh b">react-poop-emoji</code>的示例npm模块，它公开了一个组件<code class="eh oe of og oh b">PoopEmoji</code>💩。我们将假设一个示例github用户名为<code class="eh oe of og oh b">github-haxor</code>，其中您的github用户名将用于指定<code class="eh oe of og oh b">package.json</code>中的存储库并解析示例github页面部署。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oi kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Initial setup cloning and replacing boilerplate placeholders</figcaption></figure><h2 id="aa40" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">地方发展</h2><p id="bd63" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">现在您已经准备好运行rollup的本地版本，它将监视您的<code class="eh oe of og oh b">src/</code>组件，并在您做出更改时自动将其重新编译到<code class="eh oe of og oh b">dist/</code>中。</p><p id="230f" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">我们还将运行我们的<code class="eh oe of og oh b">example/</code> create-react-app，它链接到您的<code class="eh oe of og oh b">react-poop-emoji</code>模块的本地版本。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oi kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Setup for developing your module locally</figcaption></figure><p id="24ff" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">现在，无论您何时对<code class="eh oe of og oh b">src/</code>中的组件或示例应用程序的<code class="eh oe of og oh b">example/src</code>进行更改，<code class="eh oe of og oh b">create-react-app</code>都会实时重新加载您的本地开发服务器，因此您可以实时迭代您的组件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oi kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Here we have the default exported component that comes with the boilerplate. Feel free to edit it to your liking before moving on while testing your changes in the live create-react-app dev server.</figcaption></figure><h2 id="50f8" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">Git东西</h2><p id="dd14" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">当您准备好第一次将您的组件推送到github时，确保您已经定制了所有的自述文件和元数据，然后正常初始化您的git repo:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oi kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Setup git normally… huzzah!</figcaption></figure><h2 id="8883" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">NPM的东西</h2><p id="4eca" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">当您准备好将模块发布到npm时，请确保您的依赖项是最新的。您不希望包含在已发布捆绑包中的任何npm模块依赖项都应在<code class="eh oe of og oh b">package.json</code>中标记为<a class="ae kv" href="https://nodejs.org/en/blog/npm/peer-dependencies/" rel="noopener ugc nofollow" target="_blank">对等依赖项</a>，并添加到您的汇总配置中的外部数组。注意，这个样板文件默认将<code class="eh oe of og oh b">react</code>、<code class="eh oe of og oh b">react-dom</code>和<code class="eh oe of og oh b">prop-types</code>设置为对等依赖，这可能是您想要的，除非您真的知道自己在做什么。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oi kx l"/></div></figure><h2 id="6dd3" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">Github页面</h2><p id="a5db" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">最后，我们建议将您的示例部署到github页面，这样您的用户就可以在安装之前快速体验您的库的实时版本。</p><p id="9ade" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">部署到github页面非常简单。我们为展示您的库的示例<code class="eh oe of og oh b">create-react-app</code>创建一个生产构建，然后运行<code class="eh oe of og oh b">gh-pages</code>来部署结果包。这可以通过以下命令完成:</p><pre class="jk jl jm jn fq oj oh ok ol aw om dt"><span id="4460" class="nq lk hu oh b fv on oo l op oq">npm run deploy</span></pre><p id="7623" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">注意，为您的<code class="eh oe of og oh b">example/package.json</code>设置正确的<code class="eh oe of og oh b">homepage</code>属性很重要，因为<code class="eh oe of og oh b">create-react-app</code>使用这个值作为解析静态资产URL的前缀。</p><p id="1796" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">我们建议在您的自述文件中添加一个指向生成的github页面示例的链接。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="or kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">The Dude eloquently describing the engineering <a class="ae kv" href="https://www.wikiwand.com/en/KISS_principle" rel="noopener ugc nofollow" target="_blank">KISS</a> principle.</figcaption></figure><h1 id="fc5c" class="lj lk hu bd ll lm ln lo lp lq lr ls lt ja nn jb lv jd no je lx jg np jh lz ma dt translated">常见问题解答</h1><h2 id="4258" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">为什么在Webpack上使用Rollup？</h2><p id="0dee" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">更深入的解释，我推荐阅读Rich Harris的文章<a class="ae kv" rel="noopener" href="/webpack/webpack-and-rollup-the-same-but-different-a41ad427058c"> Webpack和Rollup:相同但不同</a>。简而言之，现在社区的大多数人倾向于对库使用Rollup，对应用程序使用Webpack。也就是说，我认为你应该坚持使用你更喜欢的东西，因为只要你喜欢使用其中一个，两者之间就没有太大的区别。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oi kx l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Rollup configs are generally more concise for library development. This config transpiles and bundles the module’s source and external dependencies to CommonJS and ES6 formats.</figcaption></figure><h2 id="8615" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">为什么在这个例子中使用create-react-app？</h2><p id="24e1" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">create-react-app 已经成为几乎每个react开发者都熟悉的标准。它的内部设计选择和权衡代表了React社区中许多最好的开发人员之间的大量协作。</p><p id="be65" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">我们认为，通过利用这样一个标准的应用程序框架，模块作者可以提供尽可能简单的示例应用程序，既可以作为一个成熟的本地开发工具，同时迭代您的模块，也可以作为一个示例展示来轻松发布。</p><p id="1754" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">参见本期CRA <a class="ae kv" href="https://github.com/facebookincubator/create-react-app/issues/737" rel="noopener ugc nofollow" target="_blank">杂志</a>了解更多关于这一运动的背景。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff os"><img src="../Images/f4b37eb2f2847c9a8dcd6c1c76848d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*XgMpgjwwDrHLOiS748kpBg.png"/></div></figure><h2 id="d370" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">考试在哪里？</h2><p id="95c1" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">我建议您借用create-react-app的内置<a class="ae kv" href="https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#running-tests" rel="noopener ugc nofollow" target="_blank">测试工具设置</a>来测试您的库。也就是说，你可以随意提交一份简历，我很乐意在样板文件中添加一些单独的标准化测试。</p><h2 id="d79c" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">创建样板文件的目的是什么？一个月后不会过时吗？</h2><p id="5aca" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">这是一个合理的大问题。我想感谢我自己问了这个问题😝</p><p id="86d4" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">尽管JS社区通常发展得太快，对自己不利，但我相信这些类型的时间点最佳实践样板仍然是有用的学习目的，也是有抱负的开源作者和老手们的出发点。我个人感到沮丧的是，在发布了几个开源的react模块之后，很难找到一个高质量的、最新的起点，所以我想把我所学到的东西回馈给教会了我这么多的社区。</p><p id="4fda" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">如果您对如何改进这个样板文件或演练有任何建议，或者如果某个东西从现在起一个月后已经过时，请随时提出问题，或者更好的是，提交一份PR！</p><h2 id="9141" class="nq lk hu bd ll nr ns nt lp nu nv nw lt ki nx ny lv km nz oa lx kq ob oc lz od dt translated">如何在我的组件中使用Typescript？</h2><p id="2dbb" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">Rollup拥有出色的Typescript支持。有关如何将Typescript与该样板文件集成的详细信息，请参见本<a class="ae kv" href="https://github.com/transitive-bullshit/react-modern-library-boilerplate/issues/1" rel="noopener ugc nofollow" target="_blank">期</a>。</p><h1 id="c9d7" class="lj lk hu bd ll lm ln lo lp lq lr ls lt ja nn jb lv jd no je lx jg np jh lz ma dt translated">发布的模块是什么样子的？</h1><p id="baf6" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">这里有一个根据本指南创建的react模块示例:<a class="ae kv" href="https://github.com/transitive-bullshit/react-background-slideshow" rel="noopener ugc nofollow" target="_blank">react-background-slide show</a>，React的一个性感的平铺背景幻灯片。它附带了一个托管在github页面上的create-react-app示例，应该可以让您很好地了解从这个样板文件开始能够创建的模块类型。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff ot"><img src="../Images/38bdfe4040ecc35e65886b15aac34f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*lKkYHp76fRoAbib8_tfJJA.gif"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Example boilerplate module <a class="ae kv" href="https://github.com/transitive-bullshit/react-background-slideshow" rel="noopener ugc nofollow" target="_blank">react-background-slideshow</a> (animations sped up for <a class="ae kv" href="https://transitive-bullshit.github.io/react-background-slideshow/" rel="noopener ugc nofollow" target="_blank">demo</a>)</figcaption></figure><h1 id="5c68" class="lj lk hu bd ll lm ln lo lp lq lr ls lt ja nn jb lv jd no je lx jg np jh lz ma dt translated">从这里去哪里？</h1><p id="4543" class="pw-post-body-paragraph jz ka hu kb b kc mb iv ke kf mc iy kh ki md kk kl km me ko kp kq mf ks kt ku hn dt translated">我想对<a class="ae kv" href="https://js.coach/react" rel="noopener ugc nofollow" target="_blank"> js.coach </a>大喊一声，这是我最喜欢的寻找高质量、开源React组件的资源。如果你正在寻找进一步的灵感或试图找到一个可靠的解决方案，而不是重新发明轮子，机会将会有一些相关的模块列在他们的索引上。</p><blockquote class="kz"><p id="cd7f" class="la lb hu bd lc ld le lf lg lh li ku ek translated">如果你觉得这个演练或附带的<a class="ae kv" href="https://github.com/transitive-bullshit/react-modern-library-boilerplate" rel="noopener ugc nofollow" target="_blank">样板</a>有用，请⭐️ ️️回购，以帮助其他开发人员找到它。</p></blockquote><p id="b9fc" class="pw-post-body-paragraph jz ka hu kb b kc ou iv ke kf ov iy kh ki ow kk kl km ox ko kp kq oy ks kt ku hn dt translated">免责声明:作者是脸书的软件工程师，但本文讨论的是一个独立的开源项目，我的观点不代表脸书或其工程人员的整体观点。例如，我写这类东西是为了好玩😃</p></div></div>    
</body>
</html>