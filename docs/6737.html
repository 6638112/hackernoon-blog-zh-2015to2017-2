<html>
<head>
<title>[Nodejs] Something about Buffer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于缓冲区的一些事情</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/nodejs-javasript-react-buffer-understand-tutorial-example-easy-step-create-read-utf8-ce37866ddd8c?source=collection_archive---------15-----------------------#2017-10-02">https://medium.com/hackernoon/nodejs-javasript-react-buffer-understand-tutorial-example-easy-step-create-read-utf8-ce37866ddd8c?source=collection_archive---------15-----------------------#2017-10-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/dede65fea24ba5e451f953fd2a891387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G7nMRuRnZTJc3ODU1lK00g.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek"><a class="ae jg" href="https://flink.apache.org/news/2015/05/11/Juggling-with-Bits-and-Bytes.html" rel="noopener ugc nofollow" target="_blank">https://flink.apache.org/news/2015/05/11/Juggling-with-Bits-and-Bytes.html</a></figcaption></figure><blockquote class="jh"><p id="165f" class="ji jj hu bd jk jl jm jn jo jp jq jr ek translated">在node.js中，缓冲区是原始字节的容器。<strong class="ak"> <em class="js">一个字节</em> </strong>只是表示<strong class="ak"> <em class="js">八位</em> </strong>，<strong class="ak"> <em class="js">一位</em> </strong>只是一个0或者1。所以一个字节可能看起来像10101010 ( <a class="ae jg" href="https://allenkim67.github.io/programming/2016/05/17/nodejs-buffer-tutorial.html" rel="noopener ugc nofollow" target="_blank"> <em class="js">出自艾伦</em> </a>)。</p></blockquote><h1 id="813a" class="jt ju hu bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dt translated">1-缓冲区看起来像什么？</h1><p id="8bdf" class="pw-post-body-paragraph kr ks hu kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln jr hn dt translated">基本上，缓冲剂可以以两种主要形式出现</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="d2fb" class="lx ju hu lt b fv ly lz l ma mb"><strong class="lt hv">const</strong> Buffer <strong class="lt hv">=</strong> require('buffer').Buffer;<br/><br/><strong class="lt hv">const</strong> buf <strong class="lt hv">=</strong> Buffer.from([0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x77, 0x6f, 0x72,<br/> 0x6c, 0x64]);</span></pre><p id="c7a8" class="pw-post-body-paragraph kr ks hu kt b ku mc kw kx ky md la lb lc me le lf lg mf li lj lk mg lm ln jr hn dt translated">形式1，原始内存块</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="f8fb" class="lx ju hu lt b fv ly lz l ma mb">console.log(buf);<br/><em class="mh">// outputs &lt;Buffer 68 65 6c 6c 6f 20 77 6f 72 6c 64&gt;</em></span></pre><p id="0a80" class="pw-post-body-paragraph kr ks hu kt b ku mc kw kx ky md la lb lc me le lf lg mf li lj lk mg lm ln jr hn dt translated">形式2，解码格式(可能是<code class="eh mi mj mk lt b">utf16le, utf8 etc. <a class="ae jg" href="https://www.tutorialspoint.com/nodejs/nodejs_buffers.htm" rel="noopener ugc nofollow" target="_blank"><em class="mh">more</em></a></code>)</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="b1e5" class="lx ju hu lt b fv ly lz l ma mb">console.log(buf.toString('utf16le'));<br/><em class="mh">// outputs '敨汬⁯潷汲'<br/></em>console.log(buf.toString('utf8'));<br/><em class="mh">// outputs 'hello world'</em></span></pre><h1 id="91c5" class="jt ju hu bd jv jw jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq dt translated">2-创建缓冲区</h1><p id="6668" class="pw-post-body-paragraph kr ks hu kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln jr hn dt translated">这是摘自<a class="ae jg" href="https://docs.nodejitsu.com/articles/advanced/buffers/how-to-use-buffers/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt hv"> <em class="mh">约什</em> </strong> </a> <strong class="kt hv"> <em class="mh">的注释部分。</em> </strong>创建新缓冲区有几种方法:</p><h2 id="e61c" class="lx ju hu bd jv mo mp mq jz mr ms mt kd lc mu mv kh lg mw mx kl lk my mz kp na dt translated">n个八位字节的未启动缓冲区</h2><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="dccb" class="lx ju hu lt b fv ly lz l ma mb"><strong class="lt hv">var</strong> buffer = <strong class="lt hv">new</strong> Buffer(8);</span></pre><h2 id="4929" class="lx ju hu bd jv mo mp mq jz mr ms mt kd lc mu mv kh lg mw mx kl lk my mz kp na dt translated">来自给定数组的缓冲区</h2><p id="93df" class="pw-post-body-paragraph kr ks hu kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln jr hn dt translated">该缓冲区未初始化，包含8个字节。</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="231a" class="lx ju hu lt b fv ly lz l ma mb"><strong class="lt hv">var</strong> buffer = <strong class="lt hv">new</strong> Buffer([ 8, 6, 7, 5, 3, 0, 9]);</span></pre><h2 id="a097" class="lx ju hu bd jv mo mp mq jz mr ms mt kd lc mu mv kh lg mw mx kl lk my mz kp na dt translated">给定字符串的缓冲区。</h2><p id="0ae6" class="pw-post-body-paragraph kr ks hu kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln jr hn dt translated">这将缓冲区初始化为此数组的内容。请记住，数组的内容是表示字节的整数。</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="5251" class="lx ju hu lt b fv ly lz l ma mb"><strong class="lt hv">var</strong> buffer = <strong class="lt hv">new</strong> Buffer("I'm a string!", "utf-8")</span></pre><h1 id="5522" class="jt ju hu bd jv jw jx jy jz ka kb kc kd ke ml kg kh ki mm kk kl km mn ko kp kq dt translated">3-操作</h1><p id="0a87" class="pw-post-body-paragraph kr ks hu kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln jr hn dt translated"><em class="mh">缓冲器带来更多乐趣</em></p><ul class=""><li id="2f88" class="nb nc hu kt b ku mc ky md lc nd lg ne lk nf jr ng nh ni nj dt translated">写入缓冲区</li><li id="fe1f" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">从缓冲器中读取<code class="eh mi mj mk lt b">buf.toString(‘utf8’,0,5)</code></li><li id="f68b" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">将缓冲区转换成JSON <code class="eh mi mj mk lt b">var json = buf.toJSON(buf);</code></li><li id="1893" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">连接缓冲器<code class="eh mi mj mk lt b">var buffer3 = Buffer.concat([buffer1,buffer2]);</code></li><li id="7d17" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">比较缓冲区<code class="eh mi mj mk lt b">buf.compare(otherBuffer);</code></li><li id="c312" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">复制缓冲器<code class="eh mi mj mk lt b">buffer1.copy(buffer2);</code></li><li id="2d9e" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">切片缓冲器<code class="eh mi mj mk lt b">var buffer2 = buffer1.slice(0,9);</code></li><li id="0d5d" class="nb nc hu kt b ku nk ky nl lc nm lg nn lk no jr ng nh ni nj dt translated">缓冲长度<code class="eh mi mj mk lt b">buffer.length</code></li></ul></div><div class="ab cl np nq hc nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="hn ho hp hq hr"><h2 id="0a22" class="lx ju hu bd jv mo mp mq jz mr ms mt kd lc mu mv kh lg mw mx kl lk my mz kp na dt translated">参考:</h2><p id="52f1" class="pw-post-body-paragraph kr ks hu kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln jr hn dt translated"><a class="ae jg" href="https://nodejs.org/docs/latest/api/buffer.html#buffer_buffer_from_buffer_alloc_and_buffer_allocunsafe" rel="noopener ugc nofollow" target="_blank">https://nodejs . org/docs/latest/API/buffer . html # buffer _ buffer _ from _ buffer _ alloc _ and _ buffer _ allocunsafe</a></p><p id="ad15" class="pw-post-body-paragraph kr ks hu kt b ku mc kw kx ky md la lb lc me le lf lg mf li lj lk mg lm ln jr hn dt translated"><a class="ae jg" href="https://docs.nodejitsu.com/articles/advanced/buffers/how-to-use-buffers/" rel="noopener ugc nofollow" target="_blank">https://docs . node jitsu . com/articles/advanced/buffers/how-to-use-buffers/</a></p><p id="f34f" class="pw-post-body-paragraph kr ks hu kt b ku mc kw kx ky md la lb lc me le lf lg mf li lj lk mg lm ln jr hn dt translated"><a class="ae jg" href="https://allenkim67.github.io/programming/2016/05/17/nodejs-buffer-tutorial.html" rel="noopener ugc nofollow" target="_blank">https://allenkim 67 . github . io/programming/2016/05/17/nodejs-buffer-tutorial . html</a></p><p id="1dbb" class="pw-post-body-paragraph kr ks hu kt b ku mc kw kx ky md la lb lc me le lf lg mf li lj lk mg lm ln jr hn dt translated"><a class="ae jg" href="https://www.tutorialspoint.com/nodejs/nodejs_buffers.htm" rel="noopener ugc nofollow" target="_blank">https://www.tutorialspoint.com/nodejs/nodejs_buffers.htm</a></p><p id="f4f1" class="pw-post-body-paragraph kr ks hu kt b ku mc kw kx ky md la lb lc me le lf lg mf li lj lk mg lm ln jr hn dt translated"><a class="ae jg" href="https://flink.apache.org/news/2015/05/11/Juggling-with-Bits-and-Bytes.html" rel="noopener ugc nofollow" target="_blank">https://flink . Apache . org/news/2015/05/11/杂耍比特和字节. html </a></p></div></div>    
</body>
</html>