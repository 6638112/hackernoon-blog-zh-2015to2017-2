<html>
<head>
<title>Non-Artistic Style Transfer (or How to Draw Kanye using Captain Picard’s Face)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">非艺术风格转移(或者怎么用皮卡德队长的脸画坎耶)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/non-artistic-style-transfer-or-how-to-draw-kanye-using-captain-picards-face-c4a50256b814?source=collection_archive---------2-----------------------#2017-03-14">https://medium.com/hackernoon/non-artistic-style-transfer-or-how-to-draw-kanye-using-captain-picards-face-c4a50256b814?source=collection_archive---------2-----------------------#2017-03-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/fa37996da5ed58dc96266c5946b82543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*nbAaHFEAcwsyMHMPBSCVOg.png"/></div></figure><p id="8828" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="jw">在</em> <a class="ae jx" href="http://fast.ai" rel="noopener ugc nofollow" target="_blank"> <em class="jw"> fast.ai </em> </a> <em class="jw">的</em> <a class="ae jx" href="https://www.usfca.edu/data-institute/certificates/deep-learning-part-two" rel="noopener ugc nofollow" target="_blank"> <em class="jw">深度学习第二部分</em> </a> <em class="jw">与</em><a class="ae jx" href="https://twitter.com/jeremyphoward" rel="noopener ugc nofollow" target="_blank"><em class="jw">@ Jeremy Howard</em></a><em class="jw"/><a class="ae jx" href="https://twitter.com/math_rachel" rel="noopener ugc nofollow" target="_blank"><em class="jw">@ math _ Rachel</em></a><em class="jw">我们一直在学习生成模型，这启发我在一些新的方向上进行实验。我会在这里向你展示这些实验的结果，并描述它们是如何完成的。为了完整的理解，你应该熟悉CNN，损失函数等；如果你不是，那就去看看</em> <a class="ae jx" href="http://course.fast.ai/" rel="noopener ugc nofollow" target="_blank"> <em class="jw">程序员实用深度学习，第一部分</em> </a> <em class="jw">(本课程第一部分的MOOC版本)。</em></p><p id="edc9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">自从<a class="ae jx" href="https://arxiv.org/abs/1508.06576" rel="noopener ugc nofollow" target="_blank"> Gatys </a>和朋友们引入艺术风格转移以来，深度学习社区一直热衷于以著名艺术家的风格创建图像。而且理由很充分！结果一直令人震惊；风格转移使我们能够用神经网络以简单的过滤器无法模仿的方式重新绘制图像。</p><p id="1105" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">对于那些不熟悉的人来说，艺术风格转移是一种用图像X的内容但用图像y的风格创建图像的方法。如果“卷积神经网络”、“MSE”和“反向传播”这些词对你来说是胡言乱语，请随意跳过接下来的三段(但请留意我即将推出的完整的非技术风格转移指南！).如果您熟悉这些主题，下面是对原始样式转换实现的简要概述。</p><p id="0d41" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><a class="ae jx" href="https://arxiv.org/abs/1508.06576" rel="noopener ugc nofollow" target="_blank"> Gatys </a>最初的方法是从三张图像开始，内容图像、风格图像和一张随机“噪声”图像，并让它们通过一些CNN的卷积层，这些CNN已经为图像识别进行了预训练(通常是Vgg16/19)。该方法的损失函数是将内容和样式图像的卷积层输出与随机图像进行比较。然后，我们通过反向传播来更新随机图像的像素，以最小化这种损失。</p><p id="51cb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“比较”的度量对于内容和风格图像是不同的；对于内容，我们的损失只是内容和随机图像输出之间的MSE。这将更新随机图像以最终匹配内容图像。它与原始图像的精确匹配程度取决于用于比较的图层的深度。</p><p id="32b9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在原始论文中得到的启示在于为该风格计算的损失；我们不是计算样式/随机图像的卷积输出之间的MSE，而是计算这些输出的<a class="ae jx" href="https://en.wikipedia.org/wiki/Gramian_matrix" rel="noopener ugc nofollow" target="_blank">格拉米矩阵</a>之间的MSE。这种损失的反向传播导致图像具有原始图像的风格，而没有任何内容。这种方法本质上是将风格图像解构为一个由原始艺术风格组成的图像，没有结构。我喜欢称之为风格图像的<em class="jw">调色板</em>。</p><p id="9e06" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">风格转移是这两种方法的简单结合，它允许我们用一幅图片的内容和另一幅图片的风格来创建一幅图像。</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div class="fe ff jy"><img src="../Images/425510875d9f6657ef7cdb2854684c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*XKtrAkpjrhkGEEpSUkZXyA.jpeg"/></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The Life of Pablo’s Girl Before a Mirror</figcaption></figure><p id="1831" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在上面的例子中，我的内容形象是坎耶·韦斯特，我的风格形象是巴勃罗·毕加索的《镜前少女》。左下角的图像是从绘画中解构的调色板的例子。最后一幅图像是重建图像时结合内容和风格损失的结果；我们用毕加索的风格重建了坎耶的形象。</p><p id="bcf0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然而,“艺术风格转移”这一说法略微低估了我们用这种方法实际能达到的效果。在文学中有许多将艺术作品的风格转移到图像的例子；然而，将非艺术风格转移到图像上的例子却很少。</p><p id="5edc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">试图将非艺术的“风格”应用于图像是艺术风格转移方法的自然延伸。例如，我们可能想知道是否可以将吉他的“风格”应用到图像中。</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/5bf646eedc01276b0cce2df02d9b582a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRachaAm5u9Xo35H3En_iw.jpeg"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Style Image; Palette; Style-Transferred Image</figcaption></figure><p id="bcff" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这种实现是…最好的平庸。我们可以看到，我们的结果图像确实显示了一些指板风格，但它不是特别强烈，而且相对平滑。当我们查看从该图像中提取的调色板时，指板图案并不普遍。</p><p id="44ac" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这可能仅仅是因为图像选择不当。或许这也适用于其他非艺术图片:</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/ed8df211d7e709c48e102bd31e16a8fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0BbY1NhapKwj5JDCpRgDw.jpeg"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Style Image; Palette; Style-Transferred Image</figcaption></figure><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/5cc09b29a170d93a618296cb3de25cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzu9yFFkdsKnwF2Vs2sGwg.jpeg"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Style Image; Palette; Style-Transferred Image</figcaption></figure><p id="f5e2" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">没有。无论是NES管制员还是皮卡德上尉的形象都不能赋予这些形象“NES管制员/皮卡德”的风格。与吉他一样，从这些图像中提取的调板并没有准确地捕捉到我们想要的效果。</p><p id="964c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你有一些风格转换的经验，这就不足为奇了。当我们在风格转换中说“风格”时，我们指的是图像绘制的风格。在这三幅图像中，没有画这些图像的“风格”。对于毕加索的《镜子前的女孩》，我们复制的风格由绘画中的笔触和印象派结构组成。因此，为了让style-transfer提取一种风格，它必须是在整个图像中普遍存在的东西。</p><p id="a7df" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们如何构建一个包含我们希望传递的非艺术风格的图像？</p><p id="315c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">贴瓷砖就好。</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/239dd20e863ddae863fab2bfd0ad367b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-egMFv0OuA6blYvwuXxEKw.jpeg"/></div></div></figure><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/a11d6272754e107cae4db5370964972a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBypZ5AHLSApRQUoS2DBLw.jpeg"/></div></div></figure><p id="82c9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这种方法传播了我们想要传递的风格，比仅仅应用单一图像更加突出。吉他图像清楚地显示了我们可能归因于指板的多边形图案和线条。NES控制器图像显示类似于D-pad上的矩形结构的图案，以及粗体红色按钮。</p><p id="d6f8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这种方法有效的原因是因为它允许我们对想要用来绘制新图像的调色板进行逆向工程。因为我们的目标是以NES控制器的风格绘制图像，所以我们需要一个已经以该风格绘制的图像来提取调色板。然而，由于这样的图像正是我们所追求的(并且可能不存在)，我们需要自己制造一个合成的例子。平铺正是这样做的。</p><p id="f7e2" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">但是我们到底能做到什么程度呢？我们能把这种平铺方法用于一种类似脸的“样式”吗？</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/c3eb16399d25b067495f4e6a55c416d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1XXBeoIUckUp0bMlyJ92A.jpeg"/></div></div></figure><p id="82f9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这是更好的，我们可以看到调色板正在选择一个面的一部分作为样式。但是它失去了整个面部的结构。如果我们认为调色板是创建样式图像的笔触，那么直觉应该告诉我们，我们可以通过调整平铺的粒度来调整多少我们想要的图像构成“笔触”。因此，如果我们想要整个脸被一个笔刷所捕捉，我们应该把拼贴做得更小。</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/21e72ea92507d18144900468c7a01f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n_y-l31x2pcpAlGYWKMlWw.jpeg"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Ye is on the Bridge</figcaption></figure><p id="14a3" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">神圣的烟雾。这显然是一个用皮卡德船长的脸型构造的图像！</p><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div class="fe ff km"><img src="../Images/e6d212af9776556ab8c06e01e9d329b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*tWVqtjsM_nwOsfpCKZ93QQ.png"/></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The Many Faces of Captain Picard</figcaption></figure><p id="c930" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">查看拼贴图像的调色板，我们可以看到较小的拼贴提供了一种更好的风格，可以更好地转移整个面部，而不会失去我们想要的一些抽象。如果我们以同样的方式平铺吉他和NES控制器图像，我们可能会得到类似的结果。</p><p id="cd7b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我发现这种拼贴方法非常迷人，因为它将风格转移推到了美术领域之外。虽然艺术风格转移可以实现无限的可能性，但非艺术风格转移却打开了无限多可能性的大门。</p><p id="f7ab" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你有兴趣尝试这些技术，(并可能用贾斯汀比伯画出你朋友的脸)，我推荐Anish Athalye的神经风格转移的<a class="ae jx" href="https://github.com/anishathalye/neural-style" rel="noopener ugc nofollow" target="_blank"> python实现</a>。</p><p id="0ee3" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你真的想了解这是如何工作的，请留意杰瑞米·霍华德在他的<strong class="ja hv">程序员实用深度学习，第二部分</strong>课程中关于这个主题的讲座，其中的MOOC将于2017年5月在<a class="ae jx" href="http://course.fast.ai/" rel="noopener ugc nofollow" target="_blank">这里</a>直播。</p><p id="ad25" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你没有神经网络方面的经验，并且想了解更多关于当前人工智能激增背后的技术以及如何实现它，我强烈建议你看看杰瑞米·霍华德和<a class="ae jx" href="http://fast.ai" rel="noopener ugc nofollow" target="_blank"> fast.ai </a>的<a class="ae jx" href="http://course.fast.ai/" rel="noopener ugc nofollow" target="_blank"> <strong class="ja hv">程序员实用深度学习，第1部分</strong> </a> <strong class="ja hv"> </strong>课程(完全披露:我是<a class="ae jx" href="http://fast.ai" rel="noopener ugc nofollow" target="_blank"> fast.ai </a>的实习生，也是<strong class="ja hv">第1部分</strong>课程笔记的主要撰稿人)。</p><div class="jz ka kb kc fq ab cb"><figure class="kn iv ko kp kq kr ks paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="kn iv ko kp kq kr ks paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="kn iv ko kp kq kr ks paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="kt ku kv"><p id="f922" class="iy iz jw ja b jb jc jd je jf jg jh ji kw jk jl jm kx jo jp jq ky js jt ju jv hn dt translated"><a class="ae jx" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是AMI家庭的一员。我们现在<a class="ae jx" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jx" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="iy iz jw ja b jb jc jd je jf jg jh ji kw jk jl jm kx jo jp jq ky js jt ju jv hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jx" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jx" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jz ka kb kc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kz"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>