<html>
<head>
<title>Continuous Monitoring with TICK stack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用TICK堆栈进行连续监控</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/continuous-monitoring-with-tick-stack-10585dfea481?source=collection_archive---------27-----------------------#2017-12-20">https://medium.com/hackernoon/continuous-monitoring-with-tick-stack-10585dfea481?source=collection_archive---------27-----------------------#2017-12-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/326511c638987ffc82a4a68c0088f4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-Q54bCtd-68i33v16YlxQ.jpeg"/></div></div></figure><p id="062f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">需要监控您的系统。它帮助您<strong class="je hv">在任何问题导致影响您的客户和损害您的商业声誉的重大停机之前检测到这些问题。这也有助于您根据系统的实际使用情况<strong class="je hv">规划增长</strong>。但是从不同的数据源收集指标是不够的，您需要<strong class="je hv">个性化</strong>您的监控，以满足您自己的业务需求，并定义正确的警报，以便系统中的任何异常变化都会得到报告。</strong></p><p id="adde" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这篇文章中，我将向您展示如何建立一个只有开源项目的弹性持续监控平台&amp;如何定义一个事件警报来报告系统中的变化。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ka"><img src="../Images/5810b68368f1c781a8c5a5ed659e924b.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*vwVAurfgQBJX433JRIAzBQ.png"/></div></figure><p id="fd3a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">克隆以下Github存储库:</p><blockquote class="kf kg kh"><p id="ff26" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">git克隆<a class="ae km" href="https://github.com/mlabouardy/terraform-aws-labs.git" rel="noopener ugc nofollow" target="_blank">https://github.com/mlabouardy/terraform-aws-labs.git</a></p></blockquote><p id="a03b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> 1 —地形&amp; AWS </strong></p><p id="86a6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在<em class="ki"> tick-stack/terraform </em>目录中，使用您自己的<strong class="je hv"> AWS </strong>凭证更新<em class="ki"> variables.tfvars </em>文件(确保您拥有正确的<strong class="je hv"> IAM </strong>策略) :</p><blockquote class="kf kg kh"><p id="926c" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">region = "AWS区域"</p><p id="e653" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">access_key = "您的AWS访问密钥ID "</p><p id="4bed" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">secret_key = "您的AWS密钥"</p><p id="3c38" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">key_name = "您的SSH密钥对"</p></blockquote><p id="1e09" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">发出以下命令下载AWS提供程序插件:</p><blockquote class="kf kg kh"><p id="93b4" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">地形初始化</p></blockquote><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/52242592f9579bebc69c17d38e99b426.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/0*dmAjHgzRLWd5qPhy."/></div></figure><p id="5fbf" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">发出以下命令来配置基础架构:</p><blockquote class="kf kg kh"><p id="0a4b" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">terra form apply-var-file = variables . TF vars</p></blockquote><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/7666f9dff5de9cb9fb2b6d91a054aff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*Y99i65WrMLnGAAls."/></div></figure><p id="e460" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> 2 —可回答的&amp;对接者</strong></p><p id="44ab" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用您的实例DNS名称更新<em class="ki">库存</em>文件:</p><blockquote class="kf kg kh"><p id="62b1" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">[服务器]</p><p id="9d48" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">ec2–52–206–156–244.compute-1.amazonaws.com</p></blockquote><p id="cb4b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，安装Ansible自定义角色:</p><blockquote class="kf kg kh"><p id="1b01" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">ansible-galaxy安装mlabouardy.tick</p></blockquote><p id="467d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">执行<strong class="je hv">可行剧本</strong>:</p><blockquote class="kf kg kh"><p id="67b2" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">ansi ble-playbook-private-key = AWS . PEM-I库存手册. yml</p></blockquote><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/fefcde43a59784af15338f3f593dece3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*ksGdLZIAO8oML6IO."/></div></figure><p id="6acd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将您的浏览器指向<a class="ae km" href="http://dns_name:8083/" rel="noopener ugc nofollow" target="_blank"> http://DNS_NAME:8083 </a>，您应该会看到<strong class="je hv">influx db</strong>T28】Admin Dashboard:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/17c6a77ecb865cfb2b661ff71b6a743e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*Bu7lcr0nzSBxr-wV."/></div></figure><p id="be83" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，在<strong class="je hv">Chronograf</strong>(<a class="ae km" href="http://dns_name:8888/" rel="noopener ugc nofollow" target="_blank">http://DNS _ NAME:8888</a>)中创建一个<strong class="je hv"> InfluxDB数据源</strong>:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/8243a4be8e437fb7d08d90a1c48a82bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*X7TKMKcQLGlKMMic."/></div></figure><p id="1391" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建新仪表板，如下所示:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kp"><img src="../Images/3b6c4ddf3fff16af5548af4747764468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ae8frgV0sml81syr."/></div></div></figure><p id="7b47" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以创建多个图形来可视化不同类型的指标:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kq"><img src="../Images/b171f861a41f3d6a9f4ad16e7b0ce07c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gX2sUimVKlbh6Xga."/></div></div></figure><p id="7da1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注:关于如何在<strong class="je hv"> Chronograf </strong>中创建交互式动态仪表盘的详细信息，请查看<a class="ae km" href="http://www.blog.labouardy.com/monitor-swarm-cluster-with-tick-stack-slack/" rel="noopener ugc nofollow" target="_blank">我之前的教程</a>。</p><p id="ecde" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您需要详细说明收集到的数据，以做一些类似警报的事情。因此确保启用<strong class="je hv"> Kapacitor </strong>:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kp"><img src="../Images/75d1b15910e48101161b0efef17378a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cWKKxWOqe3wSscCA."/></div></div></figure><p id="80e4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">定义一个新的警报，如果<strong class="je hv"> CPU利用率</strong>高于<strong class="je hv"> 70% </strong>，则发送<strong class="je hv"> Slack </strong>通知。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kr"><img src="../Images/8fc553d00d871d3d9ea7246b29de55db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UPeffeNvaylJLkyl."/></div></div></figure><p id="a474" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了测试它，我们需要生成一些工作负载。在这种情况下，我使用了<a class="ae km" href="https://linux.die.net/man/1/stress" rel="noopener ugc nofollow" target="_blank">重音</a>:</p><blockquote class="kf kg kh"><p id="32eb" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">容易获得安装应力</p></blockquote><p id="c6dd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">给CPU带来压力:</p><blockquote class="kf kg kh"><p id="1ba6" class="jc jd ki je b jf jg jh ji jj jk jl jm kj jo jp jq kk js jt ju kl jw jx jy jz hn dt translated">压力— cpu 4 —超时20秒</p></blockquote><p id="0e85" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">几秒钟后，您应该会收到一个<strong class="je hv">松弛</strong>通知。</p></div></div>    
</body>
</html>