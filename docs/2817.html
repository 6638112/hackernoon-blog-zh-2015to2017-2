<html>
<head>
<title>React Native’s new FlatList component</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React Native的新FlatList组件</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/react-native-new-flatlist-component-30db558c7a5b?source=collection_archive---------3-----------------------#2017-02-21">https://medium.com/hackernoon/react-native-new-flatlist-component-30db558c7a5b?source=collection_archive---------3-----------------------#2017-02-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e3fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">包括:如何从</em> <code class="eh jq jr js jt b"><em class="jp">ListView</em></code> <em class="jp">(即将成为</em> <a class="ae ju" href="https://github.com/facebook/react-native/commit/a3457486e39dc752799b1103ebe606224a8e8d32#commitcomment-21097746" rel="noopener ugc nofollow" target="_blank"> <em class="jp">弃用</em> </a> <em class="jp">)迁移过来，如何在自己的app中不从源码构建React Native进行尝试。</em></p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><a href="https://www.youtube.com/watch?v=KSsgEOi_S5k"><div class="fe ff jv"><img src="../Images/a71caf09d48633c4bd9ad60301fe1698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hclmLrAiF6aHlU0E8U8-w.jpeg"/></div></a><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The demo video <a class="ae ju" href="https://www.facebook.com/spencer/videos/10106313941687053/" rel="noopener ugc nofollow" target="_blank">posted on Facebook</a> by Ahrens. Image link goes to YouTube.</figcaption></figure><p id="2def" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">更新4:现在已经足够稳定，可以默认从</em><a class="ae ju" href="https://github.com/cooperka/react-native-immutable-list-view#immutablevirtualizedlist" rel="noopener ugc nofollow" target="_blank"><em class="jp">React-Native-不可变-list-view</em></a><em class="jp">with</em><a class="ae ju" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"><em class="jp">React</em></a><em class="jp">Native v 0.43导出，无需自定义下载！请继续阅读轻松迁移的步骤。</em></p><p id="4fbf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">更新3:3月1日起</em> <a class="ae ju" href="https://github.com/facebook/react-native/commit/7b35eb3fdb803ddb00a82d0cda7904771f15e438" rel="noopener ugc nofollow" target="_blank"> <em class="jp">不再实验</em> </a> <em class="jp">。下面的一切仍然是最新的和准确的。</em></p><p id="5242" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">更新2:现在有多个新组件:</em><a class="ae ju" href="https://github.com/facebook/react-native/blob/master/Libraries/Lists/FlatList.js" rel="noopener ugc nofollow" target="_blank"><em class="jp">flat list</em></a><em class="jp">，</em><a class="ae ju" href="https://github.com/facebook/react-native/blob/master/Libraries/Lists/SectionList.js" rel="noopener ugc nofollow" target="_blank"><em class="jp">section list</em></a><em class="jp">，</em><a class="ae ju" href="https://github.com/facebook/react-native/blob/master/Libraries/Lists/VirtualizedList.js" rel="noopener ugc nofollow" target="_blank"><em class="jp">virtualized list</em></a><em class="jp">，以及</em><a class="ae ju" href="https://github.com/facebook/react-native/blob/master/Libraries/Lists/VirtualizedSectionList.js" rel="noopener ugc nofollow" target="_blank"><em class="jp">virtualized section list</em></a><em class="jp">。他们的位置已经移动了几次，但是下面的链接应该是最新的。</em></p><p id="ee06" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">更新1:原</em><a class="ae ju" href="https://facebook.github.io/react-native/docs/listview.html" rel="noopener ugc nofollow" target="_blank"><em class="jp">ListView</em></a><em class="jp">为</em> <a class="ae ju" href="https://github.com/facebook/react-native/commit/a3457486e39dc752799b1103ebe606224a8e8d32#commitcomment-21097746" rel="noopener ugc nofollow" target="_blank"> <em class="jp">计划弃用</em> </a> <em class="jp">。</em></p><p id="27e4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">二月早些时候，<a class="kh ki gr" href="https://medium.com/u/6b0501eb19c?source=post_page-----30db558c7a5b--------------------------------" rel="noopener" target="_blank">斯潘塞·阿伦斯</a> <a class="ae ju" href="https://github.com/facebook/react-native/commit/a3457486e39dc752799b1103ebe606224a8e8d32" rel="noopener ugc nofollow" target="_blank">发表了</a>一个名为<code class="eh jq jr js jt b">FlatList</code>的实验性新React原生<a class="ae ju" href="https://hackernoon.com/tagged/component" rel="noopener ugc nofollow" target="_blank">组件</a>。它显著提高了内存使用和效率(特别是对于大型或复杂的列表),同时也显著简化了道具——不再需要<code class="eh jq jr js jt b">dataSource</code>!</p><p id="1c8a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，<code class="eh jq jr js jt b">FlatList</code>希望您的数据是一个简单的值数组。然而，新API的一大优势是能够提供自己的<code class="eh jq jr js jt b">getItem</code>实现。这对于不可变数据或复杂嵌套等非标准数据格式非常有用。为此，您需要使用底层的<code class="eh jq jr js jt b">VirtualizedList</code>组件。</p><p id="ad0f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">声明:我是<code class="eh jq jr js jt b"><a class="ae ju" href="https://github.com/cooperka/react-native-immutable-list-view" rel="noopener ugc nofollow" target="_blank">react-native-immutable-list-view</a></code>的创建者，这个<a class="ae ju" rel="noopener" href="/@cooperka/react-native-immutable-listview-6075b7e27665">让</a>更容易在旧的<code class="eh jq jr js jt b">ListView</code>和新的<code class="eh jq jr js jt b">VirtualizedList</code>中使用不可变数据。</p><p id="d2a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您想亲自尝试，这里有一个旧组件的迁移指南。正如您所看到的，您的代码应该变得更加简单(红色表示删除，绿色表示添加):</p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="kj kk l"/></div></figure><p id="2443" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者，如果您之前使用的是<code class="eh jq jr js jt b"><a class="ae ju" href="https://github.com/cooperka/react-native-immutable-list-view" rel="noopener ugc nofollow" target="_blank">ImmutableListView</a></code>，那就更简单了:</p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="kj kk l"/></div></figure><p id="2af4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里唯一的警告是，您需要实际获得新的React原生组件的源代码，以便使用它们<em class="jp">【更新4:从React原生v0.43开始，这一步不再必要】。</em>它们目前只存在于<code class="eh jq jr js jt b"><a class="ae ju" href="https://github.com/facebook/react-native/tree/master/Libraries/CustomComponents/Lists" rel="noopener ugc nofollow" target="_blank">master</a></code>上，所以这里有一个快速脚本可以将它们直接下载到您的项目中(假设您已经使用npm或Yarn安装了<code class="eh jq jr js jt b">react-native</code>)。将整个命令复制到您的终端中:</p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="kj kk l"/></div></figure><p id="eddb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这会将最新版本的<code class="eh jq jr js jt b">FlatList</code>及其相关依赖项下载到你的应用程序的<code class="eh jq jr js jt b">node_modules</code>中，这样你就可以像上面的例子一样引用它，而不需要签出React Native的<code class="eh jq jr js jt b">master</code>并从源代码中构建它。</p><p id="2d94" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，您可以将上述命令添加到您的包的<code class="eh jq jr js jt b">postinstall</code>脚本中，以确保每个开发人员都有这些文件，并在您的团队中构建管道(感谢<a class="kh ki gr" href="https://medium.com/u/bd15ab8ce5e3?source=post_page-----30db558c7a5b--------------------------------" rel="noopener" target="_blank">布鲁诺·莱默斯</a>的这篇技巧)。</p><p id="c61e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想感受全套道具和新组件的强大，React Native的回购中有一个更广泛的<code class="eh jq jr js jt b"><a class="ae ju" href="https://github.com/facebook/react-native/blob/master/Examples/UIExplorer/js/FlatListExample.js" rel="noopener ugc nofollow" target="_blank">FlatListExample</a></code>。我也有自己的<a class="ae ju" href="https://github.com/cooperka/react-native-immutable-list-view/tree/master/example" rel="noopener ugc nofollow" target="_blank">示例应用</a>，除了复制文件和运行<code class="eh jq jr js jt b">npm install</code>之外，没有额外的步骤就可以开箱即用。如有任何问题，请随意发表<a class="ae ju" href="https://github.com/cooperka/react-native-immutable-list-view/issues" rel="noopener ugc nofollow" target="_blank">问题</a>——我很乐意帮忙。</p><p id="9168" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后说明:<code class="eh jq jr js jt b">FlatList</code>有意将<a class="ae ju" href="https://github.com/facebook/react-native/commit/a3457486e39dc752799b1103ebe606224a8e8d32#commitcomment-20777251" rel="noopener ugc nofollow" target="_blank">永远不支持</a>像<code class="eh jq jr js jt b"><a class="ae ju" href="https://facebook.github.io/react-native/docs/listview.html#rendersectionheader" rel="noopener ugc nofollow" target="_blank">ListView</a></code> <a class="ae ju" href="https://facebook.github.io/react-native/docs/listview.html#rendersectionheader" rel="noopener ugc nofollow" target="_blank">一样拥有</a>；为此，有一个单独的组件叫做<code class="eh jq jr js jt b">SectionList</code>，或者你可以直接使用较低级别的<code class="eh jq jr js jt b">VirtualizedList</code>。</p><p id="9c6d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您觉得这很有用，请点击<strong class="it hv">来帮助您👏想按多少次</strong>就按多少次，这样其他人也能找到。谢谢大家！</p><p id="8b54" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请关注更多更新，我会保持这篇文章的更新。</p></div></div>    
</body>
</html>