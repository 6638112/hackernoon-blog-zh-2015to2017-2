<html>
<head>
<title>Setting up CI/CD on Gitlab (step by step guide) — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Gitlab上设置CI/CD(分步指南)—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/setting-up-ci-cd-on-gitlab-step-by-step-guide-part-1-826385728223?source=collection_archive---------1-----------------------#2017-07-08">https://medium.com/hackernoon/setting-up-ci-cd-on-gitlab-step-by-step-guide-part-1-826385728223?source=collection_archive---------1-----------------------#2017-07-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/1050dcd24b4b51deec5f1d8d86857681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ii6jYVdMWhESJA3BsdS1g.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Source: <a class="ae jg" href="http://jeroenhildering.com/2016/04/07/continuous-integration-for-net-applications-using-jenkins/" rel="noopener ugc nofollow" target="_blank">http://jeroenhildering.com/2016/04/07/continuous-integration-for-net-applications-using-jenkins/</a></figcaption></figure><p id="2869" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们大多数人都同意C <em class="kf">持续集成(CI) </em>、C <em class="kf">持续交付(CD) </em>、云基础设施、测试自动化和配置管理构成了开发运维的基础。根据项目的规模，CI/CD可能很难建立和实施。然而，这绝对是必要的，原因如下:</p><p id="fe6a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在一个敏捷的环境中，需求会随着时间的推移而快速发展，为了发布没有bug的特性，拥有一套自动化测试和持续集成代码是最重要的。拥有一个合适的CI/CD环境为您提供了<em class="kf">信心</em>来试验、实现新特性并快速推出更新。</p><p id="4b76" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">事实上，有了适当的CI，可以更早地发现错误，开发人员可以更快地审查代码，因为对存储库中代码的更改通常一天要合并几次，这样就可以不断地进行验证。</p><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div class="fe ff kg"><img src="../Images/9e8337518891b30ed7e9cc8642a79d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*G2HxIMS-0l5nSYAa8dp9xw.jpeg"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">You sure you want to do without CI/CD?</figcaption></figure><p id="d7eb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过阅读本文，您将具备能够在不到一小时的时间内<strong class="jj hv">在<a class="ae jg" href="https://gitlab.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv"> Gitlab </strong> </a>上设置CI/CD环境</strong>并将<strong class="jj hv"> NodeJS </strong>项目部署到<a class="ae jg" href="http://heroku.com" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv"> Heroku </strong> </a>的基础知识。当然，我们不会深入讨论如何编写单元测试，这可以在另一篇文章中进一步探讨。</p><h1 id="bb30" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated">步骤1:设置Gitlab帐户</h1><p id="d9aa" class="pw-post-body-paragraph jh ji hu jj b jk lj jm jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke hn dt translated">注册一个帐户并创建一个新项目。命名您的项目，并选择它是私有的还是公共的。</p><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lo"><img src="../Images/0e57bcc00ed7c2b19ad90d4f6accb547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TxAjv3s4GzvsL2xOi4wvrw.png"/></div></div></figure><p id="4f57" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当您第一次创建项目时，您需要向其中添加ssh密钥。</p><h1 id="85bd" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated">步骤2:添加SSH密钥</h1><p id="6a0f" class="pw-post-body-paragraph jh ji hu jj b jk lj jm jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke hn dt translated">要创建一对SSH密钥，请执行以下步骤:</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="2947" class="lu km hu lq b fv lv lw l lx ly">ssh-keygen -t rsa</span></pre><p id="17e5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后输入保存SSH密钥的文件。</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="480c" class="lu km hu lq b fv lv lw l lx ly">Enter file in which to save the key (/home/demo/.ssh/id_rsa):</span></pre><p id="c910" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最后，您可以选择是否有密码短语。完成后，复制公钥并粘贴到gitlab中。</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="712f" class="lu km hu lq b fv lv lw l lx ly">cat ~/.ssh/id_rsa_gitlab.pub | pbcopy</span></pre><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lz"><img src="../Images/f989a32a923b05ae8898be065daaf4cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1MBpvT7UVO8uYeo0bEASUA.png"/></div></div></figure><p id="f7b7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">点按“添加密钥”后，使用以下命令将密钥储存在您的钥匙串中:</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="2bfc" class="lu km hu lq b fv lv lw l lx ly">ssh-add  ~/.ssh/id_rsa_gitlab</span></pre><p id="6943" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">将SSH配置为总是使用钥匙串。如果您在中还没有一个<code class="eh ma mb mc lq b">config</code>文件。<code class="eh ma mb mc lq b">ssh</code>，创建一个<code class="eh ma mb mc lq b">~/.ssh/config</code>文件。换句话说，在您主目录的<code class="eh ma mb mc lq b">.ssh</code>目录中，创建一个名为<code class="eh ma mb mc lq b">config</code>的文件。</p><p id="02de" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在那个<code class="eh ma mb mc lq b">.ssh/config</code>文件中，添加以下几行:</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="2fa8" class="lu km hu lq b fv lv lw l lx ly">Host <!-- -->gitlab.com<br/>  UseKeychain yes<br/>  AddKeysToAgent yes<br/>  IdentityFile ~/.ssh/id_rsa_gitlab</span></pre><blockquote class="md me mf"><p id="df88" class="jh ji kf jj b jk jl jm jn jo jp jq jr mg jt ju jv mh jx jy jz mi kb kc kd ke hn dt translated">来源:<a class="ae jg" href="https://apple.stackexchange.com/questions/48502/how-can-i-permanently-add-my-ssh-private-key-to-keychain-so-it-is-automatically" rel="noopener ugc nofollow" target="_blank">https://apple . stack exchange . com/questions/48502/how-can-I-permanently-add-my-ssh-private-key-to-keychain-so-it-is-automatically</a></p></blockquote><h1 id="710f" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated">步骤3:设置试运行和生产环境</h1><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div class="fe ff mj"><img src="../Images/3162b03ea6be20c288fcf38583ac5d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*miqzZwrQ9zhHSEX2K9SCKw.png"/></div></figure><p id="0b51" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在Heroku中，创建一个管道来保存临时和生产应用程序。</p><p id="6531" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在管道内部，创建暂存和生产应用程序。注意，如果分期app的名称后面能追加'分期'两个字，以明确区分两个app就好了。</p><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mk"><img src="../Images/9b351be58e9c98a8938d7d861c7672d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBtOokLTpjhZHybLAfMTww.png"/></div></div></figure><p id="a14f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">设置应用程序后，它看起来会像这样。</p><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ml"><img src="../Images/86818445892f6094a17502d95a561919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cmkNkhMSJ-wkrKfbpy7jMg.png"/></div></div></figure><h1 id="777d" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated">步骤4:设置您的测试</h1><p id="3f72" class="pw-post-body-paragraph jh ji hu jj b jk lj jm jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke hn dt translated">在app的根目录下，创建一个名为<code class="eh ma mb mc lq b">tests</code>的文件夹，在文件夹中添加一个测试文件。我呢，既用<a class="ae jg" href="http://chaijs.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv">柴</strong> </a>(断言库)，又用<a class="ae jg" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv">摩卡</strong> </a> (JS框架)。如果您愿意，可以使用其他断言库，如Jasmine等。</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="8080" class="lu km hu lq b fv lv lw l lx ly">npm install mocha chai --save-dev</span></pre><p id="968f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">向package.json添加一个脚本，这样下次就可以简单地运行<code class="eh ma mb mc lq b">npm test</code>了。</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="5159" class="lu km hu lq b fv lv lw l lx ly">"test": ./node_modules/.bin/_mocha --recursive ./tests/*.test.js</span></pre><p id="2683" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在<code class="eh ma mb mc lq b">tests</code>中添加一个名为<code class="eh ma mb mc lq b">me.test.js</code>的文件</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="fb26" class="lu km hu lq b fv lv lw l lx ly">describe(‘me’, () =&gt; { <br/>  it(‘is awesome’, () =&gt; {<br/>   expect(...).to.be....</span><span id="17be" class="lu km hu lq b fv mm lw l lx ly">  }) <br/>});</span></pre><p id="4dba" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">正如我前面提到的，我们不会深入讨论如何编写测试。</p><h1 id="f8e6" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated">步骤5:设置您的CI环境(就像最后！)</h1><p id="d27d" class="pw-post-body-paragraph jh ji hu jj b jk lj jm jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke hn dt translated">要在Gitlab上设置CI环境，在您的存储库的根目录中添加一个<code class="eh ma mb mc lq b">.gitlab-ci.yml</code>。</p><p id="97e1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">该文件包含如何构建项目的定义，Gitlab Runner(您将在稍后设置)将在您的存储库中搜索该文件，并在Runner的环境中执行它。</p><p id="5516" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这就是我如何设置我的<code class="eh ma mb mc lq b">.gitlab-ci.yml</code>。您可能希望根据您的项目进行调整。但是当然，在你把你的项目推送到Gitlab之前，最好先通过<a class="ae jg" href="http://www.yamllint.com/" rel="noopener ugc nofollow" target="_blank"> YAML验证器</a>来运行它，以确保它是有效的，否则，它会导致错误。我将解释我的YAML文件的各个组成部分。</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="803a" class="lu km hu lq b fv lv lw l lx ly">image: node:6.10.3<br/></span><span id="5efb" class="lu km hu lq b fv mm lw l lx ly">stages:</span><span id="45f7" class="lu km hu lq b fv mm lw l lx ly">  - ver</span><span id="36f2" class="lu km hu lq b fv mm lw l lx ly">  - init</span><span id="4e40" class="lu km hu lq b fv mm lw l lx ly">  - tests</span><span id="45fb" class="lu km hu lq b fv mm lw l lx ly">  - deploy<br/></span><span id="be6a" class="lu km hu lq b fv mm lw l lx ly">ver:</span><span id="f84a" class="lu km hu lq b fv mm lw l lx ly">  stage: ver</span><span id="3d0b" class="lu km hu lq b fv mm lw l lx ly">  script:</span><span id="15df" class="lu km hu lq b fv mm lw l lx ly">    - node --version</span><span id="3064" class="lu km hu lq b fv mm lw l lx ly">    - whoami</span><span id="99df" class="lu km hu lq b fv mm lw l lx ly">init:</span><span id="7106" class="lu km hu lq b fv mm lw l lx ly">  stage: init</span><span id="fe59" class="lu km hu lq b fv mm lw l lx ly">  script:</span><span id="f5f9" class="lu km hu lq b fv mm lw l lx ly">    - npm cache clean</span><span id="3f03" class="lu km hu lq b fv mm lw l lx ly">    - rm -rf node-modules</span><span id="6f39" class="lu km hu lq b fv mm lw l lx ly">    - npm install</span><span id="9a22" class="lu km hu lq b fv mm lw l lx ly">run_tests:</span><span id="ec75" class="lu km hu lq b fv mm lw l lx ly">  stage: tests</span><span id="06eb" class="lu km hu lq b fv mm lw l lx ly">  script:</span><span id="37f6" class="lu km hu lq b fv mm lw l lx ly">    - npm test<br/></span><span id="cb64" class="lu km hu lq b fv mm lw l lx ly">deploy_staging:</span><span id="83a5" class="lu km hu lq b fv mm lw l lx ly">  stage: deploy</span><span id="fa84" class="lu km hu lq b fv mm lw l lx ly">  script:</span><span id="3d24" class="lu km hu lq b fv mm lw l lx ly">    - git remote add heroku https://heroku:$HEROKU_API_KEY@git.heroku.com/text-giving-staging.git</span><span id="f24c" class="lu km hu lq b fv mm lw l lx ly">    - git push heroku master</span><span id="2c90" class="lu km hu lq b fv mm lw l lx ly">    - echo "Deployed to staging server"</span><span id="462d" class="lu km hu lq b fv mm lw l lx ly">  environment:</span><span id="9b33" class="lu km hu lq b fv mm lw l lx ly">  name: staging</span><span id="9d31" class="lu km hu lq b fv mm lw l lx ly">  url: https://text-giving-staging.herokuapp.com/</span><span id="d251" class="lu km hu lq b fv mm lw l lx ly">  only:</span><span id="89b4" class="lu km hu lq b fv mm lw l lx ly">    - master<br/></span><span id="99ca" class="lu km hu lq b fv mm lw l lx ly">deploy_production:</span><span id="44ee" class="lu km hu lq b fv mm lw l lx ly">  stage: deploy</span><span id="f24e" class="lu km hu lq b fv mm lw l lx ly">  script:</span><span id="4158" class="lu km hu lq b fv mm lw l lx ly">    - git remote add heroku https://heroku:$HEROKU_API_KEY@git.heroku.com/text-giving.git</span><span id="7999" class="lu km hu lq b fv mm lw l lx ly">    - git push heroku master</span><span id="7bcf" class="lu km hu lq b fv mm lw l lx ly">    - echo "Deployed to production server"</span><span id="2b00" class="lu km hu lq b fv mm lw l lx ly">  environment:</span><span id="ac21" class="lu km hu lq b fv mm lw l lx ly">  name: production</span><span id="9162" class="lu km hu lq b fv mm lw l lx ly">  url: https://text-giving.herokuapp.com/</span><span id="0baa" class="lu km hu lq b fv mm lw l lx ly">  when: manual</span><span id="f40b" class="lu km hu lq b fv mm lw l lx ly">  only:</span><span id="d61d" class="lu km hu lq b fv mm lw l lx ly">    - master</span></pre><p id="4ada" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> image </strong>:允许您指定在构建期间想要使用的NodeJS的某个版本</p><p id="aa44" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">阶段</strong>:定义构建阶段。在这种情况下，我们有<code class="eh ma mb mc lq b">ver</code>、<code class="eh ma mb mc lq b">init</code>、<code class="eh ma mb mc lq b">tests</code>和<code class="eh ma mb mc lq b">deploy</code>，但是您可以将阶段的名称更改为您认为适合您项目的名称。</p><p id="67cd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> stage ver: </strong> <code class="eh ma mb mc lq b">node —-version</code>允许我们检查正在使用的NodeJS的版本，并且<code class="eh ma mb mc lq b">whoami</code>显示用户是否有权限，这使得在出现问题时更容易调试。</p><p id="7023" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> stage init: </strong>我们清理npm缓存，<strong class="jj hv"> </strong>移除节点模块，安装它，然后运行我们之前编写的测试。</p><p id="84d9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">阶段测试:</strong>我们想要运行测试以确保所有的测试都通过。</p><p id="ae85" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> stage deploy </strong>:我们将使用Heroku API密钥向存储库添加一个远程。我们可以从Heroku的<strong class="jj hv">账户设置</strong>页面中检索Heroku API密钥。</p><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mn"><img src="../Images/9c2413a3cc4366925efc90405da44014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hbq27riDL-sNhkgxLtLM5Q.png"/></div></div></figure><p id="8ee7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后，进入Gitlab设置&gt; CI/CD管道&gt;秘密变量，添加HEROKU_API_KEY作为秘密变量。</p><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mo"><img src="../Images/37cd1f0d7a1270355f2bcde4074469f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIbQft5PEUzmXt7hTb7oWA.png"/></div></div></figure><figure class="kh ki kj kk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mp"><img src="../Images/e960b5e0564642ac2ac5d079d8ac158c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*62HNqyBtSGBormJGBbearQ.png"/></div></div></figure><p id="0c9b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后，我们可以在我们的YAML文件中将Heroku API键称为<code class="eh ma mb mc lq b">$HEROKU_API_KEY</code>。</p><p id="64fd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">请注意，我们有两个部署阶段—一个用于<strong class="jj hv">准备</strong>，一个用于<strong class="jj hv">生产</strong>。我们还通过在YAML文件中添加<code class="eh ma mb mc lq b">when: manual</code>将它设置为手动推入生产。因此，如果一切顺利，它会将<code class="eh ma mb mc lq b">master</code>分支自动推送到<code class="eh ma mb mc lq b">staging</code>，如果一切顺利，我们需要手动推送到<code class="eh ma mb mc lq b">production</code>。</p><h1 id="6736" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated">步骤6:安装Gitlab运行程序</h1><p id="ae8e" class="pw-post-body-paragraph jh ji hu jj b jk lj jm jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke hn dt translated">如前所述，在GitLab中，跑步者执行您在<code class="eh ma mb mc lq b">.gitlab-ci.yml</code>中定义的任务。因为我用的是MacOS，所以我会按照这里的说明:<a class="ae jg" href="https://docs.gitlab.com/runner/install/osx.html" rel="noopener ugc nofollow" target="_blank">https://docs.gitlab.com/runner/install/osx.html</a>。这应该很容易理解。</p><h1 id="cfe1" class="kl km hu bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li dt translated"><strong class="ak">第七步:注册Gitlab Runner </strong></h1><p id="a8b7" class="pw-post-body-paragraph jh ji hu jj b jk lj jm jn jo lk jq jr js ll ju jv jw lm jy jz ka ln kc kd ke hn dt translated">接下来，按照这里的说明注册git lab Runner:<a class="ae jg" href="https://docs.gitlab.com/runner/register/index.html" rel="noopener ugc nofollow" target="_blank">https://docs.gitlab.com/runner/register/index.html</a>。同样，它应该很容易理解。对于runner executor，我选择在最容易配置的<strong class="jj hv"> shell </strong>上运行它(如果您愿意，可以选择其他选项)。注册后，使用以下命令安装并启动服务:</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="409c" class="lu km hu lq b fv lv lw l lx ly">gitlab-runner install<br/>gitlab-runner start</span></pre><p id="054a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可以使用以下命令检查运行程序是否正在运行:</p><pre class="kh ki kj kk fq lp lq lr ls aw lt dt"><span id="b9f2" class="lu km hu lq b fv lv lw l lx ly">gitlab-runner status<br/>gitlab-runner: Service is running!</span></pre><p id="990f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在这还不算太糟，不是吗？</p><p id="700f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在本文的第2部分(请继续关注)中，我将向您展示如何在Telegram上为您的CI/CD管道设置一个通知程序，然后将存储库推送到Gitlab，并观察CI/CD管道在您配置的不同阶段中运行，最终手动将其推向生产。</p><p id="c6c0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你对我有任何反馈，请随时通过<strong class="jj hv">hello@imstacy.com</strong>联系我，或者对本文发表评论。</p><p id="fcce" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">或者，如果这篇文章对你有所帮助，请拿出你的爱，点击小💚请在<a class="ae jg" href="https://github.com/stacygohyunsi/" rel="noopener ugc nofollow" target="_blank">https://github.com/stacygohyunsi</a>上关注我，了解我接下来要做的事情！</p><figure class="kh ki kj kk fq iv"><div class="bz el l di"><div class="mq mr l"/></div></figure></div></div>    
</body>
</html>