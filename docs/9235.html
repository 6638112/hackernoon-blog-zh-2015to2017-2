<html>
<head>
<title>Learn CI: Automated Test and Publish in 10 min</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习CI:10分钟内自动测试和发布</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/learn-ci-automated-test-and-publish-in-10-min-3096717dc81e?source=collection_archive---------14-----------------------#2017-12-31">https://medium.com/hackernoon/learn-ci-automated-test-and-publish-in-10-min-3096717dc81e?source=collection_archive---------14-----------------------#2017-12-31</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/648a6b557a8bfbc1f35628cdad5661a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMph3SZGT__5z5jAPMkHvw.png"/></div></div></figure><h2 id="1f50" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">这里有一个模板，可以用来自动测试和发布JS客户机或服务器代码</h2><p id="6ecf" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku hn dt translated">外面有很多依赖。显然，这个世界需要更多的自动化测试。但是，我们需要快速启动并运行。</p><p id="d011" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">目标:<br/>必须是免费的，因为在金钱<br/>必须有微小的<a class="ae lb" href="https://hackernoon.com/tagged/learning" rel="noopener ugc nofollow" target="_blank">学习</a>曲线，几个神奇的单词学习！<br/>必须是UI免费。使用headless Chrome测试客户端代码<br/>使用Travis CI进行自动化测试，使用github中的“通过/失败”徽章<br/>在每次提交时运行测试<br/>轻松发布到NPM，并使用易于记忆的URL在网页中包含脚本</p><p id="5221" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated"><em class="kv">因此，每次提交github repo时</em>:</p><ol class=""><li id="aeed" class="lc ld hu kc b kd kw kh kx jn le jr lf jv lg ku lh li lj lk dt translated">Travis CI将启动其测试实例</li><li id="c914" class="lc ld hu kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk dt translated">安装最新的节点版本，和Chrome浏览器</li><li id="a7cc" class="lc ld hu kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk dt translated">启动Chrome进行无头测试<br/>(仅客户端JS项目需要)</li><li id="c957" class="lc ld hu kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk dt translated">运行两个示例测试脚本。一个用于测试服务器应用程序，一个用于浏览器JS <br/>(根据您的应用程序是节点应用程序还是客户端脚本，可以删除其中一个)</li><li id="d85f" class="lc ld hu kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk dt translated">显示测试结果</li><li id="564d" class="lc ld hu kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk dt translated">如果成功，发布到NPM</li><li id="024e" class="lc ld hu kc b kd ll kh lm jn ln jr lo jv lp ku lh li lj lk dt translated">展示NPM和<a class="ae lb" href="https://hackernoon.com/tagged/github" rel="noopener ugc nofollow" target="_blank"> github </a>项目的通过/失败徽章。</li></ol><p id="d970" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">根据项目的需要，您可以根据需要对其进行添加/删除。</p><p id="5a79" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">所有的文件都在这里:</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/f981b731022d145725248861bdfaa656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*N0-5i7eX1WfcvRI2qiU3Rw.jpeg"/></div></figure><p id="76e3" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">对于将主持测试的Travis CI，只需要一个<strong class="kc hv"> .travis.yml </strong>文件。</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lv"><img src="../Images/5a6e0c32f09cae610221e571884c99d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bHH_Kjl1oJGC07LvGOnIog.jpeg"/></div></div></figure><p id="2fc9" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">如果项目是Node app而不是client JS，就不需要Chrome部件。</p><p id="fd18" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">它还将向国家预防机制发布。对于客户端脚本，我们可以使用一个简短的，易于记忆的unpkg.com链接</p><p id="6484" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">这里不需要学习复杂的测试框架。我们只需编写测试脚本，失败时抛出错误。</p><p id="a44a" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">测试框架是<em class="kv">如下</em>，任何原生错误都构成失败的测试。</p><p id="5ce7" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">对于节点应用程序，<strong class="kc hv"> test-server.js </strong></p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/3a24576db79bb8565aec08682f3b18da.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*AVQxUXKswWgK6Ef1aosqwA.jpeg"/></div></figure><p id="63aa" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated"><strong class="kc hv"> main.js </strong>是app中的主文件。正在测试什么。如果我们调用了test_fail，测试就会失败，Travis也会这么告诉我们。</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/b5497f304f211a6631fc396d0bb5828d.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*1JNYaqvNAYBdEtVTQ5kK8Q.jpeg"/></div></figure><p id="8f38" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">用于客户端脚本的<strong class="kc hv"> test-browser.js </strong>。既然我们真的想把事情自动化，就不能有UI。没有人会在附近点击东西。所以，无头chrome是用来运行测试的。</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/384b2c3b5b637335126fa04d955d3f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*sRz8J_5nrPROoHQSayvc9g.jpeg"/></div></figure><p id="1361" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">testchrome ，只是chrome远程接口上的一个简单包装器，用于无头测试。</p><p id="e689" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">testchrome恰好使用了简化的API，就<br/>。评估(浏览器中的JS)<br/>。get(来自URL的JSON)</p><p id="a57c" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">或者，您可以使用其他可用的无头Chrome测试模块，如puppeteer。</p><p id="d37c" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">在机器上进行本地设置可能会令人不愉快。Travis CI真的在这里大放异彩！</p><p id="e6b3" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">前往travisci.org(进行公开回购)，并按照说明设置您的回购。将您的Travis CI帐户连接到github，并指定您的repo进行测试。</p><p id="4e18" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">在Travis(您的NPM令牌)上需要进行一项配置，让Travis在设置中发布应用程序:</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lz"><img src="../Images/dd2ef45128459ebb61157f10dee9e097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXNKb-4Th6efipZ7qzz0ew.png"/></div></div></figure><p id="8d50" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">然后只需提交回购，或使用控制台，开始测试。</p><p id="0da2" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">在Travis控制台中监控您的测试:</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ma"><img src="../Images/e5f166e9113be997d6c1bba2bcd7285a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbB-z_-97TJ6HfXU-TsJow.png"/></div></div></figure><p id="c076" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">并查看结果</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mb"><img src="../Images/90318c8e47c8298a5c61bfee3b7dd671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gSKvcBrNKaOutqGFcGj3FQ.jpeg"/></div></div></figure><p id="9fbd" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">最后一件事，徽章。在repo的README.md中:</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/c2bf8dea9e0237a692ca2c5f7d0cc9d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*1WOKUE-gfCWDTW69oZRP0Q.png"/></div></figure><p id="e0c0" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">它总是显示我们在NPM和Github通过/失败的徽章。</p><figure class="lr ls lt lu fq iv fe ff paragraph-image"><div class="fe ff md"><img src="../Images/47e4f7f80dc2b7adbf50e3a0a8d8919d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*CptzB0xXlebdCT1fJmSp9g.png"/></div></figure><p id="616b" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">最后，我们需要一个容易记住的URL(用于客户端脚本)。使用unpkg.com，不需要额外的配置，因为它将从NPM拉最新的。</p><pre class="lr ls lt lu fq me mf mg mh aw mi dt"><span id="5dfe" class="jc jd hu mf b fv mj mk l ml mm">&lt;script src=//unpkg.com/reponame &gt;&lt;/script&gt;</span></pre><p id="bd69" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">当然，对于服务器应用程序，简单地说</p><pre class="lr ls lt lu fq me mf mg mh aw mi dt"><span id="6bd1" class="jc jd hu mf b fv mj mk l ml mm">npm install reponame</span></pre><p id="959b" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">这就是我们提供自动化测试和发布的框架。请评论任何想法或建议。示例回购发生在<a class="ae lb" href="https://github.com/digplan/learn-ci" rel="noopener ugc nofollow" target="_blank">https://github.com/digplan/learn-ci</a></p><p id="77f8" class="pw-post-body-paragraph ka kb hu kc b kd kw kf kg kh kx kj kk jn ky km kn jr kz kp kq jv la ks kt ku hn dt translated">测试愉快！</p><figure class="lr ls lt lu fq iv"><div class="bz el l di"><div class="mn mo l"/></div></figure></div></div>    
</body>
</html>