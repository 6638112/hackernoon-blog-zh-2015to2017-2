<html>
<head>
<title>5 Small Steps to a Better Web API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提高Web API的5个小步骤</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/5-small-steps-to-a-better-web-api-6fa9698178a6?source=collection_archive---------1-----------------------#2017-09-14">https://medium.com/hackernoon/5-small-steps-to-a-better-web-api-6fa9698178a6?source=collection_archive---------1-----------------------#2017-09-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/91674955e2db4a8c7a82e7c5dd55df18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuX6UImLp3chvOyemoOCQw.jpeg"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Random picture of a Mac, because that’s how work gets done</figcaption></figure><div class=""/><p id="c444" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">作为一名网络开发人员，我最喜欢做的事情之一就是设计和构建单页应用程序。这意味着我相当定期地与Web<a class="ae ke" href="https://hackernoon.com/tagged/apis" rel="noopener ugc nofollow" target="_blank">API</a>密切合作。我甚至自己设计了Web APIs，并取得了不同程度的成功。</p><p id="62f0" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">以“API优先”<a class="ae ke" href="https://hackernoon.com/tagged/model" rel="noopener ugc nofollow" target="_blank">模式</a>构建你的应用程序有很多优势，而且它肯定会变得越来越流行，所以在你开始下一个大的构建之前，我想分享一些你可以做的小事情，它们将极大地改进你的API的设计。</p><p id="36e3" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在我们开始之前，我想提一下这些事情<strong class="ji ik">仍然很重要，即使你的API是私有的。</strong>随着应用程序的开发，私有API会逐渐公开，除此之外，一个好的API会加速前端客户端的开发，无论是spa、移动应用还是脚本。</p><h1 id="7cd4" class="kf kg ij bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">使用正确的状态代码！</h1><p id="c604" class="pw-post-body-paragraph jg jh ij ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">HTTP标准包括一个非常全面的状态代码数组，供服务器作为主体的元数据返回。这些代码可以为API的消费者提供一种很好的方式来以编程方式弄清楚发生了什么，而不必求助于解析脆弱的错误消息。</p><p id="1303" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">状态代码分为以下几类:</p><ul class=""><li id="24c0" class="li lj ij ji b jj jk jn jo jr lk jv ll jz lm kd ln lo lp lq dt translated">1xx信息(主要用于服务器)</li><li id="be14" class="li lj ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">2xx成功！</li><li id="0230" class="li lj ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">3xx重定向</li><li id="c276" class="li lj ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">4xx客户端错误(呼叫者可以修复的问题)</li><li id="63a2" class="li lj ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">5xx服务器错误(呼叫者无法解决的问题)</li></ul><p id="8f62" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我相信我们都熟悉404未找到，但409冲突呢？返回这些更具体的代码有助于客户端以更合适的方式处理错误(或不同类型的成功)。</p><p id="d816" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">哦看在上帝的份上，不要为了<strong class="ji ik">每件事</strong>都回200成功，靠身体里的一个信息来解释发生了什么。很讨厌。这就引出了我的下一个观点…</p><h1 id="8369" class="kf kg ij bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">不要在正文中包含元数据</h1><p id="339b" class="pw-post-body-paragraph jg jh ij ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">当您的API返回对请求的响应时，它将在响应正文中发送大部分数据。这就是身体的目的。但是如果客户机请求数据的分页视图呢？您需要通知客户端各种元数据，比如集合中的项目总数。那通向哪里？</p><p id="c662" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这个问题的一个常见解决方案是返回用某种包装器包装的数据，如下所示:</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="5d86" class="mf kg ij mb b fv mg mh l mi mj">{<br/>  total: 100,<br/>  page: 2,<br/>  results: [ ... ]<br/>}</span></pre><p id="14b4" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我不喜欢这样，因为它模糊了资源和接收资源的方法之间的界限。那么元数据应该放在哪里呢？在标题中。</p><p id="284a" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">HTTP标准允许将自定义头与响应一起发送。最初，人们建议自定义头以X为前缀，如X-Forwarded-By。由于很难将以前的非标准标题集成到标准中，该建议被撤回。X前缀的另一种替代方法，最初是为了避免冲突，是用您的应用程序名命名您的头。例如:</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="1c9d" class="mf kg ij mb b fv mg mh l mi mj">BobsBurgers-ItemCount: 200</span></pre><h1 id="5404" class="kf kg ij bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">支持多个快速请求，而不是单一请求</h1><p id="bae7" class="pw-post-body-paragraph jg jh ij ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">当我们从API而不是传统的回发模型中使用数据时，我们可以在数据加载时完全控制UI，因此我们能够以一种渐进的方式向用户显示数据，并且在数据可用时立即显示。因此，你应该倾向于设计多个快速返回的端点，而不是每页一个端点。总的加载时间可能会更长，但如果我的用户在我给她看电影大纲的几秒钟内看不到复杂的电影评分计算，也没关系。它还允许客户端根据用户的操作来区分请求的优先级。如果我的用户没有向下滚动那么远，我可能根本不需要加载那个评级。</p><h1 id="533f" class="kf kg ij bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">生成文档</h1><p id="fa8d" class="pw-post-body-paragraph jg jh ij ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">大多数web框架都有轻松生成详细API文档的最佳实践。作为构建过程的一部分，使用它并保持更新。它不需要很多手写的描述，但是它需要一个参数列表和一个请求和响应的例子。像这样简单的事情可以在API开发和客户端开发之间来回切换，节省几个小时的开发时间。依靠文档中规定的合同，而不是依靠一千条松散的消息。</p><h1 id="2b11" class="kf kg ij bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">保持一致</h1><p id="b750" class="pw-post-body-paragraph jg jh ij ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">从理论上讲，我应该能够准确地猜出我想要访问的资源的URL或者我想要执行的操作，只要给出几个例子。只要保持一致性和可预测性，采用什么样的URL方案并不重要(例如，REST标准没有做出任何规定)。最小惊讶原则适用于此。</p><p id="b1e1" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果你喜欢这篇文章，请记得给它一些掌声，以确保更多的人阅读它！</p><p id="c59b" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">Steven Poulton是一名居住在英国曼彻斯特的网站开发人员和技术架构师。在业余时间，他喜欢制作独立音乐，制作独立游戏，和他的独立猫玩耍。</p><figure class="lw lx ly lz fq hw"><div class="bz el l di"><div class="ml mm l"/></div></figure></div></div>    
</body>
</html>