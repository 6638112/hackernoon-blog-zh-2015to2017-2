<html>
<head>
<title>Amazon S3 and uploading into the cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊S3和上传到云中</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/amazon-s3-and-uploading-into-the-cloud-76a030be6686?source=collection_archive---------2-----------------------#2015-03-15">https://medium.com/hackernoon/amazon-s3-and-uploading-into-the-cloud-76a030be6686?source=collection_archive---------2-----------------------#2015-03-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="97c5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们的一个应用程序中，我们为用户开发了上传他们想要注册的文件的可能性。在第一阶段，我们将它们存储在我们的文件系统中，但迟早，越早越好，因为用户上传越来越多的文件，我们需要将它们存储在一些专门的文件系统中。考虑到这一点，我们得出结论，一个好办法是将文件上传到S3的亚马逊网站。这是这篇博客文章将关注的新功能，但首先让我们穿上羊皮，参与向您销售亚马逊S3。</p><p id="7f73" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">为什么是S3？</strong></p><p id="5db7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">亚马逊S3的设计让开发人员不必担心他们将如何存储他们的数据，数据是否安全，或者他们是否有足够的存储空间。有了这个S3，开发者就不用为设置他们自己的对象存储解决方案花费成本，也不用为维护T5和扩展他们的服务器花费T4的成本。现在，开发人员可以将时间集中在对他们拥有的数据进行创新上，而不是考虑如何存储这些数据。</p><p id="a043" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">亚马逊S3旨在满足这些设计要求:</p><ul class=""><li id="947e" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">安全的</li></ul><p id="b4a8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它让客户能够完全控制谁可以访问他们的数据。客户也有可能在传输中或静止时保护他的数据。</p><ul class=""><li id="ff77" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">可靠的</li></ul><p id="c743" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以存储具有99.99999999%持久性和99.99%可用性的数据。必须容忍系统中的所有故障，或者在没有任何停机时间的情况下进行修复。</p><ul class=""><li id="3713" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">可攀登的</li></ul><p id="cc8e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">亚马逊S3可以以不同的形式扩展。您可以根据存储、请求率和用户进行扩展。</p><ul class=""><li id="c829" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">快的</li></ul><p id="b651" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它必须足够快，使得服务器端的延迟与互联网延迟相比微不足道。</p><p id="fa4d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最重要的设计问题之一是，亚马逊S3必须支持亚马逊内部应用程序和任何类型的外部开发者应用程序的所有功能请求。有了这个目标，这意味着它必须足够快，足够可靠，足以运行亚马逊的网站，同时足够灵活，任何开发人员都可以使用它进行任何所需的数据存储。</p><p id="cd3e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">部分规格</strong></p><p id="6980" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在亚马逊S3，你可以存储从1字节到5兆字节的数据，你可以存储无限数量的对象。在存储对象的地方称为存储桶，从这个存储桶中，您只能通过开发人员分配的唯一键来检索对象。一个存储桶可以存储在全球多个地区，因此您可以选择最适合您的地区，以优化延迟并最大限度地降低成本。</p><p id="8d77" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Amazon提供认证机制，确保您的数据不会受到未经授权的访问，您可以将某个对象设为私有或公共，甚至授予或撤销特定用户对该对象的权限。</p><p id="7028" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以选择在一个安全的渠道从亚马逊上传或下载，也可以加密你的数据作为额外的保护。对于开发者来说，亚马逊S3使用REST和SOAP标准，因此它可以与任何互联网开发工具包一起工作。</p><p id="481b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，现在我们谈了一点S3的内部，让我们看一些小猫试图抓住一个红点…啊哈哈哈哈该死的猫。Ups很抱歉在那分心了，我们说到哪了？哦，是的…所以现在我们要保护你的数据。</p><p id="7c75" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">保护您的数据</strong></p><p id="8c1b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在亚马逊S3，只有桶和对象所有者可以访问他们创建的数据，它支持多种访问控制机制和加密，以实现安全传输和磁盘上的安全存储。您有几种机制可以控制谁可以访问您的数据，以及他们可以如何、何时甚至在哪里访问数据。在亚马逊S3，你有四种不同的访问控制机制:</p><ul class=""><li id="fe44" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">身份和访问管理(IAM)</li></ul><p id="4631" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通过这种机制，拥有多名员工的组织能够在一个AWS帐户下创建和管理多个用户。有了这种机制，您可以授予用户对您的亚马逊S3桶或对象的细粒度控制。</p><ul class=""><li id="d502" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">访问控制列表(ACL)</li></ul><p id="262b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这种机制用于授予对单个对象的某些权限。</p><ul class=""><li id="6314" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">木桶策略</li></ul><p id="1519" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">存储桶策略用于添加或拒绝对某个存储桶的权限，将这些权限应用于该存储桶中的所有或某些对象。</p><ul class=""><li id="bb92" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">查询字符串验证</li></ul><p id="8a89" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">拥有这种机制将使您共享的URL只在预定义的过期时间内有效。</p><p id="3078" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在您保护了对您数据的访问后，您可能想要保护您和亚马逊S3之间的通信，为此，您可以使用HTTPS协议通过SSL加密的端点发出上传/下载文件的请求。作为额外的安全措施，您可以使用亚马逊S3管理数据的加密和解密，如果您喜欢亚马逊S3管理您的加密密钥，您可以使用亚马逊S3服务器端加密(SSE)。相反，如果你喜欢管理自己的加密密钥，你可以使用亚马逊S3服务器端加密和客户提供的密钥(SSE-C)。在这两个选项中，亚马逊S3将在写入时加密您的数据，并在检索时解密您的数据。</p><p id="c9ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这样我们就结束了销售部分，所以让我们用一些代码弄脏我们的gads！</p><p id="03ac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">上传到亚马逊S3 </strong></p><p id="8cf6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我们开始搜索如何上传到亚马逊S3时，我们发现了一个Railscasts视频(“第383集-上传到亚马逊S3”)，作者正是这样做的，但他使用carrierwave gem来上传文件，我们使用dropzone javascript插件和回形针gem来完成图像处理部分。尽管如此，我们还是使用了Ryan Bates创建的助手来帮助上传表单。</p><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="d6ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对亚马逊S3来说重要的字段是“字段”方法中的字段，这些字段作为隐藏字段放在表单中，亚马逊S3将使用它们来验证、处理和响应您的请求。它们如下:</p><ul class=""><li id="768d" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">访问控制列表</li></ul><p id="9829" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该字段代表对象的ACL机制。</p><ul class=""><li id="b83b" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">政策</li></ul><p id="7536" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">策略字段是一个加密的散列，其中组成它的字段表示将应用于将要发出的请求的一些限制。例如，您有一个“到期”字段，它指示该表单发出请求的有效时间。</p><ul class=""><li id="53e3" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">水桶</li></ul><p id="3dc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">标识将在哪个存储桶中发出请求。</p><ul class=""><li id="9972" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">成功_操作_状态</li></ul><p id="2bfc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">表示将在响应中使用的HTTP状态代码。</p><ul class=""><li id="b211" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">键</li></ul><p id="3567" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这里，您可以指定存储文件的路径。</p><p id="4d3f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您只需执行以下操作即可使用该助手:</p><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="6110" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">需要记住的一点是，您需要用正确的CORS配置来配置您的亚马逊S3桶，以便能够针对该桶发出请求。所述配置的一个例子如下所述。</p><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="8478" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">成功地将文件上传到亚马逊S3后，您可能希望直接从代码中访问您的bucket和object。为此，您拥有“AWS-SDK”gem，其用法示例如下:</p><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="e9a3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你所看到的，用这个gem你可以很容易地在你的桶中进行操作，比如删除你的对象或者从一个路径复制你的对象到另一个路径。</p><p id="ad57" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这并不难，不是吗？通过这个简单的介绍，你可以将你的文件上传到亚马逊S3，并且你可以自豪地说你正在使用云。</p><div class="jz ka kb kc fq ab cb"><figure class="kg kd kh ki kj kk kl paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="kg kd kh ki kj kk kl paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="kg kd kh ki kj kk kl paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ko kp kq"><p id="f922" class="ir is kr it b iu iv iw ix iy iz ja jb ks jd je jf kt jh ji jj ku jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is kr it b iu iv iw ix iy iz ja jb ks jd je jf kt jh ji jj ku jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jz ka kb kc fq kd fe ff paragraph-image"><a href="https://goo.gl/Ahtev1"><div class="fe ff kv"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></a></figure></div></div>    
</body>
</html>