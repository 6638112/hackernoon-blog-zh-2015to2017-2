<html>
<head>
<title>How Kotlin’s “@Deprecated” Relieves Pain of Colossal Refactoring?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">科特林的“@弃用”如何减轻巨大重构的痛苦？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-kotlins-deprecated-relieves-pain-of-colossal-refactoring-8577545aaed?source=collection_archive---------4-----------------------#2017-10-15">https://medium.com/hackernoon/how-kotlins-deprecated-relieves-pain-of-colossal-refactoring-8577545aaed?source=collection_archive---------4-----------------------#2017-10-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d2b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我要告诉你一个真实的故事，我们是如何节省大量时间的。科特林重构的力量令人震惊。</p><p id="3db5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不要觉得和Java的<code class="eh jp jq jr js b">@Deprecated</code>一样。它更强大。它允许多步自动更换。</p><p id="5171" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那么，让我告诉你吧。</p><p id="5beb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将代码库从Java迁移到Kotlin。当有人需要接触现有的Java文件时，我们会自动将它转换成Kotlin。只有这样才能带来改变。否则，所有新代码都是用Kotlin编写的。</p><p id="228d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们在单元测试中使用了<code class="eh jp jq jr js b">mockito</code>库。你可能知道，mockito非常依赖于<code class="eh jp jq jr js b">Mockito.when</code>方法。</p><p id="3815" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh jp jq jr js b">when</code>是Kotlin中的保留关键字。所以我们必须用倒刺把它围起来。</p><p id="2012" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">老实说，它看起来很丑，打字也很笨拙:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="ff86" class="kb kc hu js b fv kd ke l kf kg">class AccountTest {</span><span id="a43d" class="kb kc hu js b fv kh ke l kf kg">    private val statementReporter =<br/>                    mock(AccountStatementReporter::class.java)<br/>                    <br/>    private val account = Account(statementReporter)</span><span id="4dd5" class="kb kc hu js b fv kh ke l kf kg">    @Test<br/>    fun `testing with Mockito when`() {</span><span id="a04c" class="kb kc hu js b fv kh ke l kf kg">        `when`(statementReporter.canPrintItem())<br/>                .thenReturn(true)</span><span id="9cbd" class="kb kc hu js b fv kh ke l kf kg">        account.generateStatement()</span><span id="93f3" class="kb kc hu js b fv kh ke l kf kg">        verify(statementReporter).printItem("-5,00\t73,91")</span><span id="7e2c" class="kb kc hu js b fv kh ke l kf kg">    }</span><span id="d570" class="kb kc hu js b fv kh ke l kf kg">}</span></pre><p id="3757" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当时，我们还不知道<code class="eh jp jq jr js b">mockito-kotlin</code>，所以我们构建了自己的<code class="eh jp jq jr js b">whenever</code>函数来缓解关键字问题:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="8010" class="kb kc hu js b fv kd ke l kf kg">fun &lt;T&gt; whenever(x: T): OngoingStub&lt;T&gt; {<br/>    return `when`(x)<br/>}</span></pre><p id="efc4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它是<code class="eh jp jq jr js b">Mockito.when</code>的别名。</p><p id="b369" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它可以快速输入，IntelliJ帮助自动完成。这很好:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="d63d" class="kb kc hu js b fv kd ke l kf kg">    @Test<br/>    fun `testing with handcrafted whenever`() {</span><span id="1b8f" class="kb kc hu js b fv kh ke l kf kg">        whenever(statementReporter.canPrintItem())<br/>                .thenReturn(true)</span><span id="2309" class="kb kc hu js b fv kh ke l kf kg">        account.generateStatement()</span><span id="6db2" class="kb kc hu js b fv kh ke l kf kg">        verify(statementReporter).printItem("-5,00\t73,91")</span><span id="f95a" class="kb kc hu js b fv kh ke l kf kg">    }</span></pre><p id="958d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在半年的时间里，我们到处都有这种基于<code class="eh jp jq jr js b">whenever</code>的代码。</p><p id="fc2e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">成千上万次。</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="a851" class="kb kc hu js b fv kd ke l kf kg">    @Test<br/>    fun `testing with handcrafted whenever – false case`() {</span><span id="f9cd" class="kb kc hu js b fv kh ke l kf kg">        whenever(statementReporter.canPrintItem())<br/>                .thenReturn(false)</span><span id="10fe" class="kb kc hu js b fv kh ke l kf kg">        account.generateStatement()</span><span id="555c" class="kb kc hu js b fv kh ke l kf kg">        verify(statementReporter).canPrintItem()<br/>        verifyNoMoreInteractions(statementReporter)</span><span id="320b" class="kb kc hu js b fv kh ke l kf kg">    }</span></pre><p id="9409" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">此时，有人已经发现了<code class="eh jp jq jr js b">BDDMockito</code> API。它允许我们用稍微不同的词来表示<code class="eh jp jq jr js b">when</code>、<code class="eh jp jq jr js b">thenReturn</code>、<code class="eh jp jq jr js b">thenThrow</code>和其他词。</p><p id="5ec0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最重要的是，它是官方<code class="eh jp jq jr js b">mockito</code>库的一部分！</p><p id="e27b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">顺便说一下，<code class="eh jp jq jr js b">mockito</code>通常在Java和Kotlin测试时使用。</p><p id="6ef0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好奇在科特林测试？还是一般的科特林？</p><p id="6c53" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">建议你<a class="ae ki" href="https://iwillteachyoukotlin.com" rel="noopener ugc nofollow" target="_blank">下载我的免费终极教程:Kotlin入门</a>。再过几分钟，您就可以在Kotlin中使用第一个成熟的命令行应用程序了。</p><p id="345a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该教程是一本80页的书，完全是动手操作。您可以在学习各种Kotlin和IntelliJ特性的同时跟随它。还有很多其他的东西。</p><p id="1867" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不管怎样？</p><p id="40ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里有一个<code class="eh jp jq jr js b">BDDMockito</code>语法的例子:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="c5d5" class="kb kc hu js b fv kd ke l kf kg">    @Test<br/>    fun `testing with handcrafted whenever`() {</span><span id="acbe" class="kb kc hu js b fv kh ke l kf kg">        given(statementReporter.canPrintItem())<br/>                .willReturn(true)</span><span id="5af2" class="kb kc hu js b fv kh ke l kf kg">        account.generateStatement()</span><span id="1573" class="kb kc hu js b fv kh ke l kf kg">        verify(statementReporter).printItem("-5,00\t73,91")</span><span id="7a31" class="kb kc hu js b fv kh ke l kf kg">    }</span></pre><p id="96f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，我们想从手工制作的功能切换到官方API！</p><p id="51c3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">顺便说一下，<code class="eh jp jq jr js b">BDDMockito</code>使用了稍微不同的命名。但是嘲讽的结构是一样的:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="66d7" class="kb kc hu js b fv kd ke l kf kg">// given vs when<br/>given(statementReporter.canPrintItem())<br/>        // willReturn vs thenReturn<br/>        .willReturn(true)</span></pre><p id="77b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如你所见，它允许我们使用<code class="eh jp jq jr js b">given</code>而不是<code class="eh jp jq jr js b">when</code>，所有的<code class="eh jp jq jr js b">then*</code>方法都变成了<code class="eh jp jq jr js b">will*</code>。</p><p id="ebfc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那时，我们决定从<code class="eh jp jq jr js b">whenever</code>切换到<code class="eh jp jq jr js b">given</code>。我们不想一次改变成千上万的事件，因为这将花费很多时间。</p><p id="ab9e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我们要进行搜索和替换，我们可能会改变一些不应该改变的东西。</p><p id="7f25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，我们决定在<code class="eh jp jq jr js b">whenever</code>函数上添加一个简单的<code class="eh jp jq jr js b">@Deprecated</code>注释。这将使IntelliJ中的所有用法都被弃用(删除)。也不太可能引入新的用法。</p><p id="e5a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我的搭档输入时，我注意到IntelliJ在参数列表工具提示中显示了一些有趣的东西:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kj"><img src="../Images/ab41cb59bdbd5859bf02499aaa36268f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NbuvQ5ja3hy4x_Ok2e11VA.png"/></div></div></figure><p id="90c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这让我对这个<code class="eh jp jq jr js b">replaceWith</code>参数很好奇。如果我理解正确的话，这将允许一些自动替换。</p><p id="268c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们稍微摆弄了一下。看起来你可以做这样的替换。</p><p id="c97f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">代码如下:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="4189" class="kb kc hu js b fv kd ke l kf kg">@Deprecated(<br/>        "use BDDMockito.given",<br/>        replaceWith = ReplaceWith(<br/>                "given(x)",<br/>                "org.mockito.BDDMockito.Companion.given"))<br/>fun &lt;T&gt; whenever(x: T): OngoingStub&lt;T&gt; {<br/>    return `when`(x)<br/>}</span></pre><p id="c26a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们尝试使用<code class="eh jp jq jr js b">whenever</code>，将光标放在已废弃的<code class="eh jp jq jr js b">whenever</code>调用上，然后按ALT+ENTER(IntelliJ的神奇热键)。</p><p id="ae5a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">发生的事情令人惊讶:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kr"><img src="../Images/d1b8f2a1387ba5b54a734b23358f95f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OlL9Xi7if3jZyEPD2GjxlQ.png"/></div></div></figure><p id="c8e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您确实可以进行自动替换。而且在整个项目中甚至还有替换它的选项！</p><p id="08cf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">令人震惊！</p><p id="2178" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但首先，我们决定仔细检查它将如何工作，只是一个事件。</p><p id="a430" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是正确的决定:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div class="fe ff ks"><img src="../Images/a9520f91906211dfefba34c7b18ed929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*kx1ly51ZjI__k0674IIk4g.png"/></div></figure><p id="1bc0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它导致了一个编译错误，因为<code class="eh jp jq jr js b">BDDOngoingStub&lt;T&gt;</code>上没有定义<code class="eh jp jq jr js b">thenReturn</code>方法。应该是<code class="eh jp jq jr js b">willReturn</code>。</p><p id="2518" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在它让我们思考。</p><p id="ce5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我们可以使用Kotlin的“扩展方法”特性来定义方法，会怎么样呢？这将使事情编译。当然可以。</p><p id="b349" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是后来我们还是没有去掉自定义代码…</p><p id="2a8d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">“如果我们也反对扩展方法，那又怎么样呢？!"——我问。</p><p id="053b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">“然后我们可以加上<code class="eh jp jq jr js b">replaceWith</code>！”我的搭档回答道。</p><p id="d59a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在欣喜中，我们开始这样做:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="936b" class="kb kc hu js b fv kd ke l kf kg">fun &lt;T&gt; BDDOngoingStub&lt;T&gt;.thenReturn(x: T) {<br/>    willReturn(x)<br/>}</span></pre><p id="0ddd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这允许我们通过自动导入<code class="eh jp jq jr js b">thenReturn</code>扩展来解决问题:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/4a2fcd5146db2a123cdde2e8b6ba0c8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*H7qR6eQEtP3fWRE5dxY83Q.png"/></div></figure><p id="4e55" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们要用同样的注释来否定它:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="2d16" class="kb kc hu js b fv kd ke l kf kg">@Deprecated(<br/>        "use willReturn",<br/>        replaceWith = ReplaceWith(<br/>                "willReturn(x)"))<br/>fun &lt;T&gt; BDDOngoingStub&lt;T&gt;.thenReturn(x: T) {<br/>    willReturn(x)<br/>}</span></pre><p id="cb4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们能够用<code class="eh jp jq jr js b">willReturn</code>替换这些<code class="eh jp jq jr js b">thenReturn</code>方法调用了:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff ku"><img src="../Images/67106b20bf58b4fa5486d29b35aef974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-i3Ub5vMAyHBUwzPklOSYw.png"/></div></div></figure><p id="8064" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们也可以为整个项目运行替换程序。</p><p id="54ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">干净利落。</p><p id="d991" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们认为我们已经准备好进行“整个项目”的重构了:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kv"><img src="../Images/247ea466c30fcf9e2a6615e107b2cc35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1aBCMPf3EE98BlacmsdlCQ.png"/></div></div></figure><p id="d555" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这仍然迫使我们在大约40个文件中进行“ALT+ENTER”自动导入。</p><p id="7f10" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，说实话，这是一个快速的。</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kw"><img src="../Images/cbc6523e17866a611c9185c66ac35cd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srmmzW-_aWJjC6Z5_9JcKg.png"/></div></div></figure><p id="bd7f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有一个捷径可以跳到下一个编译错误:CMD+ALT+DOWN。所以解决这个小问题的方法就是按一个快捷键，然后再按一个。</p><p id="d2ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一遍又一遍。</p><p id="7586" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们花了一分钟做那件事。</p><p id="20c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们也为<code class="eh jp jq jr js b">thenReturn</code>做了同样的“整个项目”替换:</p><figure class="jt ju jv jw fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kx"><img src="../Images/ab8729c445af1af6f7af190f4cdd9084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vvk-mr8pf9s1tmKw8d0aag.png"/></div></div></figure><p id="be5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">工作起来没有任何问题:</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="16bb" class="kb kc hu js b fv kd ke l kf kg">    @Test<br/>    fun `testing with handcrafted whenever`() {</span><span id="f5cf" class="kb kc hu js b fv kh ke l kf kg">        given(statementReporter.canPrintItem())<br/>                .willReturn(true)</span><span id="bf5c" class="kb kc hu js b fv kh ke l kf kg">        account.generateStatement()</span><span id="2192" class="kb kc hu js b fv kh ke l kf kg">        verify(statementReporter).printItem("-5,00\t73,91")</span><span id="e84b" class="kb kc hu js b fv kh ke l kf kg">    }</span><span id="b383" class="kb kc hu js b fv kh ke l kf kg">    @Test<br/>    fun `testing with handcrafted whenever – false case`() {</span><span id="4fa0" class="kb kc hu js b fv kh ke l kf kg">        given(statementReporter.canPrintItem())<br/>                .willReturn(false)</span><span id="9292" class="kb kc hu js b fv kh ke l kf kg">        account.generateStatement()</span><span id="1877" class="kb kc hu js b fv kh ke l kf kg">        verify(statementReporter).canPrintItem()<br/>        verifyNoMoreInteractions(statementReporter)</span><span id="3e34" class="kb kc hu js b fv kh ke l kf kg">    }</span></pre><p id="48fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，我们再次检查了没有出现<code class="eh jp jq jr js b">whenever</code>、<code class="eh jp jq jr js b">thenReturn</code>和<code class="eh jp jq jr js b">thenThrow</code>。</p><p id="d182" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">没有。</p><p id="a544" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以我们安全地删除了我们的<code class="eh jp jq jr js b">testutils/whenever.kt</code>文件。</p><p id="bc88" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你所猜测的，这些<code class="eh jp jq jr js b">@Deprecated</code>定义中融入了一些智慧。但是一旦到位——会节省你很多时间，减轻你很多痛苦。</p><p id="5132" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我真诚地感谢你阅读这篇文章。对我来说，这是一段相当长的旅程。</p><p id="b04b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢你刚刚读到的，我会很感激一些中等的掌声！社交媒体分享也很受欢迎。反馈也是如此！</p><p id="34fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你刚刚开始使用Kotlin，你将会通过下载这个免费的关于Kotlin入门的终极教程让我高兴。</p><p id="fa58" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">谢谢大家！</p><h1 id="0cca" class="ky kc hu bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu dt translated">更多精彩阅读</h1><div class="lv lw fm fo lx ly"><a href="https://hackernoon.com/how-kotlin-calamity-devours-your-java-apps-like-cancer-f3ce9500a028" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hv fv z el md eo ep me er et ht dt translated">Kotlin灾难如何像闪电一样吞噬你的Java应用？</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">我听到你在说什么。有传言说Android积极采用Kotlin作为主要编程工具…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">hackernoon.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm kp ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a href="https://hackernoon.com/for-cto-when-is-the-time-to-pay-technical-debt-65343f18e5e4" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hv fv z el md eo ep me er et ht dt translated">对于CTO:技术债什么时候还？</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">开发人员经常抱怨技术债务，并希望获得一些时间来修复它。无论是重大的重构，还是…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">hackernoon.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm kp ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a href="https://hackernoon.com/how-to-find-the-time-to-learn-a-new-skill-when-you-are-working-full-time-d1957060ced0" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hv fv z el md eo ep me er et ht dt translated">当你全职工作时，如何找到时间学习一项新技能？</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">让我猜猜…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">hackernoon.com</p></div></div></div></a></div></div></div>    
</body>
</html>