<html>
<head>
<title>Poking The Bear: Is TunnelBear’s Client Safe To Use?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">戳熊:TunnelBear的客户端使用安全吗？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/poking-the-bear-is-tunnelbears-client-safe-to-use-5960f756f4ea?source=collection_archive---------1-----------------------#2017-01-18">https://medium.com/hackernoon/poking-the-bear-is-tunnelbears-client-safe-to-use-5960f756f4ea?source=collection_archive---------1-----------------------#2017-01-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/ff312238699d79e91200a3754cb4f59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QwfSfY8jo69Ka6UnsCEzqw.jpeg"/></div></div></figure><p id="630e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">TunnelBear正迅速成为“普通”人使用VPN的最受欢迎的选项之一。它很容易使用，针对性很强，但不令人讨厌的营销也没有坏处。另外，我对那些将出色的产品和可爱的前端结合在一起的品牌有一种非理性的喜爱。同样的原因，我爱上了<a class="ae ka" href="http://www.neatmic.com/bee/King-Bee-Microphone" rel="noopener ugc nofollow" target="_blank">整洁的麦克风</a>。</p><h2 id="1650" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">不是开源的</h2><p id="991b" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">TunnelBear便宜且非侵入性，但不是开源的。帐户管理在他们的服务器上进行，使用唯一的用户令牌。因此，客户端并不那么重要，不会提供太多的攻击面。但是攻击TB的服务不是这篇文章的重点。</p><p id="047b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">也就是说，客户机毕竟是运行在你的电脑上的一个专有软件，管理着你通信中最隐私的部分:你的互联网连接。因此，了解它的工作原理以及它对你的了解和分享是非常重要的。</p><p id="36fe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">隧道熊还没有一个主要的纷争，而且(剧透)，我在我的分析中没有发现任何。然而，这个软件的某些部分可能会让你感到惊讶。</p><h2 id="cf67" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">Windows操作系统</h2><p id="a332" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">TunnelBear面向更广泛的“普通人”受众，所以我的分析集中在Windows客户端。说“TunnelBear不是开源的”并不完全正确。首先<a class="ae ka" href="https://www.tunnelbear.com/notices" rel="noopener ugc nofollow" target="_blank">它使用自由/开源软件组件</a>，并且它是用C#编写的，如果你不熟悉逆向工程，这就等同于拥有一份完整的源代码的整洁的格式和优化的副本——除去注释。</p><h2 id="786f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">资源</h2><p id="7075" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">TunnelBear基础安装将大约165个文件复制到您的PC上。该软件的独立部分是</p><ul class=""><li id="2c6e" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated">资产(如UI中使用的音频文件和图片)</li><li id="6369" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">证书(由Google颁发，根和密钥)</li><li id="e173" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">语言汇编(由于一些奇怪的原因，我的副本包含法语资源，尽管实际的应用程序是英语的)</li><li id="e982" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">一份<a class="ae ka" href="https://github.com/Yawning/obfs4" rel="noopener ugc nofollow" target="_blank"> obfs4 </a>的代理引擎(Tor组件)</li><li id="c1cd" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">各种(非常脆弱的)批处理脚本来管理<a class="ae ka" href="https://technet.microsoft.com/en-us/library/bb490991.aspx" rel="noopener ugc nofollow" target="_blank">路由</a> -ing、监控和DNS(-缓存)</li><li id="39b0" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">一份<a class="ae ka" href="https://gallery.technet.microsoft.com/Hyper-V-Network-VSP-Bind-cf937850" rel="noopener ugc nofollow" target="_blank"> Hyper-V网络VSP绑定</a>管理工具</li><li id="8672" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">OpenSSL的构建</li><li id="aded" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">OpenVPN驱动程序</li><li id="4a6a" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">GalaSoft <a class="ae ka" href="http://www.mvvmlight.net/" rel="noopener ugc nofollow" target="_blank"> MVVM轻型工具包</a></li><li id="21db" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">BitStadium的<a class="ae ka" href="https://www.hockeyapp.net/" rel="noopener ugc nofollow" target="_blank"> HockeyApp SDK </a></li><li id="f707" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">IntelliBear，一个DNS代理，不是用C#写的。这是使用上述批处理脚本的应用程序。</li><li id="c7f9" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><a class="ae ka" href="http://mahapps.com/" rel="noopener ugc nofollow" target="_blank"> MahApps Metro </a>，UI工具包</li><li id="72fb" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">ManagedWifi (NativeWifi)，一个简单的wlanapi Windows API包装器</li><li id="b3ff" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">一个JSON (de)解析器</li><li id="86ed" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">所有其他隧道承载代码。NET程序集(带有完整的调试信息)</li></ul><p id="22e9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以相当重。但这是堵住窗户上每个可能的漏洞所需要的。如果你只是想代理你的浏览器，像<a class="ae ka" href="https://github.com/turbo/TorGateway" rel="noopener ugc nofollow" target="_blank"> TorGateway </a>这样的东西就足够了。但不是每个应用程序都支持互联网选项，所以其他连接仍然会暴露你的实际IP地址。你需要代理<em class="lp">一切</em>。</p><h2 id="dd87" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">启动</h2><p id="07c7" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">这个应用程序是由这个搞笑的脚本启动的:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="b6a0" class="kb kc hu lv b fv lz ma l mb mc">Set WshShell = CreateObject(“WScript.Shell”)<br/>cmds=WshShell.RUN(“TBear.Client.exe”, 0, True)<br/>Set WshShell = Nothing</span></pre><p id="362a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">那么让我们来看看我们的入口点，TBear.Client，我看的是2.3.29.0版本。在代码中多次提到了版本3，并且对启用或禁用版本3的更新进行了许多检查，稍后会有更多的介绍。该集合链接到所有图像、声音和字体资产。它还包含默认的英语资源。</p><blockquote class="md me mf"><p id="3823" class="jc jd lp je b jf jg jh ji jj jk jl jm mg jo jp jq mh js jt ju mi jw jx jy jz hn dt translated">没有熊手套=冒险的网恋<br/> Grr。你的私处露出来了…</p></blockquote><p id="3da2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">等等。过去分词（past participle的缩写）</p><p id="c52d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先是连接助手例程。它只是通过使用<code class="eh mj mk ml lv b">Utils.PingTunnelBear()</code>等待互联网连接，默认最多尝试3次。它ping<code class="eh mj mk ml lv b">www.tunnelbear.com</code>作为检查。</p><p id="6e9e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">实际应用程序是异步启动的。启动时，它首先恢复默认代理。这适用于windows中的“internet选项”代理设置。这些作为地址和标志(开/关)存储在<code class="eh mj mk ml lv b">Software\Microsoft\Windows\CurrentVersion\Internet Settings</code>中。如果现有的代理地址是本地的，它只重置代理地址，如果您已经在使用另一个代理，这是一个好主意。</p><p id="f37e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它还确保在系统电源模式改变时恢复运行并重新连接VPN。</p><p id="5b0a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在来看实际的启动处理程序。这是我们第一次遇到一个叫做<code class="eh mj mk ml lv b">Utils.IsProd</code>的奇特旗帜。这个标志控制许多事情。其中一个是客户端访问的服务器，tunnelbear.com用于生产，而staging.tunnelbear.com用于其他目的。</p><figure class="lq lr ls lt fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><figure class="lq lr ls lt fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="ecd7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，更重要的是，这禁用或启用了内置于每个例程中的全面日志记录到标准输出功能:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="1c3e" class="kb kc hu lv b fv lz ma l mb mc">Utils.IsGodModeUnlocked = <strong class="lv hv">false</strong>;<br/><strong class="lv hv">if</strong> (!Utils.IsProd) {<br/>  Logger.<strong class="lv hv">InitializeConsole</strong>();<br/>}</span></pre><p id="1287" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一面奇特的旗帜是不言自明的<code class="eh mj mk ml lv b">AutoUpdater.IsBeta</code>。</p><p id="cab0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后测试系统(或当前用户)是否能够运行intelli bear(DNS代理，记住)。这是通过在端口53上创建一个虚拟VPN实例来实现的。如果失败，用户可能没有权限或者已经有东西在那里运行。</p><p id="2979" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，我们开始解析命令行选项。以下是可用的:</p><ul class=""><li id="4c43" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-lang</code>，用于设置用户界面语言</li><li id="5e2a" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-autoconnect</code>，启动时是否自动连接</li><li id="5591" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-tcp</code>，强制VPN使用TCP</li><li id="9b65" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-intellibear-error</code>，记录最后一个IB错误(<code class="eh mj mk ml lv b">-intellibear-info</code>记录最后一条信息语句)</li><li id="3ddd" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-intellibear-verbose</code>强制IB进入详细模式。</li><li id="6420" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-reset</code>强制复位</li><li id="af91" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-uitest mode</code>运行此UI测试模式</li><li id="f7c4" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">-autologin user password</code>使用这些凭证登录并将它们“安全”地存储在磁盘上</li></ul><p id="cf00" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">根据这是否是您的第一次启动，您会看到“onboarding”或“main”窗口。通过曲棍球的遥测也在这一点上被初始化。</p><p id="68cd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是，让我们仔细看看我们最敏感数据的存储例程:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="d9dd" class="kb kc hu lv b fv lz ma l mb mc"><strong class="lv hv">int</strong> k = Array.IndexOf&lt;string&gt;(e.Args, “-auto-login”);<br/><strong class="lv hv">if</strong> (e.Args.Length &gt; k + 2) {<br/>  Utils.<strong class="lv hv">SafeSave</strong>(“STORE_USER”, e.Args[k + 1]);<br/>  Utils.<strong class="lv hv">SafeSave</strong>(“STORE_PASS”, e.Args[k + 2]);<br/>}</span></pre><p id="7cd9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们在《熊》中找到了这个函数。Common，帮助器函数的集合。当然，这个函数内置了日志记录，但是唯一记录的是被修改的键的名称。长话短说，数据使用<a class="ae ka" href="https://msdn.microsoft.com/en-us/library/2fh8203k(v=vs.110).aspx" rel="noopener ugc nofollow" target="_blank">受保护数据</a>加密并保存到<a class="ae ka" href="https://msdn.microsoft.com/en-us/library/3ak841sy(v=vs.110).aspx" rel="noopener ugc nofollow" target="_blank">隔离存储器</a> KVS。这里没有问题。基本上所有的设置都在IsolatedStorage中管理。</p><p id="0703" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">帐户设置</p><p id="e29e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有趣的事情发生在服务器端。如果您点击了任何会改变您帐户状态的内容，您将会在TunnelBear网站上这样做。例如，当您在UI中单击“升级”时，会发生以下情况:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="8df6" class="kb kc hu lv b fv lz ma l mb mc">Utils.<strong class="lv hv">LaunchBrowser</strong>(string.<strong class="lv hv">Format</strong>(Utils.<strong class="lv hv">GetBaseWebsite</strong>() + “account#/change?token={0}”, task.Result.Result.<strong class="lv hv">ToString</strong>()));</span></pre><p id="b0f3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">基本网站是生产服务器或临时服务器。但是令牌是如何生成的呢？</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="114c" class="kb kc hu lv b fv lz ma l mb mc"><strong class="lv hv">new</strong> <strong class="lv hv">TBearClient</strong>().<strong class="lv hv">GetDeepLinkToken</strong>(Utils.<strong class="lv hv">SafeRestore</strong>(“STORE_USER”), Utils.<strong class="lv hv">SafeRestore</strong>(“STORE_PASS”));</span></pre><p id="8ba5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">考虑到普通用户的密码，这似乎没有很高的熵。让我们深入了解一下。</p><p id="6037" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">DeepLinkToken生成器实际上是一个两步过程，因为它首先咨询API。</p><h2 id="3a7f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">API回退</h2><p id="9504" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">与前端一样，API的基本URL取决于它是否是生产版本。所以是<code class="eh mj mk ml lv b"><a class="ae ka" rel="noopener ugc nofollow" target="_blank" href="/(staging).tunnelbear.com/core/">https://(staging).tunnelbear.com/core/</a></code>。但是坚持住。此API可能被阻止。那么TunnelBear是如何规避这一点的呢？</p><p id="e568" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这就是API备份IP LUT的用武之地。它在启动时通过从AWS更新来填充。整个过程有点复杂(在TunnelBear中，所有事情都是通过委托任务来完成的)，但归结起来就是:</p><ul class=""><li id="bf0a" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated">轮询<a class="ae ka" href="https://s3.amazonaws.com/tunnelbear/bluebear/config3.json" rel="noopener ugc nofollow" target="_blank">https://S3 . amazonaws . com/tunnelbear/(redacted)/config 3 . JSON</a>以获得要使用的API备份IPs和API网关主机名。</li><li id="6b89" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">一丝不苟地记录一路上的一切。</li><li id="c663" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">foreach</code> IP，添加<code class="eh mj mk ml lv b"><a class="ae ka" href="https://ip/core/a" rel="noopener ugc nofollow" target="_blank">https://ip/core/</a></code>作为LUT的备份地址。</li></ul><p id="b85c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">API通常返回四个IP。这是一个我没有预料到的非常棒的回退，但是在我看来，实现确实有一些主要问题:</p><ul class=""><li id="920d" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated">这个API(尽管我在上面对它进行了审查)可以被任何软件轻易轮询。然后可以自动将其添加到阻止列表中。</li><li id="5e87" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">所有的IP都可以被服务签名或者甚至是地区阻止，因为它们在网络和地理意义上都非常接近。</li></ul><p id="4aa2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh mj mk ml lv b">GetApiBase()</code>虽然不使用IPs，但只有网关，也就是LUT的第一个入口。</p><h2 id="4fb5" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">登录令牌</h2><p id="bba8" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">但是我跑题了。回到登录令牌。没什么特别的，有点让人担心。对<code class="eh mj mk ml lv b">api/core/getLoginToken</code>的简单POST请求。帖子数据是</p><ul class=""><li id="af42" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">username=turbo</code></li><li id="b082" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated"><code class="eh mj mk ml lv b">password=nicetry</code></li></ul><p id="4bad" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样。标头也拒绝缓存，并使用设置中的语言。我想看看我的代币。现在，回退实际上使这种方式更容易。我编辑了上面的完整API URL，因为tunnelbear.com API域有一个CloudFlare WAF，所以IP可能不应该是公共的；-).</p><p id="caa6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这也干扰了cURL(如果你没有伪造UA，你只是得到一个CF挑战站点)。但是使用其中一个IP:成功！</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="be9d" class="kb kc hu lv b fv lz ma l mb mc">$ curl -data “username=minxomat%40gmail.com&amp;password=nicetryagain” -k <a class="ae ka" href="https://138.68.89.127/core/getLoginToken" rel="noopener ugc nofollow" target="_blank">https://(redacted)/core/getLoginToken</a></span><span id="7c1a" class="kb kc hu lv b fv mo ma l mb mc">{“details”:”15242acd-****–****-****-7484152ce15c”,”result”:”PASS”}</span></pre><p id="6e3e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">PASS表示成功，因为如果请求失败，服务器也会发送200 OK。<code class="eh mj mk ml lv b">-k</code>杀死证书错误(没有域名，咄！).</p><p id="74f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我们可以看到令牌确实只依赖于明文密码。如果你知道使用TunnelBear的人的电子邮件地址，你只需要暴力破解密码。当然这是完全不可行的。使用普通URL，您将达到CloudFlare的极限，使用IPs，您可以将攻击分散到四个点，但您仍然会很快被发现为流量异常。</p><p id="268f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您看到包含DeepLinkToken的网站，您仍然需要登录。但是如果你登录了，它会带你去它应该去的地方。</p><h2 id="b846" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">诊断模式</h2><p id="5842" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">如果你的熊行为不端，有一个故障排除模式，可以通过命令行arg <code class="eh mj mk ml lv b">-help</code>启动。</p><h2 id="f997" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">自动连接Wifi</h2><p id="8119" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">TunnelBear的一个不寻常的特点是它的<a class="ae ka" href="https://help.tunnelbear.com/customer/portal/articles/2458314" rel="noopener ugc nofollow" target="_blank"> WiFi管理功能</a>。仔细想想，这是一个必不可少的功能(目前也是windows版本独有的)。它轮询Windows WLAN API以检查当前的WiFi网络是否打开，并立即启用VPN连接，即使它是关闭的。</p><p id="1fab" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您已启用记录，记录将包含所有已连接的WiFi设定档的名称，以及它们是否安全。这部分客户不会给家里打电话，所以你的隐私保持不变。</p><h2 id="d133" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">警惕模式</h2><p id="a800" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">另一个有趣但重要的设置是<a class="ae ka" href="https://www.tunnelbear.com/blog/vigilant/" rel="noopener ugc nofollow" target="_blank">警戒模式</a>。我在这里的批评是(可能是因为UX的原因)它默认是禁用的。</p><blockquote class="md me mf"><p id="e7d3" class="jc jd lp je b jf jg jh ji jj jk jl jm mg jo jp jq mh js jt ju mi jw jx jy jz hn dt translated">这是生活的现实，无线连接下降。[……]在TunnelBear连接时，Vigilant会阻止任何不安全的流量，从而保护您的安全。</p></blockquote><p id="18eb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以…怎么做？</p><p id="ca4d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">义警防火墙，一个生活在TBear的类。Common是一个薄薄的包装器，包裹着拼凑的外部实用程序(就像Windows上所有与网络相关的东西一样)。</p><p id="b108" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了阻止一切，它当然需要允许例外，这只是TunnelBear使用的程序文件。它使用<a class="ae ka" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa364695(v=vs.85).aspx" rel="noopener ugc nofollow" target="_blank"> Windows防火墙API </a>来管理它的规则。所以，没有巫毒魔法或自制的废话。</p><h2 id="c012" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">硬件指纹</h2><p id="96c2" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">“等等。你说隐私！它到底想要一个硬件指纹做什么？!"，我听到你问。</p><p id="d4f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">每次创建TBearClient实例时，都会创建一个硬件指纹。再来剧透一下，<em class="lp">没错，是和他们的服务器共享的</em>。但是我们不要想太多。首先，我们需要剖析这个指纹是如何产生的。使用的数据是</p><ul class=""><li id="7706" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated">BIOS元数据(制造商、版本、ID等。)</li><li id="1e53" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">CPU(速度、名称、ID)</li><li id="58aa" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">注册表中的计算机GUID</li><li id="8391" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">MAC地址</li><li id="6e2c" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">GPU ID</li><li id="2a4a" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt">…</li></ul><p id="3f2c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但实际上，这个文件的大部分都是死代码。我怀疑这是从别的地方复制粘贴来的。唯一相关的例程是这样的:</p><figure class="lq lr ls lt fq iv"><div class="bz el l di"><div class="mp mn l"/></div></figure><p id="7f37" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不过，这有点奇怪。它首先尝试从32位注册表中获取GUID。返回的值可以是null，在这种情况下，它会尝试64位注册表。但是，这个调用也可能失败，可能会将指纹设置为null，并在其他地方导致异常。</p><p id="e198" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">无论如何，这个函数不会调用这个类中的任何其他方法。好的。现在，谁用这个指纹？</p><h2 id="6611" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">新用户注册</h2><p id="a725" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">那个。注册是对API的一个较大的POST请求。头部包含语言，奇怪的是包含OpenVPN版本。帖子数据是:</p><ul class=""><li id="79b4" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated">用户</li><li id="9766" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">密码</li><li id="94d1" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">程序集名称、版本和操作系统名称</li><li id="e386" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">国家</li><li id="6861" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">是否返回JSON的标志</li><li id="c8eb" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">指纹</li></ul><p id="9485" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以很清楚为什么要在注册时发送指纹。如果将cURL与一个小脚本和一个垃圾邮件API结合起来，你可以在几秒钟内在同一台机器上创建新的TunnelBear帐户，完全避开付费模式。然而，它们都有相同的硬件指纹，你会很快被阻止。</p><p id="f198" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是，这是毫无意义的。因为现在你知道如何制造假指纹了。唯一的识别信息是你的IP。但是，再次使用类似TorGateway的东西，并在每个帐户生成之间简单地轮换电路。无限自由隧道熊。这是TunnelBear需要考虑的事情，但无论如何不是一个严重的错误。</p><h2 id="67d5" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">混杂的</h2><p id="dff4" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">其他事情都很平常。设置代理信息，启动VPN等。没什么特别的，也没什么打电话回家。证书是JIT创建和安装的。</p><h2 id="d80e" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">智能熊</h2><p id="3cff" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">如果只是下载免费版的TunnelBear，IntelliBear是禁用的。它允许您在每个URL的基础上配置隧道。然而，IntelliBear运行时是默认提供的，不受其他任何保护。</p><blockquote class="md me mf"><p id="a2d0" class="jc jd lp je b jf jg jh ji jj jk jl jm mg jo jp jq mh js jt ju mi jw jx jy jz hn dt translated">为了了解使用了哪些URL，您需要代理DNS。现在，你们中的许多人可能正在使用住宅互联网连接。这意味着您可能也在不知情的情况下使用DNS代理。我看到很多人把他们的域名换成谷歌的。事实是:没关系。无论如何。即使你认为你在使用那个DNS，你的电脑也认为它在使用它。大多数ISP采用透明的DNS代理，MITM您的DNS请求，并从本地POP为您提供服务，以提高性能。然而，这些DNS缓存经常遭受愚蠢的高缓存时间(你不能清除)，有时甚至服务广告。想知道自己有没有被影响，<a class="ae ka" href="https://news.ycombinator.com/item?id=13037858" rel="noopener ugc nofollow" target="_blank">看这个讨论</a>。</p></blockquote><p id="2999" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">很高兴地报告，TunnelBear有自己的功能来检测DNS泄漏，甚至IPv6泄漏。厉害！</p><p id="c829" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们来戳一下智能熊:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="f19e" class="kb kc hu lv b fv lz ma l mb mc">C:\Program Files\TunnelBear&gt;intellibear32.exe -help<br/>Usage of intellibear32.exe:<br/> -debug=”error”: Debug level, set between error, info or verbose<br/> -f=”domains.txt”: Domain list file path<br/> -intel=”none”: Is using Intellibear?<br/> -log=””: Log path<br/> -p=””: Which proto use for lookup domain<br/> -r=””: Regex pattern for match domain to use tcp proto<br/> -s=”scripts”: Script directory path<br/> -server=””: Server ip<br/> -t=0: How many seconds to timeout<br/> -tap=”utun0": Which Tap adapter to use</span></pre><p id="5dc1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是，IB的实际包装器代码在程序集中是缺失的。</p><h2 id="da68" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">最后</h2><p id="3ccb" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">在审查了数千行代码后，我可以非常自信地说，TunnelBear没有隐私问题，没有收集不必要的遥测数据，是一个精简、快速和直观的应用程序。</p><p id="6119" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以，如果你正在看TunnelBear的特性集，并且你不需要更多，我可以从隐私的角度推荐它。如果你迫切需要绝对的隐私，Tor将是更好的选择。</p><p id="dd76" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所有这些也意味着实现您自己的TunnelBear客户端相当容易！</p><h2 id="4f38" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">接下来</h2><p id="9cf6" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">您可能会注意到，我没有深入讨论更高级的特性。那是因为V3出来了，在那里这些大部分都彻底检修了(哈，懂了？).所以接下来是付费V3版本的补充审计。敬请关注。</p><div class="lq lr ls lt fq ab cb"><figure class="mq iv mr ms mt mu mv paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mq iv mr ms mt mu mv paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mq iv mr ms mt mu mv paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="md me mf"><p id="f922" class="jc jd lp je b jf jg jh ji jj jk jl jm mg jo jp jq mh js jt ju mi jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ka" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd lp je b jf jg jh ji jj jk jl jm mg jo jp jq mh js jt ju mi jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lq lr ls lt fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mw"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>