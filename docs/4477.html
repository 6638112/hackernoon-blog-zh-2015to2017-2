<html>
<head>
<title>Managing Secrets in Docker Swarm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker Swarm中的秘密管理</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/managing-secrets-in-docker-swarm-6da766f1357d?source=collection_archive---------5-----------------------#2017-06-04">https://medium.com/hackernoon/managing-secrets-in-docker-swarm-6da766f1357d?source=collection_archive---------5-----------------------#2017-06-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e61f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">免责声明</strong>:我首先为<a class="ae jp" href="https://semaphoreci.com/community/tutorials/managing-secrets-in-docker-swarm" rel="noopener ugc nofollow" target="_blank">semaphoreci.com社区博客</a>写了这篇文章，它属于谁，它在<a class="ae jp" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener ugc nofollow" target="_blank">by-NC-sa 4.0 license</a>下分享在这个博客中。</p><h1 id="3819" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">介绍</h1><p id="a5c2" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">Docker改变了开发、测试和运行软件的方式，这就是为什么软件工程师和公司应该培养新的习惯并遵循最佳实践。另一方面，像Docker Swarm、K8S或Mesos这样的编排技术也在根据行业需求而变化。安全管理，包括Docker Swarm中的秘密管理，是对这些变化的反应之一。</p><p id="b371" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用Docker和编排工具时，遵循安全最佳实践非常重要。软件变得越来越分散，随着新的开发模式(例如微服务架构)的兴起，软件组件之间的通信正在采用新的模式，如基于消息的通信。</p><p id="8fec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在生产环境中，运行不同服务的容器可能会交换一些关键信息。当将软件部署到不同的环境中时，很明显，在开发环境中存储像生产密码这样的关键信息不是一个好的做法。在很多情况下，我们会注意到需要一个标准化的接口来访问机密。</p><p id="00b0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">数据中心操作系统、Kubernetes和其他编排技术拥有自己的集成机密管理解决方案。在本教程中，我们将探索Docker本机秘密管理。</p><h1 id="c349" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">在群体模式下管理秘密</h1><p id="682b" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在本教程的这一部分，我们将了解如何使用Docker Secrets创建、附加和旋转敏感数据。</p><h1 id="a3c2" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">Docker秘密是如何工作的</h1><p id="6ceb" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">从1.13版本开始，Docker用户可以在集群中使用Docker秘密。Docker Swarm中的管理者作为权威代表来协调秘密管理。</p><p id="6e06" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">秘密可以是密码、密钥、证书、敏感的环境数据或开发人员想要保护的任何其他自定义数据，例如数据库名称、管理员用户名等。</p><p id="2e8d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Docker Secrets只在群体模式下可用，所以独立容器不能使用该功能。Swarm模式允许您集中管理敏感数据和消息，以安全的方式加密和传输它们，并且只传输给需要访问它们的容器(最小特权原则)。</p><p id="fba3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当用户向群集群添加新的秘密时，该秘密被使用TLS连接发送到管理器。</p><p id="4c34" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意:<strong class="it hv"> TLS是一种加密协议，通过提供通信加密、隐私和数据完整性来提供网络上的通信安全性。</strong></p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff kt"><img src="../Images/cb97784ac1a4c78f6cced2d056e749a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qbNMPc3kAQ7jXdNj.png"/></div></div></figure><p id="f382" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了使所有管理器更新新的秘密，当一个管理器节点接收到该秘密时，它用256位密钥将其保存到Raft存储器中。</p><h1 id="81eb" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">创造一个秘密</h1><p id="cede" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">为了了解一切是如何工作的，让我们创建一个新的Docker机器:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="f485" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker-machine create --driver virtualbox secrets-testing</span><span id="a830" class="lk jr hu lg b fv lp lm l ln lo">&gt; Running pre-create checks...<br/>&gt; (secrets-testing) Default Boot2Docker ISO is out-of-date, downloading the latest release...<br/>&gt; (secrets-testing) Latest release for github.com/boot2docker/boot2docker is v17.05.0-ce<br/>&gt; (secrets-testing) Downloading /home/eon01/.docker/machine/cache/boot2docker.iso from <a class="ae jp" href="https://github.com/boot2docker/boot2docker/releases/download/v17.05.0-ce/boot2docker.iso..." rel="noopener ugc nofollow" target="_blank">https://github.com/boot2docker/boot2docker/releases/download/v17.05.0-ce/boot2docker.iso...</a><br/>&gt; (secrets-testing) 0%....10%....20%....30%....40%....50%....60%....70%....80%....90%....100%<br/>&gt; Creating machine...<br/>&gt; (secrets-testing) Copying /home/eon01/.docker/machine/cache/boot2docker.iso to /home/eon01/.docker/machine/machines/secrets-testing/boot2docker.iso...<br/>&gt; (secrets-testing) Creating VirtualBox VM...<br/>&gt; (secrets-testing) Creating SSH key...<br/>&gt; (secrets-testing) Starting the VM...<br/>&gt; (secrets-testing) Check network to re-create if needed...<br/>&gt; (secrets-testing) Waiting for an IP...<br/>&gt; Waiting for machine to be running, this may take a few minutes...<br/>&gt; Detecting operating system of created instance...<br/>&gt; Waiting for SSH to be available...<br/>&gt; Detecting the provisioner...<br/>&gt; Provisioning with boot2docker...<br/>&gt; Copying certs to the local machine directory...<br/>&gt; Copying certs to the remote machine...<br/>&gt; Setting Docker configuration on the remote daemon...<br/>&gt; Checking connection to Docker...<br/>&gt; Docker is up and running!<br/>&gt; To see how to connect your Docker Client to the Docker Engine running on this virtual machine, run: docker-machine env secrets-testing<br/>```</span></pre><p id="92d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您应该看到创建的机器使用:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="a0e4" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker-machine ls<br/></span><span id="4392" class="lk jr hu lg b fv lp lm l ln lo">&gt; NAME              ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER        ERRORS<br/>&gt; secrets-testing   -        virtualbox   Running   tcp://192.168.99.100:2376           v17.05.0-ce<br/>```</span></pre><p id="b746" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们看看机器变量:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="403a" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker-machine env secrets-testing</span><span id="a9ec" class="lk jr hu lg b fv lp lm l ln lo">&gt; export DOCKER_TLS_VERIFY="1"<br/>&gt; export DOCKER_HOST="tcp://192.168.99.100:2376"<br/>&gt; export DOCKER_CERT_PATH="/home/eon01/.docker/machine/machines/secrets-testing"<br/>&gt; export DOCKER_MACHINE_NAME="secrets-testing"</span><span id="8eff" class="lk jr hu lg b fv lp lm l ln lo">```</span></pre><p id="1953" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果一切正常，我们可以将当前的shell会话连接到新机器:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="fcd9" class="lk jr hu lg b fv ll lm l ln lo">```<br/>eval "$(docker-machine env secrets-testing)"<br/>```</span></pre><p id="b4d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们现在可以启动一个Swarm集群来运行我们的测试。使用创建的机器的IP地址，初始化Swarm:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="e681" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker swarm init --advertise-addr 192.168.99.100<br/>```</span></pre><p id="293c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您应该会看到类似如下的内容:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="2530" class="lk jr hu lg b fv ll lm l ln lo">```<br/>&gt; Swarm initialized: current node (sqd5o5vj5c2r9gn53jd1uc4ig) is now a manager.<br/>&gt;<br/>&gt; To add a worker to this swarm, run the following command:<br/>&gt;<br/>&gt;     docker swarm join \<br/>&gt;     --token SWMTKN-1-0atbw3c3geeyievi62dkgrw03pauh93rhfz41mdveo21ei1fb6-abf6azeaezaea \<br/>&gt;     192.168.99.100:2377<br/>&gt;<br/>&gt; To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions.<br/>```</span></pre><p id="dd46" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的经理已创建，您可以创建新的机器并添加您选择的新经理或工人。</p><p id="5315" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，让我们创建一个新的随机Docker秘密。虽然将使用<code class="eh lq lr ls lg b">date |md5sum|awk '{print $1}'</code>创建密码，但Docker密码是使用以下命令创建的:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="0709" class="lk jr hu lg b fv ll lm l ln lo">docker secret create [OPTIONS] SECRET file|-</span></pre><p id="9b0a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们可以运行一个命令来创建Docker密码:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="03ce" class="lk jr hu lg b fv ll lm l ln lo">```<br/>date |md5sum|awk '{print $1}' | docker secret create my_secret -<br/>&gt; qk4k9adgri6b3ubjua9nca5fp<br/>```</span></pre><p id="927e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建的秘密被称为<code class="eh lq lr ls lg b">my_secret</code>。</p><p id="0eaf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当你输入<code class="eh lq lr ls lg b">docker secret ls</code>时，你可以看到使用过的秘密:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="c883" class="lk jr hu lg b fv ll lm l ln lo">```<br/>&gt; ID                          NAME                CREATED              UPDATED<br/>&gt; qk4k9adgri6b3ubjua9nca5fp   my_secret           About a minute ago   About a minute ago<br/>```</span></pre><p id="4395" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">qk4k9adgri6b3ubjua9nca5fp是最近创建的秘密的随机且唯一的标识符。</p><p id="cdfe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您想了解更多关于<code class="eh lq lr ls lg b">my_secret</code>的信息，您可以使用:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="78a6" class="lk jr hu lg b fv ll lm l ln lo">docker secret inspect  my_secret</span></pre><p id="8569" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您将看到一个JSON输出，其中包含不同的其他信息，比如创建或更新日期。</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="37e9" class="lk jr hu lg b fv ll lm l ln lo">```<br/>&gt; [<br/>&gt;     {<br/>&gt;         "ID": "qk4k9adgri6b3ubjua9nca5fp",<br/>&gt;         "Version": {<br/>&gt;             "Index": 10<br/>&gt;         },<br/>&gt;         "CreatedAt": "2017-05-22T13:25:23.815462834Z",<br/>&gt;         "UpdatedAt": "2017-05-22T13:25:23.815462834Z",<br/>&gt;         "Spec": {<br/>&gt;             "Name": "my_secret",<br/>&gt;             "Labels": {}<br/>&gt;         }<br/>&gt;     }<br/>&gt; ]<br/>```</span></pre><p id="185d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的秘密现在储存在加密的木筏日志里。</p><h1 id="e5be" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">消费码头机密</h1><p id="7e80" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">让我们创建一个新的服务，它将使用创建的秘密(<code class="eh lq lr ls lg b">my_secret</code>)。</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="81a1" class="lk jr hu lg b fv ll lm l ln lo">docker service create --name my_test_app --secret my_secret eon01/infinite</span></pre><p id="1d1c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">eon01/infinite是我为这种使用Alpine运行无限循环的测试创建的Docker映像。</p><p id="e5a1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们有了一个使用秘密my_secret的名为<code class="eh lq lr ls lg b">my_test_app</code>的运行服务。我们可以用<code class="eh lq lr ls lg b">docker service ls</code>甚至<code class="eh lq lr ls lg b">docker ps</code>来查看。</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="06bb" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker ps</span><span id="3391" class="lk jr hu lg b fv lp lm l ln lo">&gt; CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS               NAMES<br/>&gt; db38ae5f19fa        eon01/infinite:latest   "/bin/sh -c 'tail ..."   10 minutes ago      Up 10 minutes                           my_test_app.1.cc71i2rm0cl6pghn7z5ht7b98<br/>```</span></pre><p id="9fc6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">只有创建的服务在使用密码，因为我们的服务运行一个容器，只有这个容器可以看到这个秘密。换句话说，当一个秘密被附加到一个服务上时，只有这个服务和它的任务可以访问这个敏感数据。这个秘密现在存储在<code class="eh lq lr ls lg b">/run/secrets/my_secret</code>下的一个临时文件系统(tmpfs)中</p><p id="1441" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Tmpfs是许多类Unix操作系统上的临时文件存储工具，存储在易失性内存中，而不是永久存储设备中。</p><p id="24bb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因为我们的容器id是db38ae5f19fa，所以我们可以使用以下命令检查tmpfs内容:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="7bfc" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker exec -it db38ae5f19fa cat /run/secrets/my_secret</span><span id="3879" class="lk jr hu lg b fv lp lm l ln lo">&gt; 21ac8406497dded57ceafb7767e53633<br/>```</span></pre><p id="1048" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您为相同的服务创建了其他秘密，您可以在<code class="eh lq lr ls lg b">/run/secrets/&lt;secret_name&gt;</code>下的相同目录中找到它们</p><h1 id="9198" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">分享码头工人的秘密</h1><p id="8e9d" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">为了了解如何在两个应用程序之间共享敏感数据，我们可以创建一个名为my_other_test_app的新服务，并将创建的秘密发送给它。在我们的示例中，my_other_test_app将使用相同的密码，但使用不同的名称(my_other_secret):</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="e5b2" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker service create --name my_other_test_app --secret source=my_secret,target=my_other_secret,mode=0400 eon01/infinite<br/>```</span></pre><p id="97af" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们已经将模式设置为共享秘密(0400)，但是也可以添加其他选项，如UID或GID。让我们进入容器内部验证create secret的内容:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="f9e2" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker exec -it 51fe104e416b cat /run/secrets/my_other_secret<br/>```</span></pre><p id="a819" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">并且我们会发现与之前的命令<code class="eh lq lr ls lg b">docker exec -it db38ae5f19fa cat /run/secrets/my_secret</code>相同的输出是第一个秘密21ac 8406497 dded 57 ce AFB 7767 e 53633。</p><h1 id="13ce" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">循环码头机密</h1><p id="07ca" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">轮换密码等敏感数据是一项安全最佳实践，使用Docker Swarm Secrets功能是可行的。</p><p id="9c18" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先创建一个新的秘密:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="b9da" class="lk jr hu lg b fv ll lm l ln lo">```<br/>date |md5sum|awk '{print $1}' | docker secret create my_new_secret -<br/>```</span></pre><p id="ec13" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">之后，旧的密码应该被删除，并用新的密码更新，这是在一个命令中完成的:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="236b" class="lk jr hu lg b fv ll lm l ln lo">docker service update --secret-rm my_secret --secret-add  source=my_new_secret,target=my_secret  my_test_app</span></pre><p id="30be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想验证，你会发现旧的秘密(在我的例子中是21 AC 8406497 dded 57 ce AFB 7767 e 53633)现在有了新的值:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="5231" class="lk jr hu lg b fv ll lm l ln lo">docker exec -it 5152ba89ea7f cat /run/secrets/my_secret</span></pre><p id="49d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你也可以检查新的秘密:</p><pre class="ku kv kw kx fq lf lg lh li aw lj dt"><span id="4482" class="lk jr hu lg b fv ll lm l ln lo">```<br/>docker secret inspect my_new_secret</span><span id="0d5d" class="lk jr hu lg b fv lp lm l ln lo">&gt; [<br/>&gt;     {<br/>&gt;         "ID": "loame64czkbto3z87s37iy2ds",<br/>&gt;         "Version": {<br/>&gt;             "Index": 34<br/>&gt;         },<br/>&gt;         "CreatedAt": "2017-05-22T14:03:46.627206229Z",<br/>&gt;         "UpdatedAt": "2017-05-22T14:03:46.627206229Z",<br/>&gt;         "Spec": {<br/>&gt;             "Name": "my_new_secret",<br/>&gt;             "Labels": {}<br/>&gt;         }<br/>&gt;     }<br/>&gt; ]<br/>```</span></pre><h1 id="b3df" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">结论</h1><p id="2fd3" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我们已经在Swarm中看到了一个原生特性，它是在意识到秘密管理有多么重要之后，在Docker 1.13中引入的。</p><p id="da3a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Docker CLI和API的所有最新版本都支持这一特性，但仅限于Swarm模式，在这种模式下，机密存储在相关Swarm集群的Raft日志中，并存储在容器内的临时文件系统中。</p><p id="201b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Docker的秘密管理是有用的:敏感数据是不可变的，不会写入磁盘，也不会以明文形式发送到网络。其他编排技术，如Kubernetes，有不同的安全和秘密管理模型。如果安全性在您的项目中很重要，您应该比较这些不同的模型，并选择最适合您的模型。</p><h1 id="b89b" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">连接更深</h1><p id="5da7" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">如果你对这篇文章产生了共鸣，你可能会对我的书感兴趣:<a class="ae jp" href="http://painlessdocker.com/" rel="noopener ugc nofollow" target="_blank">无痛码头工人:<strong class="it hv">解锁码头工人的力量&amp;其生态系统</strong> </a>。</p><p id="e7c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还可以订阅<a class="ae jp" href="http://devopslinks.com" rel="noopener ugc nofollow" target="_blank"> DevOpsLinks </a> : <strong class="it hv">一个在线社区，由来自世界各地&amp;热情的DevOps、系统管理员&amp;开发人员</strong>和<a class="ae jp" href="http://shipped.devopslinks.com/" rel="noopener ugc nofollow" target="_blank">发布的</a> : <strong class="it hv">一份关注容器&amp;编排的独立时事通讯。</strong></p><p id="5d3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以在<a class="ae jp" href="https://twitter.com/eon01" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上找到我，也可以查阅其他书籍，比如<a class="ae jp" href="http://saltstackfordevops.com" rel="noopener ugc nofollow" target="_blank">salt stack For devo PS</a>:<strong class="it hv">极其快速简单的IT自动化和配置管理。</strong></p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="ab fr cl lt"><img src="../Images/9be788c6c2620a6f8af98543b867b658.png" data-original-src="https://miro.medium.com/v2/1*koUfnfQ-YkmwubsUs4zwwQ.gif"/></div></figure><p id="bd81" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢这篇文章，请推荐并分享给你的追随者。</p><div class="ku kv kw kx fq ab cb"><figure class="lu ky lv lw lx ly lz paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lu ky lv lw lx ly lz paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lu ky lv lw lx ly lz paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ma mb mc"><p id="f922" class="ir is md it b iu iv iw ix iy iz ja jb me jd je jf mf jh ji jj mg jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is md it b iu iv iw ix iy iz ja jb me jd je jf mf jh ji jj mg jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff mh"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>