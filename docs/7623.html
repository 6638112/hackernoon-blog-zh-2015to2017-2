<html>
<head>
<title>🔥 Latest Deep Learning OCR with Keras and Supervisely in 15 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">🔥最新的深度学习OCR与Keras和Supervisely在15分钟内</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/latest-deep-learning-ocr-with-keras-and-supervisely-in-15-minutes-34aecd630ed8?source=collection_archive---------0-----------------------#2017-11-02">https://medium.com/hackernoon/latest-deep-learning-ocr-with-keras-and-supervisely-in-15-minutes-34aecd630ed8?source=collection_archive---------0-----------------------#2017-11-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/53073e59cb308216abec4283e7afde1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZw3Q79NyaLMGnyF2jSvjw.png"/></div></div></figure><p id="fb22" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你好世界。本教程温和地介绍了如何在15分钟内使用深度学习构建现代文本识别系统。它将教你如何使用<a class="ae ka" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>和<a class="ae ka" href="https://supervise.ly/" rel="noopener ugc nofollow" target="_blank">supervised</a>解决这个问题的主要思想。本指南适用于对使用深度学习进行图像中的文本识别感兴趣但不知道从哪里开始的任何人。</p><p id="904e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将考虑一个简单的现实世界的例子:车牌识别。这是一个很好的起点，您可以轻松地为您的任务定制它。关于如何检测车牌的简单教程你可以在这里找到<a class="ae ka" rel="noopener" href="/towards-data-science/number-plate-detection-with-supervisely-and-tensorflow-part-1-e84c74d4382c"/>。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div class="fe ff kb"><img src="../Images/39727318c3cac6aeaf54a06080e5f8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ajdYalj2e6sh5f63fwLhjQ.jpeg"/></div></figure><p id="3a4f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当我们进入这个领域时，我们面临着互联网上资料的缺乏。通过长期的研究和阅读许多论文，我们已经对创建有效的识别系统背后的主要原则有了理解。我们在两个小型视频讲座(<a class="ae ka" rel="noopener" href="/towards-data-science/lecture-on-how-to-build-a-recognition-system-part-1-best-practices-46208e1ae591">第一部分</a>和<a class="ae ka" href="https://goo.gl/KwWR48" rel="noopener ugc nofollow" target="_blank">第二部分</a>)中与社区分享了我们的理解，并用简单的语言解释了它是如何工作的。我们认为这些内容非常有价值，因为不可能找到关于如何构建现代识别系统的简单而又好的解释。我们强烈建议在你开始之前观看它们，因为它们会给你这个话题背后的很多直觉。</p><p id="50e1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要顺利通过这个教程，你需要Ubuntu，GPU和Docker。</p><p id="b0b2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所有资源都可以在<a class="ae ka" href="https://github.com/DeepSystems/supervisely-tutorials" rel="noopener ugc nofollow" target="_blank"> github </a>获得。源代码位于<a class="ae ka" href="https://github.com/DeepSystems/supervisely-tutorials/blob/master/anpr_ocr/src/image_ocr.ipynb" rel="noopener ugc nofollow" target="_blank">单个jupyther笔记本</a>上，带有注释和有用的可视化。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kg"><img src="../Images/ed6513b8dde5deeaabd80ec7cc61fbe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BgDbuTIXEWY-IHCLiQpw2w.png"/></div></div></figure><h1 id="4b03" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">从哪里获取训练数据？</h1><p id="a670" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">对于本教程，我们已经生成了超过10K图像的人工数据集，非常类似于真实的车牌。图像看起来像这样。</p><div class="kc kd ke kf fq ab cb"><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/010cf687e09cebd31364e7eed6817ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*llAkc12-C5fE-l9EC-Z5Fw.png"/></figure><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/2955a02cdec661326226fb3bcb012ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*fIhytfdk_M3lGDp5F7kvWA.png"/></figure><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/066831f5d23579f5a182e70efc52c149.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*hWs4o_kUQvi45lM7b-nvMQ.png"/></figure></div><div class="ab cb"><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/bb327ae00e68eec437fd8d08341e5e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*Q6oWS1TQCEOcShjhHht8jg.png"/></figure><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/7e2329f0271b6bae154dce6a6df7991e.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*AISU0Dv2N7ogfXA8dpR2Dg.png"/></figure><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/9d2e89b78a202f4a9c1724031905aa8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*zNK7HkV2qp2uHKRwcnGhvw.png"/></figure></div><div class="ab cb"><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/799e7d26f7d119b4c4ce27b94ecec02c.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*l4f9-lAijYYWSMNmXF-OYQ.png"/></figure><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/9bde2e1ce654caefc112d2d5a49c6dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*X1XVLranZjC2wyFSprOOCw.png"/></figure><figure class="lk iv ll lm ln lo lp paragraph-image"><img src="../Images/3fc2d19e3d3b0cd96fa1e7f62c7d4f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*UD3egYd7cQ0IDHGq3mtQSA.png"/></figure></div><p id="40f3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以很容易地从<a class="ae ka" href="https://supervise.ly/" rel="noopener ugc nofollow" target="_blank">supervised</a>得到这个数据集。让我们对此说几句话。我们在<a class="ae ka" href="https://deepsystems.ai" rel="noopener ugc nofollow" target="_blank"> DeepSystems </a>做了很多计算机视觉开发，比如<a class="ae ka" href="https://deepsystems.ai/solutions/autonomous-driving" rel="noopener ugc nofollow" target="_blank">自动驾驶汽车</a>，收据识别系统<a class="ae ka" href="https://deepsystems.ai/solutions/road-defects-detection" rel="noopener ugc nofollow" target="_blank">，道路缺陷检测</a>等等。作为数据科学家，我们花费大量时间来处理训练数据:创建自定义图像注释，将我们的数据与公共数据集合并，进行数据扩充等等。<a class="ae ka" href="https://supervise.ly/" rel="noopener ugc nofollow" target="_blank">超级管理</a>简化了您处理培训数据的方式，并自动化了许多常规任务。我们相信你会发现它在你的日常工作中很有用。</p><p id="69b9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第一步是<a class="ae ka" href="https://app.supervise.ly/signup" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae ka" href="https://supervise.ly/" rel="noopener ugc nofollow" target="_blank">中监督注册</a>。下一步是进入“导入”—&gt;“数据集库”标签，点击“anpr_ocr”项目。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/accab0ffb3f0d57e0ddfb1b7be2df229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1VPtJFPXr5BGvXWYmxODjg.png"/></div></div></figure><p id="9306" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在那之后输入名字“anpr_ocr”并且点击“下一步”按钮。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/5824051a78f9baa9e41f7183ecc66f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iuFoP3MN-qFqtewNFZmhMw.png"/></div></div></figure><p id="68d9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后点击“上传”按钮。仅此而已。现在项目“anpr_ocr”被添加到您的帐户中。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/809372387d36849444f43085587400f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dO_iUkxHSoSNEaGyvB0P9g.png"/></div></div></figure><p id="7af5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它由两个数据集组成:“训练”和“测试”。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/5a548644dfd7342779a58cd1a2bd114e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mBw72dKzTjP5dBPpCtdrrg.png"/></div></div></figure><p id="d78b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你想预览图像，只需点击数据集，你会立即进入注释工具。对于每个图像，我们都有一个文本描述，它将被用作训练我们系统的基础事实。要查看它，只需点击所选图像对面的小图标(红色市场)。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/733bcefe6812c70c10d4b143d7126e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PNdhLOt6aFN29kk0_fCyMw.png"/></div></div></figure><p id="5201" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们必须以特定的格式下载它。为此，只需点击“DTL”页面，并将此<a class="ae ka" href="https://github.com/DeepSystems/supervisely-tutorials/blob/master/anpr_ocr/src/export_config.json" rel="noopener ugc nofollow" target="_blank">配置</a>插入文本区域。它看起来会像这样。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/858db3d87df02487b4f63759ad2d0fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-xNBtqOYDcpdIlDRsx6W1g.png"/></div></div></figure><p id="611c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在上面的截图中，您可以看到说明导出步骤的方案。我们不会深究技术细节(如果需要，您可以阅读<a class="ae ka" href="https://docs.supervise.ly" rel="noopener ugc nofollow" target="_blank">文档</a>),但是尝试在下面解释这个过程。在我们的“anpr_ocr”项目中，我们有两个数据集。“测试”数据集按原样导出(所有图像将被标记为“测试”)。“train”数据集被分成两组:“Train”和“val”。随机95%的图像将被标记为“火车”，其余5%被标记为“val”。</p><p id="b37e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在你可以点击“开始”按钮，等待两分钟，系统准备下载档案。点击“DTL”-&gt;“任务状态”-&gt;“三个竖点”-&gt;“下载”按钮，获取培训数据(红色标记)。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lr"><img src="../Images/c155ba8dacad59c59baf6d0dde68864f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HK4d-muok6Y-Qhx8G5Kp3Q.jpeg"/></div></div></figure><h1 id="1cee" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">让我们开始实验吧</h1><p id="4355" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">我们在我们的<a class="ae ka" href="https://github.com/DeepSystems/supervisely-tutorials" rel="noopener ugc nofollow" target="_blank"> git仓库</a>中准备了您需要的所有东西。使用以下命令克隆它</p><pre class="kc kd ke kf fq ls lt lu lv aw lw dt"><span id="57d9" class="lx ki hu lt b fv ly lz l ma mb">git clone <a class="ae ka" href="https://github.com/DeepSystems/supervisely-tutorials.git" rel="noopener ugc nofollow" target="_blank">https://github.com/DeepSystems/supervisely-tutorials.git</a> <br/>cd supervisely-tutorials/anpr_ocr</span></pre><p id="72d0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">目录结构如下</p><pre class="kc kd ke kf fq ls lt lu lv aw lw dt"><span id="6c1e" class="lx ki hu lt b fv ly lz l ma mb">.<br/>├── data<br/>├── docker<br/>│   ├── build.sh<br/>│   ├── Dockerfile<br/>│   └── run.sh<br/>└── src<br/>    ├── architecture.png<br/>    ├── export_config.json<br/>    └── image_ocr.ipynb</span></pre><p id="5ea5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将下载的zip存档文件放入“data”目录，并运行下面的命令</p><pre class="kc kd ke kf fq ls lt lu lv aw lw dt"><span id="3bed" class="lx ki hu lt b fv ly lz l ma mb">unzip &lt;archive name&gt;.zip -d .</span></pre><p id="314f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我的例子中，命令是</p><pre class="kc kd ke kf fq ls lt lu lv aw lw dt"><span id="2b53" class="lx ki hu lt b fv ly lz l ma mb">unzip anpr_ocr.zip -d .</span></pre><p id="23e4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在让我们用准备好的工作环境(tensorflow和keras)构建并运行docker容器。只需转到“docker”目录并运行以下命令</p><pre class="kc kd ke kf fq ls lt lu lv aw lw dt"><span id="a00f" class="lx ki hu lt b fv ly lz l ma mb">./build.sh<br/>./run.sh</span></pre><p id="2174" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在那之后，你将进入集装箱。运行下一个命令启动Jupyther笔记本</p><pre class="kc kd ke kf fq ls lt lu lv aw lw dt"><span id="de47" class="lx ki hu lt b fv ly lz l ma mb">jupyter notebook</span></pre><p id="ff1c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在终端中，您会看到类似这样的内容</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mc"><img src="../Images/d1885d8c1f83b0ec9d47dabad6ce003a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WEsv-tANld1xVapNZNH6FQ.png"/></div></div></figure><p id="e5e6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你必须复制选定的链接，并将其粘贴到网络浏览器。请注意，您的链接将与我的略有不同。</p><p id="83e0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后一步是运行整个“image_ocr.ipynb”笔记本。点击“单元格”-&gt;“全部运行”。</p><p id="8e63" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">笔记本由几个主要部分组成:数据加载和可视化，模型训练，测试集上的模型评估。对于该数据集，训练过程平均需要大约30分钟。</p><p id="61e8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果一切正常，您将看到以下输出</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff md"><img src="../Images/5c14f54ec5e311016bce412c55796958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-JEPmeYUhscVcURoBns_Hw.png"/></div></div></figure><p id="ab96" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如你所见，预测的字符串将与地面真相相同。因此，我们在一个漂亮的<a class="ae ka" href="https://github.com/DeepSystems/supervisely-tutorials/blob/master/anpr_ocr/src/image_ocr.ipynb" rel="noopener ugc nofollow" target="_blank">清晰的jupyther笔记本</a>中构建了现代OCR系统。在本教程的下一章，我们将涵盖和解释它如何工作的所有主要原则。</p><h1 id="8bdd" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">它是如何工作的</h1><p id="e626" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">对于我们来说，对神经网络架构的理解是关键。请不要偷懒<strong class="je hv"> </strong>，花15分钟看一下我们的小而简单的<a class="ae ka" href="https://youtu.be/uVbOckyUemo" rel="noopener ugc nofollow" target="_blank">视频讲座</a>关于NN架构的高级概述，这是在开始时提到的。它会让你有个大概的了解。如果你已经做了—太好了！:-)</p><p id="4736" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这里，我将尝试给你简短的解释。高层次的概述如下</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff me"><img src="../Images/daeb2792a9745cddb88aebbe9943caa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdb9_e5LVSJnxivblcFxEg.png"/></div></div></figure><p id="1b30" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，将图像送入CNN提取图像特征。下一步是将<a class="ae ka" rel="noopener" href="/towards-data-science/lecture-evolution-from-vanilla-rnn-to-gru-lstms-58688f1da83a">递归神经网络</a>应用于这些特征，然后是特殊的解码算法。这种解码算法从每个时间步长获取lstm输出，并产生最终的标记。</p><p id="eebe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">详细的架构如下。FC —全连接层，SM — softmax层。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lr"><img src="../Images/3db34d0820780b9c66a5b964a518120d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppxHSM2dKhtH6lOTlKInfg.png"/></div></div></figure><p id="a03a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">图像具有以下形状:高度等于64，宽度等于128，通道数等于3。</p><p id="0fa4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">正如你之前看到的，我们将这个图像张量输入到CNN特征提取器，它产生形状为4*8*4的张量。我们把图像“苹果”放到特征张量中，这样你就能理解如何解释它。高度等于4，宽度等于8(这些是空间维度)，通道数等于4。因此，我们将具有3个通道的输入图像变换为4个通道的张量。实际上，通道的数量应该更大，但我们构建了一个小型演示网络，因为幻灯片上的所有内容都很合适。</p><p id="38ca" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来我们做整形手术。之后，我们得到16个元素的8个向量的序列。之后，我们将这8个向量馈送到LSTM网络，并获得其输出——也是16个元素的向量。然后，我们应用全连接层，接着是softmax层，并获得6个元素的向量。这个向量包含在每个LSTM步骤中观察到的字母符号的概率分布。</p><p id="a418" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">实际上，CNN输出向量的数量可以达到32、64或更多。选择将取决于具体的任务。此外，在生产中，最好使用多层双向LSTM。但是这个简单的例子只解释了最重要的概念。</p><p id="78d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是解码算法是如何工作的呢？在上图中，我们在每个LSTM时间步有八个概率向量。让我们在每个时间步取最可能的符号。结果，我们获得了八个字符的字符串——每个时间步一个最可能的字母。然后，我们必须将所有连续的重复字符粘合成一个。在我们的例子中，两个字母“e”粘在了一起。特殊空白字符允许我们拆分原始标签中重复的符号。我们将空白符号添加到字母表中，以教会我们的神经网络预测这种大小写符号之间的空白。然后我们删除所有空白符号。看下面的插图</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mf"><img src="../Images/956875791b9e944b121d9770ca32d176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOmMMj4lxy4quHd4qjkd_g.png"/></div></div></figure><p id="7985" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当我们训练我们的网络时，我们用CTC丢失层代替解码算法。在我们的第二次视频讲座中会有解释。现在它只有俄语版本，很抱歉。但好消息是:我们有英文幻灯片，我们将很快发布英文版本。</p><p id="63f3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我们的实现中使用了有点复杂的神经网络结构。架构如下，但主要原理仍然相同。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mg"><img src="../Images/9da758f4974c27f64a6f4687bad73060.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MyHdDOccT2gqrCcNxKeQYA.png"/></div></div></figure><p id="0591" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在模型训练后，我们将它应用于测试集的图像，并获得了非常高的精度。我们还将每个RNN步骤的概率分布可视化为一个矩阵。下面是例子。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mh"><img src="../Images/96362557cd050a0a5268db803bedf6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*drhzXqNlpRY5VuYt7rhaDw.png"/></div></div></figure><p id="ac66" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该矩阵的行对应于所有字母符号加上“空白”。列对应于RNN步骤。</p><h1 id="ddfd" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">结论</h1><p id="867e" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">我们很乐意与社区分享我们的经验。我们相信视频讲座、本教程、现成的人工数据和源代码<strong class="je hv"> </strong>将帮助您获得基本的直觉，并且每个人都可以从头开始构建现代OCR系统。</p><p id="3fa1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有什么问题尽管问！谢谢大家！</p></div></div>    
</body>
</html>