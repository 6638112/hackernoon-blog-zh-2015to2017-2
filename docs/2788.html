<html>
<head>
<title>3 tricks for mastering Docker with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python掌握Docker的3个技巧</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/3-tricks-for-mastering-docker-with-python-99876412348d?source=collection_archive---------4-----------------------#2017-02-19">https://medium.com/hackernoon/3-tricks-for-mastering-docker-with-python-99876412348d?source=collection_archive---------4-----------------------#2017-02-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e84d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个故事的灵感来自于我用100% Python编写Docker式容器守护进程的徒劳尝试。</p><h1 id="d6e2" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">技巧Python的Docker</h1><p id="305f" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated"><code class="eh kt ku kv kw b">pip install docker</code></p><p id="28cf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用Docker CLI很好，但是使用Python的API要好得多。您可以列出容器，查看属性，并使用其他3个技巧，利用它们的强大功能。</p><figure class="kx ky kz la fq lb"><div class="bz el l di"><div class="lc ld l"/></div></figure><h1 id="290d" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">技巧Python的名称空间</h1><p id="3563" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated"><code class="eh kt ku kv kw b">pip install nsenter</code></p><p id="f411" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢Zalando的人们，这是C API进入内核名称空间的包装器。有了docker，Docker运行容器就有了自己的名称空间。这是保护它不受主机上其他容器影响的原因，使它保持隔离。<a class="ae jp" href="https://tech.zalando.com/posts/entering-kernel-namespaces-with-python.html" rel="noopener ugc nofollow" target="_blank">更多细节请点击</a>查看他们的博客文章。</p><p id="9752" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用nsenter很简单，假设您使用<code class="eh kt ku kv kw b">docker run -d nginx</code>启动了一个新的nginx容器，并获得了一个容器ID 277906 BC 266 c，您可以使用这个命令获得正在运行的进程ID。</p><p id="469c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用技巧1中的例子来获取进程ID。使用该进程ID跳转到命名空间并运行命令，查看文件系统或者只是进行一般性破坏。</p><figure class="kx ky kz la fq lb"><div class="bz el l di"><div class="lc ld l"/></div></figure><p id="e743" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="le">为什么是</em>？嗯，您经常会发现自己在一个bash会话中跳转到一个正在运行的容器来调试代码中的一些bug(我？绝不！)，嗯这叫Bash是有原因的，既然可以用<a class="ae jp" href="https://en.wikipedia.org/wiki/Sonic_screwdriver" rel="noopener ugc nofollow" target="_blank">声波螺丝刀</a>为什么还要用锤子呢？</p><h1 id="b1cb" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">绝招三:<code class="eh kt ku kv kw b">cgroups</code>针对Python</h1><p id="d292" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated"><code class="eh kt ku kv kw b">pip install cgroups</code></p><p id="ac46" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">控制组是Docker和其他工具确保特定进程不会失控并耗尽主机上所有资源的方式。你可以使用<code class="eh kt ku kv kw b">cgroups</code>包既创建、列出又操纵主机上现有的cgroups。例如，默认情况下，容器上没有设置CPU限制，所以您可以使用Python在主机上动态地转移资源。这个例子启动了一个新的进程并将它移动到一个cgroup中，你可以对Docker已经启动的现有进程做类似的事情。</p><figure class="kx ky kz la fq lb"><div class="bz el l di"><div class="lc ld l"/></div></figure><p id="55ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在就这些了，如果你想要一些使用这些包的可靠例子，请查看我在GitHub上的Docker守护进程实现<a class="ae jp" href="https://github.com/tonybaloney/mocker" rel="noopener ugc nofollow" target="_blank">https://github.com/tonybaloney/mocker</a></p><blockquote class="lf lg lh"><p id="8f28" class="ir is le it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is le it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated">要了解更多信息，请<a class="ae jp" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">阅读我们的“关于”页面</a>、<a class="ae jp" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书上点赞/给我们发消息</a>，或者简单地说，<a class="ae jp" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is le it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>