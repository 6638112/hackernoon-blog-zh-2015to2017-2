<html>
<head>
<title>Writing Shorter React-Redux Containers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写更短的React-Redux容器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/writing-shorter-react-redux-containers-9852a43d457?source=collection_archive---------18-----------------------#2017-12-20">https://medium.com/hackernoon/writing-shorter-react-redux-containers-9852a43d457?source=collection_archive---------18-----------------------#2017-12-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div class="fe ff hs"><img src="../Images/3ca127d342438a2e3f78ac08a006c1f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*q6pV7vn5hh09awgqxDtVRg.gif"/></div></figure><div class=""/><p id="2641" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你整天写react + redux代码，很可能你的手指已经习惯于打出这种模式的<code class="eh jw jx jy jz b">mapStateToProps</code>、<code class="eh jw jx jy jz b">mapDispatchToProps</code>和<code class="eh jw jx jy jz b">connect</code>:</p><figure class="ka kb kc kd fq hw"><div class="bz el l di"><div class="ke kf l"/></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">As described in the redux docs: this pattern produces a “Container” which is a component that listens to changes in redux store and re-renders automatically.</figcaption></figure><p id="63b0" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">没关系。功能是可重用的，一切都很简单，有什么不喜欢的呢？</p><p id="3a49" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">作为一个实验，我写了这个，并最终保留了它，因为它使样板文件更加简洁:</p><pre class="ka kb kc kd fq kk jz kl km aw kn dt"><span id="6afd" class="ko kp ib jz b fv kq kr l ks kt">import {connect} from 'react-redux'</span><span id="fc4f" class="ko kp ib jz b fv ku kr l ks kt">const reduxify = (container) =&gt;<br/>    connect(<br/>        container.mapStateToProps,<br/>        container.mapDispatchToProps,<br/>    )(container.render)</span></pre><p id="a4ab" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们所做的就是一次传入<code class="eh jw jx jy jz b">mapStateToProps</code>、<code class="eh jw jx jy jz b">mapDispatchToProps</code>和<code class="eh jw jx jy jz b">render</code>函数，而不是使用两步链式函数调用。</p><p id="2fc1" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">下面是新的、更短的语法，它使用<code class="eh jw jx jy jz b">reduxify</code>函数来创建一个“容器”:</p><figure class="ka kb kc kd fq hw"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="1aa6" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">大约9行的样板文件变成了大约6行，但更重要的是，它并没有降低原始文件的良好品质:可测试性&amp;函数易于重用。</p><figure class="ka kb kc kd fq hw fe ff paragraph-image"><div class="fe ff kv"><img src="../Images/bb7f76c8802a617e6140f5b60bb17470.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*elmYdaVS4wTa0kJwDksTgQ.gif"/></div></figure><h1 id="4387" class="kw kp ib bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">测试和重复使用</h1><p id="c498" class="pw-post-body-paragraph iy iz ib ja b jb lt jd je jf lu jh ji jj lv jl jm jn lw jp jq jr lx jt ju jv hn dt translated">也许你想在不止一个地方重用<code class="eh jw jx jy jz b">mapStateToProps</code>，或者你想单元测试它，不用担心！</p><p id="37f0" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它们只是函数，你可以在任何你想要的地方定义它们，导入它们，并把它们放入<code class="eh jw jx jy jz b">reduxify</code>。对象<a class="ae ly" href="https://ariya.io/2013/02/es6-and-object-literal-property-value-shorthand" rel="noopener ugc nofollow" target="_blank">属性值速记</a>允许它保持清晰和简洁。</p><pre class="ka kb kc kd fq kk jz kl km aw kn dt"><span id="e32c" class="ko kp ib jz b fv kq kr l ks kt">import {mapStateToProps} from './other-component.js'</span><span id="1b77" class="ko kp ib jz b fv ku kr l ks kt">const Component = reduxify({<br/>    mapStateToProps,<br/>    render: (props) =&gt;<br/>        &lt;div&gt;...&lt;/div&gt;<br/>})</span></pre><p id="e623" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这里有一个在reduxify调用之外定义的<code class="eh jw jx jy jz b">mapStateToProps</code>的例子:</p><figure class="ka kb kc kd fq hw"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="ac38" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">一位有帮助的读者指出，如果你使用动作创建器，那么<code class="eh jw jx jy jz b">mapDispatchToProps</code>甚至不一定是一个函数:</p><figure class="ka kb kc kd fq hw"><div class="bz el l di"><div class="ke kf l"/></div></figure><h1 id="aed2" class="kw kp ib bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">下载<code class="eh jw jx jy jz b">reduxify</code>库</h1><p id="34c3" class="pw-post-body-paragraph iy iz ib ja b jb lt jd je jf lu jh ji jj lv jl jm jn lw jp jq jr lx jt ju jv hn dt translated">哈哈开个玩笑，我不会给你一个6行函数的<code class="eh jw jx jy jz b">npm</code>包，只是<a class="ae ly" href="https://gist.github.com/pirate/0aa0e1b9fe0f0c989241e90cb51e20a8" rel="noopener ugc nofollow" target="_blank">复制/粘贴</a>:)</p></div></div>    
</body>
</html>