<html>
<head>
<title>Rethinking JavaScript: Death of the For Loop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重新思考JavaScript:For循环的死亡</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/rethinking-javascript-death-of-the-for-loop-c431564c84a8?source=collection_archive---------1-----------------------#2017-01-11">https://medium.com/hackernoon/rethinking-javascript-death-of-the-for-loop-c431564c84a8?source=collection_archive---------1-----------------------#2017-01-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/61e6e80b0017e71986b4a8ce79070ca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4WIiBjwyKvOfdIMf1VFbaA.png"/></div></div></figure><p id="3245" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">JavaScript的<code class="eh ka kb kc kd b">for loop</code>为我们提供了很好的服务，但是它现在已经过时了，应该被更新的函数式编程技术所取代。</p><p id="0421" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">幸运的是，这是一个不需要你成为函数式编程大师的改变。更好的是，<strong class="je hv">这是你今天可以在现有项目中做的事情！</strong></p><p id="d3f4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">JavaScript的for循环到底有什么问题？</p><p id="71a4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ka kb kc kd b">for loop</code>的设计鼓励状态的<strong class="je hv">突变和<strong class="je hv">副作用</strong>的使用，这两者都是错误和不可预测代码的潜在来源。</strong></p><p id="f57c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们都听说过全球状态不好，应该避免。虽然<strong class="je hv">地方政府与全球政府</strong>有着相同的弊端，但我们只是不经常注意到它，因为它的规模较小。所以我们从来没有真正解决问题，我们只是把它最小化了。</p><p id="231a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于可变状态，在某个未知的时间点，变量会因为未知的原因而改变，您将花费数小时来调试和搜索值改变的原因。光是想到这一点，我就已经拔了十几根头发。</p><p id="6c43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来我想快速说一下<strong class="je hv">副作用</strong>。那些话听起来很可怕，副作用。呸。你希望你的程序有副作用吗？不，我不希望我的程序有副作用！</p><p id="5340" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是什么是副作用呢？</p><p id="009a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">当一个函数修改了该函数作用域之外的东西时，它被认为有副作用</strong>。它可以是改变变量值、读取键盘输入、进行api调用、将数据写入磁盘、登录控制台等。</p><p id="550d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">副作用是强大的，但是伴随着强大的力量而来的是巨大的责任。</p><p id="704b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在可能的情况下，应该消除副作用，或者对副作用进行封装和管理。<strong class="je hv">有副作用的函数更难测试，也更难推理</strong>，所以只要有可能就把它们弄出来。幸运的是，我们在这里不用担心副作用。</p><p id="0e2e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">好吧，少说话多代码。让我们来看看一个典型的<code class="eh ka kb kc kd b">for loop</code>，你可能已经看过一千遍了。</p><pre class="ke kf kg kh fq ki kd kj kk aw kl dt"><span id="31f9" class="km kn hu kd b fv ko kp l kq kr">const cats = [<br/>  { name: 'Mojo',    months: 84 },<br/>  { name: 'Mao-Mao', months: 34 },<br/>  { name: 'Waffles', months: 4 },<br/>  { name: 'Pickles', months: 6 }<br/>]</span><span id="3638" class="km kn hu kd b fv ks kp l kq kr">var kittens = []</span><span id="f7a7" class="km kn hu kd b fv ks kp l kq kr">// typical poorly written `for loop`<br/>for (var i = 0; i &lt; cats.length; i++) {<br/>  if (cats[i].months &lt; 7) {<br/>    kittens.push(cats[i].name)<br/>  }<br/>}</span><span id="ec0a" class="km kn hu kd b fv ks kp l kq kr">console.log(kittens)</span></pre><p id="69fa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我的计划是一步一步地重构这段代码，这样您就可以看到将您自己的代码转换成更漂亮的东西是多么容易。</p><p id="0f4f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我想做的第一个改变是将<code class="eh ka kb kc kd b">if</code>语句提取到它自己的函数中。</p><pre class="ke kf kg kh fq ki kd kj kk aw kl dt"><span id="3c42" class="km kn hu kd b fv ko kp l kq kr"><strong class="kd hv">const isKitten = cat =&gt; cat.months &lt; 7</strong></span><span id="2264" class="km kn hu kd b fv ks kp l kq kr">var kittens = []</span><span id="4a93" class="km kn hu kd b fv ks kp l kq kr">for (var i = 0; i &lt; cats.length; i++) {<br/>  if (<strong class="kd hv">isKitten(cats[i])</strong>) {<br/>    kittens.push(cats[i].name)<br/>  }<br/>}</span></pre><p id="d4a7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一般来说，摘录你的<code class="eh ka kb kc kd b">if</code>陈述是一个好的做法。<strong class="je hv">过滤从“7个月以下”到“是只小猫”的变化是件大事。现在当你阅读代码时，意图就变得很清楚了。为什么我们有7个月以下的猫？这个一点都不清楚。我们的目的是找到小猫，所以让代码这么说吧！</strong></p><p id="03c3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一个好处是<code class="eh ka kb kc kd b">isKitten</code>现在可以重复使用，我们都知道，</p><blockquote class="kt"><p id="5770" class="ku kv hu bd kw kx ky kz la lb lc jz ek translated">让我们的代码可重用应该是我们的目标之一。</p></blockquote><p id="e454" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">下一个变化是提取从cat类型的对象到名称的转换(或映射)。这个改变以后会更有意义，所以现在你只需要相信我。</p><pre class="ke kf kg kh fq ki kd kj kk aw kl dt"><span id="2511" class="km kn hu kd b fv ko kp l kq kr">const isKitten = cat =&gt; cat.months &lt; 7<br/><strong class="kd hv">const getName = cat =&gt; cat.name</strong></span><span id="65da" class="km kn hu kd b fv ks kp l kq kr">var kittens = []</span><span id="488d" class="km kn hu kd b fv ks kp l kq kr">for (var i = 0; i &lt; cats.length; i++) {<br/>  if (isKitten(cats[i])) {<br/>    kittens.push(<strong class="kd hv">getName(cats[i])</strong>)<br/>  }<br/>}</span></pre><p id="ff95" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我打算写几段描述一下<code class="eh ka kb kc kd b">filter</code>和<code class="eh ka kb kc kd b">map</code>的机制。但是我认为不描述它们，而是向你展示即使没有被介绍过<code class="eh ka kb kc kd b">map</code>或<code class="eh ka kb kc kd b">filter</code>，你也可以很容易地阅读和理解这些代码，这将最好地展示你的代码的可读性。</p><pre class="ke kf kg kh fq ki kd kj kk aw kl dt"><span id="f978" class="km kn hu kd b fv ko kp l kq kr">const isKitten = cat =&gt; cat.months &lt; 7<br/>const getName = cat =&gt; cat.name</span><span id="810e" class="km kn hu kd b fv ks kp l kq kr">const kittens =<br/>  <strong class="kd hv">cats.filter(isKitten)<br/>      .map(getName)</strong></span></pre><p id="ed7f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">还要注意，我们已经取消了<code class="eh ka kb kc kd b">kittens.push(...)</code>。不再有状态突变，不再有<code class="eh ka kb kc kd b">var</code>！</p><blockquote class="kt"><p id="3652" class="ku kv hu bd kw kx ky kz la lb lc jz ek translated">使用const(超过var和let)的代码非常性感</p></blockquote><p id="a814" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">在这里完全公开，我们可以一直使用const，因为const并不使对象本身不可变(下一次会详细介绍)。但是，嘿，这是一个人为的例子，所以放过我吧！</p><p id="4ab0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我建议的最后一个重构是将过滤和映射提取到它自己的函数中(你知道，为了整个重用)。</p><p id="a18e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在大家一起:</p><pre class="ke kf kg kh fq ki kd kj kk aw kl dt"><span id="9815" class="km kn hu kd b fv ko kp l kq kr">const isKitten = cat =&gt; cat.months &lt; 7<br/>const getName = cat =&gt; cat.name<br/><strong class="kd hv">const getKittenNames = cats =&gt;<br/>  cats.filter(isKitten)<br/>      .map(getName)</strong></span><span id="dbb1" class="km kn hu kd b fv ks kp l kq kr">const cats = [<br/>  { name: 'Mojo',    months: 84 },<br/>  { name: 'Mao-Mao', months: 34 },<br/>  { name: 'Waffles', months: 4 },<br/>  { name: 'Pickles', months: 6 }<br/>]</span><span id="af15" class="km kn hu kd b fv ks kp l kq kr">const kittens = getKittenNames(cats)</span><span id="59e5" class="km kn hu kd b fv ks kp l kq kr">console.log(kittens)</span></pre><h1 id="bfc0" class="li kn hu bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">额外学分</h1><p id="acd1" class="pw-post-body-paragraph jc jd hu je b jf mf jh ji jj mg jl jm jn mh jp jq jr mi jt ju jv mj jx jy jz hn dt translated">作为额外的奖励，进一步将<code class="eh ka kb kc kd b">filter</code>和<code class="eh ka kb kc kd b">map</code>方法从它们的对象中分离出来。还有双倍的额外学分，你可以研究函数合成。</p><div class="mk ml fm fo mm mn"><a href="https://hackernoon.com/functional-javascript-decoupling-methods-from-their-objects-aa3ca13d7ae8" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd hv fv z el ms eo ep mt er et ht dt translated">函数式JavaScript:从对象中分离方法</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">在我的项目中，我最后总是做的一件事是将方法从它们的对象中分离出来。映射、过滤和减少不是…</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">hackernoon.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ja mn"/></div></div></a></div><div class="mk ml fm fo mm mn"><a href="https://hackernoon.com/javascript-functional-composition-for-every-day-use-22421ef65a10" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd hv fv z el ms eo ep mt er et ht dt translated">函数JavaScript:日常使用的函数组合。</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">函数组合是函数式编程中我最喜欢的部分。我希望给你提供一个好的真实的…</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">hackernoon.com</p></div></div><div class="mw l"><div class="nc l my mz na mw nb ja mn"/></div></div></a></div><h1 id="5180" class="li kn hu bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">休息呢？</h1><p id="cf84" class="pw-post-body-paragraph jc jd hu je b jf mf jh ji jj mg jl jm jn mh jp jq jr mi jt ju jv mj jx jy jz hn dt translated">你们中的许多人问，“休息呢？”<strong class="je hv">看看第2部分:Break是循环的GOTO。</strong>(提示:递归)</p><div class="mk ml fm fo mm mn"><a rel="noopener follow" target="_blank" href="/@joelthoms/rethinking-javascript-break-is-the-goto-of-loops-51b27b1c85f8"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd hv fv z el ms eo ep mt er et ht dt translated">重新思考JavaScript: Break是循环的归宿</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">在我的上一篇文章《for循环之死》中，我试图说服您放弃for循环，转而使用一个更具功能性的…</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">medium.com</p></div></div><div class="mw l"><div class="nd l my mz na mw nb ja mn"/></div></div></a></div><h1 id="9d10" class="li kn hu bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">结束</h1><p id="15fe" class="pw-post-body-paragraph jc jd hu je b jf mf jh ji jj mg jl jm jn mh jp jq jr mi jt ju jv mj jx jy jz hn dt translated">请在下面的评论中让我知道你对此的感受。难道<code class="eh ka kb kc kd b">for loop</code>现在对你也死了？</p><p id="4530" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我知道这是一件小事，但当我在媒体和Twitter上收到这些后续通知时，我感到非常高兴。或者你觉得我满嘴屁话，在下面的评论里告诉我。</p><p id="fba1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">干杯！</p><h1 id="32c3" class="li kn hu bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">相关文章</h1><div class="mk ml fm fo mm mn"><a rel="noopener follow" target="_blank" href="/@joelthoms/rethinking-javascript-the-if-statement-b158a61cd6cb"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd hv fv z el ms eo ep mt er et ht dt translated">重新思考JavaScript:if语句</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">功能性思维打开了我对编程的思维。</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">medium.com</p></div></div><div class="mw l"><div class="nf l my mz na mw nb ja mn"/></div></div></a></div><div class="mk ml fm fo mm mn"><a rel="noopener follow" target="_blank" href="/@joelthoms/rethinking-javascript-eliminate-the-switch-statement-for-better-code-5c81c044716d"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd hv fv z el ms eo ep mt er et ht dt translated">重新思考JavaScript:删除switch语句以获得更好的代码</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">在我的前3篇文章中，我说服你删除if语句，取消for循环，并且不要使用break。</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">medium.com</p></div></div><div class="mw l"><div class="ng l my mz na mw nb ja mn"/></div></div></a></div><div class="mk ml fm fo mm mn"><a rel="noopener follow" target="_blank" href="/@joelthoms/functional-javascript-resolving-promises-sequentially-7aac18c4431e"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd hv fv z el ms eo ep mt er et ht dt translated">函数式JavaScript:顺序解析承诺</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">我喜欢ES6附带的新的Promise库，尽管有一点被遗漏了，那就是一个按顺序…</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">medium.com</p></div></div><div class="mw l"><div class="nh l my mz na mw nb ja mn"/></div></div></a></div><p id="dfde" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章已经为我的俄罗斯朋友翻译成了俄语。</p><div class="ke kf kg kh fq ab cb"><figure class="ni iv nj nk nl nm nn paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ni iv nj nk nl nm nn paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ni iv nj nk nl nm nn paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="no np nq"><p id="f922" class="jc jd nr je b jf jg jh ji jj jk jl jm ns jo jp jq nt js jt ju nu jw jx jy jz hn dt translated"><a class="ae ne" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ne" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ne" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ne" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd nr je b jf jg jh ji jj jk jl jm ns jo jp jq nt js jt ju nu jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ne" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ne" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ke kf kg kh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nv"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>