<html>
<head>
<title>Security vulnerabilities in Cleartrip.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Cleartrip.com的安全漏洞</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/security-vulnerabilities-in-cleartrip-com-37b6ae6b5d1?source=collection_archive---------7-----------------------#2017-05-11">https://medium.com/hackernoon/security-vulnerabilities-in-cleartrip-com-37b6ae6b5d1?source=collection_archive---------7-----------------------#2017-05-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="2a8f" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">包括整个卡细节泄露的问题</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/950ce411d9a9581f64d6cc5fc4d8bb10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TtSHMiYG4kdg_efjHOHklA.jpeg"/></div></div></figure><p id="d52a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">Cleartrip是一家印度在线旅游预订公司，为印度和其他一些中东国家的用户提供机票、火车和酒店预订等服务。</p><p id="c613" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们在Cleartrip的公共内部API中发现了多个漏洞，包括-</p><ol class=""><li id="57f7" class="ks kt hu jx b jy jz kb kc ke ku ki kv km kw kq kx ky kz la dt translated">用户全部信用卡/借记卡信息泄露，包括CVV和卡到期日期。</li><li id="6d3f" class="ks kt hu jx b jy lb kb lc ke ld ki le km lf kq kx ky kz la dt translated">用户的行程和个人信息数据，包括姓名、电话号码、酒店电子邮件、航班和Cleartrip本地预订。</li><li id="6d7a" class="ks kt hu jx b jy lb kb lc ke ld ki le km lf kq kx ky kz la dt translated">失败或正在进行的交易的用户个人信息泄露。</li><li id="89ba" class="ks kt hu jx b jy lb kb lc ke ld ki le km lf kq kx ky kz la dt translated">能够大量取消通过Cleartrip预订的所有航班。</li></ol><p id="6b12" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这些漏洞已被修复。我们从2017年2月28日开始向Cleartrip告知这些问题以及我们负责任的披露时间表。Cleartrip在修复问题的整个过程中反应迅速，我们帮助验证修复，并报告应用修复时出现的其他副作用。我们收到通知，Cleartrip已经修复了我们在2017年5月3日报告的所有漏洞。这是我们最初联系他们的推文，因为我们找不到任何与安全相关的电子邮件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lg lh l"/></div></figure></div><div class="ab cl li lj hc lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hn ho hp hq hr"><p id="e71b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">一个值得注意的问题是HTTP头泄露了一个URL，该URL包含一个连续的旅程id，而端点本身没有受到保护。卡细节泄漏发生在一个API端点上，该端点应该以隐藏的形式预填充不同支付网关的卡信息。以下数据已被编辑为用户数据隐私。稍后，我们会在自己的博客上发布这些问题的详细技术细节。</p><blockquote class="lp"><p id="04dd" class="lq lr hu bd ls lt lu lv lw lx ly kq ek translated">向API端点<em class="lz">'</em><a class="ae kr" href="https://www.cleartrip.com/payment/citruspay/redirect" rel="noopener ugc nofollow" target="_blank"><em class="lz">【https://www.cleartrip.com/payment/XXXXXX/redirect】</em></a><em class="lz">'发出一个HTTP POST请求，其中包含一个包含merchantTransactionId的数据，在本例中该数据只是一个整数，可以在一个循环中运行，该请求将在HTML表单响应中显示完整的卡详细信息。</em></p></blockquote><blockquote class="ma mb mc"><p id="2576" class="jv jw md jx b jy me iv ka kb mf iy kd mg mh kg kh mi mj kk kl mk ml ko kp kq hn dt translated"><em class="hu">&lt;input type = " hidden " name = " VPC _ secure hash " value = " 3a 189 D2 Abe 416355 e 604 c 371005445 AE 6 af 93 af 138 a 52 e 5 FCA 37 b 9 ff 185 ed 45 "/&gt;&lt;input type = " hidden " name = " VPC _ secure hashtype " value = " sha 256 "/&gt;&lt;input type = " hidden " name = " VPC _。 &gt;&lt;input type = " hidden " name = " VPC _</em><strong class="jx hv"><em class="hu">CardExp</em></strong><em class="hu"/><strong class="jx hv"><em class="hu">value = " 2110 "</em></strong><em class="hu">/&gt;&lt;input type = " hidden " name = " VPC _</em><strong class="jx hv"><em class="hu">CardSecurityCode</em></strong><em class="hu"/><strong class="jx hv"/></p></blockquote><p id="2d19" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们想再次提醒用户，假设像PCI-DSS这样的遵从性会使您免受攻击是不明智的。遵从的唯一目的是检查复选框并继续前进。大多数时候，合规性流程缺乏必要的时间和技能来发现可能被老练的黑客利用的漏洞。谈论“安全远离OWASP十大威胁”也是如此。除了OWASP十大安全漏洞之外，还有很多安全漏洞。</p><p id="e268" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在Fallible，我们的重点领域是自动检测API中的一般安全漏洞。我们认为，像HTTP APIs这样的安全漏洞需要一种技术解决方案，每个运行web服务的人都可以使用，而不是像bug bounty这样的基于流程的解决方案，这种解决方案只会使那些积极运行bug bounty并利用全球购买力差异等待有人报告问题的公司受益。在制造“智能WAFs”方面已经取得了进展，但大多数尝试都没有成功。在过去的几个月里，我们花了一些时间思考这个问题，并测试了各种替代策略。</p><div class="jk jl jm jn fq ab cb"><figure class="mm jo mn mo mp mq mr paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mm jo mn mo mp mq mr paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mm jo mn mo mp mq mr paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ma mb mc"><p id="f922" class="jv jw md jx b jy jz iv ka kb kc iy kd mg kf kg kh mi kj kk kl mk kn ko kp kq hn dt translated"><a class="ae kr" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kr" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kr" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">正在接受投稿</a>并乐意<a class="ae kr" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jv jw md jx b jy jz iv ka kb kc iy kd mg kf kg kh mi kj kk kl mk kn ko kp kq hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kr" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kr" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff ms"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>