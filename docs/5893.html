<html>
<head>
<title>How to Add User Authentication in Django Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Django框架中添加用户认证</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-add-user-authentication-in-django-framework-c2ea59fc6a3d?source=collection_archive---------12-----------------------#2017-08-22">https://medium.com/hackernoon/how-to-add-user-authentication-in-django-framework-c2ea59fc6a3d?source=collection_archive---------12-----------------------#2017-08-22</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="2010" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Django有一个用户认证系统，可以处理从用户账户和基于cookie的用户会话到组和权限的各种功能。身份验证是一种将传入请求与标识凭据(包括请求来自何处以及使用哪个令牌签名)联系起来的机制。然后，权限策略可用于允许或拒绝请求。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/47add62eebc576fcfce779523e0a77a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9pGNWgBBjXxMU7YP.jpg"/></div></div></figure><p id="2c0d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Django认证系统处理认证和授权。认证确认用户是否确实是他们所声称的那个人，而授权决定已经通过认证的用户被允许做什么。在大多数情况下，术语身份验证指的是这两项任务。<em class="kb">Django认证系统由以下部分组成:</em></p><ul class=""><li id="3d8c" class="kc kd hu it b iu iv iy iz jc ke jg kf jk kg jo kh ki kj kk dt translated">一组用户</li><li id="1ad8" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">一组权限，包括二进制是/否标志，用于确定是否允许用户执行某项任务</li><li id="55e1" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">为多个用户分组标签和权限</li><li id="2363" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">密码散列系统</li><li id="91c0" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">查看用于登录用户或限制对特定内容的访问的工具和表单</li><li id="c10b" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">后端系统</li></ul><p id="995e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">与大多数web认证系统不同，Django认证是通用的，功能相对较少。该系统使用第三方软件包为常见问题提供解决方案，如检查密码强度、限制登录尝试以及第三方身份验证(如OAuth)。</p><h1 id="0d25" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">身份验证的安装</h1><p id="7ef4" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">身份验证支持是作为contrib提供的。模块(django.contrib.auth)。默认情况下，所需的配置包含在settings.py中，该文件由django-admin startproject部分生成。在<strong class="it hv">已安装应用</strong>设置中你会发现这两项:</p><ul class=""><li id="eebc" class="kc kd hu it b iu iv iy iz jc ke jg kf jk kg jo kh ki kj kk dt translated"><em class="kb"> django.contrib.auth </em>，它拥有认证框架核心和默认模型</li><li id="f74a" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated"><em class="kb">django . contrib . content types</em>，这是系统的内容类型，允许与创建的模型相关的权限。</li></ul><p id="6fdf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<strong class="it hv">中间件</strong>设置中，你会发现这两项:</p><ul class=""><li id="93c6" class="kc kd hu it b iu iv iy iz jc ke jg kf jk kg jo kh ki kj kk dt translated"><em class="kb">会话中间件</em>处理请求会话</li><li id="a74d" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated"><em class="kb">认证中间件</em>连接用户和会话请求</li></ul><p id="bfc1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您已经有了这些设置后，您只需要运行manage.py migrate命令来创建您需要的数据库表，以便在您已安装的应用程序中执行与授权相关的任务和权限。</p><h1 id="d78b" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">如何使用Django认证系统</h1><p id="a2f1" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">随着时间的推移，Django身份验证系统一直在变化，它不断发展，以服务于大量的任务，处理项目需求，并实现安全的密码和权限。</p><p id="be16" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Django还支持广泛的扩展和定制，以处理具有不同认证需求的不同类型的项目。Django身份验证中的身份验证和授权特性在某种程度上是结合在一起的。</p><h1 id="7917" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">Django中的用户对象</h1><p id="45e3" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">Django认证系统严重依赖用户对象。这些基本上是与您的网站互动的人或用户。用户对象处理诸如限制对特定内容的访问、将内容与其创建者连接以及注册新的用户配置文件等问题。</p><p id="7338" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae lt" href="https://docs.djangoproject.com/en/1.11/topics/auth/" rel="noopener ugc nofollow" target="_blank"> Django认证框架</a>只有一个用户类。“超级用户”和管理人员用户不是不同的用户类，而是具有特定属性集的用户对象。默认用户有以下主要属性:</p><ul class=""><li id="e719" class="kc kd hu it b iu iv iy iz jc ke jg kf jk kg jo kh ki kj kk dt translated">用户名</li><li id="1959" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">西方人名的第一个字</li><li id="3a02" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">姓</li><li id="4be3" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">密码</li><li id="cdcf" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">电子邮件地址</li></ul><p id="075d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如需更详细的参考资料，您可查阅完整的API文档<a class="ae lt" href="https://docs.djangoproject.com/en/1.11/ref/contrib/auth/#django.contrib.auth.models" rel="noopener ugc nofollow" target="_blank">https://docs . djangopolympic . com/en/1.11/ref/contrib/auth/# django . contrib . auth . models</a>。</p><h1 id="82e2" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">如何创建用户</h1><p id="d8d4" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">您可以通过包含的create_user()函数直接创建用户，方法是转到django . contrib . auth . models import user。例如User = User . objects . create _ User(' Jane '，' jane@example.com '，' janepassword ')。</p><p id="4cbe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Jane现在是一个已经创建并保存在数据库中的用户对象。然后，您可以继续对属性或其他字段进行任何必要的更改，例如“user.lastname ”,然后保存在“user.save()。</p><p id="ddce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者，如果您已经安装了Django管理器，您可以通过交互方式创建用户。</p><h1 id="9b73" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">如何创建超级用户</h1><p id="64c4" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">您可以直接从createsuperuser命令创建超级用户。为此，请访问“python manage . py create super user-username = Jane-email = Jane @ example . com”。</p><p id="8d4d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您需要提供密码。用户将在您输入密码后创建。如果您将值留空，还会提示您输入值——用户名或——电子邮件。</p><h1 id="85d2" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">如何更改密码</h1><p id="f702" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">系统的用户模型不存储明文或原始密码，而是存储哈希。有关密码管理的更多详细信息，请查看此链接:<a class="ae lt" href="https://docs.djangoproject.com/en/1.11/topics/auth/passwords/" rel="noopener ugc nofollow" target="_blank">https://docs . djangoproject . com/en/1.11/topics/auth/password/。</a></p><p id="0206" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">避免直接操作用户密码属性，而是在创建用户时参考助手函数。但是，您可以通过几种方式更改用户密码。</p><ul class=""><li id="cfec" class="kc kd hu it b iu iv iy iz jc ke jg kf jk kg jo kh ki kj kk dt translated">第一种方法是通过命令行管理程序。py changepassword *username*。如果命令提示您更改用户密码，您需要输入两次密码。如果两个密码匹配，新密码将立即生效。如果您不提供用户，系统将尝试更改与当前使用系统的用户匹配的用户名密码。</li><li id="1c03" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">也可以通过set_password()函数更改密码。您可以简单地从django.contrib.auth.models导入用户中完成此操作。u = user . objects . get(username = ' Jane ')，然后u.set_password ('new password ')，并从u.save()保存新密码。</li><li id="496c" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">如果您已经从认证系统的管理页面安装了Django admin，您可以参考以下链接更改用户密码:<a class="ae lt" href="https://docs.djangoproject.com/en/1.11/topics/auth/default/#auth-admin" rel="noopener ugc nofollow" target="_blank">https://docs . Django project . com/en/1.11/topics/auth/default/# auth-admin</a></li><li id="186f" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">该系统还提供了允许所有用户随时更改密码的表单和视图。</li></ul><p id="0caa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请记住，当您更改密码时，系统会自动将您从所有活动会话中注销。</p><h1 id="7809" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">如何认证用户</h1><p id="104c" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">要验证用户，您可以使用' authenticate()'函数来验证用户凭证。该函数使用凭据作为关键字参数，使用默认情况下的用户名和密码值来验证每种情况，如果给定的凭据对后端有效，则返回用户对象。当提供的凭据对后端无效时，或者如果指定的后端以PermissionDenied响应，系统将返回None响应。</p><p id="6df4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当一个未经验证的请求被拒绝时，您将得到一个错误代码，比如HTTP 401未授权或HTTP 403权限被拒绝。因此，确保为添加到系统中的每个用户提供正确的用户名和密码值非常重要。</p></div></div>    
</body>
</html>