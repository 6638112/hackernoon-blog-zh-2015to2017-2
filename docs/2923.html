<html>
<head>
<title>Building and distributing iOS Layouts with EverLayout</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用EverLayout构建和分发iOS布局</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-and-distributing-ios-layouts-with-everlayout-c9ea41750f6?source=collection_archive---------7-----------------------#2017-02-28">https://medium.com/hackernoon/building-and-distributing-ios-layouts-with-everlayout-c9ea41750f6?source=collection_archive---------7-----------------------#2017-02-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/2cc3e8c3b08540a5fb9c1b10c7825a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wpdhvktnVE5W0uga64Qr5Q.png"/></div></div></figure><div class=""/><p id="0665" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">EverLayout是一个将JSON/XML数据转换成布局的iOS库。在这篇文章中，我想演示如何使用EverLayout为一个新的应用程序创建一个基本的登录视图。</p><p id="8341" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为什么你想用JSON而不是Xcode的界面构建器来编写你的应用程序布局，或者仅仅使用普通代码？有几个原因:</p><ul class=""><li id="e4a7" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">用<a class="ae kj" href="https://hackernoon.com/tagged/json" rel="noopener ugc nofollow" target="_blank"> JSON </a>编写的布局可以很容易地通过你的服务器分发，也可以通过你的应用程序下载。您可以根据自己的意愿随时更新应用布局，无需应用审核流程。</li><li id="84f7" class="ka kb if je b jf kk jj kl jn km jr kn jv ko jz kf kg kh ki dt translated">对于开发来说，EverLayout将连接到一个本地服务器，当你更新布局文件时，这个服务器可以提供你的布局文件。这是实时布局设计/构建—您不需要重新编译您的应用程序来查看它的外观或行为。</li><li id="c46b" class="ka kb if je b jf kk jj kl jn km jr kn jv ko jz kf kg kh ki dt translated">用代码编写布局很笨拙。它在你的控制器和视图中占据了很大的空间，不容易阅读/可视化。数据结构中描述的布局更容易阅读，并且与控制器逻辑分开。</li></ul><p id="43f1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以从<a class="ae kj" href="https://acrocat.github.io/EverLayout/" rel="noopener ugc nofollow" target="_blank">文档</a>中找到更多关于使用EverLayout的信息。</p><h1 id="5f98" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">入门指南</h1><p id="71c1" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">在这篇“教程”中，我将假设你知道如何创建一个新的iOS项目并使用Cocoapods安装框架。</p><p id="ea89" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦你建立了你的新项目，你可以像这样把EverLayout添加到你的Podfile中:</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="4d3d" class="mb kq if lx b fv mc md l me mf">pod 'EverLayout'</span></pre><p id="7552" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于实时布局构建，我将使用一个名为<a class="ae kj" href="https://github.com/acrocat/EverLayoutBridge" rel="noopener ugc nofollow" target="_blank"> EverLayout Bridge </a>的配套工具。这个应用程序是一个基本的node <a class="ae kj" href="https://hackernoon.com/tagged/http" rel="noopener ugc nofollow" target="_blank"> HTTP </a>服务器，它将与我们的应用程序通信，通过套接字发送布局更新。</p><p id="db60" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要安装EverLayout Bridge，请使用您的终端并运行:</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="2e2b" class="mb kq if lx b fv mc md l me mf">npm install -g ever-layout-bridge</span></pre><p id="db00" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">注— </strong>如果你不熟悉Node或<code class="eh mg mh mi lx b">npm</code>，你可能希望访问<a class="ae kj" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/en/</a>了解更多信息(这是相当可怕的。)</p><h1 id="c2e1" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">配置应用程序</h1><p id="8527" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">安装好一切后，我们要做的第一件事是配置我们的新应用程序与EverLayout Bridge对话。桥，当运行时，将监测我们的布局目录的变化，并将它们发送到应用程序。</p><p id="dac1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们开始吧:</p><ul class=""><li id="c567" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">创建一个布局目录，并将其添加到您的应用程序中。</li></ul><p id="6f6f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">注意— </strong>在我看来，Xcode是一个非常糟糕的JSON编辑器，所以我建议使用其他东西。还有别的吗？然而，不是由Xcode创建的文件不会自动添加到应用程序的目标，除非我们创建一个指向我们的Layouts目录的文件夹引用。您需要将Layouts目录拖到项目导航器中，并将其添加为引用。</p><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mj"><img src="../Images/8e0c1a34779f46458e2e44a76d428da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*InxSL-neNeZ0Fz-A5akaeg.png"/></div></div></figure><p id="37f6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">注意— </strong>桥还可以通过将GET请求路由到images文件夹来为应用程序提供图像。然而，我们不需要为此费心，因为我们的示例将下载图像。</p><ul class=""><li id="3eef" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">在您的项目目录中运行<code class="eh mg mh mi lx b">ever-layout-bridge</code>来启动服务器。默认情况下，它会在端口<code class="eh mg mh mi lx b">3000</code>上查找布局目录‘Layouts ’,但是这些选项可以用参数配置:<code class="eh mg mh mi lx b">ever-layout-bridge --layouts="MyLayouts” --port=”1234”</code></li><li id="3d14" class="ka kb if je b jf kk jj kl jn km jr kn jv ko jz kf kg kh ki dt translated">服务器现在正在监视我们的布局并等待我们的连接，这应该在我们的AppDelegate中启动。</li></ul><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mk"><img src="../Images/548588f893c65372149c779dc8425bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYkVyuiygfliZ6yJvztWGw.png"/></div></div></figure><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="1a1f" class="mb kq if lx b fv mc md l me mf">import UIKit<br/>import EverLayout<br/>@UIApplicationMain</span><span id="d0c3" class="mb kq if lx b fv ml md l me mf">class AppDelegate: UIResponder, UIApplicationDelegate {</span><span id="7268" class="mb kq if lx b fv ml md l me mf">var window: UIWindow?</span><span id="e7ee" class="mb kq if lx b fv ml md l me mf">func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool {</span><span id="837c" class="mb kq if lx b fv ml md l me mf">#if DEBUG<br/>EverLayoutBridge.connectToLayoutServer()<br/>#endif<br/>return true<br/>}</span></pre><ul class=""><li id="6cc5" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">在这里，我正在导入EverLayout库，并在<code class="eh mg mh mi lx b">applicationDidLoad</code>下初始化一个连接。</li></ul><p id="8178" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">注意</strong> —只有在<code class="eh mg mh mi lx b">DEBUG</code>模式下连接到网桥才有意义，这不是你在生产中想要的。</p><p id="ac7a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">双注</strong> —您的HTTP服务器可能没有使用SSL证书，这意味着我们需要允许任意连接才能工作。如果你不确定如何做到这一点，请看这个<a class="ae kj" href="http://stackoverflow.com/questions/30731785/how-do-i-load-an-http-url-with-app-transport-security-enabled-in-ios-9" rel="noopener ugc nofollow" target="_blank"> StackOverflow答案。</a></p><ul class=""><li id="a55c" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">编译应用程序，如果一切按计划进行，我们应该会在Xcode控制台和终端窗口中看到一条<code class="eh mg mh mi lx b">connected</code>消息。</li></ul><h1 id="ec44" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">加载布局</h1><p id="5444" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">现在我们的应用程序正在与服务器对话，我们希望在ViewController中加载一个布局。我知道我们实际上还没有编写布局，但这就是桥的全部目的——我们可以运行这个空白的应用程序，并在运行时构建它的布局！</p><ul class=""><li id="301e" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">在布局目录中创建一个<code class="eh mg mh mi lx b">ViewController.json</code>文件。</li></ul><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="f874" class="mb kq if lx b fv mc md l me mf">{<br/> "name":"ViewController"<br/>}</span></pre><ul class=""><li id="e350" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">此文件包含名称属性很重要，因为它用于路由布局更新。</li><li id="a3c7" class="ka kb if je b jf kk jj kl jn km jr kn jv ko jz kf kg kh ki dt translated">打开控制器文件，像这样加载布局:</li></ul><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mm"><img src="../Images/47c7c13a155b84c531d6226e26fd7c8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAyYgx2pEI7lMJ8M5E87OA.png"/></div></div></figure><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="b179" class="mb kq if lx b fv mc md l me mf">import UIKit</span><span id="b092" class="mb kq if lx b fv ml md l me mf">import EverLayout</span><span id="7151" class="mb kq if lx b fv ml md l me mf">class ViewController: UIViewController {</span><span id="01f4" class="mb kq if lx b fv ml md l me mf">private var layout : EverLayout?</span><span id="b1da" class="mb kq if lx b fv ml md l me mf">override func viewDidLoad() {</span><span id="3325" class="mb kq if lx b fv ml md l me mf">super.viewDidLoad()</span><span id="20a8" class="mb kq if lx b fv ml md l me mf">let layoutData = NSData(contentsOfFile: Bundle.main.path(forResource: "ViewController", ofType: "json", inDirectory: "Layouts")!)</span><span id="2036" class="mb kq if lx b fv ml md l me mf">self.layout = EverLayout(layoutData: layoutData as! Data)</span><span id="d922" class="mb kq if lx b fv ml md l me mf">self.layout?.buildLayout(onView: self.view, viewEnvironment: self)</span><span id="e352" class="mb kq if lx b fv ml md l me mf">}</span><span id="4fc0" class="mb kq if lx b fv ml md l me mf">}</span></pre><ul class=""><li id="32a7" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">在<code class="eh mg mh mi lx b">buildLayout</code>调用中，我们选择在控制器的视图上构建布局，但是使用<code class="eh mg mh mi lx b">self</code>作为视图环境。这是因为控制器本身将包含我们将在布局文件中引用的属性。</li><li id="c1d9" class="ka kb if je b jf kk jj kl jn km jr kn jv ko jz kf kg kh ki dt translated"><strong class="je ig">编译！如果一切顺利，这不会崩溃</strong></li></ul><h1 id="44ae" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">编写布局</h1><p id="87bf" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">如果您的应用程序正在运行，并且您已经看到了<code class="eh mg mh mi lx b">connected</code>消息，我们可以运行一个快速测试来查看布局更新是否有效。</p><ul class=""><li id="d640" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">将您的<code class="eh mg mh mi lx b">ViewController.json</code>更新为如下所示，然后点击保存。</li></ul><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="6379" class="mb kq if lx b fv mc md l me mf">{<br/> "name":"ViewController",<br/> "root":{<br/>  "properties":{<br/>   "backgroundColor":"orange"<br/>  }<br/> }<br/>}</span></pre><p id="b326" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个基本布局是将橙色背景色应用到它的<code class="eh mg mh mi lx b">root</code>，在我们的例子中是在控制器的视图中。您的应用程序应该如下所示:</p><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mn"><img src="../Images/d51163b78ba52e612298c15af7d8b428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbwpQmpCtHKNFYvIy4uXzQ.png"/></div></div></figure><p id="1bf7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，让我们创建一个真正的布局:</p><ul class=""><li id="d25a" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">回到您的控制器，添加这4个属性</li></ul><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="9dce" class="mb kq if lx b fv mc md l me mf">public let inputUsername : UITextField = UITextField()<br/>public let inputPassword : UITextField = UITextField()<br/>public let buttonRegister : UIButton = UIButton()<br/>public let buttonLogin : UIButton = UIButton()</span></pre><p id="86ca" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些属性是我们的登录逻辑所必需的，其余的我们可以用JSON构建。</p><ul class=""><li id="affa" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">从<a class="ae kj" href="http://pastebin.com/U45j1qyt" rel="noopener ugc nofollow" target="_blank">这里</a>复制JSON布局，并粘贴到你的布局文件中。点击保存和繁荣…我们有一个应用程序！</li></ul><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mo"><img src="../Images/3e8636f3cdc1116067e30364c216e68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6d78o9eCf5tVi9mrtx2q1Q.png"/></div></div></figure><p id="0804" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">EverLayout在控制器中找到了文本输入和按钮视图，并对它们应用了一组属性和布局约束。然而，我们不必为logo甚至输入标签创建属性——它们在布局中有描述，EverLayout可以动态创建它们！我们不太可能在任何逻辑中需要这些属性，那么为什么我们要在控制器中看到它们呢？</p><ul class=""><li id="f9b5" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">我们登录页面剩下的唯一一件事就是连接我们的按钮:</li></ul><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mp"><img src="../Images/f6e8294ed1f98c0b38939cb9920989b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6m2xv7Mi6ZatSjZXOmSn3A.png"/></div></div></figure><h1 id="0fd7" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">就这样</h1><p id="dc02" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">这就是EverLayout的工作方式！注意，在你启动的时候下载你的应用程序的logo并不是一个好的做法，但是我认为这是一个很好的展示，展示了它的强大之处。</p><p id="02bf" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">EverLayout仍然是一项正在进行的工作，并且在很大程度上是一项实验，如果你有兴趣了解更多关于这个项目的信息，你可以查看它的<a class="ae kj" href="https://github.com/acrocat/EverLayout" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae kj" href="https://acrocat.github.io/EverLayout/" rel="noopener ugc nofollow" target="_blank"> Docs </a>。</p><p id="c235" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">感谢阅读！</p><div class="ls lt lu lv fq ab cb"><figure class="mq hw mr ms mt mu mv paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mq hw mr ms mt mu mv paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mq hw mr ms mt mu mv paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mw mx my"><p id="f922" class="jc jd mz je b jf jg jh ji jj jk jl jm na jo jp jq nb js jt ju nc jw jx jy jz hn dt translated"><a class="ae kj" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae kj" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kj" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd mz je b jf jg jh ji jj jk jl jm na jo jp jq nb js jt ju nc jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kj" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kj" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ls lt lu lv fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nd"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="ls lt lu lv fq hw"><div class="bz el l di"><div class="ne nf l"/></div></figure></div></div>    
</body>
</html>