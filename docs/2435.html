<html>
<head>
<title>3 new ways to mock out APIs in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python模拟API的3种新方法</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/3-new-ways-to-mock-out-apis-in-python-c12510c30d79?source=collection_archive---------3-----------------------#2017-01-27">https://medium.com/hackernoon/3-new-ways-to-mock-out-apis-in-python-c12510c30d79?source=collection_archive---------3-----------------------#2017-01-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/22e92c20d7b720ee6566e125085357bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8BbOwhDKQDAOnQhjEeTrew.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Getting your tests right can be crucial</figcaption></figure><p id="7776" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在我关于主题的上一篇博客<a class="ae ke" rel="noopener" href="/@anthonypjshaw/python-requests-deep-dive-a0a5c5c1e093#.f17oeryy0">中，我谈到了如何使用<code class="eh kf kg kh ki b">requests_mock</code>模拟对REST APIs的快速而简单的响应。</a></p><ul class=""><li id="bb48" class="kj kk hu ji b jj jk jn jo jr kl jv km jz kn kd ko kp kq kr dt translated">返回大量响应，如CSV报告</li><li id="3063" class="kj kk hu ji b jj ks jn kt jr ku jv kv jz kw kd ko kp kq kr dt translated">返回二进制文件，如图像</li><li id="80f3" class="kj kk hu ji b jj ks jn kt jr ku jv kv jz kw kd ko kp kq kr dt translated">通过回调动态响应</li></ul><p id="d48b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我放在一起的是一个新的(beta)包，用于在单元测试和Python请求适配器API之间创建一个简单的桥梁。</p><p id="8ce8" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这个包叫做requests-staticmock，你可以在<a class="ae ke" href="https://github.com/tonybaloney/requests-staticmock" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae ke" href="https://pypi.python.org/pypi/requests-staticmock" rel="noopener ugc nofollow" target="_blank"> PyPi </a>找到代码。</p><p id="575f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">它提供了3种模拟API响应的新方法。</p><h2 id="fec0" class="kx ky hu bd kz la lb lc ld le lf lg lh jr li lj lk jv ll lm ln jz lo lp lq lr dt translated">模式1:将一个API模仿成一组文件</h2><p id="e6c8" class="pw-post-body-paragraph jg jh hu ji b jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd hn dt translated">考虑这个场景，您想要测试您开发的一个类，它</p><p id="1819" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">最简单的形式是，您可以使用上下文管理器将静态资产适配器注入到请求会话中。</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="mb mc l"/></div></figure><p id="6643" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果该方法不存在，它将生成404响应。</p><p id="acf5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这里有一个更详细的例子来说明如何使用它。</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="mb mc l"/></div></figure><h2 id="861e" class="kx ky hu bd kz la lb lc ld le lf lg lh jr li lj lk jv ll lm ln jz lo lp lq lr dt translated">模式2:模仿一个特定的URL，但是也使用一个真实的实例</h2><p id="7001" class="pw-post-body-paragraph jg jh hu ji b jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd hn dt translated">在这个例子中，您可能想要模拟一个特定的API，但是保持对另一个API的访问。适配器注入器(和上下文管理器模式)支持会话中的特定URL，对不匹配模式的URL保持默认的HTTP行为。</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="mb mc l"/></div></figure><h2 id="4a4f" class="kx ky hu bd kz la lb lc ld le lf lg lh jr li lj lk jv ll lm ln jz lo lp lq lr dt translated">模式3:让测试类生成响应</h2><p id="c7a7" class="pw-post-body-paragraph jg jh hu ji b jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd hn dt translated">这种模式允许您创建一个共享类，该共享类为您可能想要测试的所有URL提供回调</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="mb mc l"/></div></figure><p id="bf38" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果该方法不存在，它将生成404响应。</p><h2 id="8c1f" class="kx ky hu bd kz la lb lc ld le lf lg lh jr li lj lk jv ll lm ln jz lo lp lq lr dt translated">摘要</h2><p id="9a8d" class="pw-post-body-paragraph jg jh hu ji b jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz lw kb kc kd hn dt translated">这个库的目标是使用Python模拟给定API客户机的HTTP APIs变得非常简单。</p><p id="aec1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我正在寻找反馈，因为这是一个早期的测试版，请在GitHub上提出任何问题或功能想法。</p><div class="lx ly lz ma fq ab cb"><figure class="md iv me mf mg mh mi paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="md iv me mf mg mh mi paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="md iv me mf mg mh mi paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mj mk ml"><p id="f922" class="jg jh mm ji b jj jk jl jm jn jo jp jq mn js jt ju mo jw jx jy mp ka kb kc kd hn dt translated"><a class="ae ke" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ke" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ke" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ke" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jg jh mm ji b jj jk jl jm jn jo jp jq mn js jt ju mo jw jx jy mp ka kb kc kd hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ke" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ke" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mq"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>