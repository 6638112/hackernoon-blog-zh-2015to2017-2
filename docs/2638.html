<html>
<head>
<title>Getting started with Gulp 4 for Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular的Gulp 4入门</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/getting-started-with-gulp-4-for-angular-1280a78fa91a?source=collection_archive---------4-----------------------#2017-02-08">https://medium.com/hackernoon/getting-started-with-gulp-4-for-angular-1280a78fa91a?source=collection_archive---------4-----------------------#2017-02-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="998e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Gulp是Angular团队和许多其他专业工程师使用的构建工具。速度和简单性被吹捧为优于Grunt的优点。我又看了一眼，试图用GULP构建一个简单的SPA Angular应用程序。下面是我的故事。</p><p id="9c9e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">安装大口</strong></p><p id="4f90" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以安装大口— <a class="ae jp" href="https://github.com/gulpjs/gulp/blob/master/docs/getting-started.md" rel="noopener ugc nofollow" target="_blank">链接</a>。并创建一个gulpfile.js:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="4ea4" class="jz ka hu jv b fv kb kc l kd ke">var gulp = require('gulp');<br/><br/>gulp.task('default', function() {<br/>  // place code for your default task here<br/>});</span></pre><p id="6d8d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在运行它，它应该什么也不做。瞧啊。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="da83" class="jz ka hu jv b fv kb kc l kd ke">Genes-MacBook-Pro-2:gulp_plunge thinkjones$ gulp<br/>[18:18:56] Using gulpfile ~/dev/GeneConroyJonesArticles/gulp_plunge/gulpfile.js<br/>[18:18:56] Starting 'default'...<br/>[18:18:56] Finished 'default' after 93 μs<br/>Genes-MacBook-Pro-2:gulp_plunge thinkjones$</span></pre><p id="8e25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">到目前为止一切顺利。</p><p id="f67e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">目录结构</strong></p><p id="ceb3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，对于这个应用程序，我们将转换<em class="kf">客户端</em>目录中的文件，并将它们复制并转换到<em class="kf"> dist。</em></p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="9b7e" class="jz ka hu jv b fv kb kc l kd ke"># Dir Structure <br/>\client\  # Source Files<br/>\client\index.html</span><span id="f768" class="jz ka hu jv b fv kg kc l kd ke">\dist\    # Dist or converted files.</span></pre><p id="005f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">用</strong> <a class="ae jp" href="https://gulp.readme.io/docs/gulpdestpath-options" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">复制文件gulp . dest</strong></a><strong class="it hv"/></p><p id="4a05" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的第一个任务是复制index.html到dist文件夹。为此，我们可以使用<a class="ae jp" href="https://gulp.readme.io/docs/gulpdestpath-options" rel="noopener ugc nofollow" target="_blank"> gulp.dest </a>。一个内置的吞咽命令。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="919f" class="jz ka hu jv b fv kb kc l kd ke">gulp.task('default', <strong class="jv hv">function</strong>() {<br/>    gulp.src('./client/index.html')<br/>        .pipe(gulp.dest('./dist/index.html'))<br/>});</span></pre><p id="554a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后运行<code class="eh kh ki kj jv b">gulp</code></p><p id="b9cd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这看起来不错吧？<strong class="it hv">错了</strong></p><p id="eb3f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这实际上是将项目复制到一个文件夹<code class="eh kh ki kj jv b">/dist/index.html/index.html</code></p><p id="0359" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Gulp.dest需要一个文件夹作为目的地。你真正需要的是:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="cd48" class="jz ka hu jv b fv kb kc l kd ke">gulp.task('default', <strong class="jv hv">function</strong>() {<br/>    gulp.src('./client/index.html')<br/>        .pipe(gulp.dest('./dist'))<br/>});</span></pre><p id="2b1b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，如果您尝试运行下一步，您将得到一个目录权限错误。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="65d5" class="jz ka hu jv b fv kb kc l kd ke">events.js:160<br/>      throw er; // Unhandled 'error' event<br/>      ^</span><span id="1308" class="jz ka hu jv b fv kg kc l kd ke">Error: EISDIR: illegal operation on a directory, open '/Users/thinkjones/dev/GeneConroyJonesArticles/gulp_plunge/dist/index.html'<br/>Genes-MacBook-Pro-2:gulp_plunge thinkjones$</span></pre><p id="8444" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是因为在运行之前没有清理目录。随后在谷歌上快速搜索，结果是需要为<em class="kf"> gulp.series </em>安装Gulp 4，并通过<em class="kf"> npm安装<em class="kf"> del </em>。</em>新<em class="kf"> gulpfile.js </em>:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="1f70" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">var </strong>gulp = require('gulp');<br/><strong class="jv hv">var </strong>del = require('del');<br/><br/>gulp.task('default',  gulp.series(clean, copyIndex));<br/><br/><strong class="jv hv">function </strong>clean(done) {<br/>    del(['dist']);<br/>    done();  # Async callback for completion.<br/>}<br/><br/><strong class="jv hv">function </strong>copyIndex(done) {<br/>    <strong class="jv hv">return </strong>gulp.src('./client/index.html').pipe(gulp.dest('./dist', {overwrite: <strong class="jv hv">true</strong>}));<br/>}</span></pre><p id="b6b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">GULP的好处在于你可以很好地将任务模块化成函数。</p><p id="ea65" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在成功运行<strong class="it hv">的</strong>给了我们大口:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="474b" class="jz ka hu jv b fv kb kc l kd ke">Genes-MacBook-Pro-2:gulp_plunge thinkjones$ gulp<br/>[18:53:32] Using gulpfile ~/dev/GeneConroyJonesArticles/gulp_plunge/gulpfile.js<br/>[18:53:32] Starting 'default'...<br/>[18:53:32] Starting 'clean'...<br/>[18:53:33] Finished 'clean' after 6.5 ms<br/>[18:53:33] Starting 'copyIndex'...<br/>[18:53:33] Finished 'copyIndex' after 28 ms<br/>[18:53:33] Finished 'default' after 37 ms</span></pre><p id="d4b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">输出不错。让我们查一下目录:</p><figure class="jq jr js jt fq kl fe ff paragraph-image"><div class="fe ff kk"><img src="../Images/60145657151d9ea718ac49bdf16eb896.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*myjyH9gFlSFJN1UqQ4cUEg.png"/></div></figure><p id="439f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完美。让我们在这里添加一个角度应用程序。</p><p id="9af6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">添加角度App </strong></p><p id="d5cf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">鲍尔似乎变得不太受欢迎，这似乎没有必要，因为我们已经有了npm。让我们使用NPM安装Angular。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="f485" class="jz ka hu jv b fv kb kc l kd ke">npm install angular # installs to ./node_modules/angular.js</span></pre><p id="39c2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们参考我们index.html档案中的文件。我们稍后(可能)会改变这一点，但让我们假设我们现在正在这样做。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="698f" class="jz ka hu jv b fv kb kc l kd ke">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;title&gt;Gulp Plunge&lt;/title&gt;<br/><br/>    &lt;!-- Vendor Files --&gt;<br/>    &lt;script src="/node_modules/angular/angular.js"&gt;&lt;/script&gt;<br/><br/>    &lt;!-- App Files --&gt;<br/>    &lt;script src="/app/app.js"&gt;&lt;/script&gt;<br/><br/>&lt;/head&gt;<br/>&lt;body ng-app="app"&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ddde" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在让我们提供这个文件，看看它看起来像什么:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="2313" class="jz ka hu jv b fv kb kc l kd ke">npm install --save-dev http-server<br/>node ./node_modules/http-server/bin/http-server dist</span></pre><p id="250a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们知道这将会失败，因为我们已经添加了一个app.js，并且没有将其复制到dist目录中。所以我添加了一个新的copyAppJs函数:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="6f31" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">var </strong>gulp = require('gulp');<br/><strong class="jv hv">var </strong>del = require('del');<br/><br/>gulp.task('default',  gulp.series(clean, copyIndex, copyAppJs));<br/><br/><strong class="jv hv">function </strong>clean(done) {<br/>    del(['dist/**/*.*']);<br/>    done();<br/>}<br/><br/><strong class="jv hv">function </strong>copyIndex(done) {<br/>    <strong class="jv hv">return </strong>gulp.src('./client/index.html').pipe(gulp.dest('./dist', {overwrite: <strong class="jv hv">true</strong>}));<br/>    done();<br/>}<br/><br/><strong class="jv hv">function </strong>copyAppJs(done) {<br/>    <strong class="jv hv">return </strong>gulp.src('./client/**/*.js').pipe(gulp.dest('./dist', {overwrite: <strong class="jv hv">true</strong>}));<br/>    done();<br/>}</span></pre><p id="127e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新运行GULP后问题得到解决。</p><p id="90db" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是仍然有一个角度问题:</p><figure class="jq jr js jt fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="fe ff ko"><img src="../Images/b32ce24aea9b014bc21838db82425c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9AV8vaKnsVfBJKqTxHnzpg.png"/></div></div></figure><p id="7ac6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">node_modules文件夹位于根目录中，因此也需要复制到dist。由于这涉及到一个<em class="kf">供应商</em>代码，让我们来看看添加供应商资产的潜在模式。</p><p id="6409" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">用GULP添加供应商资产。</strong></p><p id="2e68" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于大型应用程序，你会希望将供应商的代码与你的应用程序代码分开。原因是在开发时，你的应用程序代码会比供应商的代码更频繁地改变，所以为了保持<em class="kf">的速度，不编译所有东西，只编译应用程序中的资产是有益的。此外，供应商代码的添加略有不同。你可能会把所有东西都放在你的<strong class="it hv"> app </strong>文件夹中，但你可能只会放入来自<strong class="it hv">供应商</strong>安装的某些文件。让我们看看如何使用GULP来管理这个过程。</em></p><p id="7d5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因为每个工程师都喜欢DRY，所以让我们在一个地方指定供应商文件，然后根据需要使用它们来填充dist/index.html和任何其他相关资产。</p><p id="87ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">供应商源代码将被推送到<code class="eh kh ki kj jv b">/dist/vendor:</code></p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="4c50" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">function </strong>copyVendor(done) {<br/>    <strong class="jv hv">var </strong>vendor_files = ['./node_modules/angular/angular.js'];<br/>    <strong class="jv hv">return </strong>gulp.src(vendor_files).pipe(gulp.dest('./dist/vendor', {overwrite: <strong class="jv hv">true</strong>}));<br/>}</span></pre><p id="c702" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">哪些副本。/node _ modules/angular/angular . js '到/vendor/angular.js</p><p id="c115" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从表面上看，这很好，但它缺少包文件夹。这可能会导致冲突或无意的覆盖。我们真正需要的是将它复制到:</p><p id="ef25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">/dist/vendor/angle/angular . js</p><p id="5934" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了保持原来的目录结构或者它的一部分，你可以使用<a class="ae jp" href="https://github.com/gulpjs/gulp/blob/master/docs/recipes/maintain-directory-structure-while-globbing.md" rel="noopener ugc nofollow" target="_blank">基本选项</a></p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="7aa2" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">function </strong>copyVendor(done) {<br/>    <strong class="jv hv">var </strong>vendor_files = ['./node_modules/angular/angular.js'];<br/>    <strong class="jv hv">return </strong>gulp.src(vendor_files, {base: './node_modules'}).pipe(gulp.dest('./dist/vendor', {overwrite: <strong class="jv hv">true</strong>}));<br/>    done();<br/>}</span></pre><p id="0a7a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">耶！</p><figure class="jq jr js jt fq kl fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/5d2c14388ac0346efc57795f8fb2d6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*-D3tezn5ODVwvYdpRgHLkg.png"/></div></figure><p id="bdad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新运行gulp并刷新应用程序会产生一个完全正常工作的应用程序。</p><p id="899c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，令人沮丧的是，每次都必须重新运行gulp。让我们看看让手表走起来有多容易。</p><p id="5173" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> Gulp-watch —在进行更改时自动更新您的应用程序代码</strong></p><p id="dc94" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，让我们添加一个新函数，并将其分配给一个任务:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="faf7" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">function </strong>watchAppJs(done) {<br/>    <strong class="jv hv">return </strong>gulp.watch('./client/**/*.*', gulp.series(clean, copyIndex, copyAppJs, copyVendor));<br/>}</span><span id="375b" class="jz ka hu jv b fv kg kc l kd ke">gulp.task('watch', gulp.series(watchAppJs));</span></pre><p id="9fae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，当我编辑app.js .时，我在终端中看到以下内容:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="c7f3" class="jz ka hu jv b fv kb kc l kd ke">[19:42:40] Using gulpfile ~/dev/GeneConroyJonesArticles/gulp_plunge/gulpfile.js<br/>[19:42:40] Starting 'watch'...<br/>[19:42:40] Starting 'watchAppJs'...<br/>[19:42:52] Starting 'clean'...<br/>[19:42:52] Finished 'clean' after 4.98 ms<br/>[19:42:52] Starting 'copyIndex'...<br/>[19:42:52] Finished 'copyIndex' after 45 ms<br/>[19:42:52] Starting 'copyAppJs'...<br/>[19:42:52] Finished 'copyAppJs' after 6.72 ms<br/>[19:42:52] Starting 'copyVendor'...<br/>[19:42:52] Finished 'copyVendor' after 20 ms</span></pre><p id="0d90" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那很容易。</p><p id="9b3a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那么接下来呢？</p><p id="bfa4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">确保index.html包含最新的供应商文件。</p><p id="959f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以现在真正让我恼火的是我在index.html中维护厂商文件:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="49f3" class="jz ka hu jv b fv kb kc l kd ke">&lt;head&gt;<br/>    &lt;title&gt;Gulp Plunge&lt;/title&gt;<br/><br/>    &lt;!-- Vendor Files --&gt;<br/>    &lt;script src="/vendor/angular/angular.js"&gt;&lt;/script&gt;<br/><br/>    &lt;!-- App Files --&gt;<br/>    &lt;script src="/app/app.js"&gt;&lt;/script&gt;<br/><br/>&lt;/head&gt;</span></pre><p id="c032" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">和gulpfile.js:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="40af" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">function </strong>copyVendor(done) {<br/>    <strong class="jv hv">var </strong>vendor_files = ['./node_modules/angular/angular.js'];<br/>    <strong class="jv hv">return </strong>gulp.src(vendor_files, {base: './node_modules'}).pipe(gulp.dest('./dist/vendor', {overwrite: <strong class="jv hv">true</strong>}));<br/>}</span></pre><p id="7f0d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于<em class="kf"> gulpfile.js </em>是事实的来源，我们希望用正确的依赖资产自动填充<em class="kf"> dist/index.html </em>。<a class="ae jp" href="https://www.npmjs.com/package/gulp-inject" rel="noopener ugc nofollow" target="_blank">吞咽注射</a>似乎是个不错的选择。安装:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="2bf7" class="jz ka hu jv b fv kb kc l kd ke">npm install --save-dev gulp-inject</span></pre><p id="ed25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后修改index.html以添加模板标记来指定写入资产的位置:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="aa61" class="jz ka hu jv b fv kb kc l kd ke">&lt;!-- Vendor Files --&gt;<br/>&lt;!-- app:js --&gt;<br/>&lt;!-- endinject --&gt;</span></pre><p id="fdd9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后告诉大口注射:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="8a5e" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">var </strong>vendor_files = ['./node_modules/angular/angular.js'];</span><span id="1084" class="jz ka hu jv b fv kg kc l kd ke"><strong class="jv hv">function </strong>copyIndex(done) {<br/>    <strong class="jv hv">var </strong>sources = gulp.src(vendor_files, {read: <strong class="jv hv">false</strong>});<br/>    <strong class="jv hv">return </strong>gulp.src('./client/index.html')<br/>        .pipe(inject(sources, {name: 'app'}))<br/>        .pipe(gulp.dest('./dist', {overwrite: <strong class="jv hv">true</strong>}));<br/>}</span></pre><p id="e9ee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在dist/index.html看起来像这样:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="ea3f" class="jz ka hu jv b fv kb kc l kd ke">&lt;!-- Vendor Files --&gt;<br/>&lt;!-- app:js --&gt;<br/>&lt;script src="/node_modules/angular/angular.js"&gt;&lt;/script&gt;<br/>&lt;!-- endinject --&gt;</span></pre><p id="2041" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这没问题，但是文件再次指向node_modules。我们的网络服务器从。/vendor/angular/angular.js。因此，我们需要在过程中操作这些文件。我们可以通过吞咽注射的<em class="kf">忽略路径</em>和<em class="kf">添加前缀</em>选项来实现。<em class="kf"> ignorePath </em>可以删除前缀文件夹<em class="kf"> addPrefix </em>可以添加新的位置。</p><p id="c3fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">函数copy-index现在变成:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="a30c" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">function </strong>copyIndex(done) {<br/>    <strong class="jv hv">var </strong>sources = gulp.src(vendor_files, {read: <strong class="jv hv">false</strong>});<br/>    <strong class="jv hv">return </strong>gulp.src('./client/index.html')<br/>        .pipe(inject(sources, {name: 'app', ignorePath: 'node_modules', addPrefix: 'vendor' }))<br/>        .pipe(gulp.dest('./dist', {overwrite: <strong class="jv hv">true</strong>}));<br/>}</span></pre><p id="5e63" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">运行gulp时，供应商文件指向正确的dist位置:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="6a0f" class="jz ka hu jv b fv kb kc l kd ke">&lt;head&gt;<br/>    &lt;title&gt;Gulp Plunge&lt;/title&gt;<br/><br/>    &lt;!-- Vendor Files --&gt;<br/>    &lt;!-- app:js --&gt;<br/>    &lt;script src="/vendor/angular/angular.js"&gt;&lt;/script&gt;<br/>    &lt;!-- endinject --&gt;<br/><br/>    &lt;!-- App Files --&gt;<br/>    &lt;script src="/app/app.js"&gt;&lt;/script&gt;<br/><br/>&lt;/head&gt;</span></pre><p id="869a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我喜欢这种方法的原因是因为在<em class="kf"> gulpfile.js </em>中，我们指定了文件的实际位置:</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="66b0" class="jz ka hu jv b fv kb kc l kd ke"><strong class="jv hv">var </strong>vendor_files = ['./node_modules/angular/angular.js'];</span></pre><p id="b6ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">并且当需要它们存在于不同的位置时，根据需要对它们进行操作。</p><p id="cfc5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://github.com/thinkjones/GeneConroyJonesArticles/tree/master/gulp_plunge" rel="noopener ugc nofollow" target="_blank">代码位于此处</a></p><p id="b8dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">还有很多其他的东西可以看，但是到目前为止，我喜欢我所看到的。在后续文章中，我们将了解:</p><ol class=""><li id="5946" class="ku kv hu it b iu iv iy iz jc kw jg kx jk ky jo kz la lb lc dt translated">少编译</li><li id="d21f" class="ku kv hu it b iu ld iy le jc lf jg lg jk lh jo kz la lb lc dt translated">HTML模板化</li><li id="d638" class="ku kv hu it b iu ld iy le jc lf jg lg jk lh jo kz la lb lc dt translated">缩小和版本化</li><li id="7863" class="ku kv hu it b iu ld iy le jc lf jg lg jk lh jo kz la lb lc dt translated">自动化karma配置和单元测试。</li></ol><div class="jq jr js jt fq ab cb"><figure class="li kl lj lk ll lm ln paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="li kl lj lk ll lm ln paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="li kl lj lk ll lm ln paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lo lp lq"><p id="f922" class="ir is kf it b iu iv iw ix iy iz ja jb lr jd je jf ls jh ji jj lt jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是AMI家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is kf it b iu iv iw ix iy iz ja jb lr jd je jf ls jh ji jj lt jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jq jr js jt fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="fe ff lu"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>