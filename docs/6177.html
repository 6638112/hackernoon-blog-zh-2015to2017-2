<html>
<head>
<title>E2E Testing AngularJS applications with TestCafe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">E2E用TestCafe测试AngularJS应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/e2e-testing-angularjs-applications-with-testcafe-96108abe4bec?source=collection_archive---------10-----------------------#2017-09-06">https://medium.com/hackernoon/e2e-testing-angularjs-applications-with-testcafe-96108abe4bec?source=collection_archive---------10-----------------------#2017-09-06</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c6f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你用<a class="ae jp" href="https://angularjs.org/" rel="noopener ugc nofollow" target="_blank"> AngularJS </a>写字，那么你首先想到的很可能是用量角器测试。但这是唯一的选择吗？如果你对其他选择感到好奇，请继续阅读。</p><p id="dde9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本教程中，我将展示如何使用<a class="ae jp" href="https://devexpress.github.io/testcafe/" rel="noopener ugc nofollow" target="_blank"> TestCafe </a>测试<a class="ae jp" href="https://hackernoon.com/tagged/angularjs" rel="noopener ugc nofollow" target="_blank"> AngularJS </a>应用。</p><h1 id="43dc" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">设置</h1><p id="524b" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">TestCafe是一个<a class="ae jp" href="https://hackernoon.com/tagged/nodejs" rel="noopener ugc nofollow" target="_blank"> Node.js </a>解决方案。所以你需要安装一个<a class="ae jp" href="https://nodejs.org" rel="noopener ugc nofollow" target="_blank"> Node.js </a>版本4.x及更高版本。</p><p id="3294" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在让我们从npm安装TestCafe和<code class="eh kt ku kv kw b">testcafe-angular-selectors</code> <a class="ae jp" href="https://github.com/DevExpress/testcafe-angular-selectors" rel="noopener ugc nofollow" target="_blank">插件</a>:</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="9cea" class="lf jr hu kw b fv lg lh l li lj">npm install testcafe<br/>npm install testcafe-angular-selectors</span></pre><p id="8d4c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就这样，其他所有东西都从盒子里出来了。TestCafe不使用WebDriver。如果你想知道如何以及为什么，看看常见问题解答。</p><h1 id="52c6" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">进行第一次测试</h1><p id="008e" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">让我们做一个简单的测试并运行它。在本教程中，我们将使用<a class="ae jp" href="http://todomvc.com/examples/angularjs/#/" rel="noopener ugc nofollow" target="_blank"> TodoMVC </a>应用程序。</p><p id="fd34" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建一个<code class="eh kt ku kv kw b">test.js</code>文件，并将下面的代码复制到其中。</p><figure class="kx ky kz la fq lk"><div class="bz el l di"><div class="ll lm l"/></div></figure><p id="0b1c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这个测试中，我们已经检查了应用程序标题等于<code class="eh kt ku kv kw b">todos</code>。这里<code class="eh kt ku kv kw b">test</code>代表一个单独的测试用例。而<code class="eh kt ku kv kw b">fixture</code>就是这些测试中的一套。要了解更多关于测试结构的信息，请查阅<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/test-api/test-code-structure.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="31bb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要运行测试，在与<code class="eh kt ku kv kw b">test.js</code>相同的文件夹中创建<code class="eh kt ku kv kw b">package.js</code>文件。将以下代码复制到这个新文件中:</p><figure class="kx ky kz la fq lk"><div class="bz el l di"><div class="ll lm l"/></div></figure><p id="d91c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们可以使用以下命令运行测试:</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="60ff" class="lf jr hu kw b fv lg lh l li lj">npm test</span></pre><figure class="kx ky kz la fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff ln"><img src="../Images/f1b0ab9781de81c67d6198e1df289a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5dQz_cwZOnWE49FPVUkuLQ.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">Results of the first test run</figcaption></figure><p id="5153" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试通过了。默认情况下，TestCafe在您启动测试的shell中显示报告。这些报告用<a class="ae jp" href="https://github.com/DevExpress/testcafe-reporter-spec" rel="noopener ugc nofollow" target="_blank">规范</a>表示，这是一种人类可读的报告格式。如果你想使用其他格式(例如json、xUnit、Slack messages)，你可以尝试一个<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/using-testcafe/common-concepts/reporters.html" rel="noopener ugc nofollow" target="_blank">现有插件</a>或者在<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/extending-testcafe/reporter-plugin/" rel="noopener ugc nofollow" target="_blank">官方教程</a>的帮助下创建自己的插件。</p><h1 id="510b" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">使用角度选择器</h1><p id="7a2e" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">让我们修改测试来与页面元素交互。</p><figure class="kx ky kz la fq lk"><div class="bz el l di"><div class="ll lm l"/></div></figure><p id="da93" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们添加了新的选择器:<code class="eh kt ku kv kw b">byModel</code>和<code class="eh kt ku kv kw b">byRepeater</code>。它们来自我们之前安装的插件<code class="eh kt ku kv kw b">testcafe-angular-selectors</code> <a class="ae jp" href="https://github.com/DevExpress/testcafe-angular-selectors" rel="noopener ugc nofollow" target="_blank">。<code class="eh kt ku kv kw b">byModel</code>通过ng-model表达式查找元素。而<code class="eh kt ku kv kw b">byRepeater</code>通过ng-repeat表达式找到元素。</a></p><p id="0872" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如您所见，我们首先检查todo项的数量是否等于0。然后我们键入<code class="eh kt ku kv kw b">Item 1</code>并按回车键。接下来，我们添加两个断言:一个检查现在是否有1个元素，另一个检查这个元素的文本是否等于<code class="eh kt ku kv kw b">Item 1</code>。</p><p id="7740" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们用<code class="eh kt ku kv kw b">npm test</code>命令再次运行测试，看看它是否通过了。</p><figure class="kx ky kz la fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff ln"><img src="../Images/1a615acfec759e12cd058cceb84b1aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Xi_DiVnWDNOHOTzy-3HGw.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">Results of the second test run</figcaption></figure><h1 id="d5b6" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">在各种浏览器中运行测试</h1><p id="5b83" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">TestCafe支持最新版本的流行浏览器。使用<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/using-testcafe/common-concepts/browser-support.html#browsers-in-cloud-testing-services" rel="noopener ugc nofollow" target="_blank">插件</a>，你可以在云浏览器提供商中运行你的测试。在文档中阅读更多关于<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/using-testcafe/common-concepts/browser-support.html" rel="noopener ugc nofollow" target="_blank">浏览器支持的信息。</a></p><p id="b165" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">TestCafe本身会检测你在本地机器上安装了哪些浏览器。要在几个浏览器中运行测试，请用逗号分隔它们。给<code class="eh kt ku kv kw b">package.json</code>增加一条命令:</p><figure class="kx ky kz la fq lk"><div class="bz el l di"><div class="ll lm l"/></div></figure><p id="7094" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在开始测试:</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="f80f" class="lf jr hu kw b fv lg lh l li lj">npm run test-in-chrome-and-ff</span></pre><figure class="kx ky kz la fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff ln"><img src="../Images/73c795b30582dcaa92186fa50516d51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CnN2se1ywqmEIaIcps8qA.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">Results for the tests launched in Chrome and Firefox</figcaption></figure><p id="359f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者使用单词<code class="eh kt ku kv kw b">all</code>在TestCafe已经找到的所有浏览器中运行测试。将以下行添加到<code class="eh kt ku kv kw b">package.json</code>文件中:</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="b932" class="lf jr hu kw b fv lg lh l li lj">"testcafe-in-all-browsers": "testcafe all test.js"</span></pre><p id="993e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试在您指定的所有浏览器中同时执行。您还可以在同一个浏览器的几个实例中同时运行测试。这使得测试批次完成得更快。更多信息见<a class="ae jp" href="https://devexpress.github.io/testcafe/blog/testcafe-v0-17-0-released.html#concurrent-test-execution-1165" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h1 id="b397" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">查看失败测试的报告</h1><p id="7279" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">让我们修改测试来查看失败测试的报告。更改最后一个断言，使测试失败:</p><figure class="kx ky kz la fq lk"><div class="bz el l di"><div class="ll lm l"/></div></figure><p id="9ff9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">再次启动测试以查看错误报告。</p><figure class="kx ky kz la fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff ln"><img src="../Images/b21436b14b7c108fd50747c8fbbede33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aRnJMxWrrFSistkp-it5sw.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">TestCafe highlights the line where the assertion has failed</figcaption></figure><p id="fc1c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于每个失败的测试，TestCafe报告浏览器、调用点和其他细节，让您可以快速找到失败的原因。为了修复测试，我们应该在最后一个断言中用1替换2。</p><h1 id="35ac" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">扩展TestCafe功能</h1><p id="26ac" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">你可以访问GitHub了解更多关于<a class="ae jp" href="https://github.com/DevExpress/testcafe#testcafe-ecosystem" rel="noopener ugc nofollow" target="_blank"> TestCafe生态系统</a>的信息。如果您需要测试代码中的更多功能，您可以使用任何node.js模块。TestCafe还为使用便携式和远程浏览器的<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/extending-testcafe/browser-provider-plugin/" rel="noopener ugc nofollow" target="_blank">提供了扩展功能</a>和定制测试报告的<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/extending-testcafe/reporter-plugin/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a0f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想制作自己的插件，查看文档中的<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/extending-testcafe/" rel="noopener ugc nofollow" target="_blank">提示。你也可以向TestCafe开发者发送一个快速通知，与社区分享你的插件(通过</a><a class="ae jp" href="https://github.com/DevExpress/testcafe/issues" rel="noopener ugc nofollow" target="_blank"> GitHub issue </a>或<a class="ae jp" href="https://twitter.com/DXTestCafe" rel="noopener ugc nofollow" target="_blank"> Twitter </a>)。</p><h1 id="6993" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">结论</h1><p id="af1a" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">现在您已经看到了如何在AngularJS应用程序中使用TestCafe进行e2e测试。您可以自己尝试一下，看看它是否符合您的测试需求。别忘了在twitter上用<code class="eh kt ku kv kw b">#TestCafe</code>标签分享你的想法。</p><p id="4c6a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">' testcafe-angular-selectors '插件扩展了<a class="ae jp" href="https://devexpress.github.io/testcafe/documentation/test-api/selecting-page-elements/selectors.html" rel="noopener ugc nofollow" target="_blank">内置的testcafe元素选择器</a>。这个插件增加了方法(<code class="eh kt ku kv kw b">byModel</code>、<code class="eh kt ku kv kw b">byBinding</code>、T19)等。)允许您通过AngularJS绑定来查找元素。Angular (v2.x)的插件也即将推出。它将提供组件选择器，允许通过Angular的组件标签名称访问元素。</p><p id="99a9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要了解新闻和更新，请在Twitter上关注<a class="ae jp" href="https://twitter.com/DXTestCafe" rel="noopener ugc nofollow" target="_blank">test cafe</a>。如果你有任何问题，可以在<a class="ae jp" href="https://testcafe-discuss.devexpress.com/" rel="noopener ugc nofollow" target="_blank">论坛</a>或者浏览<a class="ae jp" href="https://github.com/DevExpress/testcafe/issues" rel="noopener ugc nofollow" target="_blank"> GitHub问题页面</a>提问。</p><figure class="kx ky kz la fq lk"><div class="bz el l di"><div class="ly lm l"/></div></figure></div></div>    
</body>
</html>