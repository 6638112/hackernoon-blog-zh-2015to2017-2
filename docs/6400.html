<html>
<head>
<title>How I built a Content Management System for a React app in one day</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何在一天之内为React应用程序构建了一个内容管理系统</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-i-built-a-content-management-system-for-a-react-app-in-one-day-269df17f5509?source=collection_archive---------0-----------------------#2017-09-16">https://medium.com/hackernoon/how-i-built-a-content-management-system-for-a-react-app-in-one-day-269df17f5509?source=collection_archive---------0-----------------------#2017-09-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/7fdac9e206b2c4b8bffed989710d1c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NE3gWTfTTXBJ8OseFVImEw.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">DYI content management system with Firebase &amp; React</figcaption></figure><div class=""/><div class=""><h2 id="23a6" class="pw-subtitle-paragraph jg ii ij bd b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ek translated">Firebase + React =快速DIY CMS</h2></div><p id="f5f8" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">有两种处理网站内容的方法:</p><ol class=""><li id="c377" class="ku kv ij ka b kb kc ke kf kh kw kl kx kp ky kt kz la lb lc dt translated">使用CMS。</li><li id="274b" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">代码本身中的副本/图像URL中的硬代码。</li></ol><p id="f77d" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">第二种选择一开始更快，对于在一个国家运营的早期创业公司来说也不错。然而，随着公司规模的扩大，两大问题将会浮出水面并不断加剧。</p><p id="535e" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">这两个问题中的第一个，我其实在工作中亲身经历过多次。</p><h2 id="2da7" class="li lj ij bd lk ll lm ln lo lp lq lr ls kh lt lu lv kl lw lx ly kp lz ma mb mc dt translated">问题1:工程师浪费了时间</h2><p id="6a62" class="pw-post-body-paragraph jy jz ij ka b kb md jk kd ke me jn kg kh mf kj kk kl mg kn ko kp mh kr ks kt hn dt translated">每次需要进行内容更改时，产品团队都需要向工程师寻求帮助，而工程师则需要:</p><ol class=""><li id="7f0f" class="ku kv ij ka b kb kc ke kf kh kw kl kx kp ky kt kz la lb lc dt translated">停下他们正在做的事情</li><li id="0c61" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">钻研代码</li><li id="2d06" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">更改副本</li><li id="78e4" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">创建拉式请求</li><li id="6b0a" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">请审阅PR</li><li id="165e" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">合并到母版</li><li id="3efa" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">部署</li></ol><p id="3ff3" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">整个过程最多需要半小时到四十五分钟。然而，机会成本要大得多，因为工程师本可以把时间花在更重要的任务上。</p><p id="3389" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">如果换副本是瞬间的，岂不是很神奇？</p><h2 id="e629" class="li lj ij bd lk ll lm ln lo lp lq lr ls kh lt lu lv kl lw lx ly kp lz ma mb mc dt translated">问题2:国际化</h2><p id="ebbe" class="pw-post-body-paragraph jy jz ij ka b kb md jk kd ke me jn kg kh mf kj kk kl mg kn ko kp mh kr ks kt hn dt translated">如果英文版本是硬编码的，网站只能以英文显示。如果公司在非英语国家走向国际，这肯定会是一个问题。</p><h1 id="e6d7" class="mi lj ij bd lk mj mk ml lo mm mn mo ls jp mp jq lv js mq jt ly jv mr jw mb ms dt translated">解决办法</h1><p id="0376" class="pw-post-body-paragraph jy jz ij ka b kb md jk kd ke me jn kg kh mf kj kk kl mg kn ko kp mh kr ks kt hn dt translated">这两个问题的解决方案是一个好的内容管理系统。</p><p id="cfaf" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated"><a class="ae mt" href="http://pillow.com" rel="noopener ugc nofollow" target="_blank">枕头</a>，我现在工作的地方，上周举行了一次黑客马拉松。主题是生产力。我认为建立一个CMS来解决第一个问题会让产品和工程团队更有效率。</p><p id="5f5b" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">此外，我希望我的CMS不仅能解决第一个问题，还能在将来提供处理第二个问题的方法。</p><p id="1576" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">一天？是的，这就是建立一个简单有效的CMS所需要的一切。</p><h2 id="1dab" class="li lj ij bd lk ll lm ln lo lp lq lr ls kh lt lu lv kl lw lx ly kp lz ma mb mc dt translated">工艺:React + Firebase</h2><p id="d93a" class="pw-post-body-paragraph jy jz ij ka b kb md jk kd ke me jn kg kh mf kj kk kl mg kn ko kp mh kr ks kt hn dt translated">Firebase是一个实时的NoSQL云托管数据库。任何人都可以注册一个gmail帐户，创建一个项目，并向数据库添加数据。</p><p id="c438" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">因为NoSQL的结构，我认为这将是一个伟大的方式来存储网站副本。这是我在黑客马拉松期间为构建Pillow的登录页面所做的工作:</p><figure class="mv mw mx my fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mu"><img src="../Images/d7eb1493aca22fbe04706916cbce6323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZqsN4T9Dqc3R-H18_8DUQw.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Screenshot of json data structure</figcaption></figure><p id="2fb3" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">Pillow的网站已经用React建立起来了，这让我的工作轻松了很多。</p><p id="7190" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">在这方面，我所需要做的就是安装<a class="ae mt" href="https://github.com/tylermcginnis/re-base" rel="noopener ugc nofollow" target="_blank"> re-base </a>，设置一些配置，并替换硬拷贝。是一个npm包，它提供了方便的方法来轻松地与Firebase同步数据。回购有很好的设置文件，所以我不会在这里进入太多的细节。</p><p id="e2d9" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">我用了<code class="eh mz na nb nc b">listenTo</code>函数和Firebase同步。然后，我使用dispatch将数据加载到状态中。因此，<code class="eh mz na nb nc b">re-base</code>与Redux配合得很好。</p><pre class="mv mw mx my fq nd nc ne nf aw ng dt"><span id="9b33" class="li lj ij nc b fv nh ni l nj nk">componentWillMount() {<br/>    const { dispatch } = this.props</span><span id="04a1" class="li lj ij nc b fv nl ni l nj nk">    base.listenTo('en', {<br/>      context: this,<br/>      then(copies) {<br/>        dispatch( loadCopies( language, copies ) )<br/>      },<br/>      onFailure(error) {<br/>        console.log('error', error)<br/>      }<br/>    })<br/>}</span></pre><p id="c9aa" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">我的<code class="eh mz na nb nc b">loadCopies</code>动作调用一个reducer返回一个加载了副本的新状态。</p><p id="6260" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">在我的组件的render方法中，我使用了存储在状态中的副本，而不是任何硬编码的东西。</p></div><div class="ab cl nm nn hc no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="hn ho hp hq hr"><p id="28cf" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">我还构建了一个独立的Rails应用程序，它有一个用于编辑Firebase数据的UI。因此，CMS与主应用程序完全分离，防止主应用程序变成一个更大的庞然大物。</p><figure class="mv mw mx my fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nt"><img src="../Images/5198f8d18ef7f4ef7aadd1d02236dc24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMDXvJobV1H68JiJFB8YCQ.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Screenshot of my Rails app for editing content</figcaption></figure><p id="51d6" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">我再次使用React和re-base来处理Firebase sync。</p><pre class="mv mw mx my fq nd nc ne nf aw ng dt"><span id="8624" class="li lj ij nc b fv nh ni l nj nk">componentWillMount() {<br/>    const that = this<br/>    firebase.auth().signInWithPopup(provider).then(function(result) {<br/><br/>    const user = result.user</span><span id="5c6f" class="li lj ij nc b fv nl ni l nj nk">    if (user.email.indexOf('<a class="ae mt" href="http://twitter.com/pillow" rel="noopener ugc nofollow" target="_blank">@pillow</a>.com') &gt; -1) {<br/>       base.syncState(EN, {<br/>          context: that,<br/>          state: EN,<br/>          onFailure(error) {<br/>            console.log('error', error)<br/>          }<br/>        })</span><span id="0b90" class="li lj ij nc b fv nl ni l nj nk">        base.syncState(FR, {<br/>          context: that,<br/>          state: FR,<br/>          onFailure(error) {<br/>            console.log('error', error)<br/>          }<br/>        })<br/>      }<br/>    }).catch(function(error) {<br/>      // Handle Errors here.<br/>      console.log("ERROR", error)<br/>    })</span></pre><p id="5ba9" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated"><em class="nu">(请原谅这里的一些“粗鲁”，我确实在一个工作日内做到了这一点。)</em></p><p id="66e6" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated"><code class="eh mz na nb nc b">syncState</code>功能是“双向街道”它监听Firebase中的变化，然后更新组件的状态。如果组件状态得到更新(例如由<code class="eh mz na nb nc b">this.setState</code>更新)，这种变化会自动同步到Firebase。</p><p id="f416" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">在我的Firebase编辑器应用程序中，存储在Firebase中的每个值都显示在一个<code class="eh mz na nb nc b">textarea</code>中。因此，整个DOM结构是基于Firebase数据动态生成的。当<code class="eh mz na nb nc b">textarea</code>中的值发生变化时，它会触发组件状态的变化，进而更新数据库。</p><p id="61c6" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">总之，CMS逻辑看起来是这样的:</p><figure class="mv mw mx my fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nv"><img src="../Images/cb43e70fb37bf7af4cdcf5c25bb3bea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ek5LbTWZeioX6crJ6M0dqg.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Check out my mad powerpoint skill</figcaption></figure></div><div class="ab cl nm nn hc no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="hn ho hp hq hr"><p id="102b" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">观看我的CMS工作时的屏幕录像:</p><figure class="mv mw mx my fq hw"><div class="bz el l di"><div class="nw nx l"/></div><figcaption class="id ie fg fe ff if ig bd b be z ek"><a class="ae mt" href="https://www.youtube.com/watch?v=SNDvfpr3r1s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=SNDvfpr3r1s</a></figcaption></figure></div><div class="ab cl nm nn hc no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="hn ho hp hq hr"><p id="8657" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">现在，你可能会问，为什么我要建立自己的CMS？</p><p id="afd4" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">没有什么神奇的原因，我这么做是因为:</p><ol class=""><li id="112b" class="ku kv ij ka b kb kc ke kf kh kw kl kx kp ky kt kz la lb lc dt translated">只需很少的努力就可以让它与我们现有的React前端web应用程序一起工作。</li><li id="b374" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">不需要第三方服务。</li><li id="7407" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">这是免费的，免费是好事。从技术上讲，Firebase对1GB的数据是免费的，但我很想看到Pillow有一天在网站上有超过1GB的文本。</li><li id="9414" class="ku kv ij ka b kb ld ke le kh lf kl lg kp lh kt kz la lb lc dt translated">最后，我只是认为这将是一个很好的学习机会。的确如此！</li></ol><p id="4444" class="pw-post-body-paragraph jy jz ij ka b kb kc jk kd ke kf jn kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">如果你喜欢这个故事，给我一些掌声！:)</p></div></div>    
</body>
</html>