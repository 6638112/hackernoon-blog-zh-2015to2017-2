<html>
<head>
<title>Using forms in React-Redux: Tips And Tricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React-Redux中使用表单:提示和技巧</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/using-forms-in-react-redux-tips-and-tricks-48ad9c7522f6?source=collection_archive---------3-----------------------#2017-01-30">https://medium.com/hackernoon/using-forms-in-react-redux-tips-and-tricks-48ad9c7522f6?source=collection_archive---------3-----------------------#2017-01-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d20a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不久前，我发表了一篇博文,讲述了从转移到反应和还原的过程中学到的一些经验。我使用React和Friends已经有很长时间了，我想分享一下我们最大的困难之一是什么，以及我们是如何克服它们的——实现表单。</p><p id="ec63" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">许多web应用程序都是基于表单的，用户可以通过填写表单和操作表单组件来使用您的平台。这显然提出了一些关于如何在react中编写和使用表单组件的问题，以及react和redux如何一起工作等问题，例如:</p><p id="9f9a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> #组件如何表现？<br/> #我的数据保存在哪里？<br/> #我如何执行验证？</strong> <br/> <strong class="it hv"> #如何检测窗体的状态和变化？</strong></p><p id="a71b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<a class="ae jp" href="https://www.bizzabo.com" rel="noopener ugc nofollow" target="_blank"> Bizzabo </a>，我们服务中的许多页面都是基于表单的，这已经有一段时间了，所以我们意识到了挑战，当我们使用Backbone.js时，我们已经解决了上面的问题，但是，嘿，React是一个不同的游戏场，我们一方面需要让用户无缝地填写表单，不管他是使用我们的Backbone表单还是React表单，但同时完全重新设计我们使用表单的整个方式，并再次回答这些问题。</p><p id="15b6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们开始回答问题之前，让我从头开始，我们使用了<a class="ae jp" href="http://redux-form.com/" rel="noopener ugc nofollow" target="_blank">redux-form</a>——redux之上的一个表单状态管理库，由<a class="ae jp" href="https://github.com/erikras" rel="noopener ugc nofollow" target="_blank"> Erik Rasmussen </a>创建，这是一个高度维护的库，每周都在变化和发展。</p><p id="f6a3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">#我的组件表现如何？</strong></p><p id="0790" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们系统中的每个表单组件都必须有一个用户界面行为。以一个输入为例，它有许多状态:有效、被触摸、被聚焦、脏，以及更多的状态。对于每一个状态，你都希望有一个可视化的表示。显示错误、警告等。我们为此选择了Redux-form的解决方案，它提供了关于组件状态的元信息。如何使用redux表单组件？<Field/>组件是如何将每个单独的输入连接到Redux存储的(我将在下一篇文章中详细阐述这个主题)</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="jv jw l"/></div></figure><p id="3615" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你需要做的唯一的事情就是激活它，用上面显示的<Field/>组件包装你的组件，给它一个名字，你的组件，然后你可以显示你想要的UI状态。生成redux表单<Field/>有几种方法，你可以查看<a class="ae jp" href="http://redux-form.com/6.2.1/docs" rel="noopener ugc nofollow" target="_blank">文档</a>看看。</p><p id="4466" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以现在你可以随心所欲地为每个状态添加你的UI。</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="jv jw l"/></div></figure><p id="507b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你在上面看到的，当你使用<Field/>时，你得到了免费的UI状态，所以我可以根据不同的状态显示不同的通知。</p><h2 id="eea5" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jc ki kj kk jg kl km kn jk ko kp kq kr dt translated">#我在哪里保存我的数据？</h2><p id="a792" class="pw-post-body-paragraph ir is hu it b iu ks iw ix iy kt ja jb jc ku je jf jg kv ji jj jk kw jm jn jo hn dt translated">我们必须回答的一个主要问题是<strong class="it hv">在哪里保存数据。</strong>让我详细说明一下我们需要回答的问题:<br/>每个表单元素都必须有一个初始值，如果您的表单处于“新”状态，它可以是一个空值，或者是某种“编辑”状态的值。在任何更改\模糊\击键(或您感兴趣的任何其他事件)时，您希望值更新。那我把它放在哪里？</p><p id="aa7c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">redux-form的解决方案——一个Redux reducer，它监听调度的Redux-form动作，以维护Redux中的表单状态。您的表单将安装在“form”键名称中，每个表单都有一个惟一的名称，访问它就像form[name]一样简单。</p><p id="c86f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面你可以看到它是多么容易设置。</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="jv jw l"/></div></figure><p id="1b4d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">redux-form为你的初始值和当前值提供了选择器。使用它的一个好处是它只是redux，你可以监听特定的定制动作并相应地操作你的数据，不仅是redux形式的动作，也可以是你的特定动作。<a class="ae jp" href="http://redux-form.com/6.2.1/docs/api/ReducerPlugin.md/" rel="noopener ugc nofollow" target="_blank">就用那个</a>的插件吧。</p><p id="f4dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">到目前为止，我们已经讨论了显示组件的当前状态，以及在哪里管理数据。</p><p id="395c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是处理数据本身呢？</p><p id="7202" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> #如何执行验证？</strong></p><p id="2c03" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每个表单面临的主要挑战之一是验证。当用户输入被提交时(在任何其他浏览器事件上)，仅仅用新值更新表单组件是不够的，您需要验证该值。在这一期中，我们必须问自己的问题是:<br/>我是否将表单组件值保存在状态中，一旦验证通过，我就将它发送到商店？还是我在商店里执行所有的数据验证？</p><p id="a7f8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Redux form已经回答了我们所有的问题，因为验证是图书馆生态系统的一部分。您可以传递使用redux form(一种验证方法)创建的表单，甚至可以对特定的<field/>(来自特定版本)执行验证。它只有1个约束，它是error对象的结构，即:{ field1: <string>，field2: <string> }。您可以自己实现验证方法或使用第三方库。我们选择了后者，并使用了<a class="ae jp" href="https://github.com/skaterdav85/validatorjs" rel="noopener ugc nofollow" target="_blank"> validator.js </a>，它覆盖了大量的验证，支持特殊验证的插件，最重要的是，按照redux表单的要求返回错误对象。</string></string></p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="jv jw l"/></div><figcaption class="kx ky fg fe ff kz la bd b be z ek">Validation using Validator.Js</figcaption></figure><p id="d3c7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在上面的例子中，你可以看到一个验证的例子。您可以在每个字段上提供几个验证(例如:input)，也可以为每个错误提供文本，一旦运行验证，您就可以返回错误对象。</p><p id="e036" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">#如何检测表单的状态和变化</strong></p><p id="e6b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们需要解决的最后一个大问题是检测表单的当前状态，并跟踪它的变化。我将给出一个例子——我们想要检测for是否已经改变了它的原始值，以便当用户试图导航时，我们可以通知他有未保存的更改。Redux Form提供了当前表单状态的完全可见性。你可以发现它的肮脏、原始、是否被用户触摸过(关注一个元素)等等。它还提供了一个外部API，允许您通过redux操作触发您想要的状态更改，例如，您可以提交表单，或者使用redux操作重置表单，如果不需要，不需要实际的提交按钮。</p><p id="30d0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">总之</strong></p><p id="168a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">表单总是很棘手，是的，每个表单都有它的需求，有时您需要找到解决方案并变通一下，但是大多数场景都被redux-form覆盖了，如果没有，您可以很容易地将您的解决方案移植到redux form上。对我们来说，它工作得很好，我希望它也能为你工作</p><p id="d96e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们一起努力@ <a class="ae jp" href="https://www.bizzabo.com/about#career" rel="noopener ugc nofollow" target="_blank"> Bizzabo </a>，来加入我们吧！</p><blockquote class="lb lc ld"><p id="1983" class="ir is le it b iu iv iw ix iy iz ja jb lf jd je jf lg jh ji jj lh jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is le it b iu iv iw ix iy iz ja jb lf jd je jf lg jh ji jj lh jl jm jn jo hn dt translated">要了解更多信息，请<a class="ae jp" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">阅读我们的“关于”页面</a>、<a class="ae jp" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书上给我们点赞/发消息</a>，或者简单地说，<a class="ae jp" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is le it b iu iv iw ix iy iz ja jb lf jd je jf lg jh ji jj lh jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>