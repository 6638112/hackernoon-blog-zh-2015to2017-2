<html>
<head>
<title>Angular — Simple In Memory Cache Service with RxJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular —使用RxJS的简单内存缓存服务</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/angular-simple-in-memory-cache-service-on-the-ui-with-rxjs-77f167387e39?source=collection_archive---------1-----------------------#2017-08-18">https://medium.com/hackernoon/angular-simple-in-memory-cache-service-on-the-ui-with-rxjs-77f167387e39?source=collection_archive---------1-----------------------#2017-08-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/6357fc7d4b9a0d7f41a5f17f46d11754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onAtGHCIIkVn3dZY_f0qgA.png"/></div></div></figure><div class=""/><p id="8bb1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章是关于一种实验性的方法，我相信有其他方法可以解决类似的问题。如果有，请评论这篇文章。</p><p id="2370" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">演示:<a class="ae ka" href="https://ashwin-sureshkumar.github.io/angular-cache-service-blog/" rel="noopener ugc nofollow" target="_blank">https://ashwin-sureshkumar . github . io/angular-cache-service-blog/</a><em class="kb">注:打开开发者控制台查看日志消息</em></p><p id="c680" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">github Repo:<a class="ae ka" href="https://github.com/ashwin-sureshkumar/angular-cache-service-blog" rel="noopener ugc nofollow" target="_blank">https://github . com/ashwin-sureshkumar/angular-cache-service-blog</a></p><p id="ab00" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Stackblitz编辑器:<a class="ae ka" href="https://stackblitz.com/edit/angular-simple-cache-service-with-rxjs" rel="noopener ugc nofollow" target="_blank">https://stack blitz . com/edit/angular-simple-cache-service-with-rxjs</a></p><h2 id="e11e" class="kc kd if bd ke kf kg kh ki kj kk kl km jn kn ko kp jr kq kr ks jv kt ku kv kw dt translated">我们上下文中的缓存是什么？</h2><p id="f06b" class="pw-post-body-paragraph jc jd if je b jf kx jh ji jj ky jl jm jn kz jp jq jr la jt ju jv lb jx jy jz hn dt translated">缓存是一种简单的数据存储，用于存储数据，以便下次需要相同信息时可以更快地访问数据，从而提高性能和用户体验。这里，数据可以是从应用程序的不同部分导出/计算的值或复制的数据/请求。</p><h2 id="27f2" class="kc kd if bd ke kf kg kh ki kj kk kl km jn kn ko kp jr kq kr ks jv kt ku kv kw dt translated">对我们的缓存服务有什么要求？</h2><ol class=""><li id="5643" class="lc ld if je b jf kx jj ky jn le jr lf jv lg jz lh li lj lk dt translated">可注入的缓存服务</li><li id="52bd" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">能够为每个项目设置到期时间。</li><li id="1134" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">基于可观察的服务</li><li id="f81b" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">能够跟踪进行中的请求，因此不会出现重复的请求。</li></ol><h2 id="f1d3" class="kc kd if bd ke kf kg kh ki kj kk kl km jn kn ko kp jr kq kr ks jv kt ku kv kw dt translated">我们实现了什么来使用这个缓存服务？</h2><p id="6e79" class="pw-post-body-paragraph jc jd if je b jf kx jh ji jj ky jl jm jn kz jp jq jr la jt ju jv lb jx jy jz hn dt translated">我们将从Hackernews API构建一个简单的故事列表，以显示其主页上的热门故事，并实现无限滚动以加载更多数据。</p><p id="d683" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了让事情变得有趣，我想显示每篇文章作者的<em class="kb">因果报应</em>，但是因果报应不会在stories API调用中返回。必须通过单独的API调用为每个用户获取它。因此，当我们加载列表时，我们将选择作者并进行API调用来填充用户的karma。因此，如果列表中重复出现同一个用户，我们将在没有任何缓存服务的情况下进行多次调用。</p><p id="e1ac" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="kb">注意:这是一个虚构的场景，用来演示缓存服务的使用。</em></p><p id="d327" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将看到缓存服务代码、实现的演示，然后将代码分成几个部分进行演示。</p><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="lu lv l"/></div></figure><figure class="lq lr ls lt fq hw fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/54fc29b72d50747482579d5467131d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*77T1DU7XgEQo7Xv5axz0zg.gif"/></div></figure><p id="23a3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> <em class="kb">在上面的gif中，我正在记录API调用(紫色)，通知正在进行的观察(蓝色)以及何时从缓存接收到数据(绿色)。</em>T15】</strong></p><p id="8c36" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">演示:<a class="ae ka" href="https://ashwin-sureshkumar.github.io/angular-cache-service-blog/" rel="noopener ugc nofollow" target="_blank">https://ashwin-sureshkumar . github . io/angular-cache-service-blog/</a><em class="kb">注:打开开发控制台记录消息</em></p><h2 id="b442" class="kc kd if bd ke kf kg kh ki kj kk kl km jn kn ko kp jr kq kr ks jv kt ku kv kw dt translated">打破它！</h2><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="0330" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们为服务初始化了三个属性，</p><ol class=""><li id="1d60" class="lc ld if je b jf jg jj jk jn lx jr ly jv lz jz lh li lj lk dt translated">用给定的键保存缓存数据的映射</li><li id="b759" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">为我们的飞行中的可观测物保存一个主题的地图</li><li id="250b" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">缓存数据的默认最长期限。</li></ol><p id="cc98" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们来看看<code class="eh ma mb mc md b">get</code>的方法</p><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="37d6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">方法做的事情很少，</p><ul class=""><li id="d077" class="lc ld if je b jf jg jj jk jn lx jr ly jv lz jz me li lj lk dt translated">如果请求的键存在于缓存中，则返回缓存的数据</li><li id="da4a" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz me li lj lk dt translated">如果存在正在进行的请求，则返回该键的主题</li><li id="7337" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz me li lj lk dt translated">如果提供了回退，那么设置正在运行的主题并返回带有副作用(<code class="eh ma mb mc md b">do</code>)方法链的回调，该方法链调用set方法。</li><li id="b976" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz me li lj lk dt translated">最后抛出一个错误</li></ul><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="4395" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ma mb mc md b">set</code>方法非常简单，在缓存中设置给定的数据，并用数据通知所有订户。</p><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="69ae" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ma mb mc md b">notifyInFlightObservers</code>检查密钥是否存在于正在运行的Observables中，以及该密钥是否有订户。</p><h2 id="5257" class="kc kd if bd ke kf kg kh ki kj kk kl km jn kn ko kp jr kq kr ks jv kt ku kv kw dt translated">如何使用缓存服务？</h2><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="1376" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这非常简单，我用<code class="eh ma mb mc md b">id</code>(缓存的键)和<code class="eh ma mb mc md b">fallback</code>调用<code class="eh ma mb mc md b">cacheService.get</code>作为API调用，就这样。</p><p id="480d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是UI层缓存服务的一个简单实现。希望这能带来一些想法和其他实现思路。</p><p id="d298" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你喜欢这篇文章，请分享，评论和推荐。</p></div><div class="ab cl mf mg hc mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hn ho hp hq hr"><h2 id="e7c3" class="kc kd if bd ke kf kg kh ki kj kk kl km jn kn ko kp jr kq kr ks jv kt ku kv kw dt translated">相关文章</h2><p id="5ec6" class="pw-post-body-paragraph jc jd if je b jf kx jh ji jj ky jl jm jn kz jp jq jr la jt ju jv lb jx jy jz hn dt translated">angular-带有RxJS观察值的简单无限滚动条指令:<a class="ae ka" href="https://codeburst.io/angular-2-simple-infinite-scroller-directive-with-rxjs-observables-a989b12d4fb1" rel="noopener" target="_blank"><em class="kb">https://code burst . io/angular-2-Simple-Infinite-scroller-directive-with-RxJS-Observables-a 989 b 12d 4 FB 1</em></a></p><p id="4668" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用RxJS Observables的反应式编程中的Naive无限滚动<a class="ae ka" href="https://hackernoon.com/naive-infinite-scroll-in-reactive-programming-using-rxjs-observables-4a605d3146e8" rel="noopener ugc nofollow" target="_blank"><em class="kb">https://hacker noon . com/naive-Infinite-scroll-in-Reactive-Programming-using-RxJS-Observables-4a 605d 3146 E8</em></a></p></div></div>    
</body>
</html>