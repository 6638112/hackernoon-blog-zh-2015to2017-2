<html>
<head>
<title>What is wrong with Groovy?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Groovy有什么问题？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/what-is-wrong-with-groovy-482b7064f591?source=collection_archive---------11-----------------------#2017-10-20">https://medium.com/hackernoon/what-is-wrong-with-groovy-482b7064f591?source=collection_archive---------11-----------------------#2017-10-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/26395224ed01b7b16a73fa3fb26acace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*I4-kbM6BhY6NXTnwj0na2A.png"/></div></figure><p id="76f9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我的一个朋友用头撞墙，因为这个很棒的代码。</p><figure class="jw jx jy jz fq iv"><div class="bz el l di"><div class="ka kb l"/></div></figure><p id="28fb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">让我们快速解释一下这是干什么的。</p><p id="13b4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">首先，我们创建一个空映射，然后我们定义一个作为字符串插值结果的键。关键会是<code class="eh kc kd ke kf b">"job-4"</code>。</p><p id="c03d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后我们验证钥匙是否已经在地图上。如果地图没有键，我们用值<code class="eh kc kd ke kf b">1</code>添加它，然后我们再次做同样的事情，但是只是这一次键会在地图上，什么都不会改变。键<code class="eh kc kd ke kf b">"job-4"</code>的值应该保持不变，即值<code class="eh kc kd ke kf b">1</code>。</p><p id="0051" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我告诉你，我们都错了。实际上，<code class="eh kc kd ke kf b">println(cache[key])</code>行将打印<code class="eh kc kd ke kf b">2</code>。</p><p id="db43" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这太疯狂了。！！所以我们研究了其他语言，看看其中是否有一种语言的行为方式与Groovy相同。</p><p id="cfdc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在Ruby中，我们做到了:</p><figure class="jw jx jy jz fq iv"><div class="bz el l di"><div class="ka kb l"/></div></figure><p id="9064" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它像预期的那样打印出值<code class="eh kc kd ke kf b">1</code>！</p><p id="1a07" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在JavaScript中，我们做到了:</p><figure class="jw jx jy jz fq iv"><div class="bz el l di"><div class="ka kb l"/></div></figure><p id="b660" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它像预期的那样打印出值<code class="eh kc kd ke kf b">1</code>！</p><p id="6221" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在酏剂中，我们做到了:</p><figure class="jw jx jy jz fq iv"><div class="bz el l di"><div class="ka kb l"/></div></figure><p id="9091" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它像预期的那样打印出值<code class="eh kc kd ke kf b">1</code>！</p><p id="a768" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在Scala中，我们做到了:</p><figure class="jw jx jy jz fq iv"><div class="bz el l di"><div class="ka kb l"/></div></figure><p id="dcfb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它像预期的那样打印出值<code class="eh kc kd ke kf b">1</code>！</p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><p id="aed9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">Groovy怎么了！！！！？？？</p><p id="ed82" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">问题来自Groovy管理动态类型和字符串插值的方式。</p><p id="a21a" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">当Groovy进行字符串插值时，得到的类型是<code class="eh kc kd ke kf b">GStringImpl</code>,这意味着比较不是您期望的方式。我们需要迫使<code class="eh kc kd ke kf b">GStringImpl</code>成为<code class="eh kc kd ke kf b">String</code>正在做的<code class="eh kc kd ke kf b">.toString()</code>。</p><p id="64ea" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果我们只做:</p><pre class="jw jx jy jz fq kn kf ko kp aw kq dt"><span id="4240" class="kr ks hu kf b fv kt ku l kv kw">def key = "job-${4}".toString()</span></pre><p id="ade4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">一切开始按预期工作。</p><h1 id="dde6" class="kx ks hu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt dt translated">结论</h1><p id="ab64" class="pw-post-body-paragraph iy iz hu ja b jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ly jt ju jv hn dt translated">停止使用Groovy！！！</p></div></div>    
</body>
</html>