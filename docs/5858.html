<html>
<head>
<title>Clean code challenge: Unspiral</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">干净代码挑战:非spiral</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/clean-code-challenge-unspiral-b607a8bc7e83?source=collection_archive---------9-----------------------#2017-08-20">https://medium.com/hackernoon/clean-code-challenge-unspiral-b607a8bc7e83?source=collection_archive---------9-----------------------#2017-08-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="29b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我有一个挑战给你尝试。首先，请看这段代码。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="0c76" class="jy jz hu ju b fv ka kb l kc kd"><strong class="ju hv">function</strong> unspiral (i, j) {<br/>  <strong class="ju hv">const</strong> n = Math.max(Math.abs(i), Math.abs(j))<br/>  <strong class="ju hv">return</strong> 4 * n * n + (j &gt; i ? -1 : 1) * (2 * n - i - j)<br/>}</span></pre><p id="b5da" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通过阅读代码，你明白代码是做什么的吗？</p><p id="0847" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你花了多长时间才明白？</p><h1 id="5c39" class="ke jz hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">螺旋</h1><p id="ca79" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">这是一个2D螺旋模式:</p><figure class="jp jq jr js fq lh fe ff paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="fe ff lg"><img src="../Images/1cabbb17eae021c44aa9bd03a2ff96b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92uPYVq0JoupdIGBt1hMnA.png"/></div></div></figure><p id="4fab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你在上图中看到的，螺旋以(0，0)为中心。它从中心上方的瓷砖开始，然后顺时针方向移动。</p><p id="5da2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">函数<code class="eh lo lp lq ju b">unspiral(i, j)</code>获取坐标<code class="eh lo lp lq ju b">(i, j)</code>并返回相应的数字。让我们假设<code class="eh lo lp lq ju b">i</code>和<code class="eh lo lp lq ju b">j</code>可以任意大。</p><p id="bf9d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如:</p><ul class=""><li id="557b" class="lr ls hu it b iu iv iy iz jc lt jg lu jk lv jo lw lx ly lz dt translated"><code class="eh lo lp lq ju b">unspiral(0, 0) === 0</code></li><li id="e157" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated"><code class="eh lo lp lq ju b">unspiral(-2, -1) === 9</code></li><li id="c778" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated"><code class="eh lo lp lq ju b">unspiral(-123, 456) === 831165</code></li></ul><p id="4dbc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是我想到的解决方案:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="1e30" class="jy jz hu ju b fv ka kb l kc kd"><strong class="ju hv">function</strong> unspiral (i, j) {<br/>  <strong class="ju hv">const</strong> n = Math.max(Math.abs(i), Math.abs(j))<br/>  <strong class="ju hv">return</strong> 4 * n * n + (j &gt; i ? -1 : 1) * (2 * n - i - j)<br/>}</span></pre><p id="3699" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是如你所见，代码看起来非常神秘和数学化。理解代码可能需要几分钟。你需要深入思考，以便根据你的需要改变或扩展它。</p><p id="970e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">一个需求变更可能需要螺旋来:</strong></p><ul class=""><li id="58e9" class="lr ls hu it b iu iv iy iz jc lt jg lu jk lv jo lw lx ly lz dt translated">以不同的坐标为中心。</li><li id="a146" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated">从不同的号码开始跑步。</li><li id="ef8d" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated">向相反方向旋转(逆时针)。</li><li id="67b2" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated">从不同的方面开始。</li></ul><p id="53a3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我已经写了几段这样的代码，很少有人能修改它。</p><p id="2f11" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然它是一个纯粹的、小的、可测试的、不依赖于任何东西的函数，但是它读起来并不那么愉快，而且很难扩展。所以我想，可能，<a class="ae mf" href="https://blog.goyello.com/2013/01/21/top-9-principles-clean-code/" rel="noopener ugc nofollow" target="_blank">我的代码不够干净</a>。</p><p id="7a6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我希望向其他开发者学习，这就是我提出这个挑战的原因。</p></div><div class="ab cl mg mh hc mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hn ho hp hq hr"><p id="62d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你的挑战是重写<code class="eh lo lp lq ju b">unspiral</code>函数，以这样的方式:</p><ul class=""><li id="1d28" class="lr ls hu it b iu iv iy iz jc lt jg lu jk lv jo lw lx ly lz dt translated">通过阅读函数的代码，程序员可以很容易地理解它做什么以及如何工作。<a class="ae mf" href="https://github.com/facebook/react/blob/e464cf2deffdd4139784674698e871161c42b0d5/src/renderers/shared/stack/reconciler/Transaction.js#L19" rel="noopener ugc nofollow" target="_blank">允许评论</a>。</li><li id="57ae" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated">程序员可以很容易地修改、扩展或重用该功能，以满足他们的需要。</li><li id="97a4" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt translated">该算法的运行时间为O(1)。</li></ul><p id="8b31" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想看看你的解决方案。感谢阅读。</p></div></div>    
</body>
</html>