<html>
<head>
<title>Serverless 1.X — Enable API Gateway caching on request parameters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器1。X —对请求参数启用API网关缓存</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/serverless-1-x-enable-api-gateway-caching-on-request-parameters-894b31762068?source=collection_archive---------5-----------------------#2017-04-25">https://medium.com/hackernoon/serverless-1-x-enable-api-gateway-caching-on-request-parameters-894b31762068?source=collection_archive---------5-----------------------#2017-04-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="e6a5" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">如何使用无服务器框架在API Gateway中启用路径和查询字符串参数的缓存</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/eb625312701fcd0fc1add58821b52a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2EUZXtUUFnEYwsJhf3B5eQ.png"/></div></div></figure><p id="a618" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">之前<a class="ae kr" href="http://theburningmonk.com/2016/04/serverless-enable-caching-on-query-string-parameters-in-api-gateway/" rel="noopener ugc nofollow" target="_blank">在博客</a>上发表了关于在<a class="ae kr" href="https://serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器</a>框架0.5.X中启用API网关请求参数缓存的未开发路径的文章，令人有点失望的是，它仍然没有在1.0中正式修复。x版本…</p><h1 id="b85c" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">问题是</h1><p id="0663" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">问题是双重的:</p><ol class=""><li id="05d8" class="lp lq hu jx b jy jz kb kc ke lr ki ls km lt kq lu lv lw lx dt translated">目前没有办法指定应该为路径和查询字符串参数启用缓存</li><li id="0b8f" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq lu lv lw lx dt translated"><em class="md">云生成</em>模板<em class="md">无服务器</em> 1。为<em class="md"> API网关</em>生成的x缺少一些可选字段，这些缺少的字段也阻止您在<em class="md"> API网关</em>管理控制台中手动启用缓存</li></ol><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff me"><img src="../Images/0eeeb68892e20f445d70e1fa4178aed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1J4Cnga5n3obZh5efGcHfA.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">after you deploy your Lambda function with associated API, if you go to the management console and enable caching on path or request parameters you will get an error saying “Invalid cache key parameter specified”.</figcaption></figure><h1 id="8d58" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">变通办法</h1><p id="78ff" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">一个朋友给我指了一个<a class="ae kr" rel="noopener" href="/@nickdenengelsman/modifying-auto-generated-serverless-v1-0-aws-cloudformation-resources-5bb5b55bbdf0">巧妙的技巧</a>来修改<em class="md"> CloudFormation </em>模板，即<em class="md"> Serverless 1。X </em>自动为您生成。</p><p id="4ce9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">项目部署完成后，您可以到<em class="md"> CloudFormation </em>查看<em class="md"> Serverless </em>生成的模板。这些模板相当大(并且格式很差)，所以我发现在<em class="md"> Designer </em>视图中打开它们并使用该视图导航到我正在寻找的端点更容易。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mj"><img src="../Images/77faf0e4e192e256319e0a818c2ed2ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DvmxOPLmgh-eJLkoFhRegw.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">When you click on a resource in the Designer, it’ll also highlight it in the YAML, write down the resource name.</figcaption></figure><p id="0771" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">找到端点的资源模板后，记下它的名称。现在回到项目中的<code class="eh mk ml mm mn b">serverless.yml</code>文件，将资源名称添加到底部的<code class="eh mk ml mm mn b">resources</code>部分。您只需要包含要更新或添加到模板中的字段。</p><p id="2161" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="md"> API网关</em>方法的<em class="md"> CloudFormation </em>语法如下:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mo"><img src="../Images/264de9cabe7f1afe81e7c4fe6b427f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0anKzqkzL7U1EIk2D4c-Rg.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">see <a class="ae kr" href="http://amzn.to/2px6ITq" rel="noopener ugc nofollow" target="_blank">http://amzn.to/2px6ITq</a> for more detail</figcaption></figure><p id="fac1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们还需要为<code class="eh mk ml mm mn b">Integration</code>部分填充一些空白:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mp"><img src="../Images/0f9916a0f27f34988f308b1f0a325489.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KyWk6Qgx1LveWzlkLV1YtQ.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">see <a class="ae kr" href="http://amzn.to/2oJsC1P" rel="noopener ugc nofollow" target="_blank">http://amzn.to/2oJsC1P</a> for more detail</figcaption></figure><p id="8100" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">经过反复试验，我必须添加的最小字段集是:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mq"><img src="../Images/859d2ed18cb9ce1a364abb27b7ecd4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HmhF49T8hURC7YhXcZh6Nw.png"/></div></div></figure><p id="f820" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">使用无服务器重新部署，并且为缓存启用了path参数:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/eb625312701fcd0fc1add58821b52a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2EUZXtUUFnEYwsJhf3B5eQ.png"/></div></div></figure><h1 id="a07b" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">包裹</h1><p id="04ea" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">我希望这篇文章对你有用，尽管我很惊讶在我的研究中缺乏信息，并且缺乏来自<em class="md">无服务器</em>框架的官方支持。</p><p id="ec45" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果你知道更好的方法，请在评论中告诉我。</p><h1 id="f831" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">链接</h1><ul class=""><li id="43c7" class="lp lq hu jx b jy lk kb ll ke mr ki ms km mt kq mu lv lw lx dt translated"><a class="ae kr" rel="noopener" href="/@nickdenengelsman/modifying-auto-generated-serverless-v1-0-aws-cloudformation-resources-5bb5b55bbdf0">修改自动生成的无服务器1.0版AWS云信息资源</a></li></ul></div><div class="ab cl mv mw hc mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hn ho hp hq hr"><p id="4e84" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">喜欢你正在读的东西吗？查看我的视频课程<a class="ae kr" href="https://bit.ly/prod-ready-serverless" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv">生产就绪无服务器</strong> </a>，学习如何在生产中运行无服务器应用。</p><p id="072d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们将讨论的主题包括:</p><ul class=""><li id="0ffa" class="lp lq hu jx b jy jz kb kc ke lr ki ls km lt kq mu lv lw lx dt translated">使用API网关和Cognito进行身份验证和授权</li><li id="4f2f" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">在本地测试和运行功能</li><li id="28bc" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">项目组织策略</li><li id="16b4" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">CI/CD</li><li id="d586" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">集中伐木</li><li id="e72b" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">监视</li><li id="a85b" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">X射线分布式跟踪</li><li id="5115" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">跟踪相关id</li><li id="5cf3" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">性能和成本优化</li><li id="c88e" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">错误处理</li><li id="0e03" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">配置管理</li><li id="723e" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">金丝雀部署</li><li id="81f2" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">VPC</li><li id="8aec" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">安全</li><li id="a7db" class="lp lq hu jx b jy ly kb lz ke ma ki mb km mc kq mu lv lw lx dt translated">Lambda、Kinesis和API网关的最佳实践</li></ul><p id="9465" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">并包括在最近的AWS re:Invent大会上宣布的所有最新变化！</p><div class="nc nd fm fo ne nf"><a href="https://bit.ly/prod-ready-serverless" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab ej"><div class="nh ab ni cl cj nj"><h2 class="bd hv fv z el nk eo ep nl er et ht dt translated">生产就绪无服务器</h2><div class="nm l"><h3 class="bd b fv z el nk eo ep nl er et ek translated">看到了。动手吧。学着点！生产就绪无服务器:运营最佳实践向您介绍领先的模式和…</h3></div><div class="nn l"><p class="bd b gc z el nk eo ep nl er et ek translated">bit.ly</p></div></div><div class="no l"><div class="np l nq nr ns no nt jt nf"/></div></div></a></div></div></div>    
</body>
</html>