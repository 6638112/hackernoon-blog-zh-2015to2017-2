<html>
<head>
<title>How to Build an Emoji Game Using AngularJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用AngularJS构建表情游戏</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-an-emoji-game-using-angularjs-3fdf0de64cb5?source=collection_archive---------21-----------------------#2017-07-10">https://medium.com/hackernoon/how-to-build-an-emoji-game-using-angularjs-3fdf0de64cb5?source=collection_archive---------21-----------------------#2017-07-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/4233ab2ce7cc4e81d8334b214c9f1771.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/0*ZJo-pOnnN2J8_TT1.png"/></div></figure><p id="ed7a" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在本教程中，我将向你展示如何使用一点Node和<a class="ae jw" href="https://cosmicjs.com" rel="noopener ugc nofollow" target="_blank"> Cosmic JS </a>创建一个“表情符号”游戏。为了理解如何使用Restful API，本教程将展示如何向<a class="ae jw" href="https://cosmicjs.com" rel="noopener ugc nofollow" target="_blank">宇宙JS API </a>发出简单的AJAX请求，以便检索、更新和删除宇宙JS桶中的数据。让我们开始吧。</p><h1 id="73fc" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="3e47" class="pw-post-body-paragraph iy iz hu ja b jb kv jd je jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv hn dt translated"><a class="ae jw" href="https://github.com/cosmicjs/angular-emoji-game" rel="noopener ugc nofollow" target="_blank">下载GitHub回购。</a> <br/> <a class="ae jw" href="https://cosmicjs.com/apps/angular-emoji-game" rel="noopener ugc nofollow" target="_blank">查看演示。</a></p><h1 id="4b54" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">开始使用:</h1><p id="e630" class="pw-post-body-paragraph iy iz hu ja b jb kv jd je jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv hn dt translated">首先，让我们创建一个新目录来构建我们的项目，并创建一个package.json文件。</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="8514" class="lj jy hu lf b fv lk ll l lm ln">mkdir emoji-app</span><span id="fd86" class="lj jy hu lf b fv lo ll l lm ln">emoji-app$ touch package.json</span></pre><p id="bcc6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，在您的package.json中，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="7e79" class="lj jy hu lf b fv lk ll l lm ln">//emoji-app/package.json<br/>{<br/>  "name": "emoji-app",<br/>  "version": "1.0.0",<br/>  "main": "app-server.js",<br/>  "engines": {<br/>    "node": "4.1.2",<br/>    "npm": "3.5.2"<br/>  },<br/>  "description": "",<br/>  "dependencies": {<br/>    "body-parser": "^1.17.2",<br/>    "bower": "^1.7.7",<br/>    "buffer-to-vinyl": "^1.1.0",<br/>    "express": "^4.13.3",<br/>    "gulp": "^3.9.1",<br/>    "gulp-autoprefixer": "^3.1.0",<br/>    "gulp-concat": "^2.6.0",<br/>    "gulp-concat-css": "^2.2.0",<br/>    "gulp-env": "^0.4.0",<br/>    "gulp-minify-css": "^1.2.4",<br/>    "gulp-ng-config": "^1.4.0",<br/>    "gulp-npm-script-sync": "^1.1.0",<br/>    "gulp-webserver": "^0.9.1",<br/>    "http-server": "^0.9.0",<br/>    "stripe": "^4.22.0",<br/>    "wiredep": "^3.0.0"<br/>  },<br/>  "scripts": {<br/>    "postinstall": "bower install &amp;&amp; gulp config &amp;&amp; gulp js",<br/>    "start": "npm run production",<br/>    "production": "node app-server.js",<br/>    "gulp": "gulp"<br/>  },<br/>  "author": "",<br/>  "license": "ISC",<br/>  "devDependencies": {<br/>    "gulp-npm-script-sync": "^1.1.0",<br/>    "gulp-remote-src": "^0.4.2"<br/>  }<br/>}/</span></pre><p id="4dcf" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">其次，我们来做一个bower.json文件。</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="f55d" class="lj jy hu lf b fv lk ll l lm ln">emoji-app$ touch bower.json</span></pre><p id="93bf" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，在您的bower.json中，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="2f16" class="lj jy hu lf b fv lk ll l lm ln">//emoji-app/bower.json<br/>{<br/>  "name": "emoji-app",<br/>  "description": "Emoji App",<br/>  "version": "0.0.0",<br/>  "homepage": "https://github.com/kutsaniuk/emoji-app",<br/>  "license": "MIT",<br/>  "private": true,<br/>  "dependencies": {<br/>    "angular": "~1.5.x",<br/>    "angular-mocks": "~1.5.x",<br/>    "angular-bootstrap": "~1.1.x",<br/>    "angular-cookies": "~1.5.x",<br/>    "angular-route": "~1.5.x",<br/>    "angular-ui-router": "0.2.x",<br/>    "angular-resource": "1.5.x",<br/>    "angular-animate": "~1.5.x",<br/>    "ng-dialog": "0.6.1",<br/>    "bootstrap": "3.3.x",<br/>    "cr-acl": "",<br/>    "angular-chosen-localytics": "*",<br/>    "bootstrap-chosen": "*",<br/>    "ng-flow": "^2.7.4",<br/>    "angular-mask": "*",<br/>    "checklist-model": "0.9.0",<br/>    "angular-ui-notification": "^0.2.0",<br/>    "angular-ui-calendar": "^1.0.2",<br/>    "angular-ui-switch": "^0.1.1",<br/>    "ng-scrollbars": "^0.0.11",<br/>    "jquery.scrollbar": "*",<br/>    "angular-flash-alert": "^2.4.0",<br/>    "components-font-awesome": "^4.7.0",<br/>    "angular-loading-bar": "^0.9.0",<br/>    "angular-environment": "^1.0.8",<br/>    "angular-emoji-popup": "",<br/>    "angular-dragdrop": "",<br/>    "angular-sanitize": "1.5.*",<br/>    "angular-drag-and-drop-directives": "",<br/>    "jquery-ui-touch-punch": "",<br/>    "angular-touch":"1.5.*",<br/>    "textAngular":"1.5.*"<br/>  },<br/>  "resolutions": {<br/>    "angular": "~1.5.x"<br/>  },<br/>  "devDependencies": {<br/>    "cr-acl": "^0.5.0"<br/>  }<br/>}</span></pre><p id="0fff" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">配置应用服务器:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="3a8a" class="lj jy hu lf b fv lk ll l lm ln">emoji-app$ touch app-server.js</span><span id="28bb" class="lj jy hu lf b fv lo ll l lm ln">//events-app/app-server.js<br/>var express = require('express');<br/>var bodyParser = require('body-parser');<br/>var app = express();<br/>app.set('port', process.env.PORT || 3000)<br/>app.use(express.static(__dirname))<br/>app.use(bodyParser.json())<br/>var http = require('http').Server(app)<br/>// Route<br/>app.get('/', (req, res) =&gt; {<br/>  res.sendFile(__dirname + '/index.html');<br/>})<br/>http.listen(app.get('port'), () =&gt; {<br/>  console.log('Emoji App listening on ' + app.get('port'))<br/>})</span></pre><h1 id="9c12" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">我们正在安装什么，为什么:</h1><ol class=""><li id="8fed" class="lp lq hu ja b jb kv jf kw jj lr jn ls jr lt jv lu lv lw lx dt translated">我们将使用AngularJS框架来构建单页面应用程序</li><li id="bf6a" class="lp lq hu ja b jb ly jf lz jj ma jn mb jr mc jv lu lv lw lx dt translated">我们正在为创建多视图安装angular-ui-router。</li><li id="6efd" class="lp lq hu ja b jb ly jf lz jj ma jn mb jr mc jv lu lv lw lx dt translated">我们将使用gulp把所有的js和css文件构建成一个文件。</li></ol><h1 id="b46d" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">构建我们的应用程序:</h1><p id="ba54" class="pw-post-body-paragraph iy iz hu ja b jb kv jd je jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv hn dt translated">现在我们将构建我们的文件结构，这样我们就可以组织我们的angular模块和js文件。我们的表情符号应用程序目录应该是这样的:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="dddb" class="lj jy hu lf b fv lk ll l lm ln">emoji-app<br/>|----app<br/>|       |----auth<br/>|                 |----auth.ctrl.js<br/>|                 |----auth.service.js<br/>|       |----config<br/>|                 |----config.js<br/>|       |----watch<br/>|                 |----profile<br/>|                           |----watch.profile.ctrl.js<br/>|                           |----watch.profile.mdl.js<br/>|                 |----watch.ctrl.js<br/>|                 |----watch.mdl.js<br/>|                 |----watch.service.js<br/>|       |----admin<br/>|                 |----authors<br/>|                           |----add<br/>|                                   |----admin.authors.add.ctrl.js<br/>|                                   |----admin.authors.add.mdl.js<br/>|                           |----edit<br/>|                                   |----admin.authors.edit.ctrl.js<br/>|                                   |----admin.authors.edit.mdl.js<br/>|                           |----admin.authors.ctrl.js<br/>|                           |----admin.authors.mdl.js<br/>|                           |----admin.authors.service.js<br/>|                 |----quotes<br/>|                           |----add<br/>|                                   |----admin.quotes.add.ctrl.js<br/>|                                   |----admin.quotes.add.mdl.js<br/>|                           |----edit<br/>|                                   |----admin.quotes.edit.ctrl.js<br/>|                                   |----admin.quotes.edit.mdl.js<br/>|                           |----admin.quotes.ctrl.js<br/>|                           |----admin.quotes.mdl.js<br/>|                           |----admin.quotes.service.js<br/>|                 |----admin.ctrl.js<br/>|                 |----admin.mdl.js<br/>|       |----author<br/>|                 |----author.ctrl.js<br/>|                 |----author.mdl.js<br/>|       |----emoji<br/>|                 |----emoji.ctrl.js<br/>|                 |----emoji.mdl.js<br/>|                 |----emoji.service.js<br/>|       |----user<br/>|                 |----user.service.js<br/>|       |----main.mdl.js<br/>|----dist<br/>|       |----css<br/>|       |----img<br/>|       |----js<br/>|----css<br/>|----views<br/>|----resources<br/>|----gulpfile.js<br/>|----app-server.js<br/>|----bower.json<br/>|----package.json</span></pre><p id="5ada" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在我们将建立我们的index.html。将以下代码复制并粘贴到您的index.html文件中:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="e57d" class="lj jy hu lf b fv lk ll l lm ln">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en" ng-app="main"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>    &lt;meta name="description" content=""&gt;<br/>    &lt;meta name="author" content=""&gt;</span><span id="b699" class="lj jy hu lf b fv lo ll l lm ln">    &lt;title&gt;Emoji App&lt;/title&gt;</span><span id="346a" class="lj jy hu lf b fv lo ll l lm ln">    &lt;!-- bower:css --&gt;<br/>    &lt;!-- endbower --&gt;</span><span id="6afb" class="lj jy hu lf b fv lo ll l lm ln">    &lt;!-- Bootstrap Core CSS --&gt;<br/>    &lt;link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet"&gt;</span><span id="39e7" class="lj jy hu lf b fv lo ll l lm ln">    &lt;!-- Custom CSS --&gt;</span><span id="1974" class="lj jy hu lf b fv lo ll l lm ln">    &lt;link href="dist/css/main.min.css" rel="stylesheet"&gt;<br/></span><span id="3641" class="lj jy hu lf b fv lo ll l lm ln">    &lt;!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;<br/>    &lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;<br/>    &lt;!--[if lt IE 9]&gt;<br/>    &lt;script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;<br/>    &lt;![endif]--&gt;</span><span id="16d7" class="lj jy hu lf b fv lo ll l lm ln">&lt;/head&gt;<br/>&lt;body&gt;</span><span id="b06b" class="lj jy hu lf b fv lo ll l lm ln">&lt;div ui-view&gt;&lt;/div&gt;</span><span id="bb64" class="lj jy hu lf b fv lo ll l lm ln">&lt;!-- bower:js --&gt;<br/>&lt;!-- endbower --&gt;</span><span id="8af5" class="lj jy hu lf b fv lo ll l lm ln">&lt;script src="dist/js/main.js"&gt;&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="12aa" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在这里，我们将把我们的“根”视图作为目标，稍后放置我们的角度模块。位于我们的dist目录中的main.js文件是我们的gulpfile.js文件在捆绑了我们所有的angular模块之后将产生的文件。现在，设置我们的gulpfile.js文件来捆绑我们所有的js文件，并将该捆绑文件导出到我们的dist目录中。将以下代码复制到gulpfile.js文件中:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="5f40" class="lj jy hu lf b fv lk ll l lm ln">//emoji-app/gulpfile.js<br/>'use strict';</span><span id="0afd" class="lj jy hu lf b fv lo ll l lm ln">var gulp = require('gulp'),<br/>    webserver = require('gulp-webserver'),<br/>    minifyCSS = require('gulp-minify-css'),<br/>    concat = require('gulp-concat'),<br/>    wiredep = require('wiredep').stream,<br/>    gulpNgConfig = require('gulp-ng-config'),<br/>    autoprefixer = require('gulp-autoprefixer'),<br/>    b2v = require('buffer-to-vinyl'),<br/>    sync = require('gulp-npm-script-sync');</span><span id="c374" class="lj jy hu lf b fv lo ll l lm ln">sync(gulp);</span><span id="b2b6" class="lj jy hu lf b fv lo ll l lm ln">gulp.task('css', function () {<br/>  return gulp.src('css/**/*.css')<br/>    .pipe(minifyCSS())<br/>    .pipe(concat('main.min.css'))<br/>    .pipe(autoprefixer())<br/>    .pipe(gulp.dest('dist/css'));<br/>});</span><span id="d6f4" class="lj jy hu lf b fv lo ll l lm ln">gulp.task('js', function() {<br/>    return gulp.src('app/**/**/*.js')<br/>        .pipe(concat('main.js'))<br/>        .pipe(gulp.dest('dist/js/'));<br/>});</span><span id="e016" class="lj jy hu lf b fv lo ll l lm ln">gulp.task('config', function () {<br/>    const json = JSON.stringify({<br/>        BUCKET_SLUG: process.env.COSMIC_BUCKET,<br/>        MEDIA_URL: 'https://api.cosmicjs.com/v1/' + process.env.COSMIC_BUCKET + '/media',<br/>        URL: 'https://api.cosmicjs.com/v1/',<br/>        READ_KEY: process.env.COSMIC_READ_KEY || '',<br/>        WRITE_KEY: process.env.COSMIC_WRITE_KEY || '',<br/>        DEFAULT_IMAGE: process.env.DEFAULT_IMAGE || ''<br/>    });<br/>    return b2v.stream(new Buffer(json), 'config.js')<br/>        .pipe(gulpNgConfig('config'))<br/>        .pipe(gulp.dest('app/config'));<br/>});</span><span id="b9c6" class="lj jy hu lf b fv lo ll l lm ln">gulp.task('default', function () {<br/>  gulp.watch('css/**/*.css', ['css']);<br/>  gulp.watch('app/**/**/*.js', ['js']);<br/>  gulp.watch('bower.json', ['bower']);<br/>});</span><span id="1ab8" class="lj jy hu lf b fv lo ll l lm ln">gulp.task('bower', function () {<br/>  gulp.src('index.html')<br/>    .pipe(wiredep({<br/>      directory: 'bower_components'<br/>    }))<br/>    .pipe(gulp.dest(''));<br/>});</span></pre><p id="7574" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">之后，我们可以创建主模块。将以下代码复制并粘贴到main.mdl.js文件中:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="3dec" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="541c" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main', [<br/>            'ui.router',<br/>            'ui.bootstrap',<br/>            'ngMask',<br/>            'ngCookies',<br/>            'ngRoute',<br/>            'ngDialog',<br/>            'cr.acl',<br/>            'ui-notification',<br/>            'ngFlash',<br/>            'ngAnimate',<br/>            'textAngular',<br/>            'flow',<br/>            'angular-loading-bar',<br/>            'ngDragDrop',<br/>            'ngEmoticons',<br/>            'ngSanitize',<br/>            'ngTouch',</span><span id="bc9f" class="lj jy hu lf b fv lo ll l lm ln">            'emoji',<br/>            'admin',<br/>            'author',</span><span id="4d7b" class="lj jy hu lf b fv lo ll l lm ln">            'config'<br/>        ])<br/>        .config(config)<br/>        .run(run);</span><span id="3a84" class="lj jy hu lf b fv lo ll l lm ln">    config.$inject = ['$stateProvider', '$urlRouterProvider', 'cfpLoadingBarProvider', 'NotificationProvider'];<br/>    function config($stateProvider, $urlRouterProvider, cfpLoadingBarProvider, NotificationProvider) {<br/>        cfpLoadingBarProvider.includeSpinner = false;</span><span id="7498" class="lj jy hu lf b fv lo ll l lm ln">        NotificationProvider.setOptions({<br/>            startTop: 25,<br/>            startRight: 25,<br/>            verticalSpacing: 20,<br/>            horizontalSpacing: 20,<br/>            positionX: 'right',<br/>            positionY: 'bottom'<br/>        });</span><span id="46de" class="lj jy hu lf b fv lo ll l lm ln">        $urlRouterProvider.otherwise(function ($injector) {<br/>            var $state = $injector.get("$state");<br/>            var $location = $injector.get("$location");<br/>            var crAcl = $injector.get("crAcl");</span><span id="3876" class="lj jy hu lf b fv lo ll l lm ln">            var state = "";</span><span id="cbaa" class="lj jy hu lf b fv lo ll l lm ln">            switch (crAcl.getRole()) {<br/>                case 'ROLE_ADMIN':<br/>                    state = 'admin.authors';<br/>                    break;<br/>                default : state = 'main.emoji';<br/>            }</span><span id="0c64" class="lj jy hu lf b fv lo ll l lm ln">            if (state) $state.go(state);<br/>            else $location.path('/');<br/>        });</span><span id="d989" class="lj jy hu lf b fv lo ll l lm ln">        $stateProvider<br/>            .state('main', {<br/>                url: '/',<br/>                abstract: true,<br/>                templateUrl: '../views/main.html',<br/>                // controller: 'CartCtrl as cart',<br/>                data: {<br/>                    is_granted: ['ROLE_GUEST']<br/>                }<br/>            })<br/>            .state('blog', {<br/>                url: '/blog',<br/>                templateUrl: '../blog.html'<br/>            })<br/>            .state('auth', {<br/>                url: '/login',<br/>                templateUrl: '../views/auth/login.html',<br/>                controller: 'AuthCtrl as auth',<br/>                onEnter: ['AuthService', 'crAcl', function(AuthService, crAcl) {<br/>                    AuthService.clearCredentials();<br/>                    crAcl.setRole();<br/>                }],<br/>                data: {<br/>                    is_granted: ['ROLE_GUEST']<br/>                }<br/>            });<br/>    }</span><span id="4307" class="lj jy hu lf b fv lo ll l lm ln">    run.$inject = ['$rootScope', '$cookieStore', '$state', 'crAcl'];<br/>    function run($rootScope, $cookieStore, $state, crAcl) {<br/>        // keep user logged in after page refresh<br/>        $rootScope.globals = $cookieStore.get('globals') || {};</span><span id="7afa" class="lj jy hu lf b fv lo ll l lm ln">        crAcl<br/>            .setInheritanceRoles({<br/>                'ROLE_ADMIN': ['ROLE_ADMIN', 'ROLE_GUEST'],<br/>                'ROLE_GUEST': ['ROLE_GUEST']<br/>            });</span><span id="8ec1" class="lj jy hu lf b fv lo ll l lm ln">        crAcl<br/>            .setRedirect('main.emoji');</span><span id="402e" class="lj jy hu lf b fv lo ll l lm ln">        if ($rootScope.globals.currentUser) {<br/>            crAcl.setRole($rootScope.globals.currentUser.metadata.role);<br/>            // $state.go('admin.watches');<br/>        }<br/>        else {<br/>            crAcl.setRole();<br/>        }</span><span id="4b1d" class="lj jy hu lf b fv lo ll l lm ln">    }<br/>    angular.module('main')<br/>        .directive('compile', ['$compile', function ($compile) {<br/>            return function (scope, element, attrs) {<br/>                scope.$watch(<br/>                    function (scope) {<br/>                        // watch the 'compile' expression for changes<br/>                        return scope.$eval(attrs.compile);<br/>                    },<br/>                    function (value) {<br/>                        element.html(value);</span><span id="d6b9" class="lj jy hu lf b fv lo ll l lm ln">                        $compile(element.contents())(scope);<br/>                    }<br/>                );<br/>            };<br/>        }]);<br/>})();</span></pre><p id="41ef" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，我们将设置我们的授权控制器。将以下代码复制并粘贴到auth.ctrl.js文件中:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="6e9c" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="346f" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main')<br/>        .controller('AuthCtrl', AuthCtrl);</span><span id="9ba2" class="lj jy hu lf b fv lo ll l lm ln">    function AuthCtrl(crAcl, $state, AuthService, Flash, $log) {<br/>        var vm = this;</span><span id="f0f5" class="lj jy hu lf b fv lo ll l lm ln">        vm.login = login;</span><span id="dd77" class="lj jy hu lf b fv lo ll l lm ln">        vm.loginForm = null;</span><span id="57a3" class="lj jy hu lf b fv lo ll l lm ln">        vm.credentials = {};<br/>        vm.user = {};</span><span id="4687" class="lj jy hu lf b fv lo ll l lm ln">        function login(credentials) {<br/>            function success(response) {<br/>                function success(response) {<br/>                    if (response.data.status !== 'empty') {<br/>                        var currentUser = response.data.objects[0];</span><span id="2dad" class="lj jy hu lf b fv lo ll l lm ln">                        crAcl.setRole(currentUser.metadata.role);<br/>                        AuthService.setCredentials(currentUser);<br/>                        $state.go('admin.authors');<br/>                    }<br/>                    else<br/>                        Flash.create('danger', 'Incorrect username or password');<br/>                }</span><span id="c86e" class="lj jy hu lf b fv lo ll l lm ln">                function failed(response) {<br/>                    $log.error(response);<br/>                }</span><span id="0a57" class="lj jy hu lf b fv lo ll l lm ln">                if (response.data.status !== 'empty')<br/>                    AuthService<br/>                        .checkPassword(credentials)<br/>                        .then(success, failed);<br/>                else<br/>                    Flash.create('danger', 'Incorrect username or password');</span><span id="5734" class="lj jy hu lf b fv lo ll l lm ln">                $log.info(response);<br/>            }</span><span id="b1ba" class="lj jy hu lf b fv lo ll l lm ln">            function failed(response) {<br/>                $log.error(response);<br/>            }</span><span id="332a" class="lj jy hu lf b fv lo ll l lm ln">            if (vm.loginForm.$valid)<br/>                AuthService<br/>                    .checkUsername(credentials)<br/>                    .then(success, failed);<br/>        }</span><span id="a09b" class="lj jy hu lf b fv lo ll l lm ln">    }<br/>})();</span></pre><p id="06b2" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">创建授权服务，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="1a8d" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="2ff0" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main')<br/>        .service('AuthService', function ($http,<br/>                                          $cookieStore,<br/>                                          $q,<br/>                                          $rootScope,<br/>                                          URL, BUCKET_SLUG, READ_KEY, WRITE_KEY) {<br/>            var authService = this;<br/>            $http.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';</span><span id="416b" class="lj jy hu lf b fv lo ll l lm ln">            authService.checkUsername = function (credentials) {<br/>                return $http.get(URL + BUCKET_SLUG + '/object-type/users/search', {<br/>                    params: {<br/>                        metafield_key: 'email',<br/>                        metafield_value_has: credentials.email,<br/>                        limit: 1,<br/>                        read_key: READ_KEY<br/>                    }<br/>                });<br/>            };<br/>            authService.checkPassword = function (credentials) {<br/>                return $http.get(URL + BUCKET_SLUG + '/object-type/users/search', {<br/>                    ignoreLoadingBar: true,<br/>                    params: {<br/>                        metafield_key: 'password',<br/>                        metafield_value: credentials.password,<br/>                        limit: 1,<br/>                        read_key: READ_KEY<br/>                    }<br/>                });<br/>            };<br/>            authService.setCredentials = function (user) {<br/>                $rootScope.globals = {<br/>                    currentUser: user<br/>                };</span><span id="1f60" class="lj jy hu lf b fv lo ll l lm ln">                $cookieStore.put('globals', $rootScope.globals);<br/>            };<br/>            authService.clearCredentials = function () {<br/>                var deferred = $q.defer();<br/>                $cookieStore.remove('globals');</span><span id="c649" class="lj jy hu lf b fv lo ll l lm ln">                if (!$cookieStore.get('globals')) {<br/>                    $rootScope.globals = {};<br/>                    deferred.resolve('Credentials clear success');<br/>                } else {<br/>                    deferred.reject('Can\'t clear credentials');<br/>                }</span><span id="2cfd" class="lj jy hu lf b fv lo ll l lm ln">                return deferred.promise;<br/>            };<br/>        });<br/>})();</span></pre><h1 id="8108" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">这是怎么回事:</h1><ol class=""><li id="4be9" class="lp lq hu ja b jb kv jf kw jj lr jn ls jr lt jv lu lv lw lx dt translated">我们使用ui路由器来配置路由。</li><li id="1991" class="lp lq hu ja b jb ly jf lz jj ma jn mb jr mc jv lu lv lw lx dt translated">我们为对我们的Cosmic JS API的异步调用创建了Auth Service。</li><li id="e4fc" class="lp lq hu ja b jb ly jf lz jj ma jn mb jr mc jv lu lv lw lx dt translated">我们创建了身份验证控制器来检查凭证。</li></ol><p id="8b86" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为获取和更新用户创建用户服务，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="ed46" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="656d" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main')<br/>        .service('UserService', function ($http,<br/>                                          $cookieStore,<br/>                                          $q,<br/>                                          $rootScope,<br/>                                          URL, BUCKET_SLUG, READ_KEY, WRITE_KEY) {<br/>            $http.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';</span><span id="3af3" class="lj jy hu lf b fv lo ll l lm ln">            this.getCurrentUser = function (ignoreLoadingBar) {<br/>                return $http.get(URL + BUCKET_SLUG + '/object/' + $rootScope.globals.currentUser.slug, {<br/>                    ignoreLoadingBar: ignoreLoadingBar,<br/>                    params: {<br/>                        read_key: READ_KEY<br/>                    }<br/>                });<br/>            };<br/>            this.getUser = function (slug, ignoreLoadingBar) {<br/>                return $http.get(URL + BUCKET_SLUG + '/object/' + slug, {<br/>                    ignoreLoadingBar: ignoreLoadingBar,<br/>                    params: {<br/>                        read_key: READ_KEY<br/>                    }<br/>                });<br/>            };<br/>            this.updateUser = function (user) {<br/>                user.write_key = WRITE_KEY;</span><span id="007f" class="lj jy hu lf b fv lo ll l lm ln">                return $http.put(URL + BUCKET_SLUG + '/edit-object', user, {<br/>                    ignoreLoadingBar: false<br/>                });<br/>            };</span><span id="affb" class="lj jy hu lf b fv lo ll l lm ln">        });<br/>})();</span></pre><p id="a7de" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为从单词中获取表情符号创建表情符号服务，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="9ade" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="3185" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main')<br/>        .service('EmojiService', function ($http) {</span><span id="3ac9" class="lj jy hu lf b fv lo ll l lm ln">            var that = this;</span><span id="c6ba" class="lj jy hu lf b fv lo ll l lm ln">            that.Quote = function (text, author, slug) {<br/>                this.text = text;<br/>                this.author = author;<br/>                this.slug = slug;<br/>            };</span><span id="473e" class="lj jy hu lf b fv lo ll l lm ln">            that.Emoji = function (code, position) {<br/>                this.code = code;<br/>                this.position = position;<br/>            };</span><span id="8541" class="lj jy hu lf b fv lo ll l lm ln">            that.Container = function (type, item) {<br/>                this.type = type;<br/>                this.item = item;<br/>            };</span><span id="06c0" class="lj jy hu lf b fv lo ll l lm ln">            that.Random = {<br/>                randNumOld: 0,<br/>                getRandomInt: function (min, max) {<br/>                    var randNum = Math.floor(Math.random() * (max - min + 1)) + min;<br/>                    if (randNum == this.randNumOld) return this.getRandomInt(min, max);<br/>                    this.randNumOld = randNum;</span><span id="be1b" class="lj jy hu lf b fv lo ll l lm ln">                    return randNum;<br/>                }<br/>            };</span><span id="d585" class="lj jy hu lf b fv lo ll l lm ln">            this.getEmojisFromWords = function (quote) {<br/>                var words = [];<br/>                var word = '';</span><span id="8941" class="lj jy hu lf b fv lo ll l lm ln">                quote += " ";</span><span id="e8b5" class="lj jy hu lf b fv lo ll l lm ln">                for (var i = 0; i &lt; quote.length; i++) {<br/>                    if (quote[i] !== ' ') word += quote[i];<br/>                    else {<br/>                        words.push(word);<br/>                        word = '';<br/>                    }<br/>                }</span><span id="bbe8" class="lj jy hu lf b fv lo ll l lm ln">                for (var j = 0; j &lt; words.length; j++) {<br/>                    if (getMeAnEmoji(words[j]) !== "") words[j] = ":" + getMeAnEmoji(words[j]) + ":";<br/>                }</span><span id="3f43" class="lj jy hu lf b fv lo ll l lm ln">                console.log(words);<br/>                return words;<br/>            };</span><span id="b2d1" class="lj jy hu lf b fv lo ll l lm ln">            this.getEmoji = function (quote, emojis, containers, checkAnswers) {<br/>                var i = 0;<br/>                var position = 0;<br/>                var result;<br/>                var word = '';<br/>                var isEmoji = new RegExp(":");<br/>                var _quote = quote;</span><span id="7c7a" class="lj jy hu lf b fv lo ll l lm ln">                while (i &lt; quote.text.length) {<br/>                    if (isEmoji.test(quote.text[i])) {<br/>                        result = ( /\:(\w+)\:/.exec(quote.text) )[1];<br/>                        emojis.push(new that.Emoji(":" + result + ":", i));<br/>                        containers.push(new that.Container('emoji', []));<br/>                        checkAnswers.push(new that.Emoji(":" + result + ":", position));</span><span id="23fa" class="lj jy hu lf b fv lo ll l lm ln">                        quote.text[i] = quote.text[i].replace(':' + result + ':', '_emoji_');</span><span id="6531" class="lj jy hu lf b fv lo ll l lm ln">                        position++;<br/>                    }<br/>                    else {<br/>                        containers.push(new that.Container('word', quote.text[i]));<br/>                    }<br/>                    word = '';<br/>                    i++;<br/>                }</span><span id="45aa" class="lj jy hu lf b fv lo ll l lm ln">                $http.get('/resources/emojis.json')<br/>                    .success(function (data) {<br/>                        for (var j = 0; j &lt; 3; j++) {<br/>                            emojis.push(new that.Emoji(":" + data[parseInt(Math.random() * data.length)] + ":"));<br/>                        }<br/>                    });</span><span id="1ae3" class="lj jy hu lf b fv lo ll l lm ln">                return _quote;<br/>            };</span><span id="594a" class="lj jy hu lf b fv lo ll l lm ln">        });<br/>})();</span></pre><p id="5888" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为获取报价和检查结果创建表情符号控制器，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="ad9c" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="f87b" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main')<br/>        .controller('EmojiCtrl', EmojiCtrl);</span><span id="f6c5" class="lj jy hu lf b fv lo ll l lm ln">    function EmojiCtrl($scope, DEFAULT_IMAGE, EmojiService, AdminQuotesService, $log) {<br/>        var vm = this;</span><span id="3125" class="lj jy hu lf b fv lo ll l lm ln">        vm.checkAnswers = [];<br/>        vm.quote = {};<br/>        vm.quotes = [];<br/>        vm.emojis = [];<br/>        vm.containers = [];<br/>        vm.win = false;</span><span id="a2e8" class="lj jy hu lf b fv lo ll l lm ln">        vm.DEFAULT_IMAGE = DEFAULT_IMAGE;</span><span id="c6e1" class="lj jy hu lf b fv lo ll l lm ln">        var random = EmojiService.Random;<br/>        var getEmojisFromWords = EmojiService.getEmojisFromWords;<br/>        var getEmoji = EmojiService.getEmoji;<br/>        var Quote = EmojiService.Quote;<br/>        var Emoji = EmojiService.Emoji;</span><span id="3934" class="lj jy hu lf b fv lo ll l lm ln">        var getRandomQuote = _getRandomQuote;<br/>        var getUserAnswers = _getUserAnswers;</span><span id="a02b" class="lj jy hu lf b fv lo ll l lm ln">        vm.getUserAnswerLength = getUserAnswerLength;<br/>        vm.nextQuote = nextQuote;<br/>        vm.checkAnswer = checkAnswer;<br/>        vm.getUserAnswerLength = getUserAnswerLength;</span><span id="89e6" class="lj jy hu lf b fv lo ll l lm ln">        $scope.getOptionsContainer = getOptionsContainer;</span><span id="2077" class="lj jy hu lf b fv lo ll l lm ln">        function _getRandomQuote(quotes) {<br/>            var _random = random.getRandomInt(0, quotes.length - 1);<br/>            console.log(quotes[_random]);<br/>            return quotes[_random].slug;<br/>        }</span><span id="a000" class="lj jy hu lf b fv lo ll l lm ln">        function _getUserAnswers(containers) {<br/>            var userAnswers = [];<br/>            var position = 0;</span><span id="9f5d" class="lj jy hu lf b fv lo ll l lm ln">            for (var i = 0; i &lt; containers.length; i++) {</span><span id="38ab" class="lj jy hu lf b fv lo ll l lm ln">                if (!Array.isArray(containers[i].item)) continue;<br/>                userAnswers.push(new Emoji(containers[i].item[0].code, position));<br/>                position++;</span><span id="fe8f" class="lj jy hu lf b fv lo ll l lm ln">            }</span><span id="8266" class="lj jy hu lf b fv lo ll l lm ln">            return userAnswers;<br/>        }</span><span id="96c8" class="lj jy hu lf b fv lo ll l lm ln">        function getUserAnswerLength() {<br/>            var userAnswersLength = 0;</span><span id="4944" class="lj jy hu lf b fv lo ll l lm ln">            for (var k = 0; k &lt; vm.containers.length; k++) {<br/>                if (!Array.isArray(vm.containers[k].item)) continue;<br/>                if (vm.containers[k].item.length !== 0) userAnswersLength += 1;<br/>            }<br/>            return userAnswersLength;<br/>        }</span><span id="9b79" class="lj jy hu lf b fv lo ll l lm ln">        function nextQuote() {<br/>            getQuote(getRandomQuote(vm.quotes));<br/>        }</span><span id="2297" class="lj jy hu lf b fv lo ll l lm ln">        function checkAnswer() {<br/>            var result = [];<br/>            var position = 0;</span><span id="5bf8" class="lj jy hu lf b fv lo ll l lm ln">            function in_array(value, array) {<br/>                for (var i = 0; i &lt; array.length; i++) {<br/>                    if (array[i] == value) return true;<br/>                }<br/>                return false;<br/>            }</span><span id="5b8f" class="lj jy hu lf b fv lo ll l lm ln">            if (vm.getUserAnswerLength() === vm.checkAnswers.length) {<br/>                var userAnswers = getUserAnswers(vm.containers);<br/>                for (var j = 0; j &lt; userAnswers.length; j++) {<br/>                    vm.checkAnswers[j].code === userAnswers[j].code ? result.push(true) : result.push(false);<br/>                }</span><span id="6234" class="lj jy hu lf b fv lo ll l lm ln">                console.log(result);</span><span id="8847" class="lj jy hu lf b fv lo ll l lm ln">                for (var i = 0; i &lt; vm.containers.length; i++) {</span><span id="b898" class="lj jy hu lf b fv lo ll l lm ln">                    if (!Array.isArray(vm.containers[i].item)) continue;<br/>                    if (!result[position]) {<br/>                        vm.emojis[vm.containers[i].item[0].jqyoui_pos] = new Emoji(vm.containers[i].item[0].code, i);<br/>                        vm.containers[i].item.splice(0, 1);<br/>                    }<br/>                    position++;</span><span id="7da6" class="lj jy hu lf b fv lo ll l lm ln">                }</span><span id="fb1d" class="lj jy hu lf b fv lo ll l lm ln">                console.log(vm.emojis);<br/>                !in_array(false, result) ? vm.win = true : vm.win = false;<br/>            }<br/>        }</span><span id="7582" class="lj jy hu lf b fv lo ll l lm ln">        function getOptionsContainer(container) {<br/>            return {<br/>                accept: function (dragEl) {<br/>                    if (container.length &gt;= 1) {<br/>                        return false;<br/>                    } else {<br/>                        return true;<br/>                    }<br/>                }<br/>            }<br/>        }</span><span id="95b5" class="lj jy hu lf b fv lo ll l lm ln">        function getQuotes() {<br/>            function success(response) {<br/>                response.data.objects.forEach(function (quote) {<br/>                    vm.quotes.push(<br/>                        new Quote(<br/>                            getEmojisFromWords(quote.metadata.text),<br/>                            quote.metadata.author,<br/>                            quote.slug<br/>                        )<br/>                    );<br/>                });<br/>                $log.info(vm.quotes);</span><span id="4206" class="lj jy hu lf b fv lo ll l lm ln">                getQuote(getRandomQuote(vm.quotes));</span><span id="8a47" class="lj jy hu lf b fv lo ll l lm ln">            }</span><span id="f66d" class="lj jy hu lf b fv lo ll l lm ln">            function failed(response) {<br/>                $log.error(response);<br/>            }</span><span id="804e" class="lj jy hu lf b fv lo ll l lm ln">            AdminQuotesService<br/>                .getQuotes(true)<br/>                .then(success, failed);<br/>        }</span><span id="f789" class="lj jy hu lf b fv lo ll l lm ln">        function getQuote(slug) {<br/>            function success(response) {<br/>                vm.quote = new Quote(<br/>                    getEmojisFromWords(response.data.object.metadata.text),<br/>                    response.data.object.metadata.author,<br/>                    response.data.object.slug<br/>                );</span><span id="b170" class="lj jy hu lf b fv lo ll l lm ln">                vm.emojis = [];<br/>                vm.containers = [];<br/>                vm.checkAnswers = [];<br/>                vm.win = false;</span><span id="56c3" class="lj jy hu lf b fv lo ll l lm ln">                getEmoji(<br/>                    vm.quote,<br/>                    vm.emojis,<br/>                    vm.containers,<br/>                    vm.checkAnswers<br/>                );</span><span id="4877" class="lj jy hu lf b fv lo ll l lm ln">                vm.emojis.sort(function (a, b) {<br/>                    return a.code.charCodeAt(1) - b.code.charCodeAt(2)<br/>                });</span><span id="01f2" class="lj jy hu lf b fv lo ll l lm ln">                vm.emojis.reverse();<br/>                console.log('emojis', vm.emojis);<br/>            }</span><span id="c1be" class="lj jy hu lf b fv lo ll l lm ln">            function failed(response) {<br/>                $log.error(response);<br/>            }</span><span id="f143" class="lj jy hu lf b fv lo ll l lm ln">            AdminQuotesService<br/>                .getQuoteBySlug(slug)<br/>                .then(success, failed);<br/>        }</span><span id="2d9b" class="lj jy hu lf b fv lo ll l lm ln">        getQuotes();</span><span id="f03c" class="lj jy hu lf b fv lo ll l lm ln">        $('.emoji').draggable(); // FOR TouchScreen<br/>    }<br/>})();</span></pre><p id="b25f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">创建表情模块，复制并粘贴下面的代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="7275" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="e6a8" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('emoji', [])<br/>        .config(config);</span><span id="e5a2" class="lj jy hu lf b fv lo ll l lm ln">    config.$inject = ['$stateProvider', '$urlRouterProvider'];<br/>    function config($stateProvider, $urlRouterProvider) {</span><span id="fa35" class="lj jy hu lf b fv lo ll l lm ln">        $stateProvider<br/>            .state('main.emoji', {<br/>                url: '',<br/>                templateUrl: '../views/emoji/emoji.html',<br/>                controller: 'EmojiCtrl as emojiCtrl'<br/>            });<br/>    }<br/>})();</span></pre><h1 id="02c9" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">这是怎么回事:</h1><ol class=""><li id="d7d4" class="lp lq hu ja b jb kv jf kw jj lr jn ls jr lt jv lu lv lw lx dt translated">我们为从单词中获取表情符号创建了表情符号服务。</li><li id="84fb" class="lp lq hu ja b jb ly jf lz jj ma jn mb jr mc jv lu lv lw lx dt translated">我们为拖放表情符号、获取报价和检查结果创建了表情符号控制器。</li><li id="912e" class="lp lq hu ja b jb ly jf lz jj ma jn mb jr mc jv lu lv lw lx dt translated">我们创建了表情模块。</li></ol><p id="ffaa" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">创建用于获取作者信息的作者控制器，复制并粘贴以下代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="0260" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="bdbd" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('main')<br/>        .controller('AuthorCtrl', AuthorCtrl);</span><span id="8cd5" class="lj jy hu lf b fv lo ll l lm ln">    function AuthorCtrl($stateParams, $scope, DEFAULT_IMAGE, AdminAuthorsService, Flash, $log) {<br/>        var vm = this;</span><span id="2c4a" class="lj jy hu lf b fv lo ll l lm ln">        vm.author = {};</span><span id="c52d" class="lj jy hu lf b fv lo ll l lm ln">        vm.DEFAULT_IMAGE = DEFAULT_IMAGE;</span><span id="441c" class="lj jy hu lf b fv lo ll l lm ln">        getAuthor($stateParams.slug);</span><span id="023c" class="lj jy hu lf b fv lo ll l lm ln">        function getAuthor(slug) {<br/>            function success(response) {<br/>                response.data.object.metadata.born = new Date(response.data.object.metafields[2].value);<br/>                response.data.object.metadata.died = new Date(response.data.object.metafields[3].value);<br/>                vm.author = response.data.object;<br/>            }</span><span id="0a1e" class="lj jy hu lf b fv lo ll l lm ln">            function failed(response) {<br/>                $log.error(response);<br/>            }</span><span id="2522" class="lj jy hu lf b fv lo ll l lm ln">            AdminAuthorsService<br/>                .getAuthorBySlug(slug)<br/>                .then(success, failed);<br/>        }<br/>    }<br/>})();</span></pre><p id="bef3" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">创建作者模块，复制并粘贴下面的代码:</p><pre class="la lb lc ld fq le lf lg lh aw li dt"><span id="1a5f" class="lj jy hu lf b fv lk ll l lm ln">(function () {<br/>    'use strict';</span><span id="806b" class="lj jy hu lf b fv lo ll l lm ln">    angular<br/>        .module('author', [])<br/>        .config(config);</span><span id="2809" class="lj jy hu lf b fv lo ll l lm ln">    config.$inject = ['$stateProvider', '$urlRouterProvider'];<br/>    function config($stateProvider, $urlRouterProvider) {</span><span id="42e4" class="lj jy hu lf b fv lo ll l lm ln">        $stateProvider<br/>            .state('main.author', {<br/>                url: 'author/:slug',<br/>                templateUrl: '../views/author/author.html',<br/>                controller: 'AuthorCtrl as vm',<br/>                data: {<br/>                    is_granted: ['ROLE_GUEST']<br/>                }<br/>            });<br/>    }<br/>})();</span></pre><h1 id="eba5" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">这是怎么回事:</h1><ol class=""><li id="c304" class="lp lq hu ja b jb kv jf kw jj lr jn ls jr lt jv lu lv lw lx dt translated">我们可以看到关于作者的信息。</li></ol><h1 id="beb9" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">结论:</h1><p id="3452" class="pw-post-body-paragraph iy iz hu ja b jb kv jd je jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv hn dt translated">我们能够使用我们的动作和调度程序函数来消费Cosmic JS API。我希望你和我一样喜欢这个教程，如果你有任何问题<a class="ae jw" href="https://twitter.com/cosmic_js" rel="noopener ugc nofollow" target="_blank">在Twitter上联系我们</a>和<a class="ae jw" href="https://cosmicjs.com/community" rel="noopener ugc nofollow" target="_blank">加入我们的Slack社区</a>。</p></div></div>    
</body>
</html>