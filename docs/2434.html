<html>
<head>
<title>Easily create an HTML editor with DesignMode and ContentEditable</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用设计模式和内容可编辑轻松创建HTML编辑器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/easily-create-an-html-editor-with-designmode-and-contenteditable-7ed1c465d39b?source=collection_archive---------2-----------------------#2017-01-27">https://medium.com/hackernoon/easily-create-an-html-editor-with-designmode-and-contenteditable-7ed1c465d39b?source=collection_archive---------2-----------------------#2017-01-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="ab fr cl iv"><img src="../Images/0ddfa42e98623547b528146159217e0c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*oCtk28IdNdpjnyMGiRsfLA.jpeg"/></div></figure><p id="bb66" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">你有没有想过重新创建一个像我们在Medium上使用的文本编辑器有多难？</p><p id="2e2d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你没有看过Medium的文本编辑器，我强烈推荐你去看看。您可以在您的浏览器中编写、编辑和设计您的内容(在Medium提供的样式内)。</p><p id="7c84" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">不需要任何技术知识。文本中不会出现html标签。</p><p id="a809" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果我说你只需要普通的JavaScript、CSS和HTML，你会相信吗？</p><p id="b77f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">看一看:</p><figure class="jw jx jy jz fq iu"><div class="bz el l di"><div class="ka kb l"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">An example of inline editable content with document.designMode</figcaption></figure><p id="89ad" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">希望这个例子向您展示了一些东西:</p><ol class=""><li id="df2d" class="kg kh hu ja b jb jc jf jg jj ki jn kj jr kk jv kl km kn ko dt translated">你有两个选择。<code class="eh kp kq kr ks b">document.designMode</code>用于整个文档，而<code class="eh kp kq kr ks b">element.contentEditable</code>仅用于一个元素。</li><li id="9450" class="kg kh hu ja b jb kt jf ku jj kv jn kw jr kx jv kl km kn ko dt translated">浏览器给了我们所有需要的方法。任何在<code class="eh kp kq kr ks b">document.execCommand</code>之外的东西仅仅是为了演示和错误处理。</li><li id="f01a" class="kg kh hu ja b jb kt jf ku jj kv jn kw jr kx jv kl km kn ko dt translated">这些命令通过在内容周围添加新标签来修改HTML。这允许我们使用CSS来设计这些标签的样式。如此简单。</li><li id="d4cd" class="kg kh hu ja b jb kt jf ku jj kv jn kw jr kx jv kl km kn ko dt translated">唯一的“问题”是，如果通过点击按钮触发命令，您必须使用<code class="eh kp kq kr ks b">event.preventDefault();</code>。否则，焦点将转移到按钮上，命令将失败。</li></ol><p id="4f97" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果没有选择任何内容，命令将失败<em class="ky">(有时)</em>。</p><p id="30fe" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果能更好地满足您的需求，您还可以使用HTML创建可编辑的内容。</p><pre class="jw jx jy jz fq kz ks la lb aw lc dt"><span id="9819" class="ld le hu ks b fv lf lg l lh li">&lt;div contenteditable="true"&gt;<br/>  This text can be edited!<br/>&lt;/div&gt;</span></pre><p id="4923" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这可以很好地与React、Angular等框架一起工作。您可以使用组件的状态来控制内容是否可编辑。</p><h1 id="3ece" class="lj le hu bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf dt translated">使用数据</h1><p id="8732" class="pw-post-body-paragraph iy iz hu ja b jb mg jd je jf mh jh ji jj mi jl jm jn mj jp jq jr mk jt ju jv hn dt translated">现在，我们必须小心处理这个。这里有几个选择:获取整个编辑过的内容，去掉任何危险的内容(如JavaScript)并呈现给你的内容，或者你可以设计一个系统来单独抓取更改过的数据。</p><p id="7351" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">无论哪种方式，您都需要:</p><ol class=""><li id="f8ed" class="kg kh hu ja b jb jc jf jg jj ki jn kj jr kk jv kl km kn ko dt translated">当文本改变时获取新文本。</li><li id="4c79" class="kg kh hu ja b jb kt jf ku jj kv jn kw jr kx jv kl km kn ko dt translated">确保文本是安全的。</li><li id="d114" class="kg kh hu ja b jb kt jf ku jj kv jn kw jr kx jv kl km kn ko dt translated">渲染回你的整个HTML。</li></ol><p id="18b1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">下面你会发现与上面相同的例子，但是这次当你改变文本时，会有一些信息记录到控制台。我使用<code class="eh kp kq kr ks b">MutationObserver</code> API来观察这些变化。</p><figure class="jw jx jy jz fq iu"><div class="bz el l di"><div class="ka kb l"/></div></figure><p id="a3c6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">那我做了什么？</p><ul class=""><li id="76cf" class="kg kh hu ja b jb jc jf jg jj ki jn kj jr kk jv ml km kn ko dt translated">我给我想观察的每个元素添加了一个属性。您不必这样做，但它可以让您专注于特定的可编辑项目。如果您这样做，请注意不要为您不关注更改的标签打开编辑模式。</li><li id="1a69" class="kg kh hu ja b jb kt jf ku jj kv jn kw jr kx jv ml km kn ko dt translated">我检查了这些突变，以发现它们是否包含我正在寻找的属性。如果有，我会将该元素的属性名和新内容发送到输出(在本例中是控制台)。</li></ul><p id="e205" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我认为这很简单。出于您的目的，您可以用保存更改的后端服务替换控制台。你要确保没有添加危险的JavaScript，这样就不会让你受到XSS的攻击。</p></div><div class="ab cl mn mo hc mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hn ho hp hq hr"><p id="12c0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">嗨，我是贾斯汀·富勒。很高兴你看了我的帖子！我需要让你知道，我在这里写的一切都是我自己的观点，并不打算以任何方式代表我的雇主<em class="ky">。所有代码样本都是我自己的，与美国银行的代码完全无关。</em></p><p id="5c8a" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我也很想收到你的来信，请随时通过<a class="ae mm" href="https://www.linkedin.com/in/justin-fuller-8726b2b1/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae mm" href="https://github.com/justindfuller" rel="noopener ugc nofollow" target="_blank"> Github </a>或<a class="ae mm" rel="noopener" href="/@justindanielfuller"> Medium </a>与我联系。再次感谢阅读！</p><div class="jw jx jy jz fq ab cb"><figure class="mu iu mv mw mx my mz paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mu iu mv mw mx my mz paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mu iu mv mw mx my mz paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="na nb nc"><p id="f922" class="iy iz ky ja b jb jc jd je jf jg jh ji nd jk jl jm ne jo jp jq nf js jt ju jv hn dt translated"><a class="ae mm" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae mm" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae mm" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="iy iz ky ja b jb jc jd je jf jg jh ji nd jk jl jm ne jo jp jq nf js jt ju jv hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae mm" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae mm" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jw jx jy jz fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="fe ff ng"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>