<html>
<head>
<title>Cross Compiling Rust for the Raspberry Pi on Linux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Linux上树莓Pi的交叉编译Rust</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/compiling-rust-for-the-raspberry-pi-49fdcd7df658?source=collection_archive---------3-----------------------#2017-01-15">https://medium.com/hackernoon/compiling-rust-for-the-raspberry-pi-49fdcd7df658?source=collection_archive---------3-----------------------#2017-01-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/1796f2cb3ca39d135f9e9ce65b521485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rW1ygF6vMOrl7Lw0MP8gow.jpeg"/></div></div></figure><p id="0f41" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们在Rust中构建一个简单的“Hello Pi”<a class="ae ka" href="https://hackernoon.com/tagged/program" rel="noopener ugc nofollow" target="_blank">程序</a>，并为运行<a class="ae ka" href="https://hackernoon.com/tagged/linux" rel="noopener ugc nofollow" target="_blank"> Linux </a>版本的Raspberry Pi编译它。我用的是覆盆子Pi 3和Raspbian。为什么我们要在PC上编译这个？假设您在PC上开发您的应用程序，那么在PC上编译和测试它并且只将二进制文件发送到RPi会快得多。</p><p id="2ef5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们需要<a class="ae ka" href="https://github.com/rust-lang-nursery/rustup.rs" rel="noopener ugc nofollow" target="_blank"> rustup </a>来使用不同版本的Rust并选择编译目标。这是一个工具链安装程序。</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="a452" class="kk kl hu kg b fv km kn l ko kp">curl https://sh.rustup.rs -sSf | sh</span></pre><p id="c2ee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你有一个以前安装的Rust，那么rustup会要求你删除它，这样rustup就可以管理不同的Rust版本。继续为您的环境安装默认的Rust版本。</p><p id="57a7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了编译Raspberry Pi，我们需要为ARM平台安装正确的工具链。型号2和3支持ARMv7，型号1支持ARMv6。RPi有一个浮点处理器，所以我们想要<em class="kq"> gnueabihf </em>(我相信hf是硬浮点)，而不是<em class="kq"> gnueabi </em>。本文将重点介绍型号2 &amp; 3。</p><p id="332d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">添加防锈工具链:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="2372" class="kk kl hu kg b fv km kn l ko kp">$ rustup target add armv7-unknown-linux-gnueabihf</span></pre><p id="073a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">而正确的C编译器:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="4126" class="kk kl hu kg b fv km kn l ko kp">$ sudo apt-get install gcc-4.7-multilib-arm-linux-gnueabihf</span></pre><p id="72c2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们需要将我们的构建目标添加到~/。cargo/config，以便rust知道使用哪个链接器。</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="ea22" class="kk kl hu kg b fv km kn l ko kp">[target.armv7-unknown-linux-gnueabihf]<br/>linker = "arm-linux-gnueabihf-gcc-4.7"</span></pre><h1 id="6504" class="kr kl hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">创建我们的项目</h1><p id="9453" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">安装Rust将安装货物，Rust包管理器。我们可以用它来创建一个新项目。</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="f968" class="kk kl hu kg b fv km kn l ko kp">$ cargo new hello-rpi --bin<br/>$ cd hello-rpi</span></pre><p id="4384" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们仍然可以通过运行<em class="kq"> cargo run在AMD64上本地运行我们的项目。</em>为我们使用的RPi构建我们的项目。</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="c1d8" class="kk kl hu kg b fv km kn l ko kp">$ cargo build --target=armv7-unknown-linux-gnueabihf</span></pre><p id="e94a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们看看我们是否已经成功创建了arm二进制文件</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="2489" class="kk kl hu kg b fv km kn l ko kp">$ file target/armv7-unknown-linux-gnueabihf/debug/hello-rpi</span><span id="655c" class="kk kl hu kg b fv lt kn l ko kp">target/armv7-unknown-linux-gnueabihf/debug/hello-rpi: ELF 32-bit LSB  shared object, ARM, EABI5 version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.32, </span></pre><p id="945f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">成功！当我们将hello-rpi转移到我们的Raspberry Pi时，我们将能够运行它并得到一个奇妙的“hello world！”在命令行上！现在我们可以编译了，我们可以开始开发一些更有趣的东西。</p><p id="ade6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="kq">第2部分即将推出… </em></p><div class="kb kc kd ke fq ab cb"><figure class="lu iv lv lw lx ly lz paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lu iv lv lw lx ly lz paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lu iv lv lw lx ly lz paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ma mb mc"><p id="f922" class="jc jd kq je b jf jg jh ji jj jk jl jm md jo jp jq me js jt ju mf jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>的机会。</p><p id="708a" class="jc jd kq je b jf jg jh ji jj jk jl jm md jo jp jq me js jt ju mf jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mg"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="mh mi l"/></div></figure></div></div>    
</body>
</html>