<html>
<head>
<title>How to Single Sign-on with React Native and Fabric</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用React Native和Fabric进行单点登录</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-single-sign-on-with-react-native-and-fabric-6fec9de6765a?source=collection_archive---------9-----------------------#2017-05-17">https://medium.com/hackernoon/how-to-single-sign-on-with-react-native-and-fabric-6fec9de6765a?source=collection_archive---------9-----------------------#2017-05-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/48f204398c3f3f64ee74cf277ef207e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O39EmmqEb0sfwaw5-lF-IA.png"/></div></div></figure><div class=""/><p id="30f8" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最近我开始为iOS开发一个移动应用，这要感谢<a class="ae ka" href="https://hackernoon.com/tagged/react-native" rel="noopener ugc nofollow" target="_blank"> React Native </a>👻。由于大部分事情都是新的，我想我会在弄清楚每一件事情的同时写下我的心得。</p><p id="507a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是这个系列的第一篇文章，希望我能在下面写更多。</p><h1 id="b2f6" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">什么</h1><p id="43d0" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在这里，我将谈谈我是如何用React Native实现单点登录的。</p><h1 id="85f5" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">为什么</h1><p id="659e" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">个性化服务是任何<a class="ae ka" href="https://hackernoon.com/tagged/application" rel="noopener ugc nofollow" target="_blank">应用</a>的一个重要方面。这可以通过要求用户进行身份验证来实现。有几种方法可以做到这一点:</p><h2 id="ae36" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">1.Web视图</h2><p id="efb8" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Web view是一种在应用程序中打开浏览器并要求用户提供凭据以进行身份验证的方式，然后在完成后将用户重定向回应用程序。</p><p id="4ee3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个方法对我来说实现起来很快，我遵循了官方文档<a class="ae ka" href="https://facebook.github.io/react-native/docs/webview.html" rel="noopener ugc nofollow" target="_blank">中的指南。</a></p><h2 id="f254" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">2.单点登录(SSO)</h2><p id="28da" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">SSO是允许用户使用一组登录凭证(例如，名称和密码)来访问多个应用的服务。该服务针对用户有权访问的所有应用程序对最终用户进行身份验证，并在用户在同一会话期间切换应用程序时消除进一步的提示。欲了解更多信息，您可以点击<a class="ae ka" href="http://searchsecurity.techtarget.com/definition/single-sign-on" rel="noopener ugc nofollow" target="_blank">这里</a></p><h1 id="0d07" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">怎么</h1><p id="9c64" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">像每个人一样，首先我开始寻找关于如何做的指南，我确实找到了一些，有些对于xcode来说太具体了，有些需要手动修改。但最后我还是算出了，这里我将解释我是如何实现它的。</p><h2 id="ead9" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">1.创建React应用</h2><p id="9775" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">当您运行<code class="eh ls lt lu lv b">react-native run-ios</code>时，您应该会看到下面的屏幕</p><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/f36a83fbdb0aeff3f90209819f10a479.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*dFDAztUpt_NFtDvOFMDIwg.png"/></div></figure><h2 id="082a" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">2.将Fabric安装到应用中</h2><p id="b327" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">如果您还不是会员，请前往<a class="ae ka" href="https://get.fabric.io/" rel="noopener ugc nofollow" target="_blank">https://get.fabric.io/</a>注册并下载SDK。</p><p id="0c03" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">登录SDK后，选择您的xcode项目，然后选择Twitter工具包进行安装，并按照应用程序中给出的说明进行操作</p><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mb"><img src="../Images/46ebdc2718ae14bd1e59e4d05f91ab22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dKTAm9G1N32TmQUPH9jqA.png"/></div></div></figure><p id="d4c5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">转到<a class="ae ka" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank"> Twitter Apps </a>创建您的应用程序，以便您可以获取API密钥和密码。</p><p id="2bc5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如下图所示，更新Fabric下xcode项目中的键。</p><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mc"><img src="../Images/4341eff4b640c1a62efc989ba89ea3d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lRpy06lmf-xxzIOi1doiBw.gif"/></div></div></figure><p id="8668" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者你可以直接从<code class="eh ls lt lu lv b">info.plist</code>更新。</p><h2 id="9a38" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">3.使用Twitter按钮添加登录</h2><p id="fd76" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">我添加了以下代码来创建一个新的按钮，单击该按钮将触发登录</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="md me l"/></div></figure><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div class="fe ff mf"><img src="../Images/848af90c081e946273f995b7436733ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*cXE9B9A6uqFNk4Z6IRO0fg.png"/></div></figure><h2 id="e0c0" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">4.公开SSO模块</h2><p id="79e5" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">因为React Native还没有SSO模块，所以我需要在Native中实现它，并从JavaScript访问它。</p><p id="47a1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">打开<code class="eh ls lt lu lv b">SSOExample.xcodeproj</code>，在<code class="eh ls lt lu lv b">Libraries</code>下添加2个新文件。</p><p id="7a06" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b"><strong class="je ig"><em class="mg">TwitterSignin.h</em></strong></code>T15这是一个实现<code class="eh ls lt lu lv b">RCTBridgeModule</code>协议的头文件。如果你想知道，RCT是ReaCT的缩写。</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="md me l"/></div><figcaption class="mh mi fg fe ff mj mk bd b be z ek"><code class="eh ls lt lu lv b"><em class="ml">TwitterSignin.h</em></code></figcaption></figure><p id="96e0" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b"><strong class="je ig"><em class="mg">TwitterSignin.m</em></strong></code>T16这是一个Objective-C文件。除了实现<code class="eh ls lt lu lv b">RCTBridgeModule</code>协议，该类还必须包含<code class="eh ls lt lu lv b">RCT_EXPORT_MODULE()</code>宏。这需要一个可选的参数，该参数指定了JavaScript代码中可以访问的模块的名称。如果不指定名称，JavaScript模块名称将与Objective-C类名匹配。</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="md me l"/></div></figure><p id="cf5a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因为React Native在一个单独的串行GCD队列上调用本机模块方法，这可能会改变，所以我想指定只使用主线程。这是使用<code class="eh ls lt lu lv b">- (dispatch_queue_t)methodQueue</code>完成的。</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="md me l"/></div><figcaption class="mh mi fg fe ff mj mk bd b be z ek">TwitterSignin.m</figcaption></figure><p id="e2c8" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">React Native不会将<code class="eh ls lt lu lv b">TwitterSignin</code>的任何方法暴露给JavaScript，除非被明确告知这样做。这是使用<code class="eh ls lt lu lv b">RCT_EXPORT_METHOD()</code>宏完成的:</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="md me l"/></div><figcaption class="mh mi fg fe ff mj mk bd b be z ek"><code class="eh ls lt lu lv b">TwitterSignin.m</code></figcaption></figure><p id="b277" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里我们创建了一个方法<code class="eh ls lt lu lv b">logIn</code>，它将回调作为参数，当登录完成时，无论成功还是失败，回调都会被触发。</p><p id="7199" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要了解更多信息，您可以访问官方指南<a class="ae ka" href="https://facebook.github.io/react-native/docs/native-modules-ios.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h2 id="c888" class="le kc if bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">5.从JavaScript触发</h2><p id="f4f4" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">现在，当点击登录按钮时，我触发了上面创建的<code class="eh ls lt lu lv b">logIn</code>方法。</p><p id="cbb5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用<code class="eh ls lt lu lv b">react-native</code>中的<code class="eh ls lt lu lv b">NativeModules</code>访问<code class="eh ls lt lu lv b">LogIn</code>方法。</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="md me l"/></div></figure><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div class="fe ff mm"><img src="../Images/31b4e98fe000c71a9119d92fb46367f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/1*zJ273-IgDtH3lZSXdPbvvA.gif"/></div></figure><p id="1aa9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">感谢您的阅读，如果您喜欢这篇文章，请点击“推荐”或在下面写一个回复。你可以在推特上联系我<a class="ae ka" href="https://twitter.com/narendra_shetty" rel="noopener ugc nofollow" target="_blank"> @narendra_shetty </a>。</p><p id="c9e9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我写的其他文章:</p><div class="ht hu fm fo hv mn"><a href="https://hackernoon.com/how-i-built-a-super-fast-uber-clone-for-mobile-web-863680d2100f" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd ig fv z el ms eo ep mt er et ie dt translated">我如何为移动网络建立一个超快的优步克隆</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">这篇文章是关于我对性能技术的学习，这些技术用于使优步移动网络尽可能快地反应。</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">hackernoon.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ib mn"/></div></div></a></div><div class="ht hu fm fo hv mn"><a href="https://crowdfire.engineering/redux-explained-in-4-simple-steps-12266c39b72f" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd ig fv z el ms eo ep mt er et ie dt translated">我是如何学习冗余概念的</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">所以在过去的几个月里，Javascript社区中有很多关于React和Redux的争论。每个人都…</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">众包工程</p></div></div></div></a></div><div class="ht hu fm fo hv mn"><a href="https://crowdfire.engineering/how-we-built-the-fastest-extension-for-chrome-65d695972dee" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab ej"><div class="mp ab mq cl cj mr"><h2 class="bd ig fv z el ms eo ep mt er et ie dt translated">我们如何为Chrome构建最快的扩展</h2><div class="mu l"><h3 class="bd b fv z el ms eo ep mt er et ek translated">我们一直想找到一种方法，随时随地分享任何东西。我们的想法是让一些东西…</h3></div><div class="mv l"><p class="bd b gc z el ms eo ep mt er et ek translated">众包工程</p></div></div></div></a></div><div class="lx ly lz ma fq ab cb"><figure class="nc hw nd ne nf ng nh paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nc hw nd ne nf ng nh paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nc hw nd ne nf ng nh paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ni nj nk"><p id="f922" class="jc jd mg je b jf jg jh ji jj jk jl jm nl jo jp jq nm js jt ju nn jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ka" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd mg je b jf jg jh ji jj jk jl jm nl jo jp jq nm js jt ju nn jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff no"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="np me l"/></div></figure></div></div>    
</body>
</html>