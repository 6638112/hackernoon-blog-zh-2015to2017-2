<html>
<head>
<title>The Programmer’s Guide to Booking a Plane</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预订飞机的程序员指南</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/the-programmers-guide-to-booking-a-plane-11e37d610045?source=collection_archive---------2-----------------------#2016-12-20">https://medium.com/hackernoon/the-programmers-guide-to-booking-a-plane-11e37d610045?source=collection_archive---------2-----------------------#2016-12-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="7d0b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">大约两个月前，我想去度假。我差不多已经选好了旅馆，但交通工具还没确定。</p><p id="65db" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我开始在网上寻找便宜的飞机票，就像普通的T2旅行者和T3一样。我找遍了所有的豪华航空公司，但它们的票价对我来说都太高了。</p><p id="96de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我决定去看看西南航空，事实上的低价航空公司(其实不是)。我从一些网民那里听说<a class="ae jp" href="https://hackernoon.com/tagged/ticket" rel="noopener ugc nofollow" target="_blank">的门票</a>会在周二晚上降价，所以我开始验证这一说法。我开始全天定期查看票价。</p><p id="283d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几天过去了。</p><p id="0e98" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新装弹。</p><p id="70dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新装弹。</p><p id="1889" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">"您想重新提交这个表单吗？"</p><p id="ab4c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">是的。</p><p id="0fb5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新装弹。</p><p id="0a36" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">没什么。</p><p id="6268" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我开始对重复感到厌烦(惊讶，惊讶！)，所以我开始尽我所能让事情自动化。如果我写一个脚本来替我做这些烦人的任务呢？是啊。我喜欢这个主意。</p><h1 id="fd94" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">爬西南网站</h1><p id="514f" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">快速浏览一下西南航空的网站，发现没有API。(这并不奇怪。)</p><p id="de9b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我认为直接抓取他们的网站是一种有效的方法。我可以写一个脚本，你知道，从他们的网站上搜集我想要的数据。</p><p id="a82f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我选择Node是因为我认为他们有很好的web抓取工具，在这一点上我或多或少是正确的。</p><p id="4160" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我开始试验算法…呃，脚本时，我意识到在西南航空的网站上伪造表单提交比我想象的要困难得多，这样我就可以进入结果页面。</p><p id="a2ae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我试过卷发。</p><p id="bad1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我试过“复制为卷曲”</p><p id="925f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我试着假装用户代理。</p><p id="9837" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我尝试了所有的方法。</p><p id="5b48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">解决方案是使用<a class="ae jp" href="https://github.com/rchipka/node-osmosis" rel="noopener ugc nofollow" target="_blank">渗透</a>来填写并提交搜索表单，<em class="kt">然后</em>抓取结果页面。</p><p id="741d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以，我构建了一个快速而肮脏的命令行脚本，不时地抓取他们的网站。然后我让它每天晚上在我睡觉的时候做它的事情。它并不花哨，但它做了我让它做的事。</p><figure class="kv kw kx ky fq kz fe ff paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="fe ff ku"><img src="../Images/e0ac61a72d7428e6fe4b672ae5f514ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4d1J91TUjq9OQDgHPDhk9A.png"/></div></div></figure><h1 id="bb0b" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">分析票价</h1><p id="a6cc" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我写了一个节点脚本…等等，我已经说过了。好吧。我有一个正在运行的脚本。它正在打印票价，但我不确定该如何处理这些数据。我又不想坐在那里看一晚上。</p><p id="e509" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那我做了什么？我联系了Twilio，每当车费达到某个阈值时，它就会给我发一条短信。Twilio提供了一个免费账户，只要你验证了你要发送短信的电话号码，所以这很棒。所以我验证了我的号码，让短信进来。</p><p id="6ba9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于我没有想清楚，我也选择以低间隔发送短信，这样它会一直ping我，直到我停止脚本，即使我正在和我可爱的妻子约会。</p><p id="00ae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一点也不讨厌。/s</p><p id="558f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是效果很好。我可以看到票价确实下降了，尤其是在深夜。这次上网的人没有骗我。</p><h1 id="cde7" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">绘制数据</h1><p id="ac3d" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">过了几天，我有点烦了(有什么新鲜事？)看着一串文字，想出复杂的方法，让我每天看它的那几秒钟看起来更有吸引力。</p><p id="a2d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那我做了什么？我联系了<a class="ae jp" href="https://github.com/chjj/blessed" rel="noopener ugc nofollow" target="_blank">福佑</a>给我画一些图表，让事情看起来很漂亮。我在可爱的<a class="ae jp" href="https://github.com/FormidableLabs/webpack-dashboard" rel="noopener ugc nofollow" target="_blank"> webpack-dashboard </a>中看到过祝福被使用，所以我想“为什么不呢？”。</p><p id="561d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">太棒了。谢谢肯·惠勒。</p><figure class="kv kw kx ky fq kz fe ff paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="fe ff lg"><img src="../Images/28e6a30eef5ce1af259339758e4d35b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RXcp2yG30CwcKRK4wP4fw.png"/></div></div></figure><h1 id="4bec" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">预订航班</h1><p id="7ed9" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">几天后，在一个普通的周二晚上，事情发生了:价格急剧下跌，这不是每周二都会发生的事情，而是随机发生的。我抢到了不到100美元的票。(当然，我是手动预订的，因为我的剧本没有<em class="kt">那么好。)</em></p><h1 id="ec98" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">甜蜜的胜利</h1><p id="9ace" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">一个月后，我去度假。仅此而已。如果你也想度过一个愉快的假期，你可以在GitHub上查看这个项目。</p><blockquote class="lh li lj"><p id="4d83" class="ir is kt it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated"><strong class="it hv">注:截至2017年7月，由于西南航空公司的撤销请求，该项目在GitHub上不再可用。</strong></p></blockquote><div class="kv kw kx ky fq ab cb"><figure class="ln kz lo lp lq lr ls paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ln kz lo lp lq lr ls paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ln kz lo lp lq lr ls paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lh li lj"><p id="f922" class="ir is kt it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是AMI家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is kt it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kv kw kx ky fq kz fe ff paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="fe ff lt"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kv kw kx ky fq kz"><div class="bz el l di"><div class="lu lv l"/></div></figure></div></div>    
</body>
</html>