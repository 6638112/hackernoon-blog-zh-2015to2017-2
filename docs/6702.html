<html>
<head>
<title>Creating Interfaces for Angular Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为角度服务创建接口</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/creating-interfaces-for-angular-services-1bb41fbbe47c?source=collection_archive---------0-----------------------#2017-10-01">https://medium.com/hackernoon/creating-interfaces-for-angular-services-1bb41fbbe47c?source=collection_archive---------0-----------------------#2017-10-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="ef89" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当处理一个需要根据上下文访问不同数据源的类时，用一个公共接口对这些数据源建模通常是有用的。同样，在Angular中，我们可能会遇到这样的情况，注入的服务需要根据其上下文有不同的实现，这是接口的完美候选。然而，由于接口没有被编译到TypeScript的JavaScript输出中，用Angular服务来实现这一点是相当不直观的。</p><p id="2762" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本指南将通过一个简单的应用程序演示如何在Angular中创建服务接口。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/e8e71e6c69f97366c1d64ba16695ec05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Gg-5TI6iOLPJ_Zn8aC1irg.gif"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">Easily Swap Providers for Different Implementations</figcaption></figure><p id="d54b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这个<a class="ae kf" href="https://github.com/mgmarlow/Creating-Interfaces-Angular-Services" rel="noopener ugc nofollow" target="_blank">裸机应用程序</a>中，我将建立一个todo-list组件，它与两种不同类型的数据兼容:(a)公共数据，包含每个人都可见的todo和(b)私有数据，包含只对给定用户可见的todo。然后，我将演示如何在这种情况下利用接口服务来帮助促进代码重用。</p><h2 id="ff48" class="kg kh hu bd ki kj kk kl km kn ko kp kq jc kr ks kt jg ku kv kw jk kx ky kz la dt translated">接口服务</h2><p id="d324" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">我在上面提到过Angular不允许我们提供接口作为提供者，因为接口不是由TypeScript编译的。因此，当将服务建模为接口时，我们实际上必须使用抽象类。由于这个原因，当我引用接口服务时，我实际上指的是抽象类。</p><p id="9c43" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们设置作为基础的第一个服务:</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="lg lh l"/></div></figure><p id="a67b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh li lj lk ll b">TodoListService</code>是一个简单的抽象类，除了我们的公共和私有实现之间的共享逻辑的定义之外，它什么也不包含(稍后会显示)。这个类实际上只不过是一个通知Angular关于<code class="eh li lj lk ll b">getTodos</code>方法的容器。通过使用这个服务，我们可以利用Angular的内置依赖注入来交换公共或私有数据的输入/输出实现。</p><p id="e167" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们为公共和私人todos提供一些快速服务:</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="lg lh l"/></div></figure><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="lg lh l"/></div></figure><p id="76d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">行<code class="eh li lj lk ll b">implements TodoListService</code>是告诉Angular使用这些服务中的任何一个来代替基本服务<code class="eh li lj lk ll b">TodoListService</code>是没问题的关键部分。这些服务需要做的另一件事是为接口服务中定义的所有方法提供实现；在这种情况下，方法就是<code class="eh li lj lk ll b">getTodos</code>。</p><p id="5762" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，让我们设置待办事项列表的组件:</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="lg lh l"/></div></figure><p id="4040" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是接口服务真正发挥作用的地方。在<code class="eh li lj lk ll b">TodoListComponent</code>的构造函数中，我们可以引用我们的基础类<code class="eh li lj lk ll b">TodoListService</code>，而不需要区分公共或私有实现。<strong class="it hv">对于组件，任何实现</strong> <code class="eh li lj lk ll b">TodoListService</code> <strong class="it hv">的服务都是有效的。</strong>这意味着我们可以根据我们在特定组件或模块中的需求来交换公共和私有实现。</p><p id="84d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">实际的交换发生在组件定义中的<code class="eh li lj lk ll b">providers</code>数组内。下面的代码行:<code class="eh li lj lk ll b">{ provide: TodoListService, useClass: TodoListPublicService }</code>通知Angular，组件中对<code class="eh li lj lk ll b">TodoListService</code>的任何引用都将调用<code class="eh li lj lk ll b">TodoListPublicService</code>上的相同方法。类似地，如果我们想切换到私有数据，我们可以简单地将<code class="eh li lj lk ll b">useClass</code>属性切换到<code class="eh li lj lk ll b">TodoListPrivateService</code>。</p><p id="e0ef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">需要注意的是，为了使用这个模式，这个<code class="eh li lj lk ll b">providers</code>数组不需要存在于组件上。同样的技术可以用在模块级。</p><h2 id="55f7" class="kg kh hu bd ki kj kk kl km kn ko kp kq jc kr ks kt jg ku kv kw jk kx ky kz la dt translated">资源:</h2><ul class=""><li id="0817" class="lm ln hu it b iu lb iy lc jc lo jg lp jk lq jo lr ls lt lu dt translated">App代码:<a class="ae kf" href="https://github.com/mgmarlow/Creating-Interfaces-Angular-Services" rel="noopener ugc nofollow" target="_blank">https://github . com/mgmarlow/Creating-Interfaces-Angular-Services</a></li></ul><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="lv lh l"/></div></figure></div></div>    
</body>
</html>