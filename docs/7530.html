<html>
<head>
<title>Build a “Serverless” Reddit Bot in 3 Steps with Node.js and StdLib Sourcecode</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js和StdLib源代码分三步构建一个“无服务器”Reddit机器人</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-a-serverless-reddit-bot-in-3-steps-with-node-js-and-stdlib-sourcecode-e5296b78fc64?source=collection_archive---------7-----------------------#2017-10-31">https://medium.com/hackernoon/build-a-serverless-reddit-bot-in-3-steps-with-node-js-and-stdlib-sourcecode-e5296b78fc64?source=collection_archive---------7-----------------------#2017-10-31</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e9d5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<a class="ae jp" href="https://stdlib.com" rel="noopener ugc nofollow" target="_blank"> StdLib </a>，我们是Reddit的忠实粉丝。如果你花时间浏览Reddit，毫无疑问你会遇到一些机器人。他们有许多不同的目的，从调节子主题到总结文章。不管他们的目标是什么，许多机器人只执行两个基本任务:阅读评论和回复符合特定标准的评论。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/9fb1f3c516de0b490154a27087ee4a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8-NPoUXUiJVMnmQuqMf2A.jpeg"/></div></div></figure><p id="30c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本指南中，您将了解如何仅从您的浏览器部署一个无限可扩展的“无服务器”Reddit机器人。最终，你将拥有一个机器人，它会阅读并回复包含“嘿<a class="ae jp" href="https://en.wikipedia.org/wiki/Marvin_(character)" rel="noopener ugc nofollow" target="_blank">马文</a>”的评论，但你将完全能够定制你的机器人所回复的内容。您需要做的唯一配置是指定您想要扫描的子编辑和您的reddit凭证。</p><p id="b41e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本指南由<a class="ae jp" href="https://stdlib.com/sourcecode" rel="noopener ugc nofollow" target="_blank"> StdLib源代码</a>提供支持。你可以在这里阅读StdLib源代码<a class="ae jp" rel="noopener" href="/stdlibhq/introducing-stdlib-sourcecode-share-your-node-js-serverless-code-with-developers-worldwide-b8fd5714e430">的介绍。简而言之，sourcecode是使用新的无服务器技术</a><a class="ae jp" href="https://hackernoon.com/tagged/technology" rel="noopener ugc nofollow" target="_blank">开始构建和</a><a class="ae jp" href="https://hackernoon.com/tagged/deploying" rel="noopener ugc nofollow" target="_blank">部署</a> web应用的最简单的方法。通过利用StdLib的合作伙伴和社区构建的模板，除了这个Reddit bot之外，您还可以直接从浏览器部署各种项目，如Slack应用程序、Stripe商店和Twilio消息中心。</p><h2 id="7e80" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">第一步:注册一个Reddit应用</h2><p id="6a74" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">登录Reddit，前往<a class="ae jp" href="https://www.reddit.com/prefs/apps/" rel="noopener ugc nofollow" target="_blank"> Reddit应用偏好页面</a>，点击“创建应用”。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff lc"><img src="../Images/2c237e017517a0c2d1b29428ccfeb51b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5TGHBJGNptiFxHs3oyDaqw.png"/></div></div><figcaption class="ld le fg fe ff lf lg bd b be z ek">Creating a Reddit App</figcaption></figure><p id="de60" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">给它起一个你喜欢的名字，然后选择脚本类型。一个基于脚本的应用程序将发布创建它的帐户的评论。所以，如果你不想在你的普通帐户下发布这个bot，你应该创建一个新的。拥有验证电子邮件的帐户可以发布更多内容，因此如果您使用新帐户，请确保添加电子邮件。最后，Reddit应用程序需要一个重定向URI。但是您不会使用它，所以只需放入一个虚拟的，比如<code class="eh lh li lj lk b"><a class="ae jp" href="http://www.example.com/" rel="noopener ugc nofollow" target="_blank">http://www.example.com/</a></code></p><h2 id="9a27" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">步骤2:部署Reddit应用程序</h2><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ll"><img src="../Images/c9216567fb9f1099b5012a5b671a6f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J7GGN11Qvex17Jq7zYienQ.png"/></div></div><figcaption class="ld le fg fe ff lf lg bd b be z ek">Reddit Bot Sourcecode</figcaption></figure><p id="c47b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">保持应用程序首选项页面打开，导航到<a class="ae jp" href="https://stdlib.com/@steve/src/reddit-bot/" rel="noopener ugc nofollow" target="_blank"> Reddit Bot源代码页面</a>并向下滚动到行内编辑器。打开functions文件夹，您会发现四个文件:</p><ul class=""><li id="f941" class="lm ln hu it b iu iv iy iz jc lo jg lp jk lq jo lr ls lt lu dt translated"><code class="eh lh li lj lk b">__main__</code>:从子编辑中读取最近的评论，寻找关键词，并对包含它们的评论做出响应。</li><li id="2334" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated"><code class="eh lh li lj lk b">clean</code>:接受一个数字，删除任何分数(投票数加投票数)低于该数字的评论。这使得阅读子编辑的用户可以删除不想要的评论。</li><li id="abbb" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated"><code class="eh lh li lj lk b">reply</code>:由<code class="eh lh li lj lk b">__main__</code>使用，此功能回复帖子或评论。记住，Reddit支持markdown，所以你可以在这里真正发挥创造力。</li><li id="ec5e" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated"><code class="eh lh li lj lk b">delete</code>:由<code class="eh lh li lj lk b">clean</code>使用，该函数用于删除机器人发布的帖子。</li></ul><p id="1340" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您可以单击“从源创建服务”,系统会提示您输入一些环境变量。前两个，<code class="eh lh li lj lk b">REDDIT_SECRET</code>和<code class="eh lh li lj lk b">REDDIT_KEY</code>可以在Reddit <a class="ae jp" href="https://www.reddit.com/prefs/apps/" rel="noopener ugc nofollow" target="_blank">应用偏好页面</a>找到。最后两个只是Reddit帐户的用户名和密码。填写完这些内容后，您可以单击Deploy，您的bot将在开发环境中投入使用。</p><p id="861e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们可以直接从命令行测试这个机器人。如果您没有<a class="ae jp" href="http://github.com/stdlib/lib" rel="noopener ugc nofollow" target="_blank"> StdLib命令行工具</a>，那么您可以通过运行:</p><pre class="jr js jt ju fq ma lk mb mc aw md dt"><span id="cf99" class="kc kd hu lk b fv me mf l mg mh">$ npm install lib.cli -g</span></pre><p id="be4f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用<code class="eh lh li lj lk b">$ lib init</code>导航到StdLib工作区或在空目录中创建一个工作区。您需要通过身份验证才能运行此服务，这可以防止其他人从您的Reddit帐户发帖。你可以在这里得到一个库令牌<a class="ae jp" href="https://dashboard.stdlib.com/dashboard/#/tokens" rel="noopener ugc nofollow" target="_blank">。现在您可以运行:</a></p><pre class="jr js jt ju fq ma lk mb mc aw md dt"><span id="f134" class="kc kd hu lk b fv me mf l mg mh">$ lib &lt;username&gt;.reddit-bot[@dev] stdlibbots -t &lt;library token&gt;</span></pre><p id="f029" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">转到<a class="ae jp" href="https://www.reddit.com/r/StdLibBots/comments/796n4l/hello_world/" rel="noopener ugc nofollow" target="_blank">这个帖子</a>，你应该会看到一个来自你的机器人的帖子。</p><h2 id="8162" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">步骤3:运行机器人</h2><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mi"><img src="../Images/688963452dfea7850b936e6140ee699d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JjQyj8GaxO4RhXYHqyhZUQ.png"/></div></div><figcaption class="ld le fg fe ff lf lg bd b be z ek">Creating a Scheduled Task from the Command Line</figcaption></figure><p id="3de4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有了读取和回复帖子的API，您现在要做的就是让它保持运行。这是StdLib的<a class="ae jp" href="http://docs.stdlib.com/main/#/scheduled-tasks" rel="noopener ugc nofollow" target="_blank">预定任务</a>的一个很好的用例。您只能使用服务的不可变发布版本运行计划任务。要获得bot的代码并发布它的发布版本，请运行:</p><pre class="jr js jt ju fq ma lk mb mc aw md dt"><span id="7a35" class="kc kd hu lk b fv me mf l mg mh">$ lib get &lt;username&gt;/reddit-bot<br/>$ cd &lt;username&gt;/reddit-bot<br/>$ lib release</span></pre><p id="441b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您可以使用以下选项设置计划任务:</p><pre class="jr js jt ju fq ma lk mb mc aw md dt"><span id="2c9c" class="kc kd hu lk b fv me mf l mg mh">$ lib tasks:create &lt;username&gt;/reddit-bot </span></pre><p id="a873" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">结果提示将要求您提供一个StdLib库标记。您的Reddit bot将只响应使用您的库令牌之一进行身份验证的请求，在此处指定一个令牌允许计划任务正确触发您的bot。接下来，提示符将询问您希望您的bot运行在哪个子目录中。最后，您需要指定希望任务运行的频率。根据subreddit的受欢迎程度，你可以少运行一次，但是每五分钟一次(或者一小时十二次)应该可以。</p><p id="0283" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您应该设置一个计划任务来删除不想要的注释，方法是:</p><pre class="jr js jt ju fq ma lk mb mc aw md dt"><span id="4eec" class="kc kd hu lk b fv me mf l mg mh">$ lib tasks:create &lt;username&gt;/reddit-bot clean</span></pre><p id="3998" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">提示将询问您希望为删除设置什么阈值，以及应该多长时间运行一次。类似于-5和每小时一次将是一个很好的开始。</p><p id="2863" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！现在你有了一个Reddit机器人来监控一个subreddit并自动回复评论。</p><h2 id="6759" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">添加功能</h2><p id="5160" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">既然您已经有了一个简单的机器人，您可能会对创建更复杂的工作流感兴趣。正如我前面提到的，您可以使用<code class="eh lh li lj lk b">$ lib get &lt;username&gt;/reddit-bot</code>来检索您可以获得的服务代码。您可以使用<code class="eh lh li lj lk b">$ lib up dev</code>修改代码并将其发布到开发环境中，或者使用<code class="eh lh li lj lk b">$ lib release</code>创建一个新的发布版本。</p><p id="f2d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您创建了自己喜欢的东西，您可以使用<code class="eh lh li lj lk b">$ lib source</code>将您的服务转换成新的源代码。这将在一个新的目录中创建一个新的代码副本。你可以发布这个源代码供其他人使用<code class="eh lh li lj lk b">$ lib source:publish</code>。</p></div><div class="ab cl mj mk hc ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hn ho hp hq hr"><p id="b576" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！感谢阅读！希望本指南已经向您展示了<a class="ae jp" href="https://stdlib.com/sourcecode" rel="noopener ugc nofollow" target="_blank"> Stdlib源代码</a>的一些功能。构建一个Reddit机器人只是开始使用源代码的众多方法之一。如果你有好主意想分享，请直接通过电子邮件联系我:<strong class="it hv">steven@stdlib.com</strong>，或者在Twitter上关注<a class="ae jp" href="https://twitter.com/notoriaga" rel="noopener ugc nofollow" target="_blank">我</a>和<a class="ae jp" href="https://twitter.com/stdlibhq" rel="noopener ugc nofollow" target="_blank"> StdLib </a>团队。</p><p id="aa87" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一如既往，我们期待着您和快乐大厦的来信</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mq mr l"/></div></figure></div></div>    
</body>
</html>