<html>
<head>
<title>How to get your Rails data into your React component with webpacker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用webpacker将Rails数据放入React组件</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-get-your-rails-data-into-your-react-component-with-webpacker-647dc63706c9?source=collection_archive---------4-----------------------#2017-07-04">https://medium.com/hackernoon/how-to-get-your-rails-data-into-your-react-component-with-webpacker-647dc63706c9?source=collection_archive---------4-----------------------#2017-07-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/3fb37e250aa35b54f35769a2e749d3d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw_9PbZP_8AaETxv0gLg6A.jpeg"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek"><a class="ae ih" href="https://www.flickr.com/photos/brown_family_album/4607229964/in/photolist-828fXo-6Ro25k-6jbEiu-nm9pLx-59ieDH-9vcZmd-59nsGs-9JSwsa-5Xt5Eu-4x6QvY-4fVVgX-59ieRR-4TB9fW-4W7vXa-5c5VNi-6oYjp5-5c5ZHx-7YGrbH-4pJ6Vy-7ogiPd-6oYdVj-4YANTt-QJYLeN-9pBwXx-8YtnEy-3SBgZp-4VQ87M-4fVV7M-4okqZN-ajDUJ7-4s2BwV-5P8zYT-6oUcfz-7ocpZt-b99uck-ka1ELz-4pJ68Y-4xLDHU-ka1aY6-4pE3kH-4pJ7DQ-3ehSBX-ka1KYD-4pEaxP-4pE1Zv-4pE762-4pE4Ei-95BihD-4pE1Kx-ka1CbV" rel="noopener ugc nofollow" target="_blank">Photo credit</a></figcaption></figure><div class=""/><p id="6850" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae ih" href="https://github.com/rails/webpacker" rel="noopener ugc nofollow" target="_blank"> <strong class="jj il"> webpacker gem </strong> </a>给了我们一个简单的方法来使用<a class="ae ih" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>库，包括React，在Rails内部使用原生JS <a class="ae ih" href="https://hackernoon.com/tagged/tools" rel="noopener ugc nofollow" target="_blank">工具</a>如yarn和Webpack。</p><p id="92db" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您使用的是Rails 5.1或更高版本，只需运行以下命令，您就可以直接创建一个带有React支持的新应用程序:</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="7c65" class="ko kp ik kk b fv kq kr l ks kt">$ rails new myapp --webpack=react</span></pre><p id="67c1" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您使用的是旧版本的Rails (4.2+)，您可以安装webpacker gem，然后运行</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="a14b" class="ko kp ik kk b fv kq kr l ks kt">$ ./bin/rails webpacker:install</span><span id="b41a" class="ko kp ik kk b fv ku kr l ks kt">$ ./bin/rails webpacker:install:react</span></pre><p id="5c7b" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后，您只需将React组件放在新创建的app/javascript/packs目录中，并在视图中将它们与javascript_pack_tag辅助方法一起使用。</p><p id="6ae7" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">但是如果你以前使用过<a class="ae ih" href="https://github.com/reactjs/react-rails" rel="noopener ugc nofollow" target="_blank"> <strong class="jj il"> react-rails </strong> </a>或<a class="ae ih" href="https://github.com/shakacode/react_on_rails" rel="noopener ugc nofollow" target="_blank"><strong class="jj il">react _ on _ rails</strong></a>gem，你可能会想知道如何用webpacker将你的Rails模型数据放入React组件。</p><p id="5954" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">react-rails和react_on_rails都提供了一个名为react_component的助手方法，您可以在视图中使用它来呈现一个组件并将数据作为道具传递给它。</p><p id="ec9a" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我们仔细观察一下，react_component方法将Rails数据放在页面上div的数据属性中:</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="7f1a" class="ko kp ik kk b fv kq kr l ks kt">react_component(‘Appointments’, appointments: @appointments)</span></pre><p id="29a4" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您检查页面的源代码，您可以看到在一个div中加载的数据，数据属性为react-class和react-props:</p><figure class="kf kg kh ki fq hw fe ff paragraph-image"><div class="ab fr cl kv"><img src="../Images/427a696bcf8287c2f1196bd6858823d4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*VEdiGXB7q6FGFleViYKkXQ.png"/></div></figure><p id="6405" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后，在页面加载时，使用一些JavaScript代码(react_ujs)来解析数据，并将其传递给react组件:</p><p id="f2d9" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">默认情况下，webpacker不提供任何这样的便利方法。</p><p id="136d" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以我们必须编写自己的代码来做同样的事情。</p><p id="a9ac" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，让我们将数据作为JSON放入视图中一个div的data属性中，我们希望在该视图中呈现React组件:</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="a082" class="ko kp ik kk b fv kq kr l ks kt">&lt;%= content_tag :div,<br/>  id: "appointments_data",<br/>  data: <a class="ae ih" href="http://twitter.com/appointments" rel="noopener ugc nofollow" target="_blank">@appointments</a>.to_json do %&gt;<br/>&lt;% end %&gt;</span></pre><p id="0dc3" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你使用HAML，你可以简单地做:</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="2b19" class="ko kp ik kk b fv kq kr l ks kt">#appointments_data{data: @appointments.to_json}</span></pre><p id="9d68" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后，在加载完所有DOM内容后解析数据，并将其传递给约会组件:</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="7818" class="ko kp ik kk b fv kq kr l ks kt">document.addEventListener('DOMContentLoaded', () =&gt; {<br/>  const node = document.getElementById('appointments_data')<br/>  const data = JSON.parse(node.getAttribute('data'))</span><span id="18cd" class="ko kp ik kk b fv ku kr l ks kt">  ReactDOM.render(<br/>    &lt;Appointments appointments={data} /&gt;,<br/>    document.body.appendChild(document.createElement('div')),<br/>  )<br/>})</span></pre><p id="01cc" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">仅此而已！您的数据现在将被传递到React组件。</p><p id="7faa" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你不想这么做，你也可以使用webpacker-react gem ，它提供了一个react_component辅助方法。</p><p id="6737" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在Github上查看该示例应用程序的完整代码:</p><div class="ht hu fm fo hv kw"><a href="https://github.com/learnetto/calreact/tree/lesson-4.5" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab ej"><div class="ky ab kz cl cj la"><h2 class="bd il fv z el lb eo ep lc er et ij dt translated">learnetto/calreact</h2><div class="ld l"><h3 class="bd b fv z el lb eo ep lc er et ek translated">calreact - React和Rails 5日历约会应用</h3></div><div class="le l"><p class="bd b gc z el lb eo ep lc er et ek translated">github.com</p></div></div><div class="lf l"><div class="lg l lh li lj lf lk ib kw"/></div></div></a></div><p id="2a4f" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="ll">如果你想免费学习如何使用React with Rails，请查看Learnetto </em>   <em class="ll">上的</em> <a class="ae ih" href="https://learnetto.com" rel="noopener ugc nofollow" target="_blank"> <strong class="jj il"> <em class="ll">免费React on Rails教程。</em></strong></a></p><p id="eaef" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可能也会喜欢这些文章:</p><div class="ht hu fm fo hv kw"><a rel="noopener follow" target="_blank" href="/react-on-rails/3-ways-to-use-react-with-ruby-on-rails-5-1e49171f8eb6"><div class="kx ab ej"><div class="ky ab kz cl cj la"><h2 class="bd il fv z el lb eo ep lc er et ij dt translated">使用React with Ruby on Rails 5的3种方式</h2><div class="ld l"><h3 class="bd b fv z el lb eo ep lc er et ek translated">重要更新(2017年7月6日):随着Rails 5.1的发布，Rails现在通过…</h3></div><div class="le l"><p class="bd b gc z el lb eo ep lc er et ek translated">medium.com</p></div></div><div class="lf l"><div class="lm l lh li lj lf lk ib kw"/></div></div></a></div><div class="ht hu fm fo hv kw"><a href="https://medium.freecodecamp.org/every-time-you-build-a-to-do-list-app-a-puppy-dies-505b54637a5d" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab ej"><div class="ky ab kz cl cj la"><h2 class="bd il fv z el lb eo ep lc er et ij dt translated">✅每次你建立一个待办事项应用程序，一只小狗🐕死亡😢</h2><div class="ld l"><h3 class="bd b fv z el lb eo ep lc er et ek translated">你知道当你试图学习一些新的东西，但对构建默认的示例应用程序感到厌倦的时候？</h3></div><div class="le l"><p class="bd b gc z el lb eo ep lc er et ek translated">medium.freecodecamp.org</p></div></div><div class="lf l"><div class="ln l lh li lj lf lk ib kw"/></div></div></a></div></div><div class="ab cl lo lp hc lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hn ho hp hq hr"><p id="b076" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="ll">原载于</em><a class="ae ih" href="https://learnetto.com/blog/how-to-get-your-rails-data-into-your-react-component-with-webpacker" rel="noopener ugc nofollow" target="_blank"><em class="ll">learnetto.com</em></a><em class="ll">。</em></p><div class="kf kg kh ki fq ab cb"><figure class="lv hw lw lx ly lz ma paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lv hw lw lx ly lz ma paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lv hw lw lx ly lz ma paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mb mc md"><p id="f922" class="jh ji ll jj b jk jl jm jn jo jp jq jr me jt ju jv mf jx jy jz mg kb kc kd ke hn dt translated"><a class="ae ih" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是T21家庭的一员。我们现在<a class="ae ih" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ih" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jh ji ll jj b jk jl jm jn jo jp jq jr me jt ju jv mf jx jy jz mg kb kc kd ke hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ih" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ih" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kf kg kh ki fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mh"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kf kg kh ki fq hw"><div class="bz el l di"><div class="mi mj l"/></div></figure></div></div>    
</body>
</html>