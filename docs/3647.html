<html>
<head>
<title>js-middleware makes your JS codes as scalable as ReduxJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">js-中间件使你的JS代码像ReduxJS一样可伸缩</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/js-middleware-makes-your-js-codes-as-scalable-as-reduxjs-45be85a9196a?source=collection_archive---------14-----------------------#2017-04-13">https://medium.com/hackernoon/js-middleware-makes-your-js-codes-as-scalable-as-reduxjs-45be85a9196a?source=collection_archive---------14-----------------------#2017-04-13</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><h1 id="5249" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">js-中间件</h1><p id="dfff" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">强大的Javascript中间件模式实现，将中间件应用于任何对象。一个无痛的解决方案，使代码像ReduxJS和ExpressJS一样可伸缩和可维护。</p><h1 id="f915" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">链接</h1><ul class=""><li id="98e5" class="kn ko hu jr b js jt jw jx ka kp ke kq ki kr km ks kt ku kv dt translated"><a class="ae kw" href="https://unbug.github.io/js-middleware/" rel="noopener ugc nofollow" target="_blank">项目概述</a></li><li id="37b7" class="kn ko hu jr b js kx jw ky ka kz ke la ki lb km ks kt ku kv dt translated"><a class="ae kw" href="https://unbug.github.io/js-middleware/docs/html/" rel="noopener ugc nofollow" target="_blank">文档</a></li><li id="6d9e" class="kn ko hu jr b js kx jw ky ka kz ke la ki lb km ks kt ku kv dt translated"><a class="ae kw" href="https://github.com/unbug/js-middleware" rel="noopener ugc nofollow" target="_blank"> GitHub回购</a></li></ul><h1 id="5838" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">概观</h1><p id="7712" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">中间件功能是可以访问目标功能及其参数、目标对象以及目标功能循环中的下一个中间件功能的功能。下一个中间件功能通常由名为next的变量表示。</p><p id="5459" class="pw-post-body-paragraph jp jq hu jr b js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki lg kk kl km hn dt translated">中间件功能可以执行以下任务:</p><ul class=""><li id="11d0" class="kn ko hu jr b js lc jw ld ka lh ke li ki lj km ks kt ku kv dt translated">执行任何代码。</li><li id="3a4d" class="kn ko hu jr b js kx jw ky ka kz ke la ki lb km ks kt ku kv dt translated">对函数的参数进行更改。</li><li id="f9d2" class="kn ko hu jr b js kx jw ky ka kz ke la ki lb km ks kt ku kv dt translated">结束目标函数。</li><li id="f32c" class="kn ko hu jr b js kx jw ky ka kz ke la ki lb km ks kt ku kv dt translated">调用堆栈中的下一个中间件。</li></ul><p id="2ed8" class="pw-post-body-paragraph jp jq hu jr b js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki lg kk kl km hn dt translated">如果当前中间件函数没有结束目标函数循环，它必须调用next()将控制传递给下一个中间件函数。否则，目标函数将被挂起。</p><h1 id="6f51" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">开始</h1><ol class=""><li id="1cb6" class="kn ko hu jr b js jt jw jx ka kp ke kq ki kr km lk kt ku kv dt translated">窗户。通过在HTML中包含<code class="eh ll lm ln lo b"><a class="ae kw" href="https://github.com/unbug/js-middleware/tree/master/dist" rel="noopener ugc nofollow" target="_blank">dist/middleware.min.js</a></code>文件，浏览器可以使用MiddlewareManager。</li></ol><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="70a9" class="lx is hu lo b fv ly lz l ma mb">&lt;script src="middleware.min.js"&gt;&lt;/script&gt;</span></pre><ol class=""><li id="6c22" class="kn ko hu jr b js lc jw ld ka lh ke li ki lj km lk kt ku kv dt translated">或者安装软件包</li></ol><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="e0f1" class="lx is hu lo b fv ly lz l ma mb">npm install --save js-middleware</span></pre><p id="d2f4" class="pw-post-body-paragraph jp jq hu jr b js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki lg kk kl km hn dt translated">并将其导入您的文件中</p><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="759f" class="lx is hu lo b fv ly lz l ma mb">import {MiddlewareManager} from 'js-middleware';</span></pre><h1 id="e94d" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">习惯</h1><h1 id="ae06" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">基础</h1><p id="2ba5" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们定义一个人类。</p><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="8e20" class="lx is hu lo b fv ly lz l ma mb">// the target object<br/>class Person {<br/>  // the target function<br/>  walk(step) {<br/>    this.step = step;<br/>  }<br/>  <br/>  speak(word) {<br/>    this.word = word;<br/>  }<br/> }</span></pre><p id="972e" class="pw-post-body-paragraph jp jq hu jr b js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki lg kk kl km hn dt translated">然后我们定义一个中间件函数来打印日志。</p><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="a017" class="lx is hu lo b fv ly lz l ma mb">// middleware for walk function<br/> const logger = target =&gt; next =&gt; (...args) =&gt; {<br/>    console.log(`walk start, steps: ${args[0]}.`);<br/>    const result = next(...args);<br/>    console.log(`walk end.`);<br/>    return result;<br/>  }</span></pre><p id="1881" class="pw-post-body-paragraph jp jq hu jr b js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki lg kk kl km hn dt translated">现在，我们将日志函数作为中间件应用于一个人实例。</p><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="6fc8" class="lx is hu lo b fv ly lz l ma mb">// apply middleware to target object<br/> const p = new Person();<br/> const middlewareManager = new MiddlewareManager(p);<br/> middlewareManager.use('walk', walk);<br/> p.walk(3);</span></pre><p id="8c0e" class="pw-post-body-paragraph jp jq hu jr b js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki lg kk kl km hn dt translated">每当一个Person实例调用它的walk方法时，我们都会看到来自looger中间件的日志。</p><h1 id="97f1" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">中间件对象</h1><p id="697c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们还可以将中间件对象应用到目标对象。中间件对象是包含与目标对象的函数名相同的函数名的对象。以“_”开头或结尾的函数名将无法应用中间件。</p><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="a525" class="lx is hu lo b fv ly lz l ma mb">const PersonMiddleware {<br/>  walk: target =&gt; next =&gt; step =&gt; {<br/>    console.log(`walk start, steps: step.`);<br/>    const result = next(step);<br/>    console.log(`walk end.`);<br/>    return result;<br/>  },<br/>  speak: target =&gt; next =&gt; word =&gt; {<br/>    word = 'this is a middleware trying to say: ' + word;<br/>    return next(word);<br/>  }<br/>}</span><span id="6bcc" class="lx is hu lo b fv mc lz l ma mb"> // apply middleware to target object<br/> const p = new Person();<br/> const middlewareManager = new MiddlewareManager(p);<br/> middlewareManager.use(PersonMiddleware);<br/> p.walk(3);<br/> p.speak('hi');</span></pre><h1 id="53bf" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">中间件方法</h1><p id="fd4e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">或者我们可以使用<code class="eh ll lm ln lo b">middlewareMethods</code>在一个类中为middleweare目标定义函数名。</p><pre class="lp lq lr ls fq lt lo lu lv aw lw dt"><span id="b2cb" class="lx is hu lo b fv ly lz l ma mb">class PersonMiddleware {<br/>  constructor() {<br/>    /**<br/>     * Define function names for middleweare target.<br/>     * @type {Array}<br/>     */<br/>    this.middlewareMethods = ['walk', 'speak'];<br/>  }<br/>  log(text) {<br/>    console.log('Middleware log: ' + text);<br/>  }<br/>  walk(target) {<br/>    return next =&gt; step =&gt; {<br/>      this.log(`walk start, steps: step.`);<br/>      const result = next(step);<br/>      this.log(`walk end.`);<br/>      return result;<br/>    }<br/>  }<br/>  speak(target) {<br/>    return next =&gt; word =&gt; {<br/>      this.log('this is a middleware tring to say: ' + word);<br/>      return next(word);<br/>    }<br/>  }<br/>}</span><span id="e9f6" class="lx is hu lo b fv mc lz l ma mb"> // apply middleware to target object<br/> const p = new Person();<br/> const middlewareManager = new MiddlewareManager(p);<br/> middlewareManager.use(new PersonMiddleware())<br/> p.walk(3);<br/> p.speak('hi');</span></pre><blockquote class="md me mf"><p id="9eb4" class="jp jq mg jr b js lc ju jv jw ld jy jz mh le kc kd mi lf kg kh mj lg kk kl km hn dt translated"><a class="ae kw" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kw" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kw" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kw" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="jp jq mg jr b js lc ju jv jw ld jy jz mh le kc kd mi lf kg kh mj lg kk kl km hn dt translated">如需了解更多信息，请<a class="ae kw" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">阅读我们的关于页面</a>、<a class="ae kw" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">喜欢/在脸书</a>上留言给我们，或简单地,<a class="ae kw" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="jp jq mg jr b js lc ju jv jw ld jy jz mh le kc kd mi lf kg kh mj lg kk kl km hn dt translated">如果您喜欢这个故事，我们建议您阅读我们的<a class="ae kw" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kw" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实视为理所当然！</p></blockquote></div></div>    
</body>
</html>