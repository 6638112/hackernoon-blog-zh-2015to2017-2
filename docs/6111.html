<html>
<head>
<title>Writing your first JavaScript library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写您的第一个JavaScript库</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/writing-your-first-javascript-library-475b776f5e73?source=collection_archive---------3-----------------------#2017-09-04">https://medium.com/hackernoon/writing-your-first-javascript-library-475b776f5e73?source=collection_archive---------3-----------------------#2017-09-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/e07dff3d22c68246c2197486618fb2ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYgWT1sgJOQXMAEEfHM8NA.jpeg"/></div></div></figure><p id="5a93" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们从介绍什么是JavaScript中的库开始。例如，您编写的用于在WebApp中执行操作的任何程序或函数都被捆绑到一个模块中，可以在任何地方轻松重用，而不是直接将代码添加到脚本中，仅供您的应用程序使用。</p><h1 id="6029" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">目标</h1><ol class=""><li id="e116" class="ky kz hu je b jf la jj lb jn lc jr ld jv le jz lf lg lh li dt translated">无依赖性(完全独立的代码和功能)</li><li id="3217" class="ky kz hu je b jf lj jj lk jn ll jr lm jv ln jz lf lg lh li dt translated">高效(最小的尺寸和处理负载)</li><li id="0b03" class="ky kz hu je b jf lj jj lk jn ll jr lm jv ln jz lf lg lh li dt translated">可重复使用，易于添加到任何项目中</li></ol><h1 id="3ac1" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">模板和功能</h1><p id="cb5a" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">JavaScript本身就是一种强大的语言。凭借其DOM(文档对象模型)操作功能，您只需使用<a class="ae lr" href="https://plainjs.com/javascript/" rel="noopener ugc nofollow" target="_blank"><em class="ls"/></a>函数就可以完成您的库需要完成的几乎所有任务。</p><p id="0792" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">以下是使用JavaScript可以对HTML和CSS做的一些事情:</p><pre class="lt lu lv lw fq lx ly lz ma aw mb dt"><span id="f249" class="mc kb hu ly b fv md me l mf mg">// Add HTML code to your page                   <br/>this.template = '&lt;div id="id"&gt;' + ' &lt;div class="class"&gt;&lt;/div&gt;';<br/>document.body.innerHTML += this.template;</span><span id="15a4" class="mc kb hu ly b fv mh me l mf mg">// Change element styling<br/>document.getElementById("id").style.display = "none";</span><span id="da53" class="mc kb hu ly b fv mh me l mf mg">// Modify element attributes<br/>document.getElementById("id").src = "";</span><span id="951c" class="mc kb hu ly b fv mh me l mf mg">// Add listeners to elements<br/>document.getElementById("id").addEventListener("click", this.function);</span></pre><h1 id="fcaa" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">基本结构</h1><p id="ebf3" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">所以一般图书馆都是<em class="ls">。js </em>文件连同<em class="ls">。css </em>文件(如果需要添加很多自定义样式)。库中使用的所有函数，连同变量，甚至要添加的HTML模板，都被打包成<em class="ls">中的一个类。js </em>文件。我之前写过一篇关于JavaScript类的文章<a class="ae lr" rel="noopener" href="/@ajay.ns08/moving-from-class-ical-languages-to-javascript-1dfa978ddcae">可能会对你有所帮助。</a></p><pre class="lt lu lv lw fq lx ly lz ma aw mb dt"><span id="cc40" class="mc kb hu ly b fv md me l mf mg">// Previewer.js<br/>// LIBRARY CLASS <br/>function Previewer() {<br/>  // Add all your code here<br/>}</span></pre><p id="b14f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后初始化模块，将<code class="eh mi mj mk ly b">var previewer = new Previewer;</code>添加到WebApp的脚本中，一次<em class="ls">。js </em>和<em class="ls">。css </em>文件<em class="ls"> </em>已经包含在你的项目中。</p><h1 id="e32f" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">结论</h1><p id="8123" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">现在，您已经了解了纯JavaScript的结构、功能以及如何将它打包成一个库。让我们看看在我们刚刚构建的上述假想库中，基本目标是如何实现的。</p><ol class=""><li id="c9b4" class="ky kz hu je b jf jg jj jk jn ml jr mm jv mn jz lf lg lh li dt translated">使用vanillaJS(基本上是纯Javascript)消除了对任何依赖的需要，使代码和功能相互独立</li><li id="3cbb" class="ky kz hu je b jf lj jj lk jn ll jr lm jv ln jz lf lg lh li dt translated">当你有最少或者没有依赖时，效率的优化是自动完成的，并且代码尽可能的紧凑</li><li id="3673" class="ky kz hu je b jf lj jj lk jn ll jr lm jv ln jz lf lg lh li dt translated">使用类和函数包装代码是基本的模块化</li></ol></div><div class="ab cl mo mp hc mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hn ho hp hq hr"><h1 id="bf47" class="ka kb hu bd kc kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx dt translated">预览器:编写我的第一个JavaScript库</h1><p id="813e" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">一个用于网络的图像预览器，它使用Picasa风格的用户界面，并且是超级轻量级的。</p><h1 id="85b9" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">摆脱依赖</h1><p id="7e1d" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">最初，我主要依靠jQuery选择器和函数来编写代码，因为我发现它们极大地简化了我的代码，也使我的工作变得容易。但是Reddit中的程序员让我意识到这根本不是一个好的实践，因为它有依赖性，这使得它效率更低；所以我不得不关闭jQuery。</p><p id="823d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当处理选中的单个元素并修改属性或样式时，这并不是很多工作。问题是当你在vanillaJS中为多个元素使用选择器时。</p><pre class="lt lu lv lw fq lx ly lz ma aw mb dt"><span id="5266" class="mc kb hu ly b fv md me l mf mg">// jQuery function that selects all elements of this class and assigns them the click listener<br/>$(".preview-image").click(function() { <br/>    // function code here<br/>});</span><span id="898d" class="mc kb hu ly b fv mh me l mf mg">// Pure JavaScript equivalent of above code<br/>var images = document.querySelectorAll(".preview-image");                                                       for(i = 0; i &lt; images.length; i++) {                           <br/>  (function(i){<br/>    images[i].addEventListener('click', function () { <br/>        // function code here               <br/>    });                        <br/>  })(i) <br/>}</span></pre><p id="3c2f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是因为JavaScript在查询元素时会返回一个对象数组，所以必须为每个对象单独添加click事件侦听器。</p><h1 id="d2b0" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">未来的发展</h1><p id="ea63" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">所有的库都有改进和增加功能的空间。作为开源软件的积极贡献者，首先要做的是让代码尽可能容易被其他开发者理解和贡献。整个代码中的描述性注释和一个好的README.md将会很有帮助。</p><p id="71c6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一件事是让社区来评估和建议。仅仅通过社区的想法，我已经添加了许多特性，例如基于键盘的库控制(下面将详细介绍),也接受了想要帮助的开发人员的请求。</p><pre class="lt lu lv lw fq lx ly lz ma aw mb dt"><span id="8ec7" class="mc kb hu ly b fv md me l mf mg">document.onkeydown = keyCtrl; // Maps all keyboard actions<br/>function keyCtrl(e) { <br/>    if (e.keyCode == '27') {<br/>        // Add function code here</span><span id="da2f" class="mc kb hu ly b fv mh me l mf mg">// 27 here means Esc key, similarly other conditions can be used // for other functions and different keys</span></pre><h1 id="c85e" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">结论(最后一个我发誓)</h1><p id="6443" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hn dt translated">这足以让你开始构建库或者框架。因为编码社区每天都有东西，很难保持跟踪，所以，为了进一步阅读，我建议你检查一下<a class="ae lr" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> npm </em> </a> <em class="ls">包</em>。现在，您只需将导入JS模块的任务交给npm，而不是手动添加文件。</p></div><div class="ab cl mo mp hc mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hn ho hp hq hr"><p id="e1dc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">检查我提到的项目，预览器:</p><div class="na nb fm fo nc nd"><a href="https://github.com/ajayns/previewer/" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab ej"><div class="nf ab ng cl cj nh"><h2 class="bd hv fv z el ni eo ep nj er et ht dt translated">ajayns/预览器</h2><div class="nk l"><h3 class="bd b fv z el ni eo ep nj er et ek translated">一个超轻量的JavaScript图像预览器</h3></div><div class="nl l"><p class="bd b gc z el ni eo ep nj er et ek translated">github.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ja nd"/></div></div></a></div><p id="49b0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我希望你喜欢这篇开发者教程。如果有，请一定推荐、关注并分享这篇文章。</p></div></div>    
</body>
</html>