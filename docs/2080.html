<html>
<head>
<title>Why Dataproc — Google’s managed Hadoop and Spark offering is a game changer.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么选择data proc——Google的托管Hadoop和Spark产品是一个游戏改变者。</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/why-dataproc-googles-managed-hadoop-and-spark-offering-is-a-game-changer-9f0ed183fda3?source=collection_archive---------0-----------------------#2017-01-05">https://medium.com/hackernoon/why-dataproc-googles-managed-hadoop-and-spark-offering-is-a-game-changer-9f0ed183fda3?source=collection_archive---------0-----------------------#2017-01-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="3e38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">到目前为止，我已经写了关于<a class="ae jp" href="https://hackernoon.com/tagged/google" rel="noopener ugc nofollow" target="_blank"> Google </a> BigQuery ( <a class="ae jp" href="https://cloud.google.com/blog/big-data/2016/01/anatomy-of-a-bigquery-query" rel="noopener ugc nofollow" target="_blank"> 1 </a>、<a class="ae jp" href="https://cloud.google.com/blog/big-data/2016/01/bigquery-under-the-hood" rel="noopener ugc nofollow" target="_blank"> 2 </a>、<a class="ae jp" href="https://cloud.google.com/blog/big-data/2016/08/google-bigquery-continues-to-define-what-it-means-to-be-fully-managed" rel="noopener ugc nofollow" target="_blank"> 3 </a>、<a class="ae jp" rel="noopener" href="/p/6654841fa2dc"> 4 </a>、<a class="ae jp" rel="noopener" href="/google-cloud/paying-it-forward-how-bigquerys-data-ingest-breaks-tech-norms-8bfe2341f5eb"> 5 </a>)、云原生经济学(<a class="ae jp" href="https://cloud.google.com/blog/big-data/2016/02/visualizing-the-mechanics-of-on-demand-pricing-in-big-data-technologies" rel="noopener ugc nofollow" target="_blank"> 1 </a>、<a class="ae jp" href="https://cloud.google.com/blog/big-data/2016/02/understanding-bigquerys-rapid-scaling-and-simple-pricing" rel="noopener ugc nofollow" target="_blank"> 2 </a>)，甚至是关于短暂虚拟机(<a class="ae jp" rel="noopener" href="/@thetinot/google-clouds-spot-instances-win-big-and-you-should-too-5b244ca3facf#.soec2n94i"> 1 </a>)的文章。一个真正让我兴奋的产品是Google Cloud<a class="ae jp" href="https://cloud.google.com/dataproc/" rel="noopener ugc nofollow" target="_blank">data proc</a>——Google的托管Hadoop、Spark和Flink产品。在这个乍一看似乎完全商品化的市场中，Dataproc成功创造了显著的差异化价值，这预示着人们将改变对其<a class="ae jp" href="https://hackernoon.com/tagged/hadoop" rel="noopener ugc nofollow" target="_blank"> Hadoop </a>工作负载的看法。</p><p id="f3f5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">乔布斯——Hadoop+Spark第一，不是集群——第一</strong></p><p id="d2f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Hadoop的典型操作模式——在本地或云中——要求您部署一个集群，然后继续用作业填充所述集群，无论是MapReduce作业、Hive查询、SparkSQL等。很简单的东西。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/7b1e4d6a67e72fbd226a974a6c0f92d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAnz_EsKDRwbpOcj3AjaRA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">The standard way of running Hadoop and Spark.</figcaption></figure><p id="b9ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">像亚马逊EMR这样的服务更进一步，让你运行短暂的集群，通过<a class="ae jp" href="http://docs.aws.amazon.com/ElasticMapReduce/latest/DeveloperGuide/emr-plan-file-systems.html" rel="noopener ugc nofollow" target="_blank">emrf</a>和S3将存储和计算分开来实现。这意味着在工作负载完成后，您可以丢弃集群，同时在S3上保留状态。</p><p id="a310" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">谷歌云平台有两个关键的差异化特征:</p><ul class=""><li id="f9e3" class="kg kh hu it b iu iv iy iz jc ki jg kj jk kk jo kl km kn ko dt translated">按分钟计费(Azure也有这个功能)</li><li id="6260" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">非常快的虚拟机启动时间</li></ul><p id="b55d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您的集群在不到90秒的时间内启动时(不到60秒并不罕见)，并且当您不必担心将辛苦赚来的钱浪费在云提供商的低效定价上时，您可以颠倒一下这个集群-&gt;工作等式。<strong class="it hv">您从一个作业开始，作为作业执行的一个步骤，您获得了一个集群。</strong></p><p id="9398" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您有一个MapReduce作业，只要您愿意支付60秒的初始启动税，而不是将作业提交给已经部署的集群，那么您可以将作业提交给Dataproc，它会根据需要代表您创建一个集群。集群现在是完成作业执行的一种手段。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ku"><img src="../Images/f3e891508f86f7bfe4b45fb8b4d9f0ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wL9UfMcHQS_DEIvDslxorw.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Demonstration of my exquisite art skills, plus illustration of the jobs before clusters concept realized with Dataproc.</figcaption></figure><p id="409c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，这只有使用Google Dataproc才有可能，只是因为:</p><ul class=""><li id="908e" class="kg kh hu it b iu iv iy iz jc ki jg kj jk kk jo kl km kn ko dt translated">高粒度计费(每分钟)</li><li id="fbb5" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">对初始启动时间征收非常低的税</li><li id="9151" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">存储和计算分离(放弃HDFS作为主要存储)。</li></ul><p id="2439" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">运营和经济效益显而易见且易于实现:</p><ul class=""><li id="80c3" class="kg kh hu it b iu iv iy iz jc ki jg kj jk kk jo kl km kn ko dt translated">资源隔离通过租用隔离避免了不明显的瓶颈和作业之间的资源争用。</li><li id="9f66" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">管理简单——无需通过YARN resource manager等工具实际管理集群或资源分配和优先级。您的开发/阶段/生产工作负载现在本质上是独立的，在其他地方解决和管理是多么痛苦啊！</li><li id="8371" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">定价简单—无需担心四舍五入到最接近的小时。</li><li id="2535" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">集群规模调整的简单性——为了更快地完成工作，只需要求Dataproc为这项工作部署更多的资源。当您按分钟付费时，您可以开始考虑VM-minutes。</li><li id="d212" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated">故障排除的简单性—资源是孤立的，因此您不能将您的问题归咎于其他租户。</li></ul><p id="c097" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我肯定是忘记别人了。欢迎在这里留下评论增色。最佳回应获得一个收藏版谷歌云机器人雕像！</p><p id="546a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在整个云空间中，Dataproc是最接近基于VM的架构的无服务器和云原生按作业付费的方式。在这方面，没有什么比这更好的了。</p><p id="8a41" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Dataproc至少有10分钟的定价时间。加上不到90秒的集群创建计时器，您就排除了许多相对轻量级的临时工作负载。换句话说，这适用于大型的批处理作业，而不是您希望在10秒内运行的临时SQL查询。我就这个话题<a class="ae jp" href="https://cloud.google.com/blog/big-data/2016/02/understanding-bigquerys-rapid-scaling-and-simple-pricing" rel="noopener ugc nofollow" target="_blank">写在这里</a>。(如果您有一个令人信服的使用案例，让您要求少于10分钟的最短时间，请务必告诉我们)。</p><p id="ef1e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">剩下的Dataproc好东西</strong></p><p id="930e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">谷歌云不止于此。Dataproc还有一些其他的好处，可以让您的生活更加轻松，口袋更加充实:</p><ul class=""><li id="b315" class="kg kh hu it b iu iv iy iz jc ki jg kj jk kk jo kl km kn ko dt translated"><a class="ae jp" href="https://cloud.google.com/custom-machine-types/" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">自定义虚拟机</strong> </a> —如果您知道您的作业在CPU/RAM方面的典型资源利用率配置文件，您可以使用该CPU/RAM配置文件定制您自己的实例。伙计们，这真的很酷。</li><li id="6a54" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated"><strong class="it hv">可抢占VMs </strong> —我<a class="ae jp" rel="noopener" href="/@thetinot/google-clouds-spot-instances-win-big-and-you-should-too-5b244ca3facf#.4yknmlbzx">最近就这个话题写了</a>。谷歌对Spot实例的替代方案非常棒。统一的80%折扣，Dataproc足够智能，可以在实例消失的情况下修复您的作业。我在博客文章中把这个话题打得死去活来，以我的偏见来看，它本身就值得一读。</li><li id="b665" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated"><strong class="it hv">镇上最优惠的价格。</strong>谷歌计算引擎<a class="ae jp" href="http://fortune.com/2016/01/08/google-amazon-cloud-price-war/" rel="noopener ugc nofollow" target="_blank">是同等规模虚拟机的行业价格领导者</a>。在某些情况下，比EC2低40%。</li><li id="2b0d" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated"><strong class="it hv">短暂容量的Gobs</strong>—是的，你可以在数千个可抢占的虚拟机上运行你的Spark作业，我们不会让你签署一个大的承诺，正如这位先生所发现的那样(TL；灾难恢复:运行25，000个可抢占的虚拟机)。</li><li id="a7d2" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated"><strong class="it hv"> GCS很快很快</strong>——当抛弃HDFS而支持对象存储时，重要的是存储和实例之间的整体管道。Jornson先生在此详细介绍了GCS和类似产品的性能特点。</li></ul><p id="04c2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">用于有状态集群的data proc</strong></p><p id="cf08" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，如果你正在运行一个有状态集群，比如说在HDFS上运行Impala和Hbase，如果出于某种原因你不想运行Bigtable + BigQuery，Dataproc也是一个不错的选择。</p><p id="d0a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你追求市场上最差的磁盘性能，为什么不选择性能上更像RAM而不是SSD的东西——谷歌的本地SSD？在这里，迪内什先生很好地比较了亚马逊和谷歌的产品。克里夫指出——本地SSD真的真的真的真的真的很好——真的。</p><p id="3ca2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，谷歌的持续使用折扣会自动奖励那些长时间运行虚拟机的人，最高可享受30%的折扣。没有合同也没有承诺。谢天谢地，没有管理您的保留实例账单。</p><p id="c464" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你短时间使用谷歌的虚拟机，你就赢了；如果你长时间使用谷歌，你就赢了。</p><p id="29d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">data proc的经济学</strong></p><p id="dd6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们讨论了Google的虚拟机如何通过可抢占的虚拟机、自定义虚拟机、持续使用折扣甚至更低的标价而变得更加便宜。<a class="ae jp" href="https://thehftguy.com/2016/11/18/google-cloud-is-50-cheaper-than-aws/" rel="noopener ugc nofollow" target="_blank">有些人发现差价要便宜50%</a>！</p><p id="95a6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">学习经济学教会了我两件事(放下你的干草叉，我也学过数学)——软科学和硬科学的区别，以及用二维图表讲故事的能力。</p><p id="47ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们假设一个最坏的情况，EMR和Dataproc VM价格相等。我们得到了这个图表，希望不需要解释:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kv"><img src="../Images/493e17899f5f22d406a10681fb86f1d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*95RNaWBdG6uj1X8DzCAp_Q.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Which line would you rather be on?</figcaption></figure><p id="70d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你相信我们的好朋友thehftguy的<a class="ae jp" href="https://thehftguy.com/2016/11/18/google-cloud-is-50-cheaper-than-aws/" rel="noopener ugc nofollow" target="_blank">声称</a>谷歌便宜50%(扣除可抢占虚拟机、定制虚拟机、持续使用折扣等因素)，你会看到这张引人注目的图表:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kw"><img src="../Images/dfb78a8438f3d2830ad40c2c12d5b0ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPhL1tMd4AGUUrpzpionfQ.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Same chart, but with some more aggressive assumptions.</figcaption></figure><p id="ffa2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当你向云提供商支付你宝贵的谢克尔时，想想你自愿支付的所有这些额外的蓝色区域，那完全是虚假的。这就是为什么Dataproc的许多客户不介意从他们的非Google云供应商向GCS支付费用！</p><p id="0e48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">总结</strong></p><p id="9419" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">谷歌云有后来者的优势。事情变得更简单、更便宜、更快捷。像实例(GCE)和存储(GCS)这样的低级服务更强大，也更容易使用。反过来，这使得像Dataproc这样的高级服务更加有效:</p><ul class=""><li id="b335" class="kg kh hu it b iu iv iy iz jc ki jg kj jk kk jo kl km kn ko dt translated"><strong class="it hv">更便宜的</strong> —按分钟计费、自定义虚拟机、可抢占虚拟机、持续使用折扣和更便宜的虚拟机标价。</li><li id="6e5e" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated"><strong class="it hv">更快</strong> —快速的集群启动时间、同类最佳的对象存储、同类最佳的网络以及本地固态硬盘类似RAM的性能特征。</li><li id="f42a" class="kg kh hu it b iu kp iy kq jc kr jg ks jk kt jo kl km kn ko dt translated"><strong class="it hv">更简单</strong> —大量的容量、更少碎片的实例类型产品、默认的VPC，以及紧跟Apache版本的映像。</li></ul><p id="89bf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从根本上说，Dataproc让您从作业的角度考虑问题，而不是集群。您从一个作业开始，然后得到一个集群，这只是作业执行的另一个步骤。这是一种非常不同的思维模式，我们觉得你会发现它很有说服力。</p><p id="03d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你不必相信我的话——O ' Reilly的好人对Dataproc和EMR有过这样的评论。</p><p id="7b76" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在推特上找到我。很高兴进一步聊天！</p><div class="jr js jt ju fq ab cb"><figure class="kx jv ky kz la lb lc paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="kx jv ky kz la lb lc paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="kx jv ky kz la lb lc paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ld le lf"><p id="f922" class="ir is lg it b iu iv iw ix iy iz ja jb lh jd je jf li jh ji jj lj jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is lg it b iu iv iw ix iy iz ja jb lh jd je jf li jh ji jj lj jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff lk"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ll lm l"/></div></figure></div></div>    
</body>
</html>