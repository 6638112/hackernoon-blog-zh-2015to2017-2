<html>
<head>
<title>How to copy to a user’s clipboard with only JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何仅用JavaScript复制到用户的剪贴板</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/you-need-to-discover-the-awesome-clipboard-web-api-12b248d05dd3?source=collection_archive---------1-----------------------#2017-01-16">https://medium.com/hackernoon/you-need-to-discover-the-awesome-clipboard-web-api-12b248d05dd3?source=collection_archive---------1-----------------------#2017-01-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="30be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">戴上你的学习帽，我们将进入另一个你今天之前可能不知道的API！</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/4c1a92d25509b6821e9fbcbbdc785592.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*kHNjCsoI9rHJJoXgbJ15kQ.png"/></div><figcaption class="jx jy fg fe ff jz ka bd b be z ek">It will test your head… and your mind… and your brain, too.</figcaption></figure><h1 id="61d0" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">老实说，这不是一个真正的API。</h1><p id="4715" class="pw-post-body-paragraph ir is hu it b iu kz iw ix iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo hn dt translated">剪贴板API由多个API组成。除此之外，我们还需要引入更多与剪贴板及其实用程序不直接相关的Web API，以便充分利用浏览器的剪贴板功能。到最后，你应该有几个新的工具，使你的网站和应用程序更容易处理文本！</p></div><div class="ab cl le lf hc lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hn ho hp hq hr"><h2 id="8e66" class="ll kc hu bd kd lm ln lo kh lp lq lr kl jc ls lt kp jg lu lv kt jk lw lx kx ly dt translated"><strong class="ak">从小处着手:剪贴板事件</strong></h2><p id="a7ac" class="pw-post-body-paragraph ir is hu it b iu kz iw ix iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo hn dt translated">clipboard事件是最容易使用的，从技术上讲，它是通过真正的clipboard API创建的。因此，您只能通过<code class="eh ma mb mc md b">copy</code>、<code class="eh ma mb mc md b">cut</code>和<code class="eh ma mb mc md b">paste</code>事件的事件处理程序来访问它。</p><p id="5eaf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这意味着您可以修改这些事件中发生的事情。您的代码可以改变最终出现在用户剪贴板上的内容，也可以改变最终显示在屏幕上的内容。然而，你不能创建你自己的事件，<a class="ae lz" href="http://caniuse.com/#search=clipboardevent" rel="noopener ugc nofollow" target="_blank">除了在Firefox </a>中。</p><p id="6d73" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">所以..在这些限制下，我们能做些什么呢？</strong></p><p id="e7de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">事实证明，很多！</p><p id="1c87" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我能想到一些修改这些事件的理由，我将在下面给出例子。</p><ul class=""><li id="436c" class="me mf hu it b iu iv iy iz jc mg jg mh jk mi jo mj mk ml mm dt translated">从复制或剪切的文本中添加或删除某些内容。</li><li id="b867" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated">获取粘贴的数据，并在应用程序的其他地方使用。</li></ul><p id="c380" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这不一定是很多，但是通过一些额外的API，我们可以增强我们的能力。稍后会详细介绍。</p><p id="48b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">让我们来看一些例子。</strong></p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="mt mu l"/></div><figcaption class="jx jy fg fe ff jz ka bd b be z ek">This won’t really stop people from copying your text, but it shows how it overrides the initial value.</figcaption></figure><p id="5e69" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在上面的示例中，您所要做的就是向copy事件添加一个eventListener。您接收的事件包含<code class="eh ma mb mc md b">clipboardData</code>及其三种方法:<code class="eh ma mb mc md b">setData</code>、<code class="eh ma mb mc md b">getData</code>和<code class="eh ma mb mc md b">clearData</code>。</p><p id="2ba4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它实际上拥有<a class="ae lz" href="https://html.spec.whatwg.org/multipage/interaction.html#datatransfer" rel="noopener ugc nofollow" target="_blank">数据传输</a>对象的所有方法和属性。因此，如果您不确定对<code class="eh ma mb mc md b">setData</code>或<code class="eh ma mb mc md b">getData</code>使用什么参数，您可以检查属性<code class="eh ma mb mc md b">items</code>和<code class="eh ma mb mc md b">types</code>。</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="mt mu l"/></div><figcaption class="jx jy fg fe ff jz ka bd b be z ek">Don’t let the user paste into the confirmation input, or don’t let them paste their own password.</figcaption></figure><p id="d001" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个例子展示了不允许用户将文本粘贴到ID为“passwordConfirmation”的输入中的情况。它也不允许他们将“用户密码”粘贴到任何字段中(我们假装这实际上是他们的密码。请暂时忽略一点，您永远不应该在您的web应用程序中以纯文本形式提供用户密码。).</p><p id="e3f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">另一个例子可能是脏话过滤器，如果你正在创建一个年轻用户的web应用程序。</p><p id="a6f4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以在你的应用程序的其他地方继续使用从<code class="eh ma mb mc md b">getData</code>获取的值。举个例子，也许你需要记录数据粘贴的时间，比如在一个考试应用程序中。有时在这种设置下粘贴文本可能没问题，但您可能希望能够稍后返回并确保粘贴的内容不是从其他地方复制的。</p></div><div class="ab cl le lf hc lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hn ho hp hq hr"><h1 id="7cc3" class="kb kc hu bd kd ke mv kg kh ki mw kk kl km mx ko kp kq my ks kt ku mz kw kx ky dt translated">创建您自己的拷贝事件。</h1><blockquote class="na nb nc"><p id="4046" class="ir is ms it b iu iv iw ix iy iz ja jb nd jd je jf ne jh ji jj nf jl jm jn jo hn dt translated">将文本复制到剪贴板应该不难。它不应该需要几十个步骤来配置或加载数百千字节。但最重要的是，它不应该依赖于Flash或任何臃肿的框架。—<a class="ae lz" href="https://clipboardjs.com/" rel="noopener ugc nofollow" target="_blank">clipboardjs.com</a></p></blockquote><p id="c040" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们开始之前，我想向您介绍一个开源项目，它简化了我将要向您展示的一切。它被称为“clipboard.js ”,它允许你轻松地将文本复制到你的剪贴板。你可能会发现这比你自己去做要容易得多。这是一个相当小的库，有一个非常简单的API。</p><div class="ng nh fm fo ni nj"><a href="https://clipboardjs.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab ej"><div class="nl ab nm cl cj nn"><h2 class="bd hv fv z el no eo ep np er et ht dt translated">剪贴板. js</h2><div class="nq l"><h3 class="bd b fv z el no eo ep np er et ek translated">将文本复制到剪贴板应该不难。它不应该需要几十个步骤来配置或数百kb来…</h3></div><div class="nr l"><p class="bd b gc z el no eo ep np er et ek translated">clipboardjs.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jv nj"/></div></div></a></div><p id="c682" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是我们是来学习的，所以让我们看看如何仅使用Web APIs将文本复制到用户的剪贴板。</p><p id="f164" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于<code class="eh ma mb mc md b">ClipboardEvent</code>对象在大多数浏览器中是不公开的，我们必须走一条不同的路。为了实现这一点，我们需要增加我们的工具，<code class="eh ma mb mc md b">document.execCommand()</code>。这将允许我们运行一个<code class="eh ma mb mc md b">copy</code>命令，将当前选择复制到键盘上。</p><p id="bc4b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里有一个用CodePen展示的例子:</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="ny mu l"/></div></figure><p id="eb47" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这必须由用户事件触发，比如点击。这是在重要操作上实现的安全功能，例如打开文件上传窗口、复制到剪贴板等。它有助于保护用户安全，防止网站在他们不希望的时候与他们的计算机进行交互。</p><p id="29e4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一些注意事项:</p><ul class=""><li id="c0b4" class="me mf hu it b iu iv iy iz jc mg jg mh jk mi jo mj mk ml mm dt translated">您可以使用类型属性设置为text的<code class="eh ma mb mc md b">input</code>，也可以使用<code class="eh ma mb mc md b">textarea</code>。后者创建它只需要少一行代码。</li><li id="d0fe" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated">你可能会读到<code class="eh ma mb mc md b">document.execCommand</code>需要<code class="eh ma mb mc md b">designmode</code>，但据我所知这不是真的。它只需要由用户发起的事件来触发。</li><li id="7d84" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated">您可能希望将<code class="eh ma mb mc md b">document.execCommand</code>包装在一个try/catch块中。在一些浏览器中，它会在失败时抛出一个错误。</li><li id="5209" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated">你可以检查<code class="eh ma mb mc md b">execCommand</code>的结果，看看它是否工作。它返回一个与命令成功相关的布尔值。</li></ul><p id="7c19" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！您现在成功地将文本复制到您的剪贴板！</p></div><div class="ab cl le lf hc lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hn ho hp hq hr"><p id="1ff1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请随时查看我关于API的其他一些文章:<a class="ae lz" href="https://hackernoon.com/javascript-apis-battery-c72baa74c203#.u4mh0vg6h" rel="noopener ugc nofollow" target="_blank">电池</a>、<a class="ae lz" href="https://hackernoon.com/javascript-apis-console-23ebce270419#.cheoig9tu" rel="noopener ugc nofollow" target="_blank">控制台</a>和<a class="ae lz" rel="noopener" href="/@justindanielfuller/javascript-apis-video-api-db803f9fd1b7#.f1y9dbzuk">视频</a>。</p><p id="821a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">另外，请继续关注我即将发布的关于<a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/designMode" rel="noopener ugc nofollow" target="_blank">设计模式</a> API的帖子，以及它如何与<code class="eh ma mb mc md b">execCommand</code>一起使用来做一些非常棒的事情！</p></div><div class="ab cl le lf hc lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hn ho hp hq hr"><p id="c228" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">嗨，我是贾斯汀·富勒。很高兴你看了我的帖子！我需要让你知道，我在这里写的一切都是我自己的观点，并不代表我的雇主。所有代码样本都是我自己的，与美国银行的代码完全无关。</p><p id="5c8a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我也希望收到您的来信，请随时通过<a class="ae lz" href="https://www.linkedin.com/in/justin-fuller-8726b2b1/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae lz" href="https://github.com/justindfuller" rel="noopener ugc nofollow" target="_blank"> Github </a>或<a class="ae lz" rel="noopener" href="/@justindanielfuller"> Medium </a>与我联系。再次感谢阅读！</p><div class="jq jr js jt fq ab cb"><figure class="nz ju oa ob oc od oe paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nz ju oa ob oc od oe paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nz ju oa ob oc od oe paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="na nb nc"><p id="f922" class="ir is ms it b iu iv iw ix iy iz ja jb nd jd je jf ne jh ji jj nf jl jm jn jo hn dt translated"><a class="ae lz" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae lz" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae lz" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae lz" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is ms it b iu iv iw ix iy iz ja jb nd jd je jf ne jh ji jj nf jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae lz" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae lz" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="fe ff of"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>