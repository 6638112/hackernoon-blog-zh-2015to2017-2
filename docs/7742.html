<html>
<head>
<title>Implementing interfaces in JavaScript with Implement.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Implement.js在JavaScript中实现接口</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/implementing-interfaces-in-javascript-with-implement-js-8746838f8caa?source=collection_archive---------0-----------------------#2017-11-07">https://medium.com/hackernoon/implementing-interfaces-in-javascript-with-implement-js-8746838f8caa?source=collection_archive---------0-----------------------#2017-11-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="acb3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这篇博文中，我将介绍接口的概念，以及它们在动态语言中是如何有用的。我还将使用Implement.js库将这个概念引入JavaScript，并向您展示如何从接口中获得一些额外的实用工具。</p><h1 id="d92e" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">什么是接口？</h1><p id="91d4" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">Google将界面定义为“两个系统、主体、组织等的结合点。相遇和互动”，这个定义适用于编程中的接口。在软件开发中，接口是在对象上强制实施特定属性的结构——在大多数语言中，这个对象是一个类。</p><p id="3f38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里有一个Java接口的例子:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="437c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在上面的例子中，<code class="eh kz la lb lc b">Car</code>接口描述了一个类，它有两个没有返回类型的方法，这两个方法都采用一个整数参数。每个函数的实现细节由类决定，这就是为什么这两个方法都没有主体。为了确保一个类实现了<code class="eh kz la lb lc b">Car</code>接口，我们使用了<code class="eh kz la lb lc b">implements</code>关键字:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div><figcaption class="ld le fg fe ff lf lg bd b be z ek">Simple</figcaption></figure><h1 id="e82f" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">JavaScript的接口</h1><p id="157a" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">接口不是JavaScript中的东西，至少不是。JavaScript是一种动态语言，类型变化如此频繁，以至于开发人员可能都没有意识到，因此人们认为没有必要在JavaScript所基于的ECMAScript标准中添加接口。</p><p id="6f9a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，JavaScript作为后端语言以Node.js的形式大规模发展，随之而来的是不同的需求和可能有不同意见的不同人群。除此之外，这种语言正迅速成为前端工具；已经到了许多开发人员将在内部编写绝大部分HTML的地步。JSX格式的js文件。</p><p id="6082" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，随着语言承担更多的角色，确保我们最重要的数据结构之一是我们所期望的，这是很有帮助的。JavaScript可能有<code class="eh kz la lb lc b">class</code>关键字，但实际上这只是一个未实例化的构造函数，一旦被调用，它只是一个对象。对象无处不在，因此有时确保它们与特定的形状相匹配是有益的。</p><p id="3b41" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最近在工作中，我发现一个案例，一个开发人员期望作为API响应的一部分返回的属性是<code class="eh kz la lb lc b">true</code>，但是却得到了<code class="eh kz la lb lc b">"true"</code>，导致了一个bug。这是一个容易犯的错误，如果我们有一个界面，这也是可以避免的。</p><h2 id="bb57" class="li jq hu bd jr lj lk ll jv lm ln lo jz jc lp lq kd jg lr ls kh jk lt lu kl lv dt translated">但是等等，还有呢！</h2><p id="4385" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">只要稍加修改，接口就可以用来改变物体的形状。想象一下，实现一个“严格的”接口，其中不允许接口之外的属性，我们可以删除或重命名这些属性，甚至在遇到它们时抛出一个错误。</p><p id="c11e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以现在我们有了一个接口，当我们缺少某些属性时，它会告诉我们，但当我们有意外的属性时，或者如果属性的类型不是我们所期望的，它也会告诉我们。这增加了其他可能性，例如重构来自API的响应，同时在接口的标准行为之上增加额外的安全层。如果我们让接口抛出错误，我们也可以在单元测试中使用接口。</p><h1 id="9ba3" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">实现. js</h1><p id="6361" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated"><a class="ae lw" href="https://github.com/Jahans3/Implement.js" rel="noopener ugc nofollow" target="_blank"> Implement.js </a>是一个试图给JavaScript带来接口的库。这个想法很简单:定义一个接口，定义它的属性类型，并使用它来确保一个对象是您所期望的。</p><h2 id="b47b" class="li jq hu bd jr lj lk ll jv lm ln lo jz jc lp lq kd jg lr ls kh jk lt lu kl lv dt translated">设置</h2><p id="c82c" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">首先安装软件包:</p><pre class="ks kt ku kv fq lx lc ly lz aw ma dt"><span id="57cd" class="li jq hu lc b fv mb mc l md me">npm install implement-js</span></pre><p id="82e3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，创建一个. js文件并导入<code class="eh kz la lb lc b">implement</code>、<code class="eh kz la lb lc b">Interface</code>和<code class="eh kz la lb lc b">type</code>:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><h1 id="936f" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">我们的第一个界面</h1><p id="3dd0" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">要创建一个接口，只需调用<code class="eh kz la lb lc b">Interface</code>并传入一个字符串作为接口的名称——不推荐这样做，但是如果省略名称，将会生成一个惟一的ID。这将返回一个函数，该函数接受一个属性都是<code class="eh kz la lb lc b">type</code>对象的对象，还可以传递第二个参数，该参数带有显示警告、抛出错误、删除或重命名属性、确保仅<em class="lh">接口的属性存在或者扩展现有的<code class="eh kz la lb lc b">Interface</code>的选项。</em></p><p id="1920" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一个描述汽车的界面:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="3847" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它有一个应该是number类型的<code class="eh kz la lb lc b">seats</code>属性，一个包含必须自己实现<code class="eh kz la lb lc b">Passenger</code>接口的对象的乘客数组，它还包含一个应该是函数的<code class="eh kz la lb lc b">beep</code>属性。<code class="eh kz la lb lc b">error</code>和<code class="eh kz la lb lc b">strict</code>选项已经被设置为true，这意味着当接口的属性丢失时，以及当发现接口上的属性<em class="lh">而不是</em>时，将会抛出错误。</p><h1 id="a133" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">实现我们的接口</h1><p id="307c" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">现在我们想实现我们的接口，在一个简单的例子中，我们将使用对象文字创建一个对象，看看我们是否能够实现我们的接口。</p><p id="46bc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，我们创建一个<code class="eh kz la lb lc b">Ford</code>对象，然后我们将尝试针对我们的<code class="eh kz la lb lc b">Car</code>接口实现它:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="3d44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如我们从上面的评论中看到的，这抛出了一个错误。让我们回头看看我们的<code class="eh kz la lb lc b">Car</code>界面:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="c06e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们可以看到，当所有属性都存在时，严格模式也成立，这意味着附加属性<code class="eh kz la lb lc b">fuelType</code>导致抛出错误。另外，尽管我们有一个<code class="eh kz la lb lc b">passengers</code>属性，但它不是一个数组。</p><p id="70d6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了正确实现接口，我们移除了<code class="eh kz la lb lc b">fuelType</code>并更改了<code class="eh kz la lb lc b">passengers</code>的值，这样它就是一个包含实现<code class="eh kz la lb lc b">Passenger</code>接口的对象的数组:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><h1 id="a544" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">"但是JavaScript不是面向对象的语言！"</h1><p id="3668" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">诚然，虽然接口通常与面向对象语言相关联，JavaScript是一种使用原型继承的多范式语言，但接口仍然非常有用。</p><p id="2b11" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，使用<code class="eh kz la lb lc b">implement-js</code>我们可以轻松地重构API响应，同时确保它没有偏离我们的预期。这里有一个结合<code class="eh kz la lb lc b">redux-thunk</code>使用的例子:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="2a85" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，我们将扩展了<code class="eh kz la lb lc b">User</code>接口的<code class="eh kz la lb lc b">TwitterUser</code>接口定义为具有<code class="eh kz la lb lc b">twitterId</code>和<code class="eh kz la lb lc b">twitterUsername</code>属性的对象。<code class="eh kz la lb lc b">trim</code>是真实的意思，即我们将丢弃任何没有在<code class="eh kz la lb lc b">TwitterUser</code>界面上描述的属性。由于我们的API以不友好的格式返回属性，我们将属性从<code class="eh kz la lb lc b">twitter_username</code>和<code class="eh kz la lb lc b">twitter_id</code>重命名为它们自己的camelcase版本。</p><p id="7184" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们用<code class="eh kz la lb lc b">redux-thunk</code>定义一个异步动作，该动作触发一个API调用，我们使用我们的<code class="eh kz la lb lc b">TwitterUser</code>接口来丢弃我们不想要的属性，并确保它用正确的类型实现我们期望的属性。如果你更喜欢保持你的动作创建者纯粹(er)或者不使用<code class="eh kz la lb lc b">redux-thunk</code>，你可能想要检查<code class="eh kz la lb lc b">twitterService.getUser</code>里面的接口并返回结果。</p><p id="ebfd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lh">注意:当扩展一个接口时选项不被继承</em></p><p id="9bfa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">单元测试也是使用接口的合适场所:</p><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="kx ky l"/></div></figure><h1 id="94ef" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">概括起来</h1><p id="d0fc" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">我们已经看到了接口在JavaScript中是如何有用的:即使它是一种高度动态的语言，检查对象的形状和它的属性是一种特定的数据类型也为我们提供了额外的安全层，否则我们将会错过它。通过构建接口的概念和使用<code class="eh kz la lb lc b">implement-js</code>,我们还能够在增加安全性的基础上获得额外的效用。</p></div><div class="ab cl mf mg hc mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hn ho hp hq hr"><h1 id="c6c0" class="jp jq hu bd jr js mm ju jv jw mn jy jz ka mo kc kd ke mp kg kh ki mq kk kl km dt translated">推特:<a class="ae lw" href="https://twitter.com/josh_jahans" rel="noopener ugc nofollow" target="_blank"> @josh_jahans </a></h1><figure class="ks kt ku kv fq kw"><div class="bz el l di"><div class="mr ky l"/></div></figure></div></div>    
</body>
</html>