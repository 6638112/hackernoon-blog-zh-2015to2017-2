<html>
<head>
<title>[React] Review: Unit Test is easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[React]复习:单元测试很容易</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/react-unit-test-example-tutorial-jest-enzyme-jsdom-mocha-chai-state-props-component-7ec850a98566?source=collection_archive---------1-----------------------#2017-03-22">https://medium.com/hackernoon/react-unit-test-example-tutorial-jest-enzyme-jsdom-mocha-chai-state-props-component-7ec850a98566?source=collection_archive---------1-----------------------#2017-03-22</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/6c104c52fc4623f0573860d6ca6225d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-LbtrbKqWqpaYwsfjwydA.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek"><a class="ae jg" href="http://www.deviantart.com/art/verifying-her-credentials-51202151" rel="noopener ugc nofollow" target="_blank">http://www.deviantart.com/art/verifying-her-credentials-51202151</a></figcaption></figure><h1 id="8222" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">找到正确的React单元测试工具</h1><p id="88cc" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">为React组件选择合适的单元测试工具是令人困惑的，由于google的<strong class="kh hv"><em class="ld">【React单元测试】</em> </strong>的结果，数百个chai+jsdom、jest+mocha、mocha+enzyme等组合，映入我的眼帘。嘿，谷歌，你能告诉我最好的一个，不要让我思考吗？</p><p id="622b" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">React组件的单元测试稍有不同，React中的单元测试不是验证函数的输出，而是需要4个额外的测试目的(<a class="ae jg" href="https://hackernoon.com/testing-react-components-with-jest-and-enzyme-41d592c174f#.ywbnzlakf" rel="noopener ugc nofollow" target="_blank"> <em class="ld"> Ref Artem </em> </a>):</p><ol class=""><li id="4686" class="lj lk hu kh b ki le km lf kq ll ku lm ky ln lc lo lp lq lr dt translated"><em class="ld">测试基本组件渲染</em></li><li id="60c3" class="lj lk hu kh b ki ls km lt kq lu ku lv ky lw lc lo lp lq lr dt translated"><em class="ld">测试道具</em></li><li id="3266" class="lj lk hu kh b ki ls km lt kq lu ku lv ky lw lc lo lp lq lr dt translated"><em class="ld">测试事件</em></li><li id="8d88" class="lj lk hu kh b ki ls km lt kq lu ku lv ky lw lc lo lp lq lr dt translated"><em class="ld">测试事件处理程序</em></li></ol><p id="f779" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">两个最受欢迎的选项是<strong class="kh hv">玩笑</strong>和<strong class="kh hv">酶</strong>。在花了几个小时尝试这些工具后，我最终选择了伟大的Airbnb开源酶。</p><h2 id="25c4" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">玩笑</h2><p id="a4c2" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">Jest是一个由脸书维护的JavaScript测试运行程序。包括了性能，嘲讽，<strong class="kh hv">快照</strong>，代码覆盖率，沙箱。</p><p id="9c37" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><em class="ld">当使用Jest测试React或React本机应用程序时，您可以编写一个</em> <strong class="kh hv"> <em class="ld">快照</em> </strong> <em class="ld"> </em> <strong class="kh hv"> <em class="ld">测试</em> </strong> <em class="ld">将渲染组件的输出保存到文件中，并在后续运行时将组件的输出与快照进行比较。这有助于了解组件何时改变其行为。</em></p><h2 id="545c" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">jsdom +摩卡</h2><p id="6196" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><a class="ae jg" href="https://github.com/tmpvar/jsdom" rel="noopener ugc nofollow" target="_blank"> jsdom </a>提供React所需的dom进行渲染，完全在node/io.js中实现浏览器DOM实现的合适子集。</p><h2 id="20d0" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">酶</h2><p id="a904" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">是一个包装像<strong class="kh hv"> React TestUtils </strong>、<strong class="kh hv"> JSDOM </strong>和<strong class="kh hv"> CheerIO </strong>这样的包的库，为编写单元测试创建一个更简单的接口(使用浅层渲染)。</p></div><div class="ab cl ml mm hc mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hn ho hp hq hr"><h1 id="37eb" class="jh ji hu bd jj jk ms jm jn jo mt jq jr js mu ju jv jw mv jy jz ka mw kc kd ke dt translated">例子</h1><p id="f400" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">这是使用E <strong class="kh hv"> nzyme </strong>测试React组件的示例中的<a class="ae jg" href="https://github.com/wahengchang/react-test-must-know" rel="noopener ugc nofollow" target="_blank"> git </a>:</p><p id="55d4" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><strong class="kh hv">安装</strong></p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="1042" class="lx ji hu nc b fv ng nh l ni nj">$ git clone https://github.com/wahengchang/react-test-must-know<br/>$ npm install</span></pre><p id="7dea" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><strong class="kh hv">运行测试</strong></p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="6e21" class="lx ji hu nc b fv ng nh l ni nj">$ npm test</span><span id="ae6d" class="lx ji hu nc b fv nk nh l ni nj">&gt; jest<br/><strong class="nc hv">PASS </strong> src/__tests__/<strong class="nc hv">simpleFoo-test.js<br/>PASS </strong> src/__tests__/<strong class="nc hv">Foo-test.js</strong></span><span id="19a8" class="lx ji hu nc b fv nk nh l ni nj"><strong class="nc hv">Test Summary<br/></strong>› Ran all tests.<br/><strong class="nc hv">› 7 tests passed</strong> (7 total in 2 test suites, run time 2.08s)</span></pre><h2 id="4d14" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated"><strong class="ak">应该知道</strong></h2><p id="a7f5" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><strong class="kh hv">T59】1。组件中状态/属性的验证值 </strong></p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="9937" class="lx ji hu nc b fv ng nh l ni nj">const wrapper = shallow(&lt;ComponentName /&gt;);</span><span id="3639" class="lx ji hu nc b fv nk nh l ni nj">expect(wrapper<strong class="nc hv">.state()</strong>.data).toBe('something');<br/>expect(wrapper<strong class="nc hv">.props()</strong>.data).toBe('something');</span></pre><p id="a3c2" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><strong class="kh hv"> <em class="ld"> 2。组件中标签的校验值</em> </strong></p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="74ca" class="lx ji hu nc b fv ng nh l ni nj">const wrapper = shallow(&lt;ComponentName /&gt;);</span><span id="d0a6" class="lx ji hu nc b fv nk nh l ni nj">expect(wrapper<strong class="nc hv">.find('h4')</strong>.length).toBe(1);<br/>expect(wrapper<strong class="nc hv">.find('h4')</strong>.at(0).text()).toBe('Something');</span></pre><p id="26b7" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><strong class="kh hv"> <em class="ld"> 3。模拟按钮</em>的点击事件</strong></p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="d7c0" class="lx ji hu nc b fv ng nh l ni nj">const wrapper = shallow(&lt;ComponentName /&gt;);</span><span id="766a" class="lx ji hu nc b fv nk nh l ni nj">expect(wrapper.state().data).toBe('state1');<br/><strong class="nc hv">wrapper.find('button').simulate('click');<br/></strong>expect(wrapper.state().data).toBe('state2');</span></pre></div><div class="ab cl ml mm hc mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hn ho hp hq hr"><h1 id="de18" class="jh ji hu bd jj jk ms jm jn jo mt jq jr js mu ju jv jw mv jy jz ka mw kc kd ke dt translated">欺骗</h1><h2 id="edb6" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">断言风格(<a class="ae jg" href="https://stackoverflow.com/questions/40795850/how-to-test-style-for-a-react-component-attribute-with-enzyme" rel="noopener ugc nofollow" target="_blank"> <em class="nl">出自</em> </a>)</h2><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="2820" class="lx ji hu nc b fv ng nh l ni nj">wrapper.find('.myClassname')<!-- -->.get(0).style;<br/>expect(containerStyle).to.have.property('opacity', '1');</span></pre><h2 id="559d" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">断言类名(<a class="ae jg" href="https://stackoverflow.com/questions/40795850/how-to-test-style-for-a-react-component-attribute-with-enzyme" rel="noopener ugc nofollow" target="_blank">到</a>)</h2><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="c996" class="lx ji hu nc b fv ng nh l ni nj">const span = mount(&lt;Test /&gt;).find('span');<br/>expect(span.html().match(/style="([^"]*)"/i)[1]).toBe('color: #000;');</span></pre><h1 id="c796" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">*备注</h1><h2 id="90a7" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">浅层渲染</h2><p id="623d" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">将组件作为一个单元进行测试，</p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="173e" class="lx ji hu nc b fv ng nh l ni nj">import { shallow } from 'enzyme';<br/><br/>const wrapper = <strong class="nc hv">shallow</strong>(&lt;MyComponent /&gt;);</span></pre><h2 id="e730" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">完全渲染</h2><p id="99f2" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">可能<strong class="kh hv">与DOM API</strong>交互的组件，或者可能需要整个生命周期来全面测试组件(即<code class="eh nm nn no nc b">componentDidMount</code>等)。)</p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="c906" class="lx ji hu nc b fv ng nh l ni nj">i<!-- -->mport { mount } from 'enzyme';<br/><br/>const wrapper = <strong class="nc hv">mount</strong>(&lt;MyComponent /&gt;);</span></pre><h2 id="e960" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">静态渲染</h2><p id="b867" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">用于将react组件渲染到<strong class="kh hv"> <em class="ld">静态HTML </em> </strong>中，并分析生成的HTML结构。</p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="7236" class="lx ji hu nc b fv ng nh l ni nj">import { render } from 'enzyme';<br/><br/>const wrapper = <strong class="nc hv">render</strong>(&lt;MyComponent /&gt;);</span></pre><h2 id="570a" class="lx ji hu bd jj ly lz ma jn mb mc md jr kq me mf jv ku mg mh jz ky mi mj kd mk dt translated">酶.包装</h2><p id="921d" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">包装器指的是提供API的酶包装器类(更多<a class="ae jg" href="http://airbnb.io/enzyme/GLOSSARY.html#wrapper" rel="noopener ugc nofollow" target="_blank"/>)。</p><pre class="mx my mz na fq nb nc nd ne aw nf dt"><span id="79f6" class="lx ji hu nc b fv ng nh l ni nj">wrapper.<strong class="nc hv">find</strong>(Foo)<br/>wrapper.<strong class="nc hv">find</strong>('.icon-star')<br/>wrapper.<strong class="nc hv">find</strong>('button').simulate('click')<br/>wrapper.<strong class="nc hv">contains</strong>(&lt;div className="unique" /&gt;)<br/>wrapper.<strong class="nc hv">props</strong>().data<br/>wrapper.<strong class="nc hv">state</strong>().data</span></pre></div><div class="ab cl ml mm hc mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hn ho hp hq hr"><h1 id="adad" class="jh ji hu bd jj jk ms jm jn jo mt jq jr js mu ju jv jw mv jy jz ka mw kc kd ke dt translated">参考:</h1><p id="e3fa" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><a class="ae jg" href="https://github.com/wahengchang/react-test-must-know" rel="noopener ugc nofollow" target="_blank">https://github.com/wahengchang/react-test-must-know</a></p><p id="1ad4" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="http://blog.iannelson.systems/12-reasons-why-i-love-unit-tests/" rel="noopener ugc nofollow" target="_blank">http://blog . Ian Nelson . systems/12-reasons-why-I-love-unit-tests/</a></p><p id="fc39" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="https://github.com/facebook/jest/blob/master/examples/snapshot/Link.react.js" rel="noopener ugc nofollow" target="_blank">https://github . com/Facebook/jest/blob/master/examples/snapshot/link . react . js</a></p><p id="80ff" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated">【https://github.com/facebook/jest】</p><p id="af53" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="https://facebook.github.io/jest/docs/tutorial-react.html" rel="noopener ugc nofollow" target="_blank">https://facebook.github.io/jest/docs/tutorial-react.html</a></p><p id="9ee6" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="https://github.com/facebook/jest/tree/master/examples/snapshot" rel="noopener ugc nofollow" target="_blank">https://github . com/Facebook/jest/tree/master/examples/snapshot</a></p><p id="303b" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="https://www.codementor.io/vijayst/unit-testing-react-components-jest-or-enzyme-du1087lh8" rel="noopener ugc nofollow" target="_blank">https://www . code mentor . io/vijayst/unit-testing-react-components-jest-or-enzyme-du 1087 LH 8</a></p><p id="9e13" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="https://hackernoon.com/testing-react-components-with-jest-and-enzyme-41d592c174f#.d3lo5wnl5" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/testing-react-components-with-jest-and-enzyme-41d 592 c 174 f # . d3lo 5 wnl 5</a></p><p id="eccf" class="pw-post-body-paragraph kf kg hu kh b ki le kk kl km lf ko kp kq lg ks kt ku lh kw kx ky li la lb lc hn dt translated"><a class="ae jg" href="http://airbnb.io/enzyme/docs/api/shallow.html" rel="noopener ugc nofollow" target="_blank">http://airbnb.io/enzyme/docs/api/shallow.html</a></p><div class="mx my mz na fq ab cb"><figure class="np iv nq nr ns nt nu paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="np iv nq nr ns nt nu paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="np iv nq nr ns nt nu paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nv nw nx"><p id="f922" class="kf kg ld kh b ki le kk kl km lf ko kp ny lg ks kt nz lh kw kx oa li la lb lc hn dt translated"><a class="ae jg" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jg" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jg" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jg" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="kf kg ld kh b ki le kk kl km lf ko kp ny lg ks kt nz lh kw kx oa li la lb lc hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jg" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jg" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mx my mz na fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ob"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>