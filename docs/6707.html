<html>
<head>
<title>Spring 5 JDBC support for Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">春天5 JDBC支持科特林</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/spring-5-jdbc-support-for-kotlin-7cc31f4db4a5?source=collection_archive---------5-----------------------#2017-10-01">https://medium.com/hackernoon/spring-5-jdbc-support-for-kotlin-7cc31f4db4a5?source=collection_archive---------5-----------------------#2017-10-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="147e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://spring.io/blog/2017/09/28/spring-framework-5-0-goes-ga" rel="noopener ugc nofollow" target="_blank"> Spring 5上周发布</a>有很多令人兴奋的功能，但对我来说，最重要的是<a class="ae jp" href="https://hackernoon.com/tagged/kotlin" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>支持。不仅因为我热爱这门语言，还因为我为它做出了贡献。(我知道，不要脸的塞)</p><p id="72ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这种支持中包含的一个特性是一组针对<code class="eh jq jr js jt b">JdbcTemplate</code>和<code class="eh jq jr js jt b">MapSqlParamaterSource</code>的扩展函数，它为您提供了一个更加惯用的API。</p><p id="f56d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们把使用JDBC访问关系数据的<a class="ae jp" href="https://spring.io/guides/gs/relational-data-access/" rel="noopener ugc nofollow" target="_blank">和Spring </a>官方指南翻译成Kotlin</p><h1 id="ad19" class="ju jv hu bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">使用Spring 5.0 JDBC</h1><p id="d4bf" class="pw-post-body-paragraph ir is hu it b iu ks iw ix iy kt ja jb jc ku je jf jg kv ji jj jk kw jm jn jo hn dt translated">在本例中，我们将使用Spring Boot 2.0快照</p><h2 id="bef4" class="kx jv hu bd jw ky kz la ka lb lc ld ke jc le lf ki jg lg lh km jk li lj kq lk dt translated">客户数据类别</h2><figure class="ll lm ln lo fq lp"><div class="bz el l di"><div class="lq lr l"/></div></figure><h2 id="5b4f" class="kx jv hu bd jw ky kz la ka lb lc ld ke jc le lf ki jg lg lh km jk li lj kq lk dt translated">使用JDBC模板</h2><figure class="ll lm ln lo fq lp"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="c678" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">来评论一下最有趣的台词吧。</p><ol class=""><li id="d369" class="ls lt hu it b iu iv iy iz jc lu jg lv jk lw jo lx ly lz ma dt translated"><code class="eh jq jr js jt b">log</code>在第46行的伴随对象中声明</li><li id="924a" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated">功能<code class="eh jq jr js jt b">with</code>将帮助我们节省一些打字。在<code class="eh jq jr js jt b">with</code>区块内，我们可以访问<code class="eh jq jr js jt b">jdbcTemplate</code>的所有成员。</li><li id="03e0" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated"><code class="eh jq jr js jt b">splitUpNames</code>是一个<code class="eh jq jr js jt b">List&lt;Pair&lt;String, String&gt;&gt;</code>。稍后我们将使用<code class="eh jq jr js jt b">Pair</code>的析构声明。</li><li id="bdae" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated">在任何具有带析构声明(<code class="eh jq jr js jt b">component1()</code>、<code class="eh jq jr js jt b">component2()</code>等等)的参数类型的函数中，您可以用它们来替换它。在这种情况下，我们用<code class="eh jq jr js jt b">(String, String)</code>替换<code class="eh jq jr js jt b">Pair&lt;String, String&gt;</code>。</li><li id="aa8a" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated"><code class="eh jq jr js jt b">batchUpdate</code>的最后一个参数是一个<code class="eh jq jr js jt b">ParameterizedPreparedStatementSetter&lt;T&gt;</code>，它是一个Java 8函数接口。我们可以使用Kotlin中的函数接口作为函数，包括<a class="ae jp" href="https://hackernoon.com/tagged/destructuring" rel="noopener ugc nofollow" target="_blank">析构</a>声明。</li><li id="aaf1" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated">这个查询是一个扩展函数。改变参数的顺序，将<code class="eh jq jr js jt b"> RowMapper&lt;T&gt; </code>切换为<code class="eh jq jr js jt b">(ResultSet, Int) -&gt;T</code>。因为我们没有使用最后一个参数(行号)，所以可以用_</li></ol><p id="1298" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">说到扩展函数，你可以在这里查看kdoc<a class="ae jp" href="https://docs.spring.io/spring-framework/docs/5.0.0.RELEASE/kdoc-api/spring-framework/org.springframework.jdbc.core/index.html" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="c90e" class="kx jv hu bd jw ky kz la ka lb lc ld ke jc le lf ki jg lg lh km jk li lj kq lk dt translated">使用<code class="eh jq jr js jt b">NamedParameterJdbcTemplate</code></h2><p id="f15e" class="pw-post-body-paragraph ir is hu it b iu ks iw ix iy kt ja jb jc ku je jf jg kv ji jj jk kw jm jn jo hn dt translated"><code class="eh jq jr js jt b">NamedParameterJdbcTemplate</code>是<code class="eh jq jr js jt b">JdbcTemplate</code>的一个版本，它使用命名参数(<code class="eh jq jr js jt b">‘:parameter1’</code>，而不是占位符(<code class="eh jq jr js jt b">‘?’</code>)。Spring 5没有为<code class="eh jq jr js jt b">NamedParameterJdbcTemplate</code>提供任何扩展函数(Kotlin提供的API已经足够好了)，但是它为相关类<code class="eh jq jr js jt b">MapSqlParameterSource</code>提供了<a class="ae jp" href="https://docs.spring.io/spring-framework/docs/5.0.0.RELEASE/kdoc-api/spring-framework/org.springframework.jdbc.core.namedparam/index.html" rel="noopener ugc nofollow" target="_blank">扩展函数</a>。</p><figure class="ll lm ln lo fq lp"><div class="bz el l di"><div class="lq lr l"/></div></figure><ol class=""><li id="d6e0" class="ls lt hu it b iu iv iy iz jc lu jg lv jk lw jo lx ly lz ma dt translated"><code class="eh jq jr js jt b">jdbcOperations</code>返回一个普通的<code class="eh jq jr js jt b">JdbcTemplate</code>如果你仍然需要使用它</li><li id="22b5" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated"><code class="eh jq jr js jt b">sources</code>是一个<code class="eh jq jr js jt b">List&lt;MapSqlParameterSource&gt;</code></li><li id="7825" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated">在类似数组的setter中设置参数的扩展函数。</li><li id="04cf" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated">没有类似数组的getter来读取扩展函数，但是我们可以很容易地添加一个。</li><li id="e97c" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated">这个插入查询使用命名参数。</li><li id="6468" class="ls lt hu it b iu mb iy mc jc md jg me jk mf jo lx ly lz ma dt translated"><code class="eh jq jr js jt b">query</code>接收一个<code class="eh jq jr js jt b">Map&lt;String, *&gt;</code>作为第二个参数，在Kotlin中非常容易使用。</li></ol><h1 id="b2db" class="ju jv hu bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">结论</h1><p id="5d29" class="pw-post-body-paragraph ir is hu it b iu ks iw ix iy kt ja jb jc ku je jf jg kv ji jj jk kw jm jn jo hn dt translated">带有Kotlin的Spring JDBC为您的关系数据库应用程序提供了一个可靠的API。享受吧。</p><figure class="ll lm ln lo fq lp"><div class="bz el l di"><div class="mg lr l"/></div></figure></div></div>    
</body>
</html>