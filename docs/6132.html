<html>
<head>
<title>Headless Chrome vs PhantomJS Benchmark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无头Chrome vs PhantomJS基准测试</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/benchmark-headless-chrome-vs-phantomjs-e7f44c6956c?source=collection_archive---------0-----------------------#2017-09-05">https://medium.com/hackernoon/benchmark-headless-chrome-vs-phantomjs-e7f44c6956c?source=collection_archive---------0-----------------------#2017-09-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e9a9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<a class="ae jp" href="https://serpapi.com" rel="noopener ugc nofollow" target="_blank"> SERP API </a>，能够最快地提供真实的结果是日常关注的问题。然而，运行完整的浏览器是一项昂贵的任务，找到最佳解决方案并不容易。</p><p id="509f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当需要自动化的<a class="ae jp" href="https://hackernoon.com/tagged/browser" rel="noopener ugc nofollow" target="_blank">浏览器</a>时，趋势似乎越来越倾向于使用无头Chrome而不是PhantomJS。传言称<a class="ae jp" href="https://hackernoon.com/tagged/chrome" rel="noopener ugc nofollow" target="_blank"> Chrome </a>的新无头模式比<a class="ae jp" href="https://hackernoon.com/tagged/phantomjs" rel="noopener ugc nofollow" target="_blank"> PhantomJS </a>更快，占用内存更少。不幸的是，我找不到任何基准来支持或反驳这种说法。所以，我们就这么做吧！</p><p id="3572" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将使用Ruby Selenium WebDrivers来运行PhantomJS和Headless Chrome。如果你使用其他驱动程序，结果可能会稍有不同，但是我们认为绝大部分的费用是浏览器本身而不是库包装。</p><p id="9954" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">基准测试加载Rails缺省页面的1000倍，并检查完整性。我已经在我的2017年MacBook (1.4 GHz和16 GB的Ram)上运行过了，使用的是Ruby 2.3.3p222、Chrome 60.0.3112.113和PhantomJS 2.1.1。</p><p id="1522" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">结果如下:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/14ddd74c020083e8df9f87d8fe742045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-Jzq5yGNrYqoBzePtBjhA.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/a3a06b7b22682876af3f393674de34b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AqcPIeiw_gi8OyQNbvUUbg.png"/></div></div></figure><p id="3994" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你所看到的，与PhantomJS相比，Headless Chrome的运行速度快了55%,而消耗的内存却少了38%。当再次运行基准测试时，无头的Chrome似乎在性能上更加稳定，并且似乎是这里的大赢家。</p><p id="aad6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里主要基准逻辑的源代码:</p><pre class="jr js jt ju fq kc kd ke kf aw kg dt"><span id="66af" class="kh ki hu kd b fv kj kk l kl km">URL_TO_TEST = "http://localhost:3000"<br/>TEXT_TO_VERIFY_PROPER_LOAD = "Yay! You’re on Rails!"<br/>BENCHMARK_ITERATIONS = 1000<br/><br/>namespace :benchmark do<br/><br/>  task :phantomjs do<br/>    puts "== Starting PhantomJS Driver =="<br/>    driver = Selenium::WebDriver.for :phantomjs<br/>    puts "Benchmarking (#{BENCHMARK_ITERATIONS} times):"<br/>    time = Benchmark.measure do<br/>      BENCHMARK_ITERATIONS.times do <br/>        driver.navigate.to URL_TO_TEST<br/>        unless driver.find_element(tag_name: "body").text.include? TEXT_TO_VERIFY_PROPER_LOAD<br/>          raise "Page Not Properly Loaded"<br/>        end<br/>        print '.'<br/>      end<br/>    end<br/>    puts "\nTime taken: #{time}"<br/>    puts "== Quitting PhantomJS Driver =="<br/>    driver.quit<br/>  end<br/><br/>  task :headless_chrome do<br/>    puts "== Starting Headless Chrome Driver =="<br/>    headless_chrome_capabilities = Selenium::WebDriver::Remote::Capabilities.chrome(chromeOptions: { args: [ "--headless" ]})<br/>    driver = Selenium::WebDriver.for :chrome, desired_capabilities: headless_chrome_capabilities<br/>    puts "Benchmarking (#{BENCHMARK_ITERATIONS} times):"<br/>    time = Benchmark.measure do<br/>      BENCHMARK_ITERATIONS.times do <br/>        driver.navigate.to URL_TO_TEST<br/>        unless driver.find_element(tag_name: "body").text.include? TEXT_TO_VERIFY_PROPER_LOAD<br/>          raise "Page Not Properly Loaded"<br/>        end<br/>        print '.'<br/>      end<br/>    end<br/>    puts "\nTime taken: #{time}"<br/>    puts "== Quitting Headless Chrome Driver =="<br/>    driver.quit<br/>  end<br/>  <br/>end</span></pre><p id="4e77" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在GitHub上:<a class="ae jp" href="https://github.com/hartator/benchmark-headless-chrome-vs-phantomjs/blob/master/lib/tasks/benchmark.rake" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/hartator/benchmark-headless-chrome-vs-phantomjs/blob/master/lib/tasks/benchmark . rake</a></p><p id="efc5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完整GitHub如果要自己运行或者修改基准代码:<a class="ae jp" href="https://github.com/hartator/benchmark-headless-chrome-vs-phantomjs" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/hartator/benchmark-headless-chrome-vs-phantomjs</a></p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kn ko l"/></div></figure></div></div>    
</body>
</html>