# 在 React-Redux 中使用表单:提示和技巧

> 原文：<https://medium.com/hackernoon/using-forms-in-react-redux-tips-and-tricks-48ad9c7522f6>

不久前，我发表了一篇博文,讲述了从转移到反应和还原的过程中学到的一些经验。我使用 React 和 Friends 已经有很长时间了，我想分享一下我们最大的困难之一是什么，以及我们是如何克服它们的——实现表单。

许多 web 应用程序都是基于表单的，用户可以通过填写表单和操作表单组件来使用您的平台。这显然提出了一些关于如何在 react 中编写和使用表单组件的问题，以及 react 和 redux 如何一起工作等问题，例如:

**#组件如何表现？
#我的数据保存在哪里？
#我如何执行验证？**
**#如何检测窗体的状态和变化？**

在 [Bizzabo](https://www.bizzabo.com) ，我们服务中的许多页面都是基于表单的，这已经有一段时间了，所以我们意识到了挑战，当我们使用 Backbone.js 时，我们已经解决了上面的问题，但是，嘿，React 是一个不同的游戏场，我们一方面需要让用户无缝地填写表单，不管他是使用我们的 Backbone 表单还是 React 表单，但同时完全重新设计我们使用表单的整个方式，并再次回答这些问题。

在我们开始回答问题之前，让我从头开始，我们使用了[redux-form](http://redux-form.com/)——redux 之上的一个表单状态管理库，由 [Erik Rasmussen](https://github.com/erikras) 创建，这是一个高度维护的库，每周都在变化和发展。

**#我的组件表现如何？**

我们系统中的每个表单组件都必须有一个用户界面行为。以一个输入为例，它有许多状态:有效、被触摸、被聚焦、脏，以及更多的状态。对于每一个状态，你都希望有一个可视化的表示。显示错误、警告等。我们为此选择了 Redux-form 的解决方案，它提供了关于组件状态的元信息。如何使用 redux 表单组件？<field>组件是如何将每个单独的输入连接到 Redux 存储的(我将在下一篇文章中详细阐述这个主题)</field>

你需要做的唯一的事情就是激活它，用上面显示的<field>组件包装你的组件，给它一个名字，你的组件，然后你可以显示你想要的 UI 状态。生成 redux 表单<field>有几种方法，你可以查看[文档](http://redux-form.com/6.2.1/docs)看看。</field></field>

所以现在你可以随心所欲地为每个状态添加你的 UI。

正如你在上面看到的，当你使用<field>时，你得到了免费的 UI 状态，所以我可以根据不同的状态显示不同的通知。</field>

## #我在哪里保存我的数据？

我们必须回答的一个主要问题是**在哪里保存数据。**让我详细说明一下我们需要回答的问题:
每个表单元素都必须有一个初始值，如果您的表单处于“新”状态，它可以是一个空值，或者是某种“编辑”状态的值。在任何更改\模糊\击键(或您感兴趣的任何其他事件)时，您希望值更新。那我把它放在哪里？

redux-form 的解决方案——一个 Redux reducer，它监听调度的 Redux-form 动作，以维护 Redux 中的表单状态。您的表单将安装在“form”键名称中，每个表单都有一个惟一的名称，访问它就像 form[name]一样简单。

下面你可以看到它是多么容易设置。

redux-form 为你的初始值和当前值提供了选择器。使用它的一个好处是它只是 redux，你可以监听特定的定制动作并相应地操作你的数据，不仅是 redux 形式的动作，也可以是你的特定动作。[就用那个](http://redux-form.com/6.2.1/docs/api/ReducerPlugin.md/)的插件吧。

到目前为止，我们已经讨论了显示组件的当前状态，以及在哪里管理数据。

但是处理数据本身呢？

**#如何执行验证？**

每个表单面临的主要挑战之一是验证。当用户输入被提交时(在任何其他浏览器事件上)，仅仅用新值更新表单组件是不够的，您需要验证该值。在这一期中，我们必须问自己的问题是:
我是否将表单组件值保存在状态中，一旦验证通过，我就将它发送到商店？还是我在商店里执行所有的数据验证？

Redux form 已经回答了我们所有的问题，因为验证是图书馆生态系统的一部分。您可以传递使用 redux form(一种验证方法)创建的表单，甚至可以对特定的<field>(来自特定版本)执行验证。它只有 1 个约束，它是 error 对象的结构，即:{ field1: <string>，field2: <string>}。您可以自己实现验证方法或使用第三方库。我们选择了后者，并使用了 [validator.js](https://github.com/skaterdav85/validatorjs) ，它覆盖了大量的验证，支持特殊验证的插件，最重要的是，按照 redux 表单的要求返回错误对象。</string></string></field>

Validation using Validator.Js

在上面的例子中，你可以看到一个验证的例子。您可以在每个字段上提供几个验证(例如:input)，也可以为每个错误提供文本，一旦运行验证，您就可以返回错误对象。

**#如何检测表单的状态和变化**

我们需要解决的最后一个大问题是检测表单的当前状态，并跟踪它的变化。我将给出一个例子——我们想要检测 for 是否已经改变了它的原始值，以便当用户试图导航时，我们可以通知他有未保存的更改。Redux Form 提供了当前表单状态的完全可见性。你可以发现它的肮脏、原始、是否被用户触摸过(关注一个元素)等等。它还提供了一个外部 API，允许您通过 redux 操作触发您想要的状态更改，例如，您可以提交表单，或者使用 redux 操作重置表单，如果不需要，不需要实际的提交按钮。

**总之**

表单总是很棘手，是的，每个表单都有它的需求，有时您需要找到解决方案并变通一下，但是大多数场景都被 redux-form 覆盖了，如果没有，您可以很容易地将您的解决方案移植到 redux form 上。对我们来说，它工作得很好，我希望它也能为你工作

让我们一起努力@ [Bizzabo](https://www.bizzabo.com/about#career) ，来加入我们吧！

> [黑客中午](http://bit.ly/Hackernoon)是黑客如何开始他们的下午。我们是 [@AMI](http://bit.ly/atAMIatAMI) 家庭的一员。我们现在[接受投稿](http://bit.ly/hackernoonsubmission)并乐意[讨论广告&赞助](mailto:partners@amipublications.com)机会。
> 
> 要了解更多信息，请[阅读我们的“关于”页面](https://goo.gl/4ofytp)、[在脸书上给我们点赞/发消息](http://bit.ly/HackernoonFB)，或者简单地说， [tweet/DM @HackerNoon。](https://goo.gl/k7XYbx)
> 
> 如果你喜欢这个故事，我们推荐你阅读我们的[最新科技故事](http://bit.ly/hackernoonlatestt)和[趋势科技故事](https://hackernoon.com/trending)。直到下一次，不要把世界的现实想当然！