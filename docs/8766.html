<html>
<head>
<title>Deploy React.js (create-react-app) Node.js to DigitalOcean Cloud Hosting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将react . js(create-react-app)node . js部署到数字海洋云主机</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/deploy-react-js-create-react-app-node-js-to-digitalocean-cloud-hosting-72206310017b?source=collection_archive---------0-----------------------#2017-12-14">https://medium.com/hackernoon/deploy-react-js-create-react-app-node-js-to-digitalocean-cloud-hosting-72206310017b?source=collection_archive---------0-----------------------#2017-12-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="3fa8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">React.js &amp; Express.js ES6构建和部署</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/38c436c29b673d2ea8faad3f4f127538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mhu9tBlpmFgfEb-oMNlddQ.jpeg"/></div></div></figure><h2 id="faff" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">获取数字海洋帐户</h2><p id="5146" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我一直在为我自己和我的客户使用<a class="ae lb" href="https://m.do.co/c/bb792e37b9dd" rel="noopener ugc nofollow" target="_blank">数字海洋</a>，所以建议为你的项目使用它，只需根据你的项目大小选择vps，起价为5美元或10美元，20美元，价格非常灵活。提供SSD云托管，但价格不错，我不认为你可以在其他供应商那里得到相同质量的价格。除了支持非常快和良好的文件，友好的用户界面为最终用户。因此，让我们开始在<a class="ae lb" href="https://m.do.co/c/bb792e37b9dd" rel="noopener ugc nofollow" target="_blank">DigitalOcean.com</a>注册账户并部署你的应用吧</p><h2 id="0091" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">在数字海洋云VPS上安装Ubuntu</h2><ul class=""><li id="aea9" class="lc ld hu it b iu kw iy kx jc le jg lf jk lg jo lh li lj lk dt translated">这个教程我将使用Ubuntu，我也推荐这个操作系统给你的vps。但这是你的选择。我用的是Ubuntu 16.04版本。对于价格，这取决于你的项目有多大，有多少流量。对我来说，我开始每月20美元是一个好的开始，然后我们可以升级。</li><li id="52c9" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">选择数据中心区域:DigitalOcean有许多数据中心，这意味着如果您的访问者几乎来自美国纽约，您可以为您的项目选择一个数据中心，例如，如果我为一个项目选择所有来自越南的访问者，那么我可以选择一个靠近越南的数据中心，即新加坡。</li><li id="3857" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">选择附加选项:如果你想有额外的备份服务，或私人网络。</li><li id="9c24" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">添加您的ssh密钥:您可以在您的计算机上生成您的ssh密钥，并将其复制到您的vps，这意味着当您从ssh登录时，不必再输入root帐户的密码，节省您的时间和更多的安全性，如果您想知道如何生成SSH密钥并在DigitalOcean主机上使用它，请查看此<a class="ae lb" href="https://www.digitalocean.com/community/tutorials/how-to-use-ssh-keys-with-digitalocean-droplets" rel="noopener ugc nofollow" target="_blank">文章</a></li><li id="990c" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">如果你想一次设置多个液滴，液滴默认值是1。</li><li id="a3f3" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">你的水滴的名字，点击提交，就可以得到一杯咖啡，并等待一会数字海洋为你设置。直到你看到“编码快乐！”您的云vps已经可以使用了。</li><li id="3143" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">检查你在数字海洋注册的电子邮件地址，你会收到一封通知你的VPS IP，root帐号和密码的邮件。以下是您的电子邮件Droplet名称的格式:[您的Droplet名称] IP地址:[您的-vps-IP]用户名:root密码:[您的-root-Password-generated-by-robot]</li><li id="96b6" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">使用以下命令<br/> <code class="eh lq lr ls lt b">ssh root@YOUR-IP-ADDREESS</code>登录到您的vps</li><li id="c5c7" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">现在输入你的超级用户密码。您将在第一时间要求更改新密码。</li><li id="313f" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">服务器将再次询问您当前的密码(这是您电子邮件中的密码)</li><li id="8603" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">输入新口令</li><li id="86c2" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">确认密码，并记住它以备后用。</li><li id="6e63" class="lc ld hu it b iu ll iy lm jc ln jg lo jk lp jo lh li lj lk dt translated">完成并愉快地设置您的云。</li></ul><h2 id="f930" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">在您的云上配置防火墙</h2><p id="2732" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">这是我们需要做的非常重要的一步。因此，我们需要重新配置我们的防火墙软件，以允许访问服务</p><p id="7dc1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我建议只为80、443、ssh(端口22)开放端口，但这取决于您的项目可能需要为其他服务开放更多的端口。在这个项目中，我们需要开放端口80用于http访问，443 https (ssl)和端口22(用于ssh登录)这就足够了。</p><h2 id="bffc" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">安装Nginx</h2><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="2c70" class="kb kc hu lt b fv ly lz l ma mb">apt-get update</span><span id="15c7" class="kb kc hu lt b fv mc lz l ma mb">sudo apt-get install nginx</span></pre><p id="3269" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，防火墙是不活动的，您可以通过运行命令<code class="eh lq lr ls lt b">sudo ufw status</code>来检查它</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="3cd7" class="kb kc hu lt b fv ly lz l ma mb">sudo ufw app list</span></pre><p id="fe79" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，让配置防火墙允许这些端口</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="5606" class="kb kc hu lt b fv ly lz l ma mb">sudo ufw allow 'Nginx Full'</span><span id="6af9" class="kb kc hu lt b fv mc lz l ma mb">sudo ufw allow 'OpenSSH'</span><span id="95c7" class="kb kc hu lt b fv mc lz l ma mb">sudo ufw enable</span></pre><h2 id="849f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">在DigitalOcean Ubuntu 16.04上设置节点</h2><p id="ee6a" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们使用Node.js作为后端，并将提供react应用程序构建的静态文件。所以Node.js是必需的</p><p id="a3d0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">访问https://nodejs.org/en/download/package-manager/<a class="ae lb" href="https://nodejs.org/en/download/package-manager/" rel="noopener ugc nofollow" target="_blank">查看文档</a></p><p id="9d51" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们使用包管理来安装，下面是安装Node.js v9的命令</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="67eb" class="kb kc hu lt b fv ly lz l ma mb">curl -sL https://deb.nodesource.com/setup_9.x | sudo -E bash -</span><span id="4557" class="kb kc hu lt b fv mc lz l ma mb">sudo apt-get install -y nodejs</span></pre><p id="432e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">成功安装Node.js后，我们可以通过在命令行中键入<code class="eh lq lr ls lt b">node -v</code>来检查版本，您会看到“v9.3.0”</p><h2 id="94cb" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">在digital ocean Ubuntu 16.04 Cloud VPS上安装MongoDB v3.6</h2><p id="0368" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们在后端restful服务中使用Mongodb作为数据库，所以让我们按照文档<a class="ae lb" href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/" rel="noopener ugc nofollow" target="_blank">https://docs . MongoDB . com/manual/tutorial/install-MongoDB-on-Ubuntu/</a>安装MongoDB</p><p id="cd05" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">导入软件包管理系统使用的公钥</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="9f60" class="kb kc hu lt b fv ly lz l ma mb">sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5</span></pre><p id="5f35" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为MongoDB (Ubuntu 16.04)创建列表文件</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="3671" class="kb kc hu lt b fv ly lz l ma mb">echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.6 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-3.6.list</span></pre><p id="8bb3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新加载本地包数据库</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="718e" class="kb kc hu lt b fv ly lz l ma mb">sudo apt-get update</span></pre><p id="8f6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安装MongoDB的最新稳定版本</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="f44a" class="kb kc hu lt b fv ly lz l ma mb">sudo apt-get install -y mongodb-org</span></pre><p id="7b93" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启动MongoDB(端口运行缺省值:27017)</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="845a" class="kb kc hu lt b fv ly lz l ma mb">sudo service mongod start</span></pre><p id="332e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想阻止MongoDB</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="a19a" class="kb kc hu lt b fv ly lz l ma mb">sudo service mongod stop</span></pre><p id="bd31" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者重启MongoDB</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="900a" class="kb kc hu lt b fv ly lz l ma mb">sudo service mongod restart</span></pre><h2 id="b9fe" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">安装Nginx — Http代理服务器。</h2><p id="5d8d" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">让我向你简单解释一下为什么我们在这个Nodejs Web应用程序中使用Nginx。示例:我们的聊天应用程序在端口3000上运行，这是Nodejs应用程序运行的默认端口。我们可以将端口更改为3001或3002或8080 …因此，如果您将您的域tabvn.com指向数字海洋云vps，那么在这种情况下，我们可以访问位于<a class="ae lb" href="http://tabvn.com:3000" rel="noopener ugc nofollow" target="_blank">http://tabvn.com:3000</a>的聊天应用程序，因此我们只需查看默认端口80中的nodejs web应用程序，例如位于<a class="ae lb" href="http://tabvn.com" rel="noopener ugc nofollow" target="_blank">http://tabvn.com</a>的应用程序，这就是我们使用Nginx的原因。</p><p id="3b6d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要安装Nginx，请访问http://nginx.org/en/linux_packages.html官方<a class="ae lb" href="http://nginx.org/en/linux_packages.html" rel="noopener ugc nofollow" target="_blank">的文档</a></p><p id="f857" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，我们将在Ubuntu云托管16.04上运行以下命令</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="4cd5" class="kb kc hu lt b fv ly lz l ma mb">apt-get update</span><span id="517a" class="kb kc hu lt b fv mc lz l ma mb">sudo apt-get install nginx</span></pre><p id="6682" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启动nginx:打开你的IP地址ex: <a class="ae lb" href="http://123.456.789" rel="noopener ugc nofollow" target="_blank"> http://123.456.789 </a>你应该看到“欢迎使用Nginx！”，我们云中的所有Nginx配置都在/etc/nginx/nginx.conf中</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="5106" class="kb kc hu lt b fv ly lz l ma mb">sudo nginx</span></pre><p id="0ef6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">停止Nginx</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="1300" class="kb kc hu lt b fv ly lz l ma mb">sudo nginx -s stop</span></pre><p id="8f14" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重新加载Nginx</p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="54e3" class="kb kc hu lt b fv ly lz l ma mb">nginx -s reload</span></pre><h2 id="3912" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">修复了Ubuntu 16.04上的bcrypt问题</h2><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="3583" class="kb kc hu lt b fv ly lz l ma mb">sudo apt-get install build-essential</span></pre><h2 id="3479" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">Nginx配置示例支持WebSocket</h2><p id="744e" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">Nginx Websocket文档:<a class="ae lb" href="http://nginx.org/en/docs/http/websocket.html" rel="noopener ugc nofollow" target="_blank">http://nginx.org/en/docs/http/websocket.html</a></p><pre class="jq jr js jt fq lu lt lv lw aw lx dt"><span id="c987" class="kb kc hu lt b fv ly lz l ma mb">server {<br/>        listen 80;<br/>        root /var/www/html;<br/>        location / {<br/><br/><br/>                proxy_pass http://127.0.0.1:3001;<br/>                proxy_http_version 1.1;<br/>                proxy_set_header Upgrade $http_upgrade;<br/>                proxy_set_header Connection "upgrade";<br/>        }<br/><br/>}</span></pre><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="md me l"/></div></figure><p id="f27c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">视频:【https://www.youtube.com/watch?v=wJsH45eWNBo T2】</p></div></div>    
</body>
</html>