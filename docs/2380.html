<html>
<head>
<title>Build your first Facebook Messenger bot in Ruby with Sinatra (Part 3/3)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Ruby和Sinatra构建你的第一个Facebook Messenger机器人(第3/3部分)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-3-3-c1b9f55ae121?source=collection_archive---------8-----------------------#2017-01-23">https://medium.com/hackernoon/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-3-3-c1b9f55ae121?source=collection_archive---------8-----------------------#2017-01-23</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="ec19" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">上线</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/3ef12086916076c01f99c6bfde936110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BmdusyPSUoNgx0JwwS3BSA.jpeg"/></div></div></figure><p id="ee56" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="kr">在本教程的</em> <a class="ae ks" href="https://hackernoon.com/smooth-coordinator-1427dce17f00#.1die4td09" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv"> <em class="kr">第一部分</em> </strong> </a> <em class="kr">中，我们在脸书上设置了我们的页面，并通过</em><a class="ae ks" href="https://ngrok.com/" rel="noopener ugc nofollow" target="_blank"><em class="kr">ngrok</em></a><em class="kr">将其连接到运行在我们机器上的</em><a class="ae ks" href="http://www.sinatrarb.com/" rel="noopener ugc nofollow" target="_blank"><em class="kr">Sinatra</em></a><em class="kr">服务器。我们从</em><a class="ae ks" href="http://www.hyper.no/" rel="noopener ugc nofollow" target="_blank"><em class="kr">hyperslo</em></a><em class="kr">引入了</em><a class="ae ks" href="https://github.com/hyperoslo/facebook-messenger" rel="noopener ugc nofollow" target="_blank"><em class="kr">Facebook-messenger</em></a><em class="kr">gem，并将我们的bot与</em><a class="ae ks" href="https://developers.google.com/maps/documentation/geocoding/intro" rel="noopener ugc nofollow" target="_blank"><em class="kr">Google Geocoding API</em></a><em class="kr">挂钩。在</em> <a class="ae ks" href="https://hackernoon.com/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-2-3-b3d929a4606d" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv"> <em class="kr">第二部分</em> </strong> </a> <em class="kr">中，我们给我们的机器人添加了新功能，看到代码的复杂性增加了，所以我们不得不重构。我们添加了两组不同的菜单，使与机器人的交互更加容易。</em></p><p id="be3b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt kt translated">这次我们将教我们的机器人使用我们当前的位置。我们也将承认我们之前犯的一些设计错误，再次重构，并最终通过将我们的机器人部署到<a class="ae ks" href="heroku.com" rel="noopener ugc nofollow" target="_blank"> Heroku </a>来将其从你的计算机的束缚中释放出来。你还将被引导通过<strong class="jx hv">脸书验证过程</strong>，这样你自己的机器人有一天就可以上线了。</p><p id="98ce" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果您没有遵循上两部分的步骤，您可以从这里的开始代码。</p><p id="cc8a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这是我们今天要建造的:</p><div class="jk jl jm jn fq ab cb"><figure class="lc jo ld le lf lg lh paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><img src="../Images/f209c6033d187974169894e9f4794d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*4FAHyq72_Az3Rp4rFrFnxw.png"/></div></figure><figure class="lc jo ld le lf lg lh paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><img src="../Images/a2d34aa069c49c546be1023375bada2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*09xxdyCWiZPcYCB0nzBdyw.png"/></div></figure><figure class="lc jo ld le lf lg lh paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><img src="../Images/3884e773b177b37143b1d3094dcfffaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*zREK2I6hJjgBYoQIxQ2X-A.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek lm di ln lo">Our bot by the end of this tutorial</figcaption></figure></div><h2 id="5ff2" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">保守秘密</h2><p id="f2c6" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">还记得每次我们打开一个新的终端窗口在本地主机上启动我们的bot时，我们不得不手工输入我们的<strong class="jx hv">环境变量</strong>，比如<code class="eh mp mq mr ms b">ACCESS_TOKEN </code>或<code class="eh mp mq mr ms b">VERIFY_TOKEN</code>吗？嗯，一些读者指出有一个gem可以解决这个问题，它可以用于任何Ruby项目(不一定非得是Rails，就像流行的<a class="ae ks" href="https://github.com/laserlemon/figaro" rel="noopener ugc nofollow" target="_blank"> figaro </a> gem一样)。遇见<a class="ae ks" href="https://github.com/bkeepers/dotenv" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv"> dotenv </strong> </a>。首先，在您的系统上安装它:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="8b12" class="lp lq hu ms b fv mx my l mz na">gem install dotenv</span></pre><p id="95b6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后要求它在 <code class="eh mp mq mr ms b">app.rb </code>和<code class="eh mp mq mr ms b">bot.rb</code>文件的<strong class="jx hv">之上</strong></p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="3bc0" class="lp lq hu ms b fv mx my l mz na">require 'dotenv/load'</span></pre><p id="d5d9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在您的项目文件夹中创建一个名为<code class="eh mp mq mr ms b">.env</code>的文件，并放置与您在终端中设置的完全相同的环境变量声明。(<em class="kr">提醒:这两个令牌都可以在您的脸书开发者控制台中找到，详见</em> <a class="ae ks" href="https://hackernoon.com/smooth-coordinator-1427dce17f00#.23zwpjyhb" rel="noopener ugc nofollow" target="_blank"> <em class="kr">第一部分</em></a><em class="kr"/>)</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="837d" class="lp lq hu ms b fv mx my l mz na">VERIFY_TOKEN=here_comes_YOUR_verify_token<br/>ACCESS_TOKEN=here_comes_YOUR_access_token</span></pre><p id="00fd" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在向您的项目文件夹添加另一个文件，名为<code class="eh mp mq mr ms b">.gitignore</code>。把<code class="eh mp mq mr ms b">.env</code>放在里面(对，只是的名字。env文件),这样您的令牌就不会被推送到Github供全世界查看。我假设您使用Git跟踪您的项目，这对我们部署到Heroku是必不可少的。</p><p id="9154" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">太好了，现在你每次用一个<code class="eh mp mq mr ms b">rackup</code>命令启动你的本地服务器时，你的环境变量都会被自动设置，不需要担心关闭和重新打开你的终端窗口。</p><h2 id="fad1" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">我在哪里？</h2><p id="56c4" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">你必须承认，我们机器人的<a class="ae ks" href="https://hackernoon.com/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-2-3-b3d929a4606d#.ahwolrald" rel="noopener ugc nofollow" target="_blank">最后一次迭代</a>不是很有用:你必须手动输入一个地址来查找GPS坐标。学习像埃菲尔铁塔的纬度这样随机的东西很好，但当你需要回答这个问题时，这并没有什么帮助，这个问题和人类本身一样古老，“我在哪里？”。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/cdfd179becbfa326d18e8ef8709d2817.png" data-original-src="https://miro.medium.com/v2/format:webp/1*WgjJ4oRWb2hMWrn_QhtjfA.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">The question everyone asks oneself sometimes: “Where the hell am I?”</figcaption></figure><p id="0ad3" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你的手机有GPS，对吧？嗯，脸书<a class="ae ks" href="https://developers.facebook.com/docs/messenger-platform/send-api-reference/quick-replies" rel="noopener ugc nofollow" target="_blank">信使API </a>让我们使用它。这是一个关于如何实现位置共享的例子。</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="4d66" class="lp lq hu ms b fv mx my l mz na">curl -X POST -H "Content-Type: application/json" -d '{<br/>  "recipient":{<br/>    "id":"USER_ID"<br/>  },<br/>  "message":{<br/>    "text":"Please share your location:",<br/>    "quick_replies":[<br/>      {<br/>        "content_type":"location",<br/>      }<br/>    ]<br/>  }<br/>}' "https://graph.facebook.com/v2.6/me/messages?access_token=PAGE_ACCESS_TOKEN"</span></pre><p id="e436" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">但是我们没有直接访问脸书JSON端点，所有这些工作都是由我们使用的Facebook-messenger gem在幕后完成的。然而，我们能够进行演绎推理，通过查看这个原始JSON，我们看到了什么？我们看到，使用户能够发送他/她的位置的部分是快速回复集中的<code class="eh mp mq mr ms b">“content_type”:”location”</code>。这意味着，我们需要首先向用户发送任何消息，并附加一个位置查询。</p><p id="248b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">您还需要在脸书开发者控制台的<em class="kr"> Webhooks </em>选项卡下启用<em class="kr"> location </em> webhook。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/5bce5a2f42a9e0c840648143490e3d33.png" data-original-src="https://miro.medium.com/v2/format:webp/1*faqrPj5D7mqg9wBiYdU4ng.png"/></div></figure><p id="87ac" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们已经有了一个JSON请求的包装器，其形式是我们在上一篇<a class="ae ks" href="https://hackernoon.com/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-2-3-b3d929a4606d#.1sct23t8l" rel="noopener ugc nofollow" target="_blank">文章</a>中介绍的<code class="eh mp mq mr ms b">say</code> helper。它看起来是这样的:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="1ff0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如您所见，这个方法采用了一个可选的<code class="eh mp mq mr ms b">quick_replies</code>参数，这是一个回复数组。我们用它来构建快速回复的“菜单”,向用户显示基本的命令。也就是说，我们可以将<code class="eh mp mq mr ms b">[{ content_type: ‘location’ }]</code>(没错，在数组中散列)传递给这个方法，瞧，我们将把上面看到的完全相同的JSON发送给脸书API。这就是代码重用！</p><p id="30c2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">另外，请记住，我们可以用<code class="eh mp mq mr ms b">message.inspect</code>检查机器人发送给我们的任何消息。尝试将这一行添加到<code class="eh mp mq mr ms b">bot.rb</code>中的<code class="eh mp mq mr ms b">wait_for_any_input</code>方法的顶部，就在<code class="eh mp mq mr ms b">sender_id = message.sender[‘id’]</code>行之前:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="c718" class="lp lq hu ms b fv mx my l mz na">puts "Received '#{message.inspect}' from #{message.sender}"</span></pre><p id="921e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，如果你在手机上打开Messenger，连接到你的机器人，发送你的位置而不是文本，然后通过检查你的<code class="eh mp mq mr ms b">rackup</code>日志，你可以看到位置信息在我们的<strong class="jx hv"> facebook-messenger </strong>圣诞老人的小助手看来是什么样的。您应该会看到类似这样的内容:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="48d1" class="lp lq hu ms b fv mx my l mz na">Received '#&lt;Facebook::Messenger::Incoming::Message:0x007fad3890be00 @messaging={"sender"=&gt;{"id"=&gt;"1295486190524658"}, "recipient"=&gt;{"id"=&gt;"1614495692193246"}, "timestamp"=&gt;1484597226465, "message"=&gt;{"mid"=&gt;"mid.1484597226465:b335687852", "seq"=&gt;59617, "attachments"=&gt;[{"title"=&gt;"Andy's Location", "url"=&gt;"https://www.facebook.com/l.php?u=https%3A%2F%2Fwww.bing.com%2Fmaps%2Fdefault.aspx%3Fv%3D2%26pc%3DFACEBK%26mid%3D8100%26where1%3D55.772721087%252C%2B37.683347132677%26FORM%3DFBKPL1%26mkt%3Den-US&amp;h=ATNEWzpLzUVPzSBK4oIF9rpOfG1IDaYzKtbNpDNcLAG9729MvTMvXETHmOTMdhnrQEw5Af2Pg8Ct2uTwXnQoTRI4DbmXWMH-p1ajjeAXhcvMLmMjvsyhCFgMDMM9xkHrFPVTTeg&amp;s=1&amp;enc=AZOftxHdpeOTr32oSlm8KEimjwBgrzLEPiUtBmE5a0pwZZ2BTsgizwnV6p3b8D3HvtE7dmT-hQuRh7Vn8x-vWNPe", "type"=&gt;"location", "payload"=&gt;{"coordinates"=&gt;{"lat"=&gt;55.772721087, "long"=&gt;37.683347132677}}}]}}&gt;' from {"id"=&gt;"1295486190524658"}</span></pre><p id="00e9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果我们挖得足够深，我们可以得到坐标，我们甚至不必再打电话给谷歌地理编码！通过反复试验，我们发现可以从我们的<a class="ae ks" href="https://hackernoon.com/tagged/ruby" rel="noopener ugc nofollow" target="_blank"> Ruby </a>程序中访问包含经纬度值散列的<code class="eh mp mq mr ms b">“coordinates”</code>键，如下所示:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="5df3" class="lp lq hu ms b fv mx my l mz na">message.attachments.first['payload']['coordinates']</span></pre><p id="74b5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">太好了！让我们写一些新的方法。将此添加到<code class="eh mp mq mr ms b">bot.rb</code>:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="b8a5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如你所见，我们使用<code class="eh mp mq mr ms b">say</code>帮助器方法为你的消息添加附加“发送位置”标签。在界面中，它看起来像这样:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/e806bed1f998ed543930ebb719d754d9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*6AyJouzfRUl0nqrXvaw64Q.png"/></div></figure><p id="7b19" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">为了进一步处理，我们还必须确保在<code class="eh mp mq mr ms b">lookup_location(sender_id)</code>中得到的任何回复确实是一个位置，而不是一个普通的旧文本。</p><p id="17d1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">将此帮助器方法添加到<code class="eh mp mq mr ms b">bot.rb</code>:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="8f73" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在让我们进入正题，把我们的主要逻辑放到另一种方法中:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="13a7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">很好，现在我们的机器人能够(理论上，我们还没有把这个方法与任何机器人对话逻辑联系起来)从你发送的位置提取你当前的GPS坐标。让我们更进一步。如果我们也可以根据位置猜测完整地址会怎么样？当然，我们可以！<strong class="jx hv">谷歌地理编码API </strong>也让我们做一些叫做<a class="ae ks" href="https://developers.google.com/maps/documentation/geocoding/intro#ReverseGeocoding" rel="noopener ugc nofollow" target="_blank">反向地理编码</a>的事情。听起来，这正是我们想要的！为了使用它，我们需要发送一个GET请求到不同的URL，所以让我们在我们的<code class="eh mp mq mr ms b">bot.rb</code>之上创建另一个常量，紧挨着我们声明<code class="eh mp mq mr ms b">API_URL </code>的地方。为了保持一致，我称它为<code class="eh mp mq mr ms b">REVERSE_API_URL</code>，但我承认这不是最好的命名。</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="7296" class="lp lq hu ms b fv mx my l mz na">REVERSE_API_URL = 'https://maps.googleapis.com/maps/api/geocode/json?latlng='</span></pre><p id="7962" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">注意:</strong> <em class="kr">记住我们只使用地理编码API，而不使用API密钥进行开发和测试。按照指示</em>  <em class="kr">制作</em> <a class="ae ks" href="https://developers.google.com/maps/documentation/geocoding/get-api-key" rel="noopener ugc nofollow" target="_blank"> <em class="kr">。</em></a></p><p id="9744" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，让我们更新我们的<code class="eh mp mq mr ms b">handle_user_location(message)</code>方法来对我们的坐标进行反向地理编码。注意，我们正在重用之前创建的<code class="eh mp mq mr ms b">get_parsed_response </code>和<code class="eh mp mq mr ms b">extract_full_address</code>方法。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="62b6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">很好，我们已经拥有了这个特性所需要的一切，现在让我们把它添加到界面中。添加它最简单的地方是一个持久菜单，在<code class="eh mp mq mr ms b">bot.rb</code>之上的线程设置中定义。更新它:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="d893" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在添加一个回发到<code class="eh mp mq mr ms b">LOCATION</code>有效负载，它将调用我们的新功能。更新你的<code class="eh mp mq mr ms b">Bot.on :postback</code>块。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="4821" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">此外，在文件顶部的某个地方添加这个常量，以避免在我们需要的任何地方重新键入<code class="eh mp mq mr ms b">[{ content_type: ‘location’ }]</code>:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="c6c3" class="lp lq hu ms b fv mx my l mz na">TYPE_LOCATION = [{ content_type: 'location' }]</span></pre><p id="7c10" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，每当用户从持久菜单中选择“位置查找”时，我们会询问位置并邀请他/她发送给我们。</p><p id="ed66" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们还通过快速回复与用户互动。更新它以包括对位置命令的引用:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="067f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们从<code class="eh mp mq mr ms b">wait_for_command</code>方法内部像处理任何其他用户命令一样处理快速回复。让我们考虑位置(并在这样做的同时更改以前的命名):</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="f994" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">注意，我们开始将<code class="eh mp mq mr ms b">TYPE_LOCATION</code>添加到所有的<code class="eh mp mq mr ms b">say</code>方法调用中。那是因为我们想给所有的机器人功能添加“发送位置”标签。毕竟，对于邮政地址查找，用户可能希望键入部分地址，或者只发送他/她的当前位置。手动GPS查找也是如此。现在我们必须处理<code class="eh mp mq mr ms b">show_coordinates</code>和<code class="eh mp mq mr ms b">show_full_addres </code>方法中的位置。我们将不得不重新审视我们已经做过的事情。</p><h2 id="f561" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">保持简单</h2><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/7724f341a7f420cbdbd2737d41c0a29f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*v7h3Qs_3f4grlWaW0oktQA.jpeg"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">An important principle in code (and in life)</figcaption></figure><p id="53d0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">好的。是时候承认有时候你可以过度重构你的代码了。正如我的一些更有经验的读者向我指出的，在第2部分的<a class="ae ks" href="https://hackernoon.com/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-2-3-b3d929a4606d#.1sct23t8l" rel="noopener ugc nofollow" target="_blank">中的<code class="eh mp mq mr ms b">handle_api_request</code>方法中引入带参数的<code class="eh mp mq mr ms b">yield</code>是很糟糕的，因为即使它帮助我们去掉了大约8个重复行，它也使得我们的代码<strong class="jx hv">很难推理出</strong>。此外，如果在某些时候我们希望我们的特性开发更多独立的功能，我们希望能够独立地修改它们。让我们改正错误:去掉<code class="eh mp mq mr ms b">handle_api_request</code>方法，重写两个特性。</a></p><blockquote class="ne nf ng"><p id="8a89" class="jv jw kr jx b jy jz iv ka kb kc iy kd nh kf kg kh ni kj kk kl nj kn ko kp kq hn dt translated">外卖:过度思考是愚蠢的一种形式。</p></blockquote><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="5e43" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这里，我们将所有的条件逻辑放在我们的<code class="eh mp mq mr ms b">Bot.on :message</code>块中，我们还为每个查找添加了一个单独的方法，以便遵循<a class="ae ks" href="https://en.wikipedia.org/wiki/Single_responsibility_principle" rel="noopener ugc nofollow" target="_blank"> SRP </a>并减少嵌套。</p><p id="9dcc" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">代码太多了！每当你觉得失落的时候，就去<a class="ae ks" href="https://github.com/progapandist/coordinator-bot" rel="noopener ugc nofollow" target="_blank">本教程的Github </a>看看最新好版本的<a class="ae ks" href="https://github.com/progapandist/coordinator-bot/blob/master/bot.rb" rel="noopener ugc nofollow" target="_blank"> bot.rb </a>文件。</p><h2 id="11d0" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">走向国际</h2><p id="f5cc" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt">You must have noticed the <code class="eh mp mq mr ms b">encode_ascii</code> method that we haven’t yet introduced. As of <a class="ae ks" href="https://hackernoon.com/build-your-first-facebook-messenger-bot-in-ruby-with-sinatra-part-2-3-b3d929a4606d#.1sct23t8l" rel="noopener ugc nofollow" target="_blank">Part 2</a>, our bot would just take whatever a user texted and append it to API URL, assuming all is good. But, if you try using international characters in your address (“Красная площадь“ or 東京都), your bot will throw this:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="6b99" class="lp lq hu ms b fv mx my l mz na">ERROR URI::InvalidURIError: URI must be ascii only "https://maps.googleapis.com/maps/api/geocode/json?address=\u{424}\u{440}. \u{42d}\u{43d}\u{433}\u{435}\u{43b}\u{44c}\u{441}\u{430}, \u{414}. 23"</span></pre><p id="81e8" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这个错误来自于<code class="eh mp mq mr ms b">HTTParty</code>(我们用来发出HTTP请求的gem)使用的Ruby标准库<code class="eh mp mq mr ms b">uri</code>模块。我们需要一种方法将来自用户的字符串转换成URL友好的ASCII格式。</p><p id="43ec" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">为此，我们将使用<a class="ae ks" href="https://github.com/sporkmonger/addressable" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv">可寻址</strong> </a>宝石。它有一个在URL上执行<a class="ae ks" href="https://en.wikipedia.org/wiki/Percent-encoding" rel="noopener ugc nofollow" target="_blank">百分比编码</a>的方法，但是你也可以在任何字符串上执行。将<code class="eh mp mq mr ms b">gem ‘addressable’</code>线添加到<code class="eh mp mq mr ms b">Gemfile</code>和<code class="eh mp mq mr ms b">bot.rb</code>中的<code class="eh mp mq mr ms b">require ‘addressable/uri’</code>。然后加上<code class="eh mp mq mr ms b">ensode_ascii(s)</code>方法，这是一句俏皮话。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="bdb9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在一串<code class="eh mp mq mr ms b">“Красная площадь, д.1”</code>会变成<code class="eh mp mq mr ms b">“%D0%9A%D1%80%D0%B0%D1%81%D0%BD%D0%B0%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%D0%B4%D1%8C,%20%D0%B4.1”</code>。一旦你发出请求，Google API足够聪明可以解码回来。</p><p id="1711" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt">The alternative is to use <a class="ae ks" href="https://github.com/norman/unidecoder" rel="noopener ugc nofollow" target="_blank"><strong class="jx hv">unidecoder</strong></a> gem that will try to <strong class="jx hv">transliterate</strong> any string so <code class="eh mp mq mr ms b">“Красная площадь”</code> will turn into <code class="eh mp mq mr ms b">“Krasnaia ploshchad’”</code>, which is close enough, but <code class="eh mp mq mr ms b">“東京都”</code> will turn into <code class="eh mp mq mr ms b">“Dong Jing Du“</code>, which has nothing to do with Tokyo (for which that three Japanese characters stood in the first place). Actually, for the transliterated version of <code class="eh mp mq mr ms b">“東京都”</code> Google API will return some address in Florida. That’s probably not what you want.</p><h2 id="31b8" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">机器人虐待</h2><p id="edc2" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">你总是不得不假设你的用户会竭尽所能破坏你的机器人，要么是因为纯粹的好奇，要么只是偶然，因为你没有解释一些行为。目前，如果你向用户索要地址，而他/她给你发了一张图片或一段视频作为回复，而不是文本——你的机器人就坏了。为了解决这个问题，您需要引入一个微小的新方法:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="b9f9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后在每个动作中执行这个检查，就像这样:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nk"><img src="../Images/6dc698bc27c56bbe0f9d80352de92e82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pq0w4LYOiXGvjVRZeR6Sjw.png"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Why humans have to be so cruel?</figcaption></figure><h2 id="3734" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">春季大扫除</h2><p id="29ba" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">好了，现在我们的机器人已经超过200行了。这使得我们的代码难以维护。是时候将一些常用的功能放到单独的文件中了。我们可以使用类或模块将我们的程序分成几个部分。我们将使用一个简单的类包装器和一个类方法来调用部分代码(<em class="kr">这是有争议的，我想在评论</em>中听到更多关于实际最佳实践的信息)。这个想法是这样的:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="7d7a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后在你的<code class="eh mp mq mr ms b">bot.rb</code>上方调用<code class="eh mp mq mr ms b">Greetings.enable</code>。我把细节留给你，在<a class="ae ks" href="https://github.com/progapandist/coordinator-bot/" rel="noopener ugc nofollow" target="_blank">我的项目</a>中我创建了两个文件:<code class="eh mp mq mr ms b">greetings.rb</code>和<code class="eh mp mq mr ms b">persistent_menu.rb</code>来收集所有的<code class="eh mp mq mr ms b">Facebook::Messenger::Thread.set</code>动作。</p><h2 id="3f7a" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">开始倒计时，引擎启动</h2><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/92547f905686008cdac7e27d47c30cc1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*shfZC8SvSsZpjT8d_pUt0Q.jpeg"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Our bot goes to Heroku cloud</figcaption></figure><p id="48f2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，在我们在本地主机上测试了所有我们能测试的东西之后(<em class="kr">是的，我知道机器人测试是一种地狱</em>)，我们已经准备好将我们的机器人发布到世界上了。我们将使用Heroku 进行部署。去Heroku的<a class="ae ks" href="https://heroku.com" rel="noopener ugc nofollow" target="_blank">网站</a>和<strong class="jx hv">免费报名</strong>。</p><p id="c153" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后，按照这些说明安装<strong class="jx hv"> Heroku CLI </strong>(如果你以前没有这样做过的话)。此外，确保您的项目文件夹被Git跟踪。如果没有，运行:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="fb1f" class="lp lq hu ms b fv mx my l mz na">git init<br/>git add . <br/>git commit -m "First commit"</span></pre><p id="25d6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后使用<code class="eh mp mq mr ms b">heroku login</code>验证您的机器，并通过运行以下命令创建您的heroku应用程序:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="d194" class="lp lq hu ms b fv mx my l mz na">heroku create YOUR_BOT_NAME</span></pre><p id="70aa" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">它将以<em class="kr">YOUR _ BOT _ name . heroku app . com</em>的形式创建一个web地址，并将heroku添加为远程Git存储库。通过运行以下命令检查是否一切顺利:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="64da" class="lp lq hu ms b fv mx my l mz na">git remote -v</span></pre><p id="605e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">您应该看到对您的<strong class="jx hv"> heroku遥控器</strong>的两个新引用(获取和推送)。</p><p id="9299" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，<strong class="jx hv">这是重要的</strong> : <strong class="jx hv">注释掉<code class="eh mp mq mr ms b">bot.rb</code>和<code class="eh mp mq mr ms b">app.rb</code>中的</strong> <code class="eh mp mq mr ms b">require ‘dotenv/load’</code>行。gem和Heroku不兼容(<em class="kr">有一个fork可以，你可以查一下，但是我发现直接在仪表盘上设置变量更容易些</em>)。然后在你的<a class="ae ks" href="https://dashboard.heroku.com/apps" rel="noopener ugc nofollow" target="_blank"> Heroku仪表盘</a>中选择你新创建的应用，转到它的<em class="kr">设置</em>并滚动到<strong class="jx hv"> <em class="kr">配置变量</em> </strong>。展示它们，然后像这样输入你的<code class="eh mp mq mr ms b">ACCESS_TOKEN</code>和<code class="eh mp mq mr ms b">VERIFY_TOKEN</code>:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/b160633c8e9df74d0895fda09fc0038b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-BHeNmQyhhrEZ6sbrNBy5g.png"/></div></figure><p id="a15f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，关键时刻到了。如果您遵循了所有步骤，那么<code class="eh mp mq mr ms b">config.ru</code>文件的内容应该足以成功部署。运行:</p><pre class="jk jl jm jn fq mt ms mu mv aw mw dt"><span id="704a" class="lp lq hu ms b fv mx my l mz na">git push heroku master</span></pre><p id="c897" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">…看看Heroku根据您的代码创建一个功能性web应用程序的神奇之处。你现在所要做的就是去脸书开发者的控制台，把一个webhook的地址从你的ngrok URL改成你的新Heroku应用，就像这样:</p><p id="64f7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><a class="ae ks" href="https://your-bot-name.herokuapp.com/webhook" rel="noopener ugc nofollow" target="_blank"><em class="kr">https://your-bot-name.herokuapp.com/webhook</em></a></p><p id="209a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果webhook验证顺利— <strong class="jx hv">您已经成功部署了您的bot </strong>！</p><blockquote class="nl"><p id="62ea" class="nm nn hu bd no np nq nr ns nt nu kq ek translated">万岁！</p></blockquote><p id="7a9b" class="pw-post-body-paragraph jv jw hu jx b jy nv iv ka kb nw iy kd ke nx kg kh ki ny kk kl km nz ko kp kq hn dt translated">现在你可以自己测试你的机器人，或者在你的脸书开发者控制台的<em class="kr">角色</em>标签下添加其他脸书用户作为测试员。如果你真的准备好向全世界发布你的机器人，你需要通过<strong class="jx hv">验证过程</strong>。也就是说，脸书总部的真人会查看你的机器人(虽然是短暂的)并检查它是否没有做任何令人讨厌的事情。进入<em class="kr"> App Review </em>标签，让你的机器人“活”起来。然后转到<em class="kr"> Messenger </em>选项卡，在<em class="kr">Messenger应用审查</em>下添加<em class="kr"> pages_messaging </em>到提交。遵循提供的清单。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="ab fr cl nb"><img src="../Images/32e47d5d860e7d7a257dd64a501ff7da.png" data-original-src="https://miro.medium.com/v2/format:webp/1*VypvdyF7ArEh6nq2ApVTqQ.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">You just need to review your pages_messaging in our case</figcaption></figure><p id="e19b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你需要为你的应用程序制定一个隐私政策，这个政策可以很容易地在很多网站上生成。我发现<a class="ae ks" href="https://privacypolicygenerator.info/" rel="noopener ugc nofollow" target="_blank">这个</a>最简单明了。此外，您需要为您的应用程序提供一个图标，它的分辨率必须正好是1024x1024。</p><p id="f2d9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在交叉手指等待。</p><p id="052f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在我的案例中，脸书的审查人员在不到15分钟的时间内审核通过了我的机器人(我是在东部时间周五早上完成的)。有时评论者可能会要求你录制一段机器人的<strong class="jx hv">截屏视频</strong>，使用QuickTime很容易做到这一点。</p><h2 id="ef06" class="lp lq hu bd lr ls lt lu lv lw lx ly lz ke ma mb mc ki md me mf km mg mh mi mj dt translated">嗨，船长！</h2><p id="9037" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">当然，我们的协调机器人不能提供最好的用户体验，有些人可能会发现它的界面令人困惑。对话流程相当僵硬，如果你犯了一个错误，你必须重新开始。然而，我觉得一些功能，比如邮政地址查询或者仅仅通过一条信息就能找到你所在街道的名称，会被证明是有用的(至少，我发现自己会时不时地使用它们)。</p><blockquote class="ne nf ng"><p id="8ade" class="jv jw kr jx b jy jz iv ka kb kc iy kd nh kf kg kh ni kj kk kl nj kn ko kp kq hn dt translated">可以通过关注<a class="ae ks" rel="noopener ugc nofollow" target="_blank" href="/hackernoon/m.me/smoothcoordinator"> <strong class="jx hv">此链接</strong> </a>来玩最新版本的本教程的bot。</p></blockquote><p id="d6a6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这个项目从一个人为的例子开始，把玩Facebook-messenger gem作为Ruby的个人练习。后来我意识到它可能对像我这样的初学者有所帮助，于是开始着手这个教程。</p><blockquote class="nl"><p id="a055" class="nm nn hu bd no np nq nr ns nt nu kq ek translated">我的工作是，最重要的是，激发你的想象力，启发你建造自己的东西。</p></blockquote><p id="423b" class="pw-post-body-paragraph jv jw hu jx b jy nv iv ka kb nw iy kd ke nx kg kh ki ny kk kl km nz ko kp kq hn dt translated">所以我很高兴地得知，我的一个读者用这个教程创造了一个机器人来帮助导航巴黎地铁。</p><div class="jk jl jm jn fq ab cb"><figure class="lc jo ld le lf lg lh paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><img src="../Images/f6500aa7276b424242a4a8dd38d620e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*nKNLT0Z5KXRl8EZT6ayefg.png"/></div></figure><figure class="lc jo ld le lf lg lh paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><img src="../Images/619d879231e9d2f67a60e3346ca4a3e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8YYymvgN8rnQuaAyWHAJEQ.png"/></div></figure><figure class="lc jo ld le lf lg lh paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><img src="../Images/3ebfb52e06fc0312ea59941dce1340b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*VgcG4389amQnyENFbTYlnA.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek lm di ln lo"><a class="ae ks" href="https://www.messenger.com/t/CaptainMetroBot/" rel="noopener ugc nofollow" target="_blank">Captain Metro</a> bot, inspired by this very tutorial</figcaption></figure></div><blockquote class="ne nf ng"><p id="211c" class="jv jw kr jx b jy jz iv ka kb kc iy kd nh kf kg kh ni kj kk kl nj kn ko kp kq hn dt translated"><strong class="jx hv">如果你住在巴黎，可以在这里</strong>  <strong class="jx hv">考地铁</strong> <a class="ae ks" href="https://m.me/CaptainMetroBot" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv">队长。</strong></a></p></blockquote><p id="fcc2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">关于我</strong> : <em class="kr">我是一名初学程序员，曾任资深国际电视记者。</em> <strong class="jx hv"> <em class="kr">我正在寻找我作为开发人员的第一份正当工作</em> </strong> <em class="kr">。目前，我在俄罗斯很难找到工作，那里的工程师非常优秀，而且似乎没有人愿意雇佣初学者。如果你想为你的团队找一个有良好人类语言技能的积极的程序员，我很乐意加入，即使是远程的。</em> <strong class="jx hv"> <em class="kr">也可以邀请我实习。</em>T19】</strong></p><p id="3b2d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="kr">我最近以全班第一名的成绩从一个优秀的</em><a class="ae ks" href="https://www.lewagon.com/" rel="noopener ugc nofollow" target="_blank"><em class="kr">Le Wagon</em></a><em class="kr">巴黎编码训练营毕业，并在那里合著了</em> <a class="ae ks" href="http://halfway.ninja" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv"> <em class="kr">半路忍者</em> </strong> </a> <em class="kr">作为毕业设计。这是情侣机票的比较。</em> <strong class="jx hv"> <em class="kr">去看看吧！</em> </strong> <em class="kr">你可以在</em><a class="ae ks" href="https://github.com/progapandist" rel="noopener ugc nofollow" target="_blank"><em class="kr">Github</em></a><em class="kr"/><a class="ae ks" href="https://twitter.com/progapandist" rel="noopener ugc nofollow" target="_blank"><em class="kr">Twitter</em></a><em class="kr">和</em><a class="ae ks" href="https://www.instagram.com/progapanda/" rel="noopener ugc nofollow" target="_blank"><em class="kr">insta gram</em></a><em class="kr">上找到我。我会说英语、俄语、法语、Ruby、JavaScript、Python和Swift，目前在俄罗斯联邦莫斯科工作。有什么优惠可以直接写我</em><a class="ae ks" href="mailto:andybarnov@gmail.com" rel="noopener ugc nofollow" target="_blank"><em class="kr"/></a><em class="kr">。</em></p><p id="fdae" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="kr"> P.S .我也写</em> <a class="ae ks" href="https://45parallel.net/andrey_kirin/nachalo_vechnogo/" rel="noopener ugc nofollow" target="_blank"> <em class="kr">诗词</em> </a> <em class="kr">(俄语知识必修)。</em></p><div class="jk jl jm jn fq ab cb"><figure class="lc jo ld le lf lg lh paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lc jo ld le lf lg lh paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lc jo ld le lf lg lh paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ne nf ng"><p id="f922" class="jv jw kr jx b jy jz iv ka kb kc iy kd nh kf kg kh ni kj kk kl nj kn ko kp kq hn dt translated"><a class="ae ks" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客们如何开始他们的下午。我们是<a class="ae ks" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ks" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ks" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jv jw kr jx b jy jz iv ka kb kc iy kd nh kf kg kh ni kj kk kl nj kn ko kp kq hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ks" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ks" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff oa"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ob nd l"/></div></figure></div></div>    
</body>
</html>