<html>
<head>
<title>How to convert and prepare TopoJSON files for interactive mapping with d3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何转换和准备TopoJSON文件以使用d3进行交互式制图</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-convert-and-prepare-topojson-files-for-interactive-mapping-with-d3-499cf0ced5f?source=collection_archive---------8-----------------------#2017-03-20">https://medium.com/hackernoon/how-to-convert-and-prepare-topojson-files-for-interactive-mapping-with-d3-499cf0ced5f?source=collection_archive---------8-----------------------#2017-03-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="7a99" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">本教程将向您展示如何将公开可用的shapefiles转换为<a class="ae jj" href="https://github.com/topojson/topojson" rel="noopener ugc nofollow" target="_blank"> TopoJSON </a>来创建与<a class="ae jj" href="https://github.com/d3/d3" rel="noopener ugc nofollow" target="_blank"> d3 </a> / <a class="ae jj" href="https://github.com/d3/d3-geo" rel="noopener ugc nofollow" target="_blank"> d3-geo </a>的交互式地图。</h2></div><h2 id="3cd9" class="jk jl hu bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dt translated">注意:我已经把我的博客搬到了zcreativelabs.com/blog/。你可以在那里找到这篇文章的更新版本。以后的文章只会在那里发表。请订阅z creative labs时事通讯，以便在您的收件箱中收到我的最新文章。</h2><figure class="kj kk kl km fq kn fe ff paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="fe ff ki"><img src="../Images/f02d50cc8e0af7dc8de6d13c7aa5eb7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nc6zBGgExmTsHkWM-LjZlg.jpeg"/></div></div></figure><p id="f390" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt ln translated"><span class="l lo lp lq bm lr ls lt lu lv di">我</span>将向您展示如何在不使用<a class="ae jj" href="https://hackernoon.com/tagged/command" rel="noopener ugc nofollow" target="_blank">命令</a>的情况下做到这一点，这样您就可以尽快开始尝试d3。如果您对以更高级的方式使用shapefiles和TopoJSON感兴趣，我建议您看看Mike Bostock最近关于命令行制图的多部分教程。</p><h1 id="f5af" class="lw jl hu bd jm lx ly lz jq ma mb mc ju ja md jb jy jd me je kc jg mf jh kg mg dt translated">世界地图</h1><p id="0c96" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">你可能想得到的第一张地图是世界地图。这方面的一个很好的资源是<a class="ae jj" href="http://www.naturalearthdata.com/downloads" rel="noopener ugc nofollow" target="_blank"> Natural Earth </a>，这是一个1:10米、1:50米和1:1亿比例的公共领域地图数据集。对于每个比例(细节层次)，Natural Earth提供了文化、物理和光栅地图。</p><h2 id="70ff" class="jk jl hu bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dt translated">步骤1-获取地图</h2><p id="dc79" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">根据详细程度(1:10米、1:50米和1:100米)和类别(文化、自然和栅格)选择您喜欢的地图。当构建网络地图时，细节层次很重要，因为它会显著影响文件大小和渲染速度，尤其是用<a class="ae jj" href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics" rel="noopener ugc nofollow" target="_blank"> SVG </a>渲染地图时。</p><p id="7849" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">基于国家数据(<a class="ae jj" href="http://data.worldbank.org/data-catalog/GDP-ranking-table" rel="noopener ugc nofollow" target="_blank"> GDP </a>、<a class="ae jj" href="http://data.worldbank.org/indicator/SP.POP.TOTL" rel="noopener ugc nofollow" target="_blank">人口</a>等)创建世界地图。)你应该选择文化载体。在接下来的步骤中，我将基于<a class="ae jj" href="http://www.naturalearthdata.com/downloads/50m-cultural-vectors/" rel="noopener ugc nofollow" target="_blank"> 1:50m cultural vectors Admin 0国家地图</a>创建一个TopoJSON地图。</p><h2 id="e8b2" class="jk jl hu bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dt translated"><strong class="ak">第二步——选择使用什么</strong></h2><p id="7cea" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">下载的文件夹将包含许多具有不同扩展名的文件，例如。dbf，。prj，。要将shapefile转换为TopoJSON，您需要。shp文件和. dbf文件(如果有的话)。</p><h2 id="7b7b" class="jk jl hu bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dt translated">步骤3 — <strong class="ak">将形状文件导入mapshaper </strong></h2><p id="fd9b" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">要将shapefiles转换为TopoJSON，您可以使用<a class="ae jj" href="http://mapshaper.org/" rel="noopener ugc nofollow" target="_blank"> mapshaper </a>，这是一个用于形状简化和从一种geo格式转换为另一种格式的工具。它支持Shapefiles、GeoJSON和TopoJSON格式。虽然mapshaper可以在命令行上使用，但在线工具也为简化过程提供了一个很好的可视化界面。</p><p id="d365" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">导入以结尾的文件。shp和。dbf到mapshaper。确保选中了“检测线交点”选项。还可以选中“捕捉顶点”来修复拓扑错误。</p><figure class="kj kk kl km fq kn fe ff paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="fe ff mm"><img src="../Images/0cf1f7d80d7cce692b2887f1e5805473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjQpDDi0gG5uxvY1Uk9Nag.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">Once you import the .shp and .dbf files into mapshaper you should see a preview of the map.</figcaption></figure><h2 id="83bc" class="jk jl hu bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dt translated">步骤4 — <strong class="ak">可选步骤:简化您的地图</strong></h2><p id="685a" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">“简化”选项允许您通过拖动滑块来调整细节级别。简化得越多，最终地图的精确度和细节就越少。简化的地图会更小，通常简化地图(有时甚至50%)不会导致任何可见的细节损失。</p><h2 id="6f83" class="jk jl hu bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dt translated">步骤5 — <strong class="ak">导出您的TopoJSON地图</strong></h2><p id="bc7b" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">对地图的详细程度感到满意后，将地图导出为TopoJSON文件。你完了！</p><h1 id="29a1" class="lw jl hu bd jm lx ly lz jq ma mb mc ju ja md jb jy jd me je kc jg mf jh kg mg dt translated">国家级和较低行政级别地图</h1><p id="966b" class="pw-post-body-paragraph ku kv hu kw b kx mh iv kz la mi iy lc jv mj le lf jz mk lh li kd ml lk ll lm hn dt translated">世界地图是很棒的，但是有时你想要可视化一个特定地区、国家、甚至一个更具体的行政区域的更详细的视图。如果你在做非商业工作，一个很好的资源就是全球管理区域网站。</p><p id="7547" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">该网站提供多种格式的地图。从<a class="ae jj" href="http://gadm.org/country" rel="noopener ugc nofollow" target="_blank">这里</a>下载文件时，确保选择shapefile作为格式。</p><p id="395c" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">解压缩下载的文件后，您将拥有多组shape file(admin 0、admin1、admin2等)。这些代表了不同的<a class="ae jj" href="https://en.wikipedia.org/wiki/Administrative_division" rel="noopener ugc nofollow" target="_blank">行政区划</a>。以美国为例，admin0表示国家，admin1表示各个州，admin2表示县，等等。</p><p id="aef9" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">一旦你决定选择哪个关卡，你可以重复步骤2-5，就像处理世界地图一样。</p><p id="3cae" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">如果你对从哪里获得shapefiles的其他资源有任何建议，请在下面留言，我会尽量把它们写进文章里。</p><p id="c51b" class="pw-post-body-paragraph ku kv hu kw b kx ky iv kz la lb iy lc jv ld le lf jz lg lh li kd lj lk ll lm hn dt translated">感谢您的阅读，如果有任何问题或意见，请在下面回复。快乐映射！</p><div class="kj kk kl km fq ab cb"><figure class="mr kn ms mt mu mv mw paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mr kn ms mt mu mv mw paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mr kn ms mt mu mv mw paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mx my mz"><p id="f922" class="ku kv na kw b kx ky iv kz la lb iy lc nb ld le lf nc lg lh li nd lj lk ll lm hn dt translated"><a class="ae jj" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jj" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jj" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jj" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ku kv na kw b kx ky iv kz la lb iy lc nb ld le lf nc lg lh li nd lj lk ll lm hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jj" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jj" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kj kk kl km fq kn fe ff paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="fe ff ne"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kj kk kl km fq kn"><div class="bz el l di"><div class="nf ng l"/></div></figure></div></div>    
</body>
</html>