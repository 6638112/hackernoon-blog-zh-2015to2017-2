<html>
<head>
<title>How you can dramatically speed up your Django site with Django’s cached template loader</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Django的缓存模板加载器显著提高Django站点的速度</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/are-you-using-djangos-cached-template-loader-9e1145a7d610?source=collection_archive---------9-----------------------#2017-05-01">https://medium.com/hackernoon/are-you-using-djangos-cached-template-loader-9e1145a7d610?source=collection_archive---------9-----------------------#2017-05-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="f459" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在剖析一个Django 1.8站点时，注意到了一些奇怪的事情。</p><p id="ed61" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">函数<code class="eh jp jq jr js b">django.template.engine.get_template</code>被调用了50次，总共花费了229毫秒，几乎是页面加载时间的一半。</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="ef54" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该网站使用大量的<a class="ae ka" href="https://hackernoon.com/tagged/template" rel="noopener ugc nofollow" target="_blank">模板</a>标签来呈现页面上的不同元素，比如广告位置和相关的故事框。</p><p id="1af0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Django的模板系统会在每次渲染时读取并编译一个模板。这种情况发生得很快，但是当你在每个页面上呈现多个模板时，它会累加起来，就像我的情况一样。</p><p id="9811" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在四处寻找解决方案后，我发现了<code class="eh jp jq jr js b">django.template.loaders.cached.Loader</code>，当它被启用时，将编译好的模板存储在内存中，减少了检索模板的时间。</p><p id="f25b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦在网站上启用了缓存模板加载器，<code class="eh jp jq jr js b">django.template.engine.get_template</code>的累积时间就下降到了1毫秒，减少了大约200毫秒的页面加载时间</p><p id="ccbe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Django 1.2中引入了缓存模板加载器，但默认情况下并未启用，这很容易被忽略。</p><p id="f2fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在启用缓存模板加载器之前，您需要确保所有自定义的<a class="ae ka" href="https://docs.djangoproject.com/en/1.11/howto/custom-template-tags/#template-tag-thread-safety" rel="noopener ugc nofollow" target="_blank">模板标签都是线程安全的</a>。</p><p id="147f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从<a class="ae ka" href="https://hackernoon.com/tagged/django" rel="noopener ugc nofollow" target="_blank">开始，当<code class="eh jp jq jr js b">DEBUG</code>设置为假时，Django </a> 1.11缓存模板加载器默认启用。</p><p id="e8ed" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你还在使用老版本的Django，并且使用大量的模板标签，启用缓存模板加载器，它可以极大地提高你的站点速度。</p><blockquote class="kb kc kd"><p id="806f" class="ir is ke it b iu iv iw ix iy iz ja jb kf jd je jf kg jh ji jj kh jl jm jn jo hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是AMI家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is ke it b iu iv iw ix iy iz ja jb kf jd je jf kg jh ji jj kh jl jm jn jo hn dt translated">要了解更多信息，<a class="ae ka" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">请阅读我们的“关于”页面</a> , <a class="ae ka" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">喜欢/在脸书给我们发消息</a>，或者简单地，<a class="ae ka" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank">发推文/DM @HackerNoon。</a></p><p id="708a" class="ir is ke it b iu iv iw ix iy iz ja jb kf jd je jf kg jh ji jj kh jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="ki jz l"/></div></figure></div></div>    
</body>
</html>