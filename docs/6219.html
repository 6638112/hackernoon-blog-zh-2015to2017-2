<html>
<head>
<title>Painless React Forms with Formik</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Formik进行无痛反应</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/painless-react-forms-with-formik-e61b70473c60?source=collection_archive---------0-----------------------#2017-09-08">https://medium.com/hackernoon/painless-react-forms-with-formik-e61b70473c60?source=collection_archive---------0-----------------------#2017-09-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/48e192b7d1503c23824792dbedb7ae24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1ae_X1VwJm74dGWpgt85A.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">formik logo</figcaption></figure><p id="b33e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我从一开始就和<a class="ae ke" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"> React </a>在一起，我一直讨厌的一件事是，编写表单和相应的验证是多么无聊，有时甚至是困难的工作。它需要做太多的工作来获得回报，并且需要做更多的工作来集中和重用代码。</p><p id="03c3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">嗯，不再是了！😃 ✨✨✨</p><p id="3794" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我最近发现<a class="ae ke" href="https://github.com/jaredpalmer/formik" rel="noopener ugc nofollow" target="_blank">福米克</a>，疼痛消失了！</p><p id="48d0" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://hackernoon.com/tagged/formik" rel="noopener ugc nofollow" target="_blank"> Formik </a>帮助解决React中处理表单的主要问题:</p><ol class=""><li id="8284" class="kf kg hu ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><strong class="ji hv">将道具转化为形态状态</strong></li><li id="2974" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv">验证和错误信息</strong></li><li id="823e" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv">处理表单提交</strong></li></ol><p id="501d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">对于验证，Formik使用了<a class="ae ke" href="https://github.com/jquense/yup" rel="noopener ugc nofollow" target="_blank">是的</a>，这是一个惊人的对象模式验证/解析库。</p><p id="8980" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我带你浏览一下这个神奇产品的速成教程。</p><h1 id="e2b1" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">构建表单</h1><p id="6633" class="pw-post-body-paragraph jg jh hu ji b jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd hn dt translated">首先安装软件包，包括Formik和Yup</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="b82f" class="mf ku hu mb b fv mg mh l mi mj">yarn add formik yup</span></pre><p id="e94e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们开始构建我们的表单。它将由一个虚构的用户填写他的电子邮件，用户名和一些虚构的东西了许多选择。相当标准的形式，你会看到它是多么容易。</p><p id="910d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">完整的最终示例<a class="ae ke" href="https://codesandbox.io/s/zl8zr8yqx" rel="noopener ugc nofollow" target="_blank">此处</a>或以下！😄</p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mk ml l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">working example</figcaption></figure><p id="0938" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们的主文件<strong class="ji hv"> index.js </strong>:</p><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mm"><img src="../Images/7504c5524d407b910d4b1769292f61cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qli3KoXnxpPIZ3wAJWDC4Q.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">index.js</figcaption></figure><p id="744e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">当然，这只是一个用于演示目的的根文件的基本示例，但是我想指出的是<strong class="ji hv">imaginar user</strong>变量可以来自你喜欢的任何地方。无论是API、从文件中读取还是其他。我们只需要它的缺省值(或现有值)来将它们映射到Formik中。</p><p id="6173" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">所以我们看到我们有一个用户，他的电子邮件是空白的，用户名也是空白的，imaginaryThingId的<strong class="ji hv">和</strong>都是空的。再来看看我们的<strong class="ji hv"> UserForm.js </strong>。</p><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mn"><img src="../Images/e1048748a5198db53778d599d404447d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_3qwJyf-UutZRDQ6ll69A.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">UserForm.js dependencies and variables</figcaption></figure><p id="a3f1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们首先必须得到我们的Formik和Yup依赖项。</p><p id="fc44" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我使用<a class="ae ke" href="https://github.com/bvaughn/react-virtualized-select" rel="noopener ugc nofollow" target="_blank">react-virtualized-select</a>来选择具有记忆功能的框，以最大限度地提高许多项目的性能。我们还必须包括默认外观的选择框样式。</p><p id="93dc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv"> imaginaryThings </strong>只是选择框的一个选项数组，它们是为了演示的目的而声明的。您可以获取它们，并按照您喜欢的方式传递它们。它们已经为选择框进行了正确的格式化。</p><p id="dbff" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们想要这样的东西:</p><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mo"><img src="../Images/c62dcfdc7b2ff1cadf4d69a8ab3b1a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N4nHC4BIzp-pJ3mZGGFowg.png"/></div></div></figure><p id="6a05" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">正如我们所看到的，这是再简单不过的了。必需的电子邮件、必需的用户名和可选字段。让我们看看如何把这些都插上。</p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mp ml l"/></div></figure><p id="2dd5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">通过浏览表单代码，你可能已经意识到Formik是一个特设(<a class="ae ke" href="https://facebook.github.io/react/docs/higher-order-components.html" rel="noopener ugc nofollow" target="_blank">高阶组件</a>)。它给你的表单组件注入了一些便利的道具，你可以用它们做任何你想做的事情！</p><p id="024e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在我的例子中，我已经定制了<strong class="ji hv"> mapPropsToValues </strong>、<strong class="ji hv"> validationSchema </strong>和<strong class="ji hv"> handleSubmit </strong>。</p><p id="316b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv"> mapPropsToValues: </strong>你可以用它来简化和“展平”一些嵌套的对象，以使事情更容易理解和操作。</p><p id="8061" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv"> validationSchema: </strong>这是您定义表单验证的地方。使用Yup，您可以创建简单和复杂的验证结构。我将在这篇文章的后面给出两个复杂的例子。</p><p id="c397" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv"> handleSubmit: </strong>这是表单的提交处理程序。只有当表单有效并且您可以在其中做任何事情时，它才会触发。你想做一个翻转，唱一首歌，去吃寿司，然后发送数据到服务器？！</p><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/88ade8ef92fb17c8a101520437916d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*AooVdt0snD9TqctD_I-Hew.gif"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">JUST DO IT</figcaption></figure><p id="e2e3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果你摆弄过我的例子，你可能知道要点。<strong class="ji hv">值</strong>属性保存所有表单值，<strong class="ji hv">错误</strong>(咄！)、<strong class="ji hv">触摸</strong>和<strong class="ji hv">脏</strong>分别保存输入失去焦点和用户与输入交互的值。</p><p id="b57c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我使用的函数是<strong class="ji hv"> handleChange </strong>,它处理值和输入名称(如果没有名称和id的话),为您变魔术。如果你在变魔术之前需要一些额外的工作，你可以使用<strong class="ji hv"> setFieldValue </strong>，我用它来设置<strong class="ji hv"> imaginaryThingId </strong>的值。<strong class="ji hv"> handleBlur </strong>处理输入的模糊事件并运行验证。最后<strong class="ji hv">处理提交</strong>，我们直接插入表单的<strong class="ji hv"> onSubmit </strong>事件。</p><p id="9b9f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">正如你所看到的，这非常简单。你什么都不用做，Formik是一只野兽，它会为你做所有的事情，同时给你提供超越的工具。</p></div><div class="ab cl mr ms hc mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hn ho hp hq hr"><h1 id="ef69" class="kt ku hu bd kv kw my ky kz la mz lc ld le na lg lh li nb lk ll lm nc lo lp lq dt translated">让我们来谈谈验证👌 ✅ ❎</h1><p id="7b1c" class="pw-post-body-paragraph jg jh hu ji b jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd hn dt translated">给Yup的文档是<strong class="ji hv">惊人的</strong>。你可能会在那里找到你想要的任何东西。但是，因为我是一个好人，所以我将抛出一些复杂形式的验证的例子。</p><p id="3de7" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这里有一些为演示目的而简化的例子。</p><h2 id="0c49" class="mf ku hu bd kv nd ne nf kz ng nh ni ld jr nj nk lh jv nl nm ll jz nn no lp np dt translated">如果我想验证用户名的长度，只有当电子邮件是foobar@example.com？</h2><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/88ade8ef92fb17c8a101520437916d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*AooVdt0snD9TqctD_I-Hew.gif"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">JUST DO IT</figcaption></figure><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mp ml l"/></div></figure><p id="be52" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们可以看到，当电子邮件是<strong class="ji hv">example@foobar.com</strong>时，我们将<strong class="ji hv"> min </strong>规则添加到模式中。如果没有，我们只是原封不动地返回模式！</p><h2 id="924a" class="mf ku hu bd kv nd ne nf kz ng nh ni ld jr nj nk lh jv nl nm ll jz nn no lp np dt translated">如果我想根据情况更改错误消息的标签，该怎么办？</h2><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/88ade8ef92fb17c8a101520437916d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*AooVdt0snD9TqctD_I-Hew.gif"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">JUST DO IT</figcaption></figure><p id="8295" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">很简单！Yup有<strong class="ji hv">。为此标记</strong>。让我们看看如何！</p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mp ml l"/></div></figure><p id="fdfb" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如您所见，当条件为真时，标签会切换到<strong class="ji hv"> papidipupi </strong>的错误消息中。我们可以通过将<strong class="ji hv"> ${path} </strong>添加到我们想要的任何消息中来动态地做到这一点。例如:所需的错误消息。</p><h2 id="a6ca" class="mf ku hu bd kv nd ne nf kz ng nh ni ld jr nj nk lh jv nl nm ll jz nn no lp np dt translated">如果我想运行自己的自定义验证函数，该怎么办？</h2><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/88ade8ef92fb17c8a101520437916d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*AooVdt0snD9TqctD_I-Hew.gif"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">JUST DO IT</figcaption></figure><p id="1c85" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">为此，我们将使用<strong class="ji hv">测试</strong>函数，该函数允许您为特定字段定义新的测试。</p><p id="eb7a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们看看是否可以具体测试用户名是(没有合理的理由)<strong class="ji hv">之字形！</strong></p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mp ml l"/></div></figure><p id="8c85" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">正如我们所看到的，我们刚刚添加了一个简单直接的检查！</p><p id="0c90" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们可以继续下去，但我想我已经提供了足够的基础知识来引导你使用Formik和Yep！这两个项目都有大量的文档，所以你必须去看看。</p></div><div class="ab cl mr ms hc mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hn ho hp hq hr"><h1 id="acc5" class="kt ku hu bd kv kw my ky kz la mz lc ld le na lg lh li nb lk ll lm nc lo lp lq dt translated">链接和参考💻</h1><p id="ae93" class="pw-post-body-paragraph jg jh hu ji b jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd hn dt translated"><a class="ae ke" href="https://github.com/jaredpalmer/formik" rel="noopener ugc nofollow" target="_blank"> Formik Github </a></p><p id="8c77" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://codesandbox.io/s/zKrK5YLDZ" rel="noopener ugc nofollow" target="_blank"> Formik基本演示</a></p><p id="e134" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://codesandbox.io/s/zl8zr8yqx" rel="noopener ugc nofollow" target="_blank">这个故事演示</a></p><p id="7821" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://github.com/jquense/yup" rel="noopener ugc nofollow" target="_blank">是Github </a></p><p id="33ed" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://runkit.com/jquense/yup" rel="noopener ugc nofollow" target="_blank">是沙盒</a></p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mk ml l"/></div></figure></div></div>    
</body>
</html>