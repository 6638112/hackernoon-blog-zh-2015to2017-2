<html>
<head>
<title>Redux Action Creator Creators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux动作创建器创建者</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/redux-action-creator-creators-6684b051d4c6?source=collection_archive---------15-----------------------#2017-11-06">https://medium.com/hackernoon/redux-action-creator-creators-6684b051d4c6?source=collection_archive---------15-----------------------#2017-11-06</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="6fbb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">更新:一位读者要求我将此作为npm包发布。完成了完成了。<a class="ae jq" href="https://www.npmjs.com/package/redux-ize" rel="noopener ugc nofollow" target="_blank"><em class="jp"/></a></em><em class="jp">。尽情享受吧！</em></p><p id="b1d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在redux应用中，我们有动作，我们有动作创建者，但是在<a class="ae jq" href="https://meeshkan.com" rel="noopener ugc nofollow" target="_blank"> Meeshkan </a>，我们使用Redux动作创建者。听起来像过度杀戮吗？也许吧。但是让我展示我们如何使用它，然后你来判断！</p><p id="7847" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，假设我们有一个动作创建器，它创建一个动作，并且由于<code class="eh jr js jt ju b">react-redux</code>，当我们调用它时，通过我们的中间件自动分派它。中间件可以添加各种好东西(时间戳、设备信息……)，记录事件，运行异步任务等等。让我们放大我们的动作创建者:</p><pre class="jv jw jx jy fq jz ju ka kb aw kc dt"><span id="6b8b" class="kd ke hu ju b fv kf kg l kh ki">export default clapForPost(nClaps) =&gt; ({<br/>    type: "CLAP_FOR_POST",<br/>    payload: nClaps<br/>});</span></pre><p id="64c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们放大一下我们的分析中间件:</p><pre class="jv jw jx jy fq jz ju ka kb aw kc dt"><span id="246d" class="kd ke hu ju b fv kf kg l kh ki">import analytics from 'my-analytics-tool'</span><span id="9551" class="kd ke hu ju b fv kj kg l kh ki">export default store =&gt; next =&gt; action =&gt; {<br/>  if (action.meta &amp;&amp; action.meta.analyticsData) {<br/>    analytics(action.type, action.meta.analyticsData)<br/>  }<br/>  next(action);<br/>}</span></pre><p id="689f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">嗯…在我们的分析数据中，我们真的很想报告掌声来自哪个页面。所以我们回到我们的<code class="eh jr js jt ju b">action.js</code>文件，写一个新的函数:</p><pre class="jv jw jx jy fq jz ju ka kb aw kc dt"><span id="4902" class="kd ke hu ju b fv kf kg l kh ki">export default clapForPostWithAnalytics(nClaps, analytics) =&gt; ({<br/>   type: "CLAP_FOR_POST",<br/>   payload: nClaps,<br/>   meta: { analytics },<br/>});</span></pre><p id="c315" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你闻到代码的味道了吗？如果我们还想引入基于我们在应用程序中所处位置的导航数据呢？如果我们有五个可能的东西要补充，你好2⁵不同的功能。</p><p id="4967" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我们能给一个动作添加一点分析数据，给另一个动作添加一点导航数据，那就太好了…让我们开始吧！</p><pre class="jv jw jx jy fq jz ju ka kb aw kc dt"><span id="0e0d" class="kd ke hu ju b fv kf kg l kh ki">const ize = n =&gt; r =&gt; (...argsOuter) =&gt; f =&gt; (...argsInner) =&gt; {<br/>  const primo = f(...argsInner.slice(n));<br/>  return {<br/>    ...primo,<br/>    meta: {<br/>      ...(primo.meta ? primo.meta : {}),<br/>      ...r(...argsInner.slice(0, n), ...argsOuter),<br/>    },<br/>  }<br/>}</span><span id="33e3" class="kd ke hu ju b fv kj kg l kh ki">export const analyticsIze = ize(0)(a =&gt; ({<br/>  analytics: a || {},<br/>}));</span><span id="b403" class="kd ke hu ju b fv kj kg l kh ki">export const promiseIze = ize(2)((resolve, reject) =&gt; ({<br/>  form: {<br/>    resolve,<br/>    reject,<br/>  }<br/>}));</span><span id="de3a" class="kd ke hu ju b fv kj kg l kh ki">export default (...args) =&gt; args.reduce((a,b) =&gt; b(a));</span></pre><p id="0cf3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后在我们的文件与行动创作者…</p><pre class="jv jw jx jy fq jz ju ka kb aw kc dt"><span id="508f" class="kd ke hu ju b fv kf kg l kh ki">import Ize, { promiseIze, analyticsIze } from './ize';<br/>import { clapForPost } from './actions/self-aggrandizing';</span><span id="3421" class="kd ke hu ju b fv kj kg l kh ki">class MyComponent {<br/>  render() {<br/>    const { clapForPost } = this.props;<br/>    const clapper = () =&gt;<br/>      new Promise((res, rej) =&gt; clapForPost(res, rej, 3));<br/>    return (&lt;button onClick={clapper}&gt;Hello world&lt;/button&gt;);<br/>  }<br/>}</span><span id="50ae" class="kd ke hu ju b fv kj kg l kh ki">connect(null,<br/>{<br/>  clapForPost: Ize(<br/>    clapForPost,<br/>    promiseIze(),<br/>    analytics({placeInApp: 'MyComponent'})<br/>  ),<br/>})(MyComponent);</span></pre><p id="be1d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将要发送的操作是:</p><pre class="jv jw jx jy fq jz ju ka kb aw kc dt"><span id="2f7f" class="kd ke hu ju b fv kf kg l kh ki">{<br/>  type: "CLAP_FOR_POST",<br/>  nClaps: 3,<br/>  meta: {<br/>    analytics: {<br/>      placeInApp: 'MyComponent',<br/>    },<br/>    form: {<br/>     resolve: [Function resolve],<br/>     reject: [Function reject],<br/>    },<br/>  },<br/>}</span></pre><p id="88ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">瞧，我们的行动创造者创造者！有趣的是，这一策略是从我们对<code class="eh jr js jt ju b">redux-form</code>世界中一个<a class="ae jq" href="https://github.com/redux-saga/redux-saga/issues/161#issuecomment-191312502" rel="noopener ugc nofollow" target="_blank">常用黑客</a>的改编中发展而来的。动作创作者创作者是这种策略的一种概括。</p><p id="2936" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<a class="ae jq" href="https://meeshkan.com" rel="noopener ugc nofollow" target="_blank"> Meeshkan </a>中，经验法则变成了:</p><ol class=""><li id="d168" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated">当一个动作包含不可能链接到UI的信息时，使用中间件。</li><li id="24de" class="kk kl hu it b iu kt iy ku jc kv jg kw jk kx jo kp kq kr ks dt translated">当一个操作只包含与该操作明显相关的信息时(例如，用于登录的电子邮件)，请使用操作创建者。</li><li id="2d9e" class="kk kl hu it b iu kt iy ku jc kv jg kw jk kx jo kp kq kr ks dt translated">当你需要分发UI相关的信息或者随机的顶级hacks，而不把它们放在动作的有效载荷中时，<em class="jp"> action creator creator模式</em>是你的朋友。</li></ol><p id="75f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">黑客快乐！</p><figure class="jv jw jx jy fq kz fe ff paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="fe ff ky"><img src="../Images/8aacf94a89f3457ee70d05f5e2a49b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZrv-rhFIvidhqeVh0cvvA.png"/></div></div></figure></div></div>    
</body>
</html>