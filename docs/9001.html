<html>
<head>
<title>Code Splitting with Parcel Web App Bundler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用宗地Web应用程序Bundler进行代码分割</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/code-splitting-with-parcel-web-app-bundler-fe06cc3a20da?source=collection_archive---------7-----------------------#2017-12-22">https://medium.com/hackernoon/code-splitting-with-parcel-web-app-bundler-fe06cc3a20da?source=collection_archive---------7-----------------------#2017-12-22</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/58e3e4b51c755f6aa475d66845633345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/1*3Tp8OGHuIlun20JS84i7DA.gif"/></div></figure><p id="b1a5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">代码拆分！！这是当今web开发中的一个时髦词。今天，我们将探索代码分割，看看我们如何用parcel超级轻松地做到这一点。</p><h2 id="73bc" class="jw jx hu bd jy jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq dt translated">什么是代码拆分？</h2><p id="66e6" class="pw-post-body-paragraph iy iz hu ja b jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr kv jt ju jv hn dt translated">如果你已经很熟悉了…你可以跳过这一部分，其他的，跟着…</p><p id="30df" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你已经用任何一个JavaScript 框架做了前端web <a class="ae kw" href="https://hackernoon.com/tagged/development" rel="noopener ugc nofollow" target="_blank">开发</a>，你肯定已经把你所有的模块打包成一个大的JavaScript文件包，你可以把它附加到你的网页上，做一些令人惊奇的事情。但是，嘿，那些包裹相当大！你已经写了一个很棒(也很复杂)的web应用程序，有这么多部分…它们应该会产生很大的包；而且东西越大，在网速慢的网络上下载需要的时间就越长。问自己一个问题，用户是否一次需要全部的内容？</p><p id="81a5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">想象一下它是一个电商单页app。用户登录查看产品列表，他可能只是来查看产品，但他已经花费了大量的时间和数据，不仅下载JavaScript来呈现产品列表，还下载JavaScript来呈现关于过滤器、产品详细信息、报价等内容。</p><p id="fcfa" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这样做我们对用户不公平！！如果我们可以只在用户需要的时候给他们他们需要的东西，这不是很棒吗？。</p><p id="aa0d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">所以，这种将你的大束分割成多个小束的想法叫做代码分割。这些较小的包是按需异步加载的。这听起来确实很难做到，但像Webpack这样的现代捆扎机使它变得非常容易，而parcel将这种容易提升到了另一个层次。</p><figure class="kz la lb lc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff ky"><img src="../Images/cc6690dd0d6e9784679aee4c2092c127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKxqnQQJjn03TXiBM4TYfw.png"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">The parent is divided into these cute babies. Courtesy <a class="ll lm gr" href="https://medium.com/u/9af1d327b35?source=post_page-----fe06cc3a20da--------------------------------" rel="noopener" target="_blank">Shreya</a> [<a class="ae kw" href="https://www.instagram.com/shreyadoodles/" rel="noopener ugc nofollow" target="_blank">Instagram</a>]</figcaption></figure><h2 id="c009" class="jw jx hu bd jy jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq dt translated">这个新包裹是什么？？</h2><p id="1f6b" class="pw-post-body-paragraph iy iz hu ja b jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr kv jt ju jv hn dt translated"><a class="ae kw" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank">包裹</a>是</p><blockquote class="ln"><p id="f2fe" class="lo lp hu bd lq lr ls lt lu lv lw jv ek translated">极快的零配置web应用捆绑器</p></blockquote><p id="cac7" class="pw-post-body-paragraph iy iz hu ja b jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr mb jt ju jv hn dt translated">这使得模块捆绑变得非常容易！！如果你没听说过，我推荐<a class="ae kw" href="https://medium.freecodecamp.org/all-you-need-to-know-about-parcel-dbe151b70082" rel="noopener ugc nofollow" target="_blank">这篇文章</a>作者<a class="ll lm gr" href="https://medium.com/u/ce572601b7e?source=post_page-----fe06cc3a20da--------------------------------" rel="noopener" target="_blank"> Indrek Lasn </a>。</p><h2 id="ecd2" class="jw jx hu bd jy jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq dt translated">我们走吧！</h2><p id="814c" class="pw-post-body-paragraph iy iz hu ja b jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr kv jt ju jv hn dt translated">对于编码部分…我不会在这里使用任何框架(你通常会)，但框架或没有框架，过程将保持不变。这个例子有非常非常简单的代码来演示这个过程。</p><p id="2ee1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">创建一个新的空目录，并通过</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="9b10" class="jw jx hu mf b fv mk ml l mm mn">npm init</span></pre><p id="14d5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">或者，</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="78fe" class="jw jx hu mf b fv mk ml l mm mn">yarn init</span></pre><p id="817c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">从你最喜欢的开始(在我的例子中是纱线😉)并创建如下所示的文件。</p><figure class="kz la lb lc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff mo"><img src="../Images/9b0fd00b269f542b414093cf68e5e08f.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*oZy87TFDpGZYXf05uunBxA.png"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">World’s simplest file structure</figcaption></figure><p id="d765" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这个想法是，我们将只在我们的<code class="eh mc md me mf b">index.html</code>中包含<code class="eh mc md me mf b">index.js</code>的内容，在一个事件中(在这个例子中是一个按钮点击),我们将加载<code class="eh mc md me mf b">someModule.js</code>,并用它呈现一些内容。</p><p id="f10e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">打开<code class="eh mc md me mf b">index.html</code>，添加以下代码。</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="0160" class="jw jx hu mf b fv mk ml l mm mn">&lt;!DOCTYPE html&gt;</span><span id="3588" class="jw jx hu mf b fv mp ml l mm mn">&lt;html lang="en"&gt;</span><span id="3350" class="jw jx hu mf b fv mp ml l mm mn">  &lt;head&gt;</span><span id="c712" class="jw jx hu mf b fv mp ml l mm mn">    &lt;meta charset="UTF-8"&gt;</span><span id="d11e" class="jw jx hu mf b fv mp ml l mm mn">    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;</span><span id="188b" class="jw jx hu mf b fv mp ml l mm mn">    &lt;title&gt;Code Splitting like Humans&lt;/title&gt;</span><span id="9d89" class="jw jx hu mf b fv mp ml l mm mn">  &lt;/head&gt;</span><span id="9495" class="jw jx hu mf b fv mp ml l mm mn">  &lt;body&gt;</span><span id="b456" class="jw jx hu mf b fv mp ml l mm mn">    &lt;button id="bt"&gt;Click&lt;/button&gt;</span><span id="3442" class="jw jx hu mf b fv mp ml l mm mn">    &lt;div class="holder"&gt;&lt;/div&gt;</span><span id="5885" class="jw jx hu mf b fv mp ml l mm mn">    &lt;script src="./index.js"&gt;&lt;/script&gt;</span><span id="4474" class="jw jx hu mf b fv mp ml l mm mn">  &lt;/body&gt;</span><span id="4daa" class="jw jx hu mf b fv mp ml l mm mn">&lt;/html&gt;</span></pre><p id="2c47" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">没什么特别的，只是基本的HTML模板，有一个按钮和一个<code class="eh mc md me mf b">div</code>，我们将呈现来自<code class="eh mc md me mf b">someModule.js</code>的内容</p><p id="8c47" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">因此，让我们为模块<code class="eh mc md me mf b">someModule</code>编写代码</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="45d0" class="jw jx hu mf b fv mk ml l mm mn">console.log("someModule.js loaded");</span><span id="d73e" class="jw jx hu mf b fv mp ml l mm mn">module.exports = {</span><span id="fa18" class="jw jx hu mf b fv mp ml l mm mn">  render : function(element){</span><span id="ed8b" class="jw jx hu mf b fv mp ml l mm mn">      element.innerHTML = "You clicked a button";<br/>  }</span><span id="95d2" class="jw jx hu mf b fv mp ml l mm mn">}</span></pre><p id="f26f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们正在导出一个对象，它有一个函数<code class="eh mc md me mf b">render</code>，该函数接收一个元素并将其内部HTML设置为“你点击了一个按钮”。</p><p id="1c89" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，奇迹出现了。在我们的<code class="eh mc md me mf b">index.js</code>文件中，我们必须处理按钮点击事件并动态加载<code class="eh mc md me mf b">someModule</code></p><p id="5362" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">对于动态异步加载，我们将使用<code class="eh mc md me mf b">import()</code>函数语法。该函数按需异步加载模块。</p><p id="ce53" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">看用法，</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="dc84" class="jw jx hu mf b fv mk ml l mm mn">import('./path/to/module').then(function(page){</span><span id="cb08" class="jw jx hu mf b fv mp ml l mm mn">//Do Something<br/>});</span></pre><p id="5141" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">由于<code class="eh mc md me mf b">import</code>是异步的，它返回一个承诺，我们用<code class="eh mc md me mf b">then</code>来处理。在<code class="eh mc md me mf b">then</code>中，我们传递一个接受从模块加载的对象的函数。类似于<code class="eh mc md me mf b">const page = require('./path/to/module');</code>，只是动态异步完成。</p><p id="61ed" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在我们的例子中，</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="a46d" class="jw jx hu mf b fv mk ml l mm mn">import('./someModule').then(function (page) {</span><span id="e5f6" class="jw jx hu mf b fv mp ml l mm mn">   page.render(document.querySelector(".holder"));</span><span id="4ada" class="jw jx hu mf b fv mp ml l mm mn">});</span></pre><p id="4d71" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们加载<code class="eh mc md me mf b">someModule</code>并调用它的渲染函数。</p><p id="a943" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">让我们将它添加到按钮的点击事件监听器中。</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="07bd" class="jw jx hu mf b fv mk ml l mm mn">console.log("index.js loaded");</span><span id="b28e" class="jw jx hu mf b fv mp ml l mm mn">window.onload = function(){<br/>       document.querySelector("#bt").addEventListener('click',function(evt){<br/>     console.log("Button Clicked");</span><span id="8a69" class="jw jx hu mf b fv mp ml l mm mn">     import('./someModule').then(function (page) {</span><span id="6fed" class="jw jx hu mf b fv mp ml l mm mn">         page.render(document.querySelector(".holder"));</span><span id="269f" class="jw jx hu mf b fv mp ml l mm mn">     });</span><span id="8fdb" class="jw jx hu mf b fv mp ml l mm mn">});</span><span id="d1d3" class="jw jx hu mf b fv mp ml l mm mn">}</span></pre><p id="1be7" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在代码都写好了，让我们运行包。包将自动处理所有的配置工作！</p><pre class="kz la lb lc fq mg mf mh mi aw mj dt"><span id="b567" class="jw jx hu mf b fv mk ml l mm mn">parcel index.html</span></pre><p id="919b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它会生成以下文件。</p><figure class="kz la lb lc fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/263c74bc058eeaf87788caf98b14a33f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*NEtHUZA1zchHSsWuOqB6mQ.png"/></div></figure><p id="1f5d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在您的浏览器中运行并观察。</p><figure class="kz la lb lc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff mr"><img src="../Images/886cc842516cf2ec8a7daf226bb5090e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RIhun_YTgvmtvHgeqKWNkw.png"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Console output</figcaption></figure><figure class="kz la lb lc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff ms"><img src="../Images/5ed8a85756065f9593b5a5efee972fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kS4YO7jH-6sA49LuWs-lsA.png"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Network tab</figcaption></figure><p id="864e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">注意在控制台输出中，<code class="eh mc md me mf b">someModule</code>只有在按钮点击后才被加载。在网络选项卡中，查看<code class="eh mc md me mf b">import</code>函数调用后<code class="eh mc md me mf b">codesplit-parcel.js</code>如何加载模块。</p><p id="4f80" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">代码分割是一件很棒的事情，如果它可以这么容易地完成，我们没有理由不去做。💞💞</p><p id="5de9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><a class="ae kw" href="https://www.youtube.com/channel/UCgY3bHW4qHKq9aC4i3nO-0g" rel="noopener ugc nofollow" target="_blank"> <strong class="ja hv"> <em class="kx">点击查看我的Youtube频道！！</em>🤓🤓<em class="kx">我需要你的爱</em> </strong> </a></p><p id="318c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> <em class="kx">请打些掌声👏如果你喜欢这些内容，你的支持会让我坚持下去。❤❤ </em> </strong></p><figure class="kz la lb lc fq iv"><div class="bz el l di"><div class="mt mu l"/></div></figure></div></div>    
</body>
</html>