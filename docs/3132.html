<html>
<head>
<title>Improve Your UX by Dynamically Rendering Images via React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过React动态渲染图像来提高UX</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/improve-your-ux-by-dynamically-rendering-images-via-react-onload-393fd4d0d946?source=collection_archive---------4-----------------------#2017-03-15">https://medium.com/hackernoon/improve-your-ux-by-dynamically-rendering-images-via-react-onload-393fd4d0d946?source=collection_archive---------4-----------------------#2017-03-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="2649" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在外面是一个竞争激烈的世界。众所周知，仅仅有一个好主意不足以让一家公司成为下一个10亿美元的IPO。执行力同样重要，而对于产品来说，这可以归结为一个因素——用户体验。</p><p id="d50e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用户体验不仅仅是我们产品的美学外观。还有它的性能如何，它有多直观——它有多让我们的用户<em class="jp">高兴</em>。</p><p id="5c69" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们都有过这样的经历，第一次发现一个新的应用程序或网页，看到这样的东西:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/782299b7b7fee2c18cc7a7c245211fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*7aPSypInSHdfEUpqW045Ig.gif"/></div></figure><p id="c500" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有了高分辨率的照片和视网膜屏幕，我们常常不得不坐下来，看着图像煞费苦心地渲染。看到一个图像从上到下慢慢渲染是很常见的景象。</p><p id="76c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">这个问题可以解决。</strong></p><p id="a4ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">前两个明显的优化是使用CDN和利用缓存(你的浏览器自动这样做)使图像加载更快。然而，我们也可以<em class="jp">欺骗</em>我们的用户对加载时间的感知，从而导致用户体验的整体积极提升。</p><p id="4adb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里有两个技巧，我们可以用来提高我们在富媒体应用上的UX:</p><h2 id="fa92" class="jy jz hu bd ka kb kc kd ke kf kg kh ki jc kj kk kl jg km kn ko jk kp kq kr ks dt translated">1.使用占位符:</h2><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff kt"><img src="../Images/3f55b6eb3a00b5ce24583d807198d6de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*AKFmR0duCBOedXFJ2b447Q.gif"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">use a placeholder to indicate media is loading</figcaption></figure><p id="795e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">占位符是经典装载旋转器的现代变形。我们没有使用通用的微调器来指示应用程序正在加载，而是使用一个占位符来告诉用户正在加载什么类型的内容——图像。</p><p id="8d08" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">脸书和LinkedIn 都是使用这种方法提高UX的很好的例子。</p><h2 id="2918" class="jy jz hu bd ka kb kc kd ke kf kg kh ki jc kj kk kl jg km kn ko jk kp kq kr ks dt translated">2.向DOM动态添加图像:</h2><p id="57f3" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">第二个优化是在屏幕上显示之前完全下载我们的图像。这将避免我们习惯于在下载图像时看到的经典的自上而下的渲染。我们通过使用React的<code class="eh li lj lk ll b"><a class="ae lc" href="https://facebook.github.io/react/docs/events.html#image-events" rel="noopener ugc nofollow" target="_blank">onLoad</a></code>事件来实现这一点；我们可以向服务器请求图像文件，但是在下载完整个文件之前，不能在DOM中呈现图像。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff kt"><img src="../Images/b3bfd6a25940b7a46255a961062200ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Sk0LSbdprkMSizngsUpWNA.gif"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">the end result: smooth as butter</figcaption></figure><p id="cfc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最终的结果是一个应用程序可以加载高分辨率的图像，并且永远不会让用户等待。占位符<em class="jp">戏弄</em>用户，让他们知道图像正在被加载。此外，我们推迟渲染图像，直到它们从服务器上完全下载，这样我们的用户就不必在浏览器中看到从上到下绘制的图像。</p><p id="1a03" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae lc" href="http://nomadwong.com" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv"> <em class="jp">查看现场演示</em> </strong> </a></p><h1 id="ff5a" class="lm jz hu bd ka ln lo lp ke lq lr ls ki lt lu lv kl lw lx ly ko lz ma mb kr mc dt translated">给我看看代码！</h1><h2 id="0530" class="jy jz hu bd ka kb kc kd ke kf kg kh ki jc kj kk kl jg km kn ko jk kp kq kr ks dt translated">呈现占位符</h2><p id="dc9d" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">对于占位符组件(本例中为<code class="eh li lj lk ll b">LoadingItem</code>)，我们只需渲染图像并应用我们想要的任何动画效果:</p><pre class="jr js jt ju fq md ll me mf aw mg dt"><span id="843e" class="jy jz hu ll b fv mh mi l mj mk">export default function () {<br/>  return (<br/>    &lt;ReactCSSTransitionGroup<br/>      transitionName="loadingItem"<br/>      transitionAppear={true}<br/>      transitionAppearTimeout={500}<br/>      transitionEnterTimeout={500}<br/>      transitionLeaveTimeout={300}&gt;<br/>      &lt;img className="feed__loading-item" src={img} /&gt;<br/>    &lt;/ReactCSSTransitionGroup&gt;<br/>  )<br/>}</span></pre><p id="0b8e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们的Feed组件的渲染中，只要还在加载<code class="eh li lj lk ll b">FeedItems</code>，我们就简单地渲染<code class="eh li lj lk ll b">LoadingItem</code>:</p><pre class="jr js jt ju fq md ll me mf aw mg dt"><span id="802a" class="jy jz hu ll b fv mh mi l mj mk">export default class Feed extends Component {</span><span id="6fee" class="jy jz hu ll b fv ml mi l mj mk">  ...</span><span id="2be3" class="jy jz hu ll b fv ml mi l mj mk">  render() {<br/>    return (<br/>      &lt;div className="feed"&gt;</span><span id="1b5c" class="jy jz hu ll b fv ml mi l mj mk">        ...</span><span id="9f8c" class="jy jz hu ll b fv ml mi l mj mk">        {this.props.items.length &gt; this.state.loadedItems.length &amp;&amp;<br/>          &lt;LoadingItem /&gt;<br/>        }</span><span id="e47b" class="jy jz hu ll b fv ml mi l mj mk">        ...</span><span id="e47d" class="jy jz hu ll b fv ml mi l mj mk">      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span></pre><h2 id="5f2d" class="jy jz hu bd ka kb kc kd ke kf kg kh ki jc kj kk kl jg km kn ko jk kp kq kr ks dt translated">通过“加载”动态渲染图像</h2><p id="f216" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">我们的<code class="eh li lj lk ll b">Feed</code>组件工作如下:</p><pre class="jr js jt ju fq md ll me mf aw mg dt"><span id="8252" class="jy jz hu ll b fv mh mi l mj mk">export default class Feed extends Component {<br/>  constructor(props) {<br/>    super(props)<br/>    this.state = { loadedItems: [] }<br/>  }</span><span id="2f3c" class="jy jz hu ll b fv ml mi l mj mk">  onLoad(feedItem) {<br/>    this.setState(({ loadedItems }) =&gt; {<br/>      return { loadedItems: loadedItems.concat(feedItem) }<br/>    })<br/>  }</span><span id="9435" class="jy jz hu ll b fv ml mi l mj mk">  render() {<br/>    return (<br/>      &lt;div className="feed"&gt;<br/>        &lt;h1 className="feed__h1"&gt;{this.props.name}&lt;/h1&gt;<br/>        {this.state.loadedItems.map((item, i) =&gt;<br/>          &lt;FeedItem<br/>            imgPath={item.imgPath}<br/>            name={item.name}<br/>            renderModal={this.props.renderModal}<br/>            key={i} /&gt;<br/>        )}<br/>        {this.props.items.length &gt; this.state.loadedItems.length &amp;&amp;<br/>          &lt;LoadingItem /&gt;<br/>        }<br/>        &lt;div className="hidden"&gt;<br/>          {this.props.items.map((item, i) =&gt;<br/>            &lt;img <br/>              src={item.imgPath} <br/>              onLoad={this.onLoad.bind(this, item)} <br/>              key={i} /&gt;<br/>          )}<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span></pre><p id="5406" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里发生了什么？我们在底部有一个隐藏的<code class="eh li lj lk ll b">&lt;div&gt;</code>，负责下载图像文件。当文件下载完成后，会触发<code class="eh li lj lk ll b">onLoad</code>事件，更新状态中新加载的项目。当状态更新时，新加载的项目被呈现到DOM中，图像已经完全下载。</p><h1 id="8a2a" class="lm jz hu bd ka ln lo lp ke lq lr ls ki lt lu lv kl lw lx ly ko lz ma mb kr mc dt translated">就是这样！</h1><ul class=""><li id="f1ac" class="mm mn hu it b iu ld iy le jc mo jg mp jk mq jo mr ms mt mu dt translated"><a class="ae lc" href="http://nomadwong.com" rel="noopener ugc nofollow" target="_blank">观看现场演示</a></li><li id="7346" class="mm mn hu it b iu mv iy mw jc mx jg my jk mz jo mr ms mt mu dt translated"><a class="ae lc" href="http://github.com/arwong09/portfolio" rel="noopener ugc nofollow" target="_blank">查看完整的源代码</a>(如果您觉得这有帮助，请开始回购！)</li></ul><div class="jr js jt ju fq ab cb"><figure class="na jv nb nc nd ne nf paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="na jv nb nc nd ne nf paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="na jv nb nc nd ne nf paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ng nh ni"><p id="f922" class="ir is jp it b iu iv iw ix iy iz ja jb nj jd je jf nk jh ji jj nl jl jm jn jo hn dt translated"><a class="ae lc" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae lc" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae lc" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb nj jd je jf nk jh ji jj nl jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae lc" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae lc" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff nm"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>