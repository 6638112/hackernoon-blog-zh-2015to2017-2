<html>
<head>
<title>Building a security alarm using raspberry pi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用raspberry pi构建安全警报</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-a-security-alarm-using-raspberry-pi-725a18f42e84?source=collection_archive---------6-----------------------#2017-06-04">https://medium.com/hackernoon/building-a-security-alarm-using-raspberry-pi-725a18f42e84?source=collection_archive---------6-----------------------#2017-06-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/></div><div class="ab cl ir is hc it" role="separator"><span class="iu bw bk iv iw ix"/><span class="iu bw bk iv iw ix"/><span class="iu bw bk iv iw"/></div><div class="hn ho hp hq hr"><p id="1e1d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">物联网是当今的一个流行词，如果你是那些渴望开始使用它但无法这样做的人之一，这是一个尝试，以帮助你了解建立物联网系统所涉及的不同部分。我有机会在工作场所参与一个基于物联网的项目，希望在这里分享我的经验。</p><p id="af50" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">使用的资源:</p><ol class=""><li id="991b" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">树莓Pi型号B</li><li id="a58c" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">Grovepi初学者工具包</li><li id="1a2e" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">IP摄像机</li><li id="4ac0" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated"><a class="ae kk" href="https://hackernoon.com/tagged/azure" rel="noopener ugc nofollow" target="_blank">蔚蓝色</a>服务总线</li><li id="bedf" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">Azure移动服务</li><li id="78bb" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">Azure Blob存储</li><li id="eb2c" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">本机Windows Mobile应用程序</li></ol><p id="7123" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> (I) </strong>为了开始，我们用raspbian操作系统启动了我们的pi设备，这是一个针对raspberry pi硬件优化的debian(<a class="ae kk" href="http://www.raspberrypi.org/documentation/installation/installing-images/windows.md" rel="noopener ugc nofollow" target="_blank">安装</a>)。</p><p id="98ca" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">每个pi设备都有一排通用输入输出(GPIO)引脚，作为pi与外界的接口。我们可以将传感器连接到这些引脚，并根据我们的要求对它们进行编程。在raspberry的型号A和B中，gpio引脚如下所示:</p><figure class="km kn ko kp fq kq fe ff paragraph-image"><div class="fe ff kl"><img src="../Images/77c8076b9ce59a5b60c687d8e8414ebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/0*jChql6URdEQyFwnk."/></div></figure><figure class="km kn ko kp fq kq fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/99e7300a22e355f14db3a81244bdf074.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/0*R_fcGeEDuAwYopTC."/></div></figure><p id="2349" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">将传感器连接到raspberry有两种选择:</p><ol class=""><li id="0bab" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">使用试验板、电阻器、电线形成所需的电路。</li><li id="f56f" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">使用连接器为您完成上述工作。</li></ol><p id="fed7" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们选择了第二个选项，使用了一个名为grove pi的设备(现在升级到grovepi +)，这是一个专门为raspberry pi设计的模块板<a class="ae kk" href="https://hackernoon.com/tagged/designed" rel="noopener ugc nofollow" target="_blank">。这样，您只需将电路板插在pi上，然后将所需的传感器与电路板连接。在树莓装置上安装grove pi的步骤可以在</a><a class="ae kk" href="http://www.seeedstudio.com/depot/GrovePi-Starter-Kit-for-Raspberry-Pipreorder-p-2240.html" rel="noopener ugc nofollow" target="_blank">上看到，此处为</a>。一旦完成，我们就可以开始实验传感器了。</p><p id="66e8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> (II) </strong> <strong class="ja hv">用例</strong>:设置一个安全监视器来检测盗窃报警，并向用户发送带有事件图片的通知</p><p id="b671" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">下面是我们用例的任务分解:</p><ol class=""><li id="53c8" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">将声音传感器连接到pi设备。</li><li id="b4ed" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">设置azure云服务。</li><li id="b081" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">脚本使用声音传感器从周围读取声音输入，并在声音水平超过特定阈值时向队列发送消息(这将是防盗报警器工作的频率值)</li><li id="1e9e" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">为发送的盗窃信息写一个消费者。</li><li id="5055" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">显示通知与盗窃照片的应用程序，将由最终用户使用。</li></ol><h2 id="3c80" class="ku kv hu bd kw kx ky kz la lb lc ld le jj lf lg lh jn li lj lk jr ll lm ln lo dt translated"><strong class="ak">步骤1:将声音传感器连接到raspberry pi </strong></h2><p id="195a" class="pw-post-body-paragraph iy iz hu ja b jb lp jd je jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv hn dt translated">(i) Grove Pi有单独的插槽用于连接模拟和数字传感器。模拟传感器端口标记为A1-An，数字端口标记为D1-Dm。由于声音传感器是模拟传感器，我们将其连接到模拟端口之一。</p><p id="8100" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">(ii)为了在raspberry pi上编码，我们将键盘、鼠标连接到它的USB端口上。HDMI端口也连接到LCD监视器，LAN电缆连接到LAN端口。完成后，我们的设置如下所示:</p><figure class="km kn ko kp fq kq fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/a4f53db340a81ebb4c81e3878ff52bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7o416owVHtQPXYFZ."/></div></div></figure><figure class="km kn ko kp fq kq fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/c4873dad9703f0ad28bb5722f883c2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dYg7L3DKTu2qxZR2."/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Raspberry pi + grove pi + sensors setup</figcaption></figure><h2 id="8cb8" class="ku kv hu bd kw kx ky kz la lb lc ld le jj lf lg lh jn li lj lk jr ll lm ln lo dt translated"><strong class="ak">第二步:设置Azure云服务</strong></h2><p id="a209" class="pw-post-body-paragraph iy iz hu ja b jb lp jd je jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv hn dt translated">我们需要在azure上设置以下云服务:</p><ol class=""><li id="8fba" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">Azure Blob存储:Blob可以是任何类型的文本或二进制数据，如文档、媒体文件或应用程序安装程序。</li><li id="0962" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">Azure服务总线队列:服务总线队列支持代理消息模型。当使用服务总线队列时，分布式应用的组件不直接交互，而是通过充当中介的队列交换消息(<a class="ae kk" href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-java-how-to-use-queues" rel="noopener ugc nofollow" target="_blank">参考</a></li></ol><figure class="km kn ko kp fq kq fe ff paragraph-image"><div class="fe ff md"><img src="../Images/ac03482219aff8626bd05bc4042b9433.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/0*_DvHxRAAsXOAL2bX."/></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Azure Service bus queue architecture</figcaption></figure><p id="911f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">3.Azure移动服务(现在的移动应用服务) :这是一个移动后端服务，提供云存储，认证和推送通知服务。它基于RESTful编程接口来执行CRUD操作(使用HTTP get/put/post/delete方法)。我们将移动服务用于云存储，并在我们的移动应用程序中提供推送通知服务。</p><figure class="km kn ko kp fq kq fe ff paragraph-image"><div class="fe ff me"><img src="../Images/8b3eab83bf07ccb939f218c84ac4a164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/0*FSRTHMdN4RqczC7c."/></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Our IOT system architecture</figcaption></figure><h2 id="d294" class="ku kv hu bd kw kx ky kz la lb lc ld le jj lf lg lh jn li lj lk jr ll lm ln lo dt translated"><strong class="ak">第三步:声音传感器脚本</strong></h2><p id="fd52" class="pw-post-body-paragraph iy iz hu ja b jb lp jd je jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv hn dt translated">该步骤进一步分为以下子步骤:</p><ol class=""><li id="c902" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">从外部环境读取声级的代码。</li><li id="99aa" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">每当声级超过声音阈值(防盗报警器工作的频率)时，我们需要:</li></ol><blockquote class="mf mg mh"><p id="f461" class="iy iz mi ja b jb jc jd je jf jg jh ji mj jk jl jm mk jo jp jq ml js jt ju jv hn dt translated">(I)在我们的位置连接到IP摄像机，并将当前帧图像保存在raspberry上。</p><p id="3df3" class="iy iz mi ja b jb jc jd je jf jg jh ji mj jk jl jm mk jo jp jq ml js jt ju jv hn dt translated">(ii)将保存的图像上传到azure blob存储器。</p><p id="085f" class="iy iz mi ja b jb jc jd je jf jg jh ji mj jk jl jm mk jo jp jq ml js jt ju jv hn dt translated">(iii)在azure服务总线队列上发送带有图像名称和时间戳的消息。</p></blockquote><h2 id="6f6f" class="ku kv hu bd kw kx ky kz la lb lc ld le jj lf lg lh jn li lj lk jr ll lm ln lo dt translated"><strong class="ak">步骤4:为服务总线队列创建消费者</strong></h2><p id="5497" class="pw-post-body-paragraph iy iz hu ja b jb lp jd je jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv hn dt translated">为此，我们决定使用azure mobile服务，因为它为我们提供了一个scheduler功能，我们可以在某个时间间隔后安排任务连续运行。在我们的案例中，我们希望消费者做两件事:</p><ol class=""><li id="7cd7" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">从队列中发送的消息中读取图像名称。</li><li id="1ac8" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">将图像名称和时间戳存储在表存储器中。</li></ol><h2 id="3c3e" class="ku kv hu bd kw kx ky kz la lb lc ld le jj lf lg lh jn li lj lk jr ll lm ln lo dt translated"><strong class="ak">第五步:创建移动应用</strong></h2><p id="3cd5" class="pw-post-body-paragraph iy iz hu ja b jb lp jd je jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv hn dt translated">我们需要一个移动应用来做以下事情:</p><ol class=""><li id="7902" class="jw jx hu ja b jb jc jf jg jj jy jn jz jr ka jv kb kc kd ke dt translated">每当防盗警报响起时显示即时通知</li><li id="eb3f" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">点击通知时显示盗窃图片。</li><li id="9c9f" class="jw jx hu ja b jb kf jf kg jj kh jn ki jr kj jv kb kc kd ke dt translated">显示盗窃照片的过去历史。</li></ol><p id="831e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们的移动应用程序与azure移动服务连接，以使用它的推送通知功能，并从云存储中获取盗窃图片的名称。对应于表存储中的每个盗窃pic名称，有一张图片存储在azure上的blob存储中，应用程序最终从那里获取图像并将其显示给用户。</p><p id="c54b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">完成后，我们就可以用raspberry pi和基本传感器套件连接设置安全系统所需的不同部件。我们大约在一年前做了这项工作，现在大多数云服务，如azure和amazon，都提供物联网框架，内部将上述服务打包在一起。</p><p id="96f4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">感谢您花时间阅读这篇文章，我希望它能帮助您理解设置物联网系统所涉及的不同组件。</p><figure class="km kn ko kp fq kq"><div class="bz el l di"><div class="mm mn l"/></div></figure></div></div>    
</body>
</html>