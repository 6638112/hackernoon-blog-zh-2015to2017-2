<html>
<head>
<title>Adaptive modern product documentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">适应性现代产品文档</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/adaptive-modern-product-documentation-7d792fd8696d?source=collection_archive---------8-----------------------#2017-04-27">https://medium.com/hackernoon/adaptive-modern-product-documentation-7d792fd8696d?source=collection_archive---------8-----------------------#2017-04-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="e74c" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated"><a class="ae jj" href="http://www.sphinx-doc.org/en/stable/" rel="noopener ugc nofollow" target="_blank"> Sphinx </a>和<a class="ae jj" href="https://facebook.github.io/react/" rel="noopener ugc nofollow" target="_blank"> React </a>加入团队，推出丰富的文档解决方案</h2></div><p id="ce0e" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">Sphinx是一个众所周知的非常强大的文档引擎，在Python社区中广泛使用。Sphinx通常用于从一组用reStructuredTEXT编写的源文件中生成一组静态HTML页面。</p><p id="1191" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">对于那些不熟悉它的人来说，reStructuredTEXT与Markdown相似，但是它增加了嵌套的概念。Sphinx将这些嵌套对象称为指令，每个指令都可以接受一些选项和子内容。在我们的文档中，我们有很多使用定制指令来驱动独特的UI和逻辑组件的例子。每个这样的指令都可以接受一些定制的配置，用于管理它的呈现。例如，下面是我们的HMAC动态价值的来源。</p><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="kl km l"/></div></figure><p id="8b34" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">使用了4种不同的自定义指令:</p><ul class=""><li id="5250" class="kn ko hu jm b jn jo jq jr jt kp jx kq kb kr kf ks kt ku kv dt translated"><code class="eh kw kx ky kz b">dv</code>(动态值)这需要2个子组件来继承我们的自定义<code class="eh kw kx ky kz b">tab</code>指令。</li><li id="f258" class="kn ko hu jm b jn la jq lb jt lc jx ld kb le kf ks kt ku kv dt translated"><code class="eh kw kx ky kz b">dvvis</code>是管理可视选项卡的指令(见左下方)，这需要一个数字。</li><li id="fcc3" class="kn ko hu jm b jn la jq lb jt lc jx ld kb le kf ks kt ku kv dt translated"><code class="eh kw kx ky kz b">dvspec</code>是一个更复杂的选项卡组件，呈现在右下方。</li></ul><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="fe ff lf"><img src="../Images/542cf9da4b64ff0157c9062f4ed87725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gTmUcf78rO2rZnPQz0zLMQ.png"/></div></div></figure><p id="132f" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">这个系统的强大之处在于，每个指令的描述可以依次包含自定义指令，父指令不需要知道，除非它需要修改或解析它。这里的<code class="eh kw kx ky kz b">figure</code>指令描述包含一个链接项，图形渲染方法可能不需要考虑这一点，它只是将描述视为指令的一个子元素，这将被正常渲染，这让我们可以根据需要在这里添加任何自定义内容。</p><p id="61ca" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">上面我们已经看了一些自定义指令，但是我们如何设置这些Sphinx扩展呢？</p><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="kl km l"/></div></figure><p id="c271" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">如果还需要渲染Sphinx默认提供的经典HTML版本，还需要添加一些函数来支持<code class="eh kw kx ky kz b">TabFrameNode</code>的渲染。对于我们的React解决方案，我们创建了一个组件，它映射到这个<code class="eh kw kx ky kz b">TabFrameNode</code>类，并在React应用程序在AST中遇到这个节点时被呈现。</p><p id="eb48" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">为了允许我们在React中呈现这些文档，我们需要传递Sphinx在将其呈现到HTML页面之前使用的AST。这是在<a class="ae jj" href="https://gist.github.com/hishnash/933ce146289faf88dd633c249eb5f228" rel="noopener ugc nofollow" target="_blank">定制构建脚本</a>中完成的。该脚本为每个文件生成AST的JSON转储，这些文件被上传到亚马逊S3桶，然后通过AWS AWS CloudFront(一种CDN服务)提供给客户端。当用户浏览文档时，单页面应用程序会在需要时从CloudFront获取所需的JSON ASTs。</p><p id="76e9" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">在React中渲染AST是一个非常简单的过程<a class="ae jj" href="https://cdn-docs.paw.cloud/v3-32-g40c79c0/dynamic-values/encoding_crypto.json" rel="noopener ugc nofollow" target="_blank">当保存AST </a>到JSON时，对应的Python <code class="eh kw kx ky kz b">class</code>和<code class="eh kw kx ky kz b">module</code>被保存到树中每个<code class="eh kw kx ky kz b">Node</code>的JSON对象中。在React应用程序中，建立了一个映射，将<code class="eh kw kx ky kz b">module.class</code>映射到一个组件。</p><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="kl km l"/></div><figcaption class="lm ln fg fe ff lo lp bd b be z ek">A Code Block example from the AST, note the attributes on the literal_block object these are parsed to the LiteralBlock component.</figcaption></figure><p id="4d4f" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">每个组件呈现它需要的东西，然后通常呈现出子组件。在我们的例子中，我们让每个组件从基类<code class="eh kw kx ky kz b">Node</code> <a class="ae jj" href="https://gist.github.com/hishnash/fb676e226ff0f28fcc9e8b9ea7708515" rel="noopener ugc nofollow" target="_blank">组件</a>继承。</p><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="kl km l"/></div><figcaption class="lm ln fg fe ff lo lp bd b be z ek">The bulletList component just adds a &lt;ul&gt; around its children.</figcaption></figure><p id="9a80" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">由于页面的内容是作为这个AST的一个功能直接管理的，所以我们可以很容易地从docs页面添加和删除内容，而不需要部署或接触我们的前端代码库。因此，我们可以通过添加一个<code class="eh kw kx ky kz b">?version={versionid}</code>作为页面的URL参数来查看不同版本的文档，甚至在开发模式下，我们可以添加<code class="eh kw kx ky kz b">?debug=True</code>来强制页面从本地服务器加载内容。作为一个例子，这里有一个我已经部署的文档的定制版本，只是为了说明这篇博客文章。请在以下位置查看此示例:</p><blockquote class="lq"><p id="c987" class="lr ls hu bd lt lu lv lw lx ly lz kf ek translated"><a class="ae jj" href="https://paw.cloud/docs/demo/blog?version=v3-46-g15005e7" rel="noopener ugc nofollow" target="_blank">https://paw.cloud/docs/demo/blog?version=v3-46-g15005e7</a>。</p></blockquote><p id="94f7" class="pw-post-body-paragraph jk jl hu jm b jn ma iv jp jq mb iy js jt mc jv jw jx md jz ka kb me kd ke kf hn dt translated">这个页面的源代码可以在<a class="ae jj" href="https://gist.github.com/hishnash/43fedeb24db39e0f9ae9f3b777427cd3" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl mf mg hc mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hn ho hp hq hr"><p id="ca02" class="pw-post-body-paragraph jk jl hu jm b jn jo iv jp jq jr iy js jt ju jv jw jx jy jz ka kb kc kd ke kf hn dt translated">我希望你对这篇文章感兴趣，在接下来的一年里，我将离开Paw团队，专注于为macOS开发其他专业级开发人员工具。</p><div class="kg kh ki kj fq ab cb"><figure class="mm kk mn mo mp mq mr paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mm kk mn mo mp mq mr paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mm kk mn mo mp mq mr paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ms mt mu"><p id="f922" class="jk jl mv jm b jn jo iv jp jq jr iy js mw ju jv jw mx jy jz ka my kc kd ke kf hn dt translated"><a class="ae jj" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jj" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jj" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jj" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jk jl mv jm b jn jo iv jp jq jr iy js mw ju jv jw mx jy jz ka my kc kd ke kf hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jj" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jj" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="fe ff mz"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="na km l"/></div></figure></div></div>    
</body>
</html>