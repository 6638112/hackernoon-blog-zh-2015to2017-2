<html>
<head>
<title>How to make a chat bot that talks to your Rails database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何制作一个与你的Rails数据库对话的聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-make-a-bot-that-talks-to-your-rails-database-af400a98d07d?source=collection_archive---------6-----------------------#2017-04-16">https://medium.com/hackernoon/how-to-make-a-bot-that-talks-to-your-rails-database-af400a98d07d?source=collection_archive---------6-----------------------#2017-04-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="0004" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今天是复活节星期五，我在ProductHunt上遇到了这个很酷的初创公司，它将简单的英语转换成SQL查询。所以类似于<em class="jq">“向用户显示墨尔本</em><strong class="it hv">”</strong>的东西，它会处理并输出类似</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="0fda" class="ka kb hu jw b fv kc kd l ke kf"><em class="jq">SELECT * FROM users WHERE city = ‘Melbourne’;</em></span></pre><p id="31a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我认为这是最棒的，我必须找到所有这些是如何工作的。我的组织中的非技术人员真的可以使用这样的东西。想象一下进入松弛状态</p><blockquote class="kg kh ki"><p id="80bf" class="ir is jq it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">本周有多少用户注册了？</p></blockquote><p id="db35" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者</p><blockquote class="kg kh ki"><p id="0738" class="ir is jq it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated"><strong class="it hv"> /db_bot </strong>查找5个最新用户</p></blockquote><p id="79fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以我的目标变成了如何制作一个能与我的Rails数据库对话的机器人。</p><ol class=""><li id="06d6" class="km kn hu it b iu iv iy iz jc ko jg kp jk kq jo kr ks kt ku dt translated">我需要做的第一件事是研究自然语言处理。你基本上可以将机器学习应用于一个短语并提取含义。这是目前所有的热潮，所以我想肯定有一个很好的免费图书馆。在权衡了几个选项之后，Wit.ai似乎是我所需要的完美人选。</li><li id="67ae" class="km kn hu it b iu kv iy kw jc kx jg ky jk kz jo kr ks kt ku dt translated">Wit.ai是一个界面，在这里你可以用你希望你的机器人理解的语句和短语来训练你的机器人。实际上开始非常容易。看看下面我所做的，但本质上我在我的短语含义中指定了相关的词，意思是稍后将作为属性返回。看看他们的文件<a class="ae jp" href="https://wit.ai/docs" rel="noopener ugc nofollow" target="_blank">https://wit.ai/docs</a>了解更多。</li></ol><figure class="jr js jt ju fq lb fe ff paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="fe ff la"><img src="../Images/3cbce2fbcc40c0cfaba4493fa88823de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eVXlZa75iUCOtALwVf8KRQ.png"/></div></div></figure><p id="80a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">3.现在我已经训练好了我的初始短语，让我们跳进一些红宝石。Wit.ai有宝石棒！安装<a class="ae jp" href="https://github.com/wit-ai/wit-ruby" rel="noopener ugc nofollow" target="_blank">红宝石</a>并直接跳进去。真的很好用。发送一条消息，并获得您在上一步中设置的所有实体的散列。使用所有这些数据足以让我们构建数据库查询。</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="c1cb" class="ka kb hu jw b fv kc kd l ke kf">&gt; Wit.message('Find users where name is Allison')<br/>=&gt; {<br/>  "verb" =&gt; [<br/>    {<br/>      "confidence" =&gt; 0.9961181593747102,<br/>            "type" =&gt; "value",<br/>           "value" =&gt; "return"<br/>    }<br/>  ],<br/>  "table" =&gt; [<br/>    {<br/>      "confidence" =&gt; 0.9972328497408993,<br/>            "type" =&gt; "value",<br/>           "value" =&gt; "users"<br/>    }<br/>  ],<br/>  "target_attribute" =&gt; [<br/>    {<br/>      "confidence" =&gt; 0.9919267848022522,<br/>            "type" =&gt; "value",<br/>           "value" =&gt; "name"<br/>    }<br/>  ],<br/>  "search_query" =&gt; [<br/>    {<br/>      "confidence" =&gt; 0.9543589657183698,<br/>            "type" =&gt; "value",<br/>           "value" =&gt; "allison",<br/>       "suggested" =&gt; true<br/>    }<br/>  ]<br/>}</span></pre><p id="f2f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">4.剩下的就相当简单了。您将实体分配给变量，应用一点小魔法，viola就有了您的第一个查询。</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="190c" class="ka kb hu jw b fv kc kd l ke kf"><a class="ae jp" href="http://twitter.com/class" rel="noopener ugc nofollow" target="_blank">@class</a> = <a class="ae jp" href="http://twitter.com/table" rel="noopener ugc nofollow" target="_blank">@table</a>.singularize.camelize.constantize<br/>@class.where(@target_attribute.to_sym =&gt; @search_query)</span></pre><p id="4f38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是我之前准备的一个例子。你可以在<a class="ae jp" href="https://github.com/dawilster/db_bot" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到源代码</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="884a" class="ka kb hu jw b fv kc kd l ke kf">&gt; bot = DbBot.message('How many users signed up this week?')<br/>&gt; bot.response<br/>=&gt; "5 users"<br/>&gt; bot = DbBot.message('Find the last 10 users') <br/>&gt; bot.response<br/>=&gt; "There you go"<br/>&gt; bot.collection<br/>=&gt; #&lt;ActiveRecord::Relation [#&lt;User id: 1...</span></pre><p id="6bef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">还有很多东西需要进入<a class="ae jp" href="https://github.com/dawilster/db_bot" rel="noopener ugc nofollow" target="_blank"> db_bot </a>中，但它是我最终想要驱动Slack bot的基础，我们的团队可以用它从我们的数据库中提取数据。</p><div class="jr js jt ju fq ab cb"><figure class="li lb lj lk ll lm ln paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="li lb lj lk ll lm ln paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="li lb lj lk ll lm ln paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="kg kh ki"><p id="f922" class="ir is jq it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jq it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq lb fe ff paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="fe ff lo"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jr js jt ju fq lb"><div class="bz el l di"><div class="lp lq l"/></div></figure></div></div>    
</body>
</html>