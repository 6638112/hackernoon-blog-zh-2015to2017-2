<html>
<head>
<title>Polyfill with PowerShell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PowerShell的Polyfill</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/polyfill-with-powershell-ad70c6cd7703?source=collection_archive---------10-----------------------#2017-08-27">https://medium.com/hackernoon/polyfill-with-powershell-ad70c6cd7703?source=collection_archive---------10-----------------------#2017-08-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="b3ab" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated"><strong class="ak">修补旧版本PowerShell上缺失的部分</strong></h2></div><p id="a21e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当编写脚本时，针对多个运行时版本可能真的很痛苦，脚本可能被分支到不同的文件中，或者包含复杂的条件语句来处理PowerShell运行时/模块版本之间的差异/缺失，从而导致不可读和不可维护的意大利面条代码。</p><p id="9b98" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您改为检测缺失的命令并在需要时为其提供实现，会怎么样呢？这将允许您让您的脚本看起来相同，并且基本上不知道它在哪个运行时上运行，从而使代码更加简洁和易于维护。</p><p id="3a8c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这种技术称为多填充，是web开发中的常见做法，不同的浏览器版本和供应商会有所不同。</p><p id="fcf9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">事实证明，在PowerShell中做到这一点相当简单，我将使用PowerShell 5中引入的<code class="eh kf kg kh ki b"><a class="ae kj" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive?view=powershell-5.0" rel="noopener ugc nofollow" target="_blank">Expand-Archive</a></code>命令来演示这一点，该命令从指定的归档文件中提取文件</p><figure class="kk kl km kn fq ko"><div class="bz el l di"><div class="kp kq l"/></div></figure><p id="fb43" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">很明显，它在PowerShell的早期版本上会失败得很惨</p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff kr"><img src="../Images/777dd6606511916df4c27432077d8f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*G3ISFH2XB1ZG49aGBGUN5w.png"/></div></figure><p id="2dc1" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因为PowerShell拥有。NET中，我们可以利用自。NET 4.5 ( <em class="ku">)对于更老版本的PowerShell，我们也可以直接使用7zip或类似的命令行工具，或者利用第三方。NET汇编，因为我们可以在我们的polyfill中做任何可能的PowerShell </em>。<br/>这样的聚合填充可能如下所示:</p><figure class="kk kl km kn fq ko"><div class="bz el l di"><div class="kp kq l"/></div></figure><p id="6df7" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">上面的脚本检查命令是否存在，如果不存在，它将执行一个代码块，这个代码块将创建一个全局可用的函数，带有我们期望的参数和功能。为了在我们的脚本中使用它，我们将它点源到我们的脚本或外壳<br/> <code class="eh kf kg kh ki b">. .\Expand-Archive.Polyfill.ps1</code></p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff kv"><img src="../Images/5f44dc70a3897dd49c08c2aa3f0b0b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*6AXz15YwhI2CVaFKjPeDlQ.png"/></div></figure><p id="f103" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以像在新版本的PowerShell中一样使用它。</p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff kw"><img src="../Images/a6ac5d8da725628931d0c6f3abb745f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*pUWsUv1lyaAvbu_tn1vosg.png"/></div></figure><h1 id="6435" class="kx ky hu bd kz la lb lc ld le lf lg lh ja li jb lj jd lk je ll jg lm jh ln lo dt translated">结论</h1><p id="83dc" class="pw-post-body-paragraph jj jk hu jl b jm lp iv jo jp lq iy jr js lr ju jv jw ls jy jz ka lt kc kd ke hn dt translated">Polyfilling是一种非常简洁的方式，它具有更加同质和可维护的脚本，同时还允许您采用新的命令和特性，即使您有一两台旧服务器<em class="ku">；)</em></p></div></div>    
</body>
</html>