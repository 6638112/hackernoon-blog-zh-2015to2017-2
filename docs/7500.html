<html>
<head>
<title>Why Our Tech Startup Chose Google Cloud Platform (GCP) over AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我们的科技创业公司选择谷歌云平台(GCP)而不是AWS</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/why-our-tech-startup-chose-google-cloud-platform-gcp-over-aws-dc7c8080fb89?source=collection_archive---------9-----------------------#2017-10-30">https://medium.com/hackernoon/why-our-tech-startup-chose-google-cloud-platform-gcp-over-aws-dc7c8080fb89?source=collection_archive---------9-----------------------#2017-10-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/51313442cff91414afccab49a428e146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pnNfhF6jNpVQvfzQi5IRA.jpeg"/></div></div></figure><blockquote class="jc jd je"><p id="eb5c" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">披露:<a class="ae ke" href="https://goo.gl/7ZKSvU" rel="noopener ugc nofollow" target="_blank"> mabl </a> <strong class="ji hv">，</strong>ML驱动的测试自动化服务，之前赞助过黑客Noon。</p></blockquote><p id="8848" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">由于产品开发于2017年初在<a class="ae ke" href="https://goo.gl/7ZKSvU" rel="noopener ugc nofollow" target="_blank"> mabl </a>开始，我们必须决定使用哪家云提供商。虽然我们最熟悉亚马逊网络服务(AWS ),但我们决定花些时间探索所有可用的选项。基于最初的一组需求，我们能够将候选人名单缩小到AWS和谷歌云平台(GCP)。我们花了几周时间研究这两者，并构建原型来熟悉我们以前没有使用过的功能。在对两家供应商进行了全面客观的评估后，我们一致决定在GCP的基础上继续发展。在这篇博文中，我将描述做出这个决定的一些因素。</p><p id="e2b5" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">本博客详细比较了特定的GCP和AWS产品，包括无服务器计算、数据库、分析引擎以及机器学习服务。</p><h1 id="b8d2" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">一点点观点</h1><p id="e41a" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">作为一家新的软件公司，我们在熟悉问题领域和开发产品概念时面临许多问题:</p><ol class=""><li id="40f3" class="ll lm hu ji b jj jk jn jo kf ln kg lo kh lp kd lq lr ls lt dt translated">高层架构应该是什么样子？</li><li id="a82b" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd lq lr ls lt dt translated">我们应该使用什么语言、过程和开发工具？</li><li id="e765" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd lq lr ls lt dt translated">我们的软件将在哪里运行？</li></ol><p id="adcc" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">前两个话题是改天的博文。在这三个问题中，第三个问题可能是过去十年中变化最快的。我上一次参加这个演习是在2008年。客观地说，2008年是AWS EC2正式上市的同一年。那时AWS还不是今天这样的70+服务巨头，<em class="jh">云</em>还没有进入普通词汇，在基于云的基础设施上运行你的软件绝不是显而易见的选择。当时的主要选择是:</p><ol class=""><li id="3a16" class="ll lm hu ji b jj jk jn jo kf ln kg lo kh lp kd lq lr ls lt dt translated">建立自己的数据中心(或从搭配设施中租赁空间)，并购买自己的硬件</li><li id="ef5b" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd lq lr ls lt dt translated">每月或每年租赁裸机服务器</li><li id="12c7" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd lq lr ls lt dt translated">租用虚拟专用服务器</li><li id="7609" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd lq lr ls lt dt translated">在AWS EC2上运行虚拟机</li></ol><p id="d199" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">在仅仅10年的时间里，我们已经看到云平台的角色从一个有趣的利基服务转变为一大部分软件公司的主导部署模式。随着这一变化，我们也看到了可用的云选项的大幅增加。我们今天的选择看起来像这样:</p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lz"><img src="../Images/724eafc43c01e974bde00177efbf0572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSt56bOhlh1aFNWIUgqcTQ.jpeg"/></div></div></figure><p id="0eef" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">我肯定错过了几个！如今有如此多的平台可供使用，以至于我们觉得有义务抛开我们的先入之见，忘记其他人都在做什么，并客观地决定哪一个平台最适合我们的需求。</p><h1 id="125c" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">决策过程</h1><p id="1738" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">我们流程的第一步是定义我们的云需求。根据我们的产品需求和高级架构，这些是我们最有可能需要的服务和功能:</p><ul class=""><li id="87a0" class="ll lm hu ji b jj jk jn jo kf ln kg lo kh lp kd me lr ls lt dt translated">文件存储器</li><li id="c411" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">发布/订阅消息</li><li id="6117" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">可伸缩NoSQL数据库</li><li id="26e4" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">HTTP REST APIs的自动扩展平台</li><li id="d69c" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">执行测试的平台，最好是基于容器的</li><li id="b9c9" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">静态UI资产托管:JavaScript、CSS、图像</li><li id="e950" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">ETL和基于流的事件处理框架</li><li id="c7c2" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">用于存储和查询大量半结构化数据的平台</li><li id="ad09" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">无服务器事件处理</li><li id="cf22" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">生产级监控和记录</li></ul><p id="0c62" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">考虑到我们认为需要的所有服务，我们能够迅速将候选人名单缩小到AWS和GCP。这些是我们可能在每个云中用来构建mabl的服务:</p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mf"><img src="../Images/f588a56c165e003e4f82d0d95326261b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fyPt_M4HzROtAyAlR_cKWQ.jpeg"/></div></div></figure><p id="ecdc" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">很明显，AWS和GCP都有我们需要的全套服务，我们觉得我们可以将我们的软件部署到任何一个平台上，而不需要诉诸任何丑陋的变通办法。接下来，我们决定看看是什么使这些服务与众不同，以及一些我们不能忽视的非技术因素。</p><h1 id="aa9b" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">先前的经验</h1><p id="5328" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">团队中的大多数人都有丰富的AWS使用经验。团队中的一些人对GCP有不同程度的体验。</p><p id="1442" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:AWS </strong></p><h1 id="76e8" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">开发者社区</h1><p id="8e25" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">虽然GCP有一些像SnapChat和Pokemon Go这样的大客户，但AWS显然有一个更大的开发者社区。我们查看了meetup.com两个平台的群组成员和预定聚会数量，以快速了解相对社区参与度:</p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mg"><img src="../Images/7c9e12304af37c7dd3d3333d1a8dfa4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qqurbmCPfPnvjPatzv8Aw.jpeg"/></div></div></figure><p id="d907" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">关于堆栈溢出的活动问题的数量显示了类似的差距:</p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mg"><img src="../Images/7c9e12304af37c7dd3d3333d1a8dfa4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qqurbmCPfPnvjPatzv8Aw.jpeg"/></div></div></figure><p id="db89" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:AWS </strong></p><h1 id="f54b" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">AWS kine sis vs GCP酒吧/Sub</h1><p id="f9c3" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">发布/订阅消息是许多分布式、松散耦合系统的关键需求。它可以用于从数据接收到事件处理和子组件之间的同步的任何事情。它必须能够扩展，而且必须能够正常工作。</p><p id="8188" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">Kinesis和Pub/Sub的特点非常相似。它们本质上是分布式队列，具有至少一次传递语义，支持多个发布者和多个订阅者。它们都有许多与其他服务的集成，比如允许无服务器功能成为订阅者，并对发布到队列的消息进行操作。然而，这些服务至少有两个显著的不同之处:</p><ol class=""><li id="685c" class="ll lm hu ji b jj jk jn jo kf ln kg lo kh lp kd lq lr ls lt dt translated">Kinesis允许新订户开始阅读过去的消息，直到trim horizon(流保留的最早的消息)。发布/订阅只允许新的订阅开始读取在订阅创建后创建的<em class="jh">消息。在这一点上，这不是我们的主要问题，但它确实对服务的使用方式施加了一些限制。运动的次要优势。</em></li><li id="ce3c" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd lq lr ls lt dt translated">发布/订阅具有非常优越的可扩展性和成本模型。酒吧/订阅的巨大优势。</li></ol><p id="1fe6" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">GCP的Pub/Sub的定价和扩展模式就是按量付费。就是这样。您不需要估计您的请求率或监控使用情况和扩展服务。您不需要为您没有使用的容量付费。您只需根据需要发出尽可能多的请求，服务就会自动扩展以满足您的需求。如果你是Kinesis用户，想想如果你不用担心可怕的<em class="jh">provisionedthroughputexceed</em>错误，当你的使用量增加或遇到突发流量时，它会如何简化你的工作。Kinesis的替代方案是提供比你大多数时候需要的更多的容量，但这需要为你没有使用的容量付费。</p><p id="2251" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">直到最近，缩放Kinesis意味着手动分割或合并碎片。在我之前的公司，我从事一项服务，每天通过Kinesis在数百个碎片上推送超过100TB的记录。扩展流是一个需要花费一天大部分时间来完成的过程，如果我们对吞吐量的意外增长毫无准备，这意味着<em class="jh">我们的某些记录会被丢弃</em>，直到流扩展到足以处理吞吐量。当然，有缓冲和重放策略可以缓解这类问题，但这不是Kinesis客户端库提供的现成功能，所以您必须自己构建这一功能。对于非常高吞吐量的流，将消息缓冲到磁盘并重试几个小时甚至是不切实际的。</p><p id="1f9d" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">有了GCP发布/订阅服务，我们不必担心服务如何扩展，也不必担心我们是否会因为过度调配容量而浪费资金。我们可以专注于产品功能，而不是运营问题。</p><p id="3189" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:GCP </strong></p><h1 id="428b" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">AWS DynamoDB与GCP数据存储</h1><p id="1d05" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">就像Kinesis与Pub/Sub的比较一样，DynamoDB和Datastore有许多共同的特性，但谷歌似乎消除了DynamoDB用户经历的一些共同的痛点。这两个数据库都可以用作键值存储或文档存储。它们都是高度可扩展的。两者都支持主索引和辅助索引。</p><p id="08ce" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">在我看来，Datastore区别于DynamoDB的主要特征还是可伸缩性和定价模型。数据存储是按请求付费的读取、写入和删除。与DynamoDB不同，无需预先配置读写吞吐量。像发布/订阅一样，对于数据存储，您永远不会看到<em class="jh">provisionedthroughputexceed</em>错误，因为可伸缩性是由GCP自动管理的。Datastore的另一个很好的特性是它对某些类型的事务的本机支持，这些事务支持诸如条件更新之类的模式。</p><p id="6cf5" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">但是，数据存储中有几个限制值得一提。首先，数据存储中的大多数操作都是<a class="ae ke" href="https://cloud.google.com/datastore/docs/articles/balancing-strong-and-eventual-consistency-with-google-cloud-datastore/" rel="noopener ugc nofollow" target="_blank">最终一致的</a>。DynamoDB允许最终一致和强一致读取(尽管价格不同)，但Datastore目前不提供该选项。也就是说，有一些设计模式(包括事务的使用)可以最小化数据存储中这种一致性约束的影响。</p><p id="58c6" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">数据存储区的另一个限制是其每个实体组每秒一次写入的写入限制。在大多数情况下，这意味着你不能每秒更新<em class="jh">相同的键/实体</em>超过一次。通常，将数据模型设计为频繁更新相同的键并不是一个好主意，因为这将导致性能瓶颈，但在一些罕见的情况下，我们不得不为达到这一限制的热键实现变通方法。</p><p id="3d93" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">在考虑了两个NoSQL数据库的所有特征和特性之后，我们认为Datastore是比DynamoDB更好的整体服务。注意，在GCP还有另外一个选项:<a class="ae ke" href="https://cloud.google.com/bigtable/" rel="noopener ugc nofollow" target="_blank"> Bigtable </a>。Bigtable是一个大规模可扩展的NosQL数据库，与HBase and兼容，并支持许多谷歌自己的核心产品，如搜索、地图和Gmail。我们在这一点上没有使用它，因为我们还没有利用Bigtable优势的用例，并且Bigtable的定价模型在低容量时不是非常经济高效。尽管我们现在不使用Bigtable，但知道我们将来需要它时可以选择它还是很好的。</p><p id="5f36" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:GCP </strong></p><h1 id="c406" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">AWS EC2容器服务(ECS)对GCP谷歌容器引擎(GKE)</h1><p id="d033" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">AWS和GCP都为运行基于容器的工作负载和存储容器本身提供了可伸缩的服务。ECS将自己标榜为Docker兼容的容器服务，它利用了专有的AWS容器编排技术。相比之下，GKE是由库伯内特公司管理的。因为GKE是典型的Kubernetes，所以我们的软件可以在任何Kubernetes集群上运行，甚至可以在AWS上运行，如果我们要在那里启动一个Kubernetes集群的话。这种灵活性很有吸引力，我们觉得我们不会被自己选择的一家供应商所束缚</p><p id="2840" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">有关我们如何在mabl 使用GKE的更多信息，请查看我们在<a class="ae ke" href="https://www.mabl.com/validating-100-million-pages-kubernetes/" rel="noopener ugc nofollow" target="_blank">上的博客帖子，使用Kubernetes </a>每月验证1亿个页面。</p><p id="c93f" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:GCP </strong></p><h1 id="85e6" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">AWS EMR + Spark与GCP数据流</h1><p id="21f3" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">我们知道我们会有几个不同的数据处理用例。主要用例是分析来自一个流的测试执行事件(Kinesis或Pub/Sub)。分析阶段将包括特征提取、对数据进行转换以及评估机器学习模型。我们预期的第二个用例是重新处理我们之前捕获的事件。重新处理旧事件可能是必要的，以纠正来自初始分析的无效结论(例如，由于bug)，或者可能是我们添加了一种新的分析类型，并希望用这种新信息更新以前生成的见解。我们知道我们需要一个既能进行流式处理又能进行批处理的系统。</p><p id="a504" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">AWS Elastic Map Reduce (EMR)允许用户启动托管的Hadoop集群，包括运行在Hadoop之上的服务，如Map Reduce、Hive、Pig和Spark。当我们调查GCP上的类似服务时，我们发现了两个与EMR相似的服务:Dataproc和Dataflow。Dataproc最接近EMR，因为它是一个托管的Hadoop集群，可以运行Spark之类的服务。接下来，我们看了数据流。</p><p id="c463" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">数据流是一个GCP管理的服务，实现了<a class="ae ke" href="https://beam.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Beam </a>。Beam将自己描述为一个用于数据处理的统一编程模型，其中包括特定于语言的SDK。换句话说，它不是一个执行数据管道的独立服务，而是一个接口和类的集合，开发者可以用它来指定<em class="jh">管道应该如何运行</em>以及<em class="jh">应该做什么</em>。为了执行光束管道，你需要使用一个<em class="jh">流道</em>。幸运的是有很多跑步者可以选择，包括Dataflow、<a class="ae ke" href="https://flink.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Flink </a>，甚至还有Spark！各种可用的运行器对我们很有吸引力，因为这意味着我们可以出于任何原因从数据流中迁移出来，并且我们不需要将我们的代码移植到另一个系统，因为EMR支持Spark和Flink。</p><p id="297c" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">在这一点上，我们看到了几个选项:EMR或Dataproc上的Spark，EMR或Dataflow上的Beam。第一个问题是我们对火花还是光束有偏好。这两个框架的详细比较超出了这篇博客的范围，但是我们打算发布关于这个主题的后续博客或技术演讲幻灯片。</p><p id="1a45" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">Beam从一开始就有一点优势，因为它是在Spark和Storm等类似框架之后几年出现的。Beam开发人员有机会解决其他框架的缺点，而不必处理遗留的API。Beam的一个显著改进是它有一个统一的批处理和流处理API，这意味着一旦定义了管道，就可以将同一管道用于批处理作业或流作业。相比之下，Spark从根本上来说是一个批处理系统，在它的顶层有一些流式API。开发人员必须提前选择是构建批处理作业还是流式作业。流API的工作方式是<em class="jh">离散化</em>流，将其累积并分块成小批，然后交给标准的Spark批处理API。我们更喜欢Beam的统一模型，因为我们知道我们需要在流模式和批处理模式下运行相同的作业。</p><p id="1f36" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">当我们评估AWS和GCP的数据处理能力时，另一个考虑因素是使用数据流是否比使用EMR有任何优势。我们喜欢数据流更像是托管服务，而不是托管集群。部署数据流作业很简单:只需使用数据流运行器执行作业。Dataflow的另一个很好的特性是，在许多情况下，它会将您现有的管道无缝地迁移到新代码。没有必要建立一个新的集群并拆除旧的集群。如果您的更改没有显著改变管道的结构，Dataflow将为您透明地换入新代码。我们认为该功能可以节省时间，并有利于提高运营可靠性。在考虑了我们所有的选择后，我们觉得Beam on Dataflow是我们的最佳选择。</p><p id="765f" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:GCP </strong></p><h1 id="e9c3" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">AWS机器学习vs GCP ML引擎</h1><p id="e962" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">mabl的主要产品需求之一是给我们的客户<em class="jh">关于他们的应用程序如何运行的可操作的</em>洞察力。我们使用机器学习(ML)来过滤测试执行中的噪音，并从这些数据点中提取关于应用程序行为如何随时间变化的信息。这个过程包括使用不同的ML技术和几个不同类别的模型。</p><p id="ea68" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">当将AWS机器学习服务与GCP的ML引擎进行比较时，我们立即注意到AWS产品中的一些重大限制。首先，对我们来说最重要的是，AWS ML只支持单一类型的ML模型:逻辑回归。虽然逻辑回归模型对于某些应用是有用的，但我们知道我们还需要使用其他技术。AWS ML的第二个限制因素是，在模型被训练之后，没有办法将它们导出服务，所以对于可移植性来说，它不是理想的。</p><p id="1117" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">GCP的ML引擎更像是一个通用计算平台，可用于训练和评估任何类型的ML模型。ML引擎服务旨在帮助在数据科学家熟悉的Python环境中进行TensorFlow模型训练和评估。也可以通过API和其他语言的客户端库访问它，因此可以用Python训练模型，用Java评估它们。Datalab本质上是Jupyter的一个变种，可以很容易地与ML Engine、BigQuery和其他GCP服务集成。我们的结论是，GCP的ML服务套件将使我们能够构建强大的ML工具，为我们的客户提供有价值的见解。</p><p id="f3c0" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:GCP </strong></p><h1 id="07a4" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">自动气象站Lambda与GCP云函数</h1><p id="8787" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">虽然提供了类似的功能，Lambda在这一点上是比云功能更成熟的产品。Lambda支持多种语言，而Cloud Functions仅支持Node.js。在评估(和编写)时，Cloud Functions仍处于测试阶段。</p><p id="b115" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:AWS </strong></p><h1 id="5ba7" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">测试支持</h1><p id="ac49" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">当我在AWS上开发特性时，我最大的抱怨之一是，如果不将代码实际部署到AWS上并看到它在那里运行，测试代码几乎是不可能的。你能做的最好的事情就是试着模仿一些AWS客户端接口，但是这并没有给我太多的信心，让我相信我的代码在AWS中会有相同的行为。单元测试能力最好的AWS服务大概就是DynamoDB了。有一个本地模拟器可以与单元测试一起运行，虽然模拟器和真实服务之间有一些差异，但模拟器足够好，至少可以让您对DynamoDB客户端在AWS中运行时的工作有一些信心。</p><p id="2e08" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">根据合同，GCP的大多数产品都有更好的测试支持。Datastore、AppEngine、Dataflow甚至云函数都有一些实用程序，允许在本地测试中使用它们，以便在部署到GCP之前验证它们的行为。其中一些模拟器比其他模拟器更容易集成到自动化测试中，但是能够在本地测试一些最关键的云服务是一个很大的优势。这些测试能力允许我们在开发过程中更早地捕捉错误，这对于一个围绕自动化软件测试概念建立的公司来说尤其重要！</p><p id="2ff4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:GCP </strong></p><h1 id="c724" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">基础设施和软件部署自动化</h1><p id="4099" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">使用CloudFormation或Terraform等第三方工具在AWS中构建完整的环境相当容易。GCP相当于CloudFormation，是Cloud Deployment Manager。不幸的是，GCP的部署管理器只支持GCP服务的一个子集，似乎没有CloudFormation那么成熟。AWS在这方面绝对有优势。</p><p id="4913" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">关于部署软件(相对于基础设施)，这两个平台有非常不同的方法。AWS提供了一些用于部署代码的工具(比如CodeDeploy for EC2)，但是并不是所有的AWS服务都有用于部署代码的内置功能。相比之下，GCP有一个名为gcloud的命令行工具，能够管理大多数GCP服务以及部署代码更改。然而，AWS从其更大的开发社区中受益匪浅，像Ansible这样的开源工具有一个用于管理AWS部署的大型模块库。</p><p id="bd8a" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><strong class="ji hv">优势:AWS </strong></p><h1 id="48fd" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">决策时间</h1><p id="c254" class="pw-post-body-paragraph jf jg hu ji b jj lg jl jm jn lh jp jq kf li jt ju kg lj jx jy kh lk kb kc kd hn dt translated">选择云平台是我们在<a class="ae ke" href="https://www.mabl.com/" rel="noopener ugc nofollow" target="_blank"> mabl </a>做出的最困难的产品开发决策之一。即使在几年前，也不会有太多的讨论。很高兴看到云平台领域有如此多的创新和竞争！</p><p id="7286" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">当我们讨论选择哪个平台时，我们敏锐地意识到AWS和GCP都没有在我们认为重要的每个类别中胜出。那太容易了！对于我们将使用的一些核心GCP服务，如发布/订阅、数据存储、数据流和ML引擎，我们当然有自己的偏好。在我们看来，选择GCP的最大风险是:</p><ul class=""><li id="d333" class="ll lm hu ji b jj jk jn jo kf ln kg lo kh lp kd me lr ls lt dt translated">许多GCP服务没有相应的AWS服务成熟，在某些情况下，GCP服务仍处于测试阶段</li><li id="3c8c" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">GCP有一个较小的开发者社区</li><li id="a6bb" class="ll lm hu ji b jj lu jn lv kf lw kg lx kh ly kd me lr ls lt dt translated">AWS是众所周知的<em class="jh">魔鬼。当谈到AWS时，我们都知道尸体埋在哪里，以及如何<em class="jh">而不是</em>使用某些服务和功能，这些知识只能通过艰苦的方式获得。毫无疑问，GCP也有一些同样的问题，但我们不知道它们是什么，也不知道它们会有多严重。</em></li></ul><p id="753b" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">回想一下最终让天平向GCP倾斜的因素，可以归结为几个主题。首先，我们认为，作为我们产品核心的GCP服务在可伸缩性方面设计得更好，并且在我们的业务增长时，需要工程师更少的手动干预来保持它们平稳运行。在mabl，我们都努力成为可以在产品的所有领域做出贡献的全栈工程师，但作为软件开发人员，我们都对开发比对运营更感兴趣。第二个因素是GCP更强大的机器学习能力，我们认为他们在ML服务方面比AWS走得更远，也更投入。第三，我们不太担心GCP的供应商锁定，因为它的更多服务是围绕开源框架和API(如Kubernetes和Apache Beam)构建的。最后，我们觉得GCP有几个方面可以加速我们的开发并方便调试:更好的单元测试支持、Stackdriver监控和日志记录，以及托管我们UI资产的Firebase。</p><p id="a5cd" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">老话“没有人因为购买IBM而被解雇”的现代版本应该是“没有人因为选择AWS而被解雇。”AWS是一个成熟的云平台，拥有许多优秀的服务和庞大的支持社区。我毫不怀疑AWS是许多组织的最佳选择，但当我们在<a class="ae ke" href="https://www.mabl.com/" rel="noopener ugc nofollow" target="_blank"> mabl </a>开始产品开发时，我们有义务为<em class="jh">我们的公司</em>和<em class="jh">我们的用户</em>围绕最佳平台构建我们的软件。我们必须选择我们认为能够最大化我们的开发速度、实现差异化功能集并最小化运营开销的云提供商。老实说，我认为整个团队都期望评估这两个平台并选择AWS(尽管我们的创始人来自Google！)，但在对这两个平台进行客观评估后，一致认为GCP的服务更适合我们的需求。</p></div><div class="ab cl mh mi hc mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hn ho hp hq hr"><blockquote class="jc jd je"><p id="f413" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">最初发表于2017年10月30日<a class="ae ke" href="https://www.mabl.com/why-we-chose-google-cloud-platform-over-aws-at-mabl/" rel="noopener ugc nofollow" target="_blank">www.mabl.com</a>。</p></blockquote></div></div>    
</body>
</html>