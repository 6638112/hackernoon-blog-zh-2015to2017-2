<html>
<head>
<title>Let’s compare Laravel and Doctrine migrations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们比较一下拉勒维尔和教义迁移</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/lets-compare-laravel-and-doctrine-migrations-795c0022285f?source=collection_archive---------9-----------------------#2017-01-25">https://medium.com/hackernoon/lets-compare-laravel-and-doctrine-migrations-795c0022285f?source=collection_archive---------9-----------------------#2017-01-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/c439cd305d8d7c17545840b1be32cc19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvUdSSDh406j75wwsSuR_A.png"/></div></div></figure><p id="cdec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章是针对Laravel初学者的。不需要任何技能。这篇文章有点固执己见，所以不要全信。此外，为了简洁起见，省略了细节。</p><p id="fd95" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因此，我将进行实际的比较，并给出一些开始的提示。</p><p id="0ee6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你从未听说过<a class="ae ka" href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/getting-started.html" rel="noopener ugc nofollow" target="_blank">主义</a>，那就是数据库抽象层。有点像<a class="ae ka" href="https://laravel.com/docs/master/eloquent" rel="noopener ugc nofollow" target="_blank">雄辩的</a>，但类型不同:Laravel是活动记录(AR)，而Doctrine是对象关系映射器(ORM)。</p><h1 id="3ee5" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">Laravel迁移(<a class="ae ka" href="https://laravel.com/docs/master/migrations" rel="noopener ugc nofollow" target="_blank">文档</a>)</h1><p id="d215" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在Laravel中，我们有<code class="eh le lf lg lh b">database/migrations</code>文件夹存储所有的迁移类。Laravel还在数据库中保留了一个表来跟踪过去的迁移。该系统非常简单，典型的工作流程如下:</p><ul class=""><li id="4f2b" class="li lj hu je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq dt translated"><code class="eh le lf lg lh b">php artisan make:migration create_foo_column_in_bar_table --table=bar</code> —创建迁移类</li><li id="6b4e" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">导航到<code class="eh le lf lg lh b">[some numbers]_create_foo_column_in_bar_table.php</code>文件</li><li id="301b" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">手动填写迁移方法。</li><li id="5fbe" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">运行<code class="eh le lf lg lh b">php artisan migrate</code>触发<code class="eh le lf lg lh b">up</code>方法。运行<code class="eh le lf lg lh b">php artisan migrate:rollback</code>触发<code class="eh le lf lg lh b">down</code>方法。</li></ul><p id="2046" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">上升</strong></p><ul class=""><li id="b321" class="li lj hu je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq dt translated">初学者友好。</li></ul><p id="4a2f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">不利方面</strong></p><ul class=""><li id="d079" class="li lj hu je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq dt translated">需要大量代码。在创建表时这并不明显，但对于复杂的更改来说更是如此。</li><li id="97ff" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">迁移类有可读的名称，并且名称应该是唯一的。因此，如果你不够小心，就有可能发生冲突。</li><li id="e312" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">写下来的方法很痛苦。这是一大堆容易出错的文案。</li><li id="05c8" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">每个迁移都应该被测试，如果没有<code class="eh le lf lg lh b">down</code>方法，这是很难做到的。</li><li id="c80a" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">所有的迁移都必须永久保存，因为它们代表了您的模式。这将在您完成数百次迁移后打开庞大的迁移文件夹。</li></ul><h1 id="31b8" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">教义迁移(<a class="ae ka" href="http://docs.doctrine-project.org/projects/doctrine-migrations/en/latest/reference/introduction.html" rel="noopener ugc nofollow" target="_blank">文档</a>)</h1><p id="30f6" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在理论上，我们将模式定义为实体类上的注释。通过将您的当前模式与预期模式进行比较，自动生成迁移。迁移以原始SQL的形式呈现，您可以在需要时修改它们(这种情况相当少见)。以下是典型的工作流程:</p><ul class=""><li id="cd85" class="li lj hu je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq dt translated">在实体类中进行更改。</li><li id="b9bf" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">从差异中产生迁移:<code class="eh le lf lg lh b">php artisan doctrine:migrations:diff</code>。</li><li id="a23b" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">浏览一下迁移，看看一切是否如预期的那样。</li><li id="e44c" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">运行迁移:<code class="eh le lf lg lh b">php artisan doctrine:migrations:migrate</code></li></ul><p id="314c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">升迁</strong></p><ul class=""><li id="8ee7" class="li lj hu je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq dt translated">需要键入的代码更少。在重命名列或移动索引时最明显。改变一行——教义会完成剩下的工作。</li><li id="3cf8" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">迁移以时间戳命名。冲突不太可能发生。</li><li id="8268" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated"><code class="eh le lf lg lh b">down</code>方法是自动编写的。这意味着你也可以毫不费力地进行<code class="eh le lf lg lh b">up</code>和<code class="eh le lf lg lh b">down</code>的迁移。您还可以迁移到特定的迁移。</li><li id="90b7" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">迁移是一次性的。因为它们可以从声明中可靠地生成。轻松移动、合并或删除它们。</li></ul><p id="8934" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">缺点</strong></p><ul class=""><li id="062e" class="li lj hu je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq dt translated">需要一点学习才能掌握。</li></ul><h1 id="db93" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="a92c" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">您可能想要使用原则迁移，即使不使用整个原则生态系统。它们非常省时且可扩展。因此，Laravel迁移只适用于最简单的情况。</p><h1 id="937d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">一些附加信息</h1><ul class=""><li id="b196" class="li lj hu je b jf kz jj la jn lw jr lx jv ly jz ln lo lp lq dt translated">原则允许从现有数据库创建带有注释<a class="ae ka" href="http://symfony.com/doc/current/doctrine/reverse_engineering.html" rel="noopener ugc nofollow" target="_blank">的实体。这些可能需要一些修正，但没有从零开始创造它们那么多。</a></li><li id="4be8" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">当使用Laravel迁移时，不要使用口才，只使用查询生成器。或者甚至是原始查询，以获得更多安全可靠的信息。原因是:你可能进行迁移，改变模型，进行另一次迁移。第一次迁移有可能不再与您的模型兼容。这个bug很容易在测试或生产环境中发现，并可能导致部分迁移，这是很难处理的。</li><li id="ea68" class="li lj hu je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq dt translated">使用教条或Laravel迁移只对模式执行更改(如创建表、移动列、附加索引等)。对于数据更改，您可以使用我的<a class="ae ka" href="https://github.com/asvae/laravel-fixtures" rel="noopener ugc nofollow" target="_blank">库</a>。或者你可以在Laravel seeders上为自己建造一些东西。</li></ul></div><div class="ab cl lz ma hc mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hn ho hp hq hr"><p id="c51b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mg">原载于</em><a class="ae ka" href="https://gist.github.com/asvae/f0b8b6f3eae9f72d9fa9e824c470804f" rel="noopener ugc nofollow" target="_blank"><em class="mg">gist.github.com</em></a><em class="mg">。</em></p><div class="mh mi mj mk fq ab cb"><figure class="ml iv mm mn mo mp mq paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ml iv mm mn mo mp mq paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ml iv mm mn mo mp mq paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mr ms mt"><p id="f922" class="jc jd mg je b jf jg jh ji jj jk jl jm mu jo jp jq mv js jt ju mw jw jx jy jz hn dt translated">黑客中午是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd mg je b jf jg jh ji jj jk jl jm mu jo jp jq mv js jt ju mw jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mx"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>