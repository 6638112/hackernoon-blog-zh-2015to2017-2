<html>
<head>
<title>RecyclerView plusAssign Kotlin power</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">recycler view plus sign kot Lin power</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/recyclerview-plus-assign-kotlin-power-6f93ce980154?source=collection_archive---------6-----------------------#2017-12-14">https://medium.com/hackernoon/recyclerview-plus-assign-kotlin-power-6f93ce980154?source=collection_archive---------6-----------------------#2017-12-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/2982c23053d4bb8f43ef36edd15c18f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mU-dHEyAcrcOz-kHU0YFLQ.png"/></div></div></figure><p id="59ba" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用recyclerview创建列表在几乎每个项目中都很常见，这需要我们为每个列表创建适配器和视图容器。在某些情况下，当我们的应用程序中有许多列表时，我们会重复这个过程太多次。</p><p id="3225" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本文中，我们使用Kotlin特性以更简单快捷的方式创建简单列表。</p><p id="7cd9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们从介绍我们将得到的结果开始。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="5a48" class="kj kk hu kf b fv kl km l kn ko">recyclerView.<strong class="kf hv"><em class="kp">setUp</em></strong>(users, R.layout.<em class="kp">item_layout</em>, <strong class="kf hv">{<br/>    </strong>nameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">name<br/>    </strong>surNameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">surname<br/>}</strong>)</span></pre><p id="260f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当然，对于这个魔术，我们还需要kotlin android扩展。T3】</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kq"><img src="../Images/e579f27be7d8d985a8c3ec8610a2a7f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5As6a6ouzrmKNiTNQ3Szg.png"/></div></div></figure><h2 id="d817" class="kj kk hu bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">第一步</h2><p id="643f" class="pw-post-body-paragraph jc jd hu je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">让我们以通用的方式创建一个抽象适配器</p><p id="aff1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们需要向构造函数传递实际的项目列表和布局资源id</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="e1cd" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv"><br/>abstract class </strong>AbstractAdapter&lt;ITEM&gt; <strong class="kf hv">constructor</strong>(<br/>        <strong class="kf hv">protected var itemList</strong>: List&lt;ITEM&gt;,<br/>        <strong class="kf hv">private val layoutResId</strong>: Int)<br/>    : RecyclerView.Adapter&lt;AbstractAdapter.Holder&gt;() {<br/><br/>    <strong class="kf hv">class </strong>Holder(itemView: View) : RecyclerView.ViewHolder(itemView)<br/>}</span></pre><p id="dbc9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，我们需要创建从基本视图持有人扩展的视图持有人，并实现我们的适配器的onBindViewHolder和onCreateViewHolder，就像我们在创建recyclerview时总是做的那样。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="b8ce" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">override fun </strong>getItemCount() = <strong class="kf hv">itemList</strong>.<strong class="kf hv">size<br/><br/>override fun </strong>onCreateViewHolder(parent: ViewGroup,<br/>                                viewType: Int): Holder {<br/>    <strong class="kf hv">val </strong>view = parent <em class="kp">inflate </em><strong class="kf hv">layoutResId<br/>    return </strong>Holder(view)<br/>}<br/><br/><strong class="kf hv">override fun </strong>onBindViewHolder(holder: Holder, position: Int) {<br/>    <strong class="kf hv">val </strong>item = <strong class="kf hv">itemList</strong>[position]<br/>    holder.<strong class="kf hv">itemView</strong>.<em class="kp">bind</em>(item)<br/>}<br/><br/><strong class="kf hv">protected open fun </strong>View.bind(item: ITEM) {<br/>}<br/><br/><strong class="kf hv">class </strong>Holder(itemView: View) : RecyclerView.ViewHolder(itemView)</span></pre><p id="ea1c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">而且我们还需要创建从我们的抽象适配器扩展而来的adapter，不要慌，比较短，姑且命名为Kadapter吧。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="88a2" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">class </strong>Kadapter&lt;ITEM&gt;(items: List&lt;ITEM&gt;,<br/>                     layoutResId: Int,<br/>                     <strong class="kf hv">private val bindHolder</strong>: View.(ITEM) -&gt; Unit)<br/>    : AbstractAdapter&lt;ITEM&gt;(items, layoutResId) {<br/><br/>    <strong class="kf hv">override fun </strong>onBindViewHolder(holder: Holder, position: Int) {<br/>        holder.<strong class="kf hv">itemView</strong>.<strong class="kf hv">bindHolder</strong>(<strong class="kf hv">itemList</strong>[position])<br/>    }<br/>}</span></pre><h2 id="f472" class="kj kk hu bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">第二步</h2><p id="dff7" class="pw-post-body-paragraph jc jd hu je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">让我们看看如何使用我们的高级适配器:</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="ef91" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">val </strong>adapter = Kadapter(users, R.layout.<em class="kp">item_layout</em>) <strong class="kf hv">{<br/>    </strong>nameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">name<br/>    </strong>surNameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">surname<br/>}<br/></strong>recyclerView.<em class="kp">adapter </em>= adapter<br/>recyclerView.<em class="kp">layoutManager </em>= LinearLayoutManager(<strong class="kf hv">this</strong>)</span></pre><p id="0f42" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们可以就这么用，或者更深入一点。为此，让我们继续前进，添加更多的东西。</p><h2 id="e210" class="kj kk hu bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">超级英雄登陆！他要做超级英雄着陆了！</h2><p id="d8bb" class="pw-post-body-paragraph jc jd hu je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">让我们创建一个recycler视图的扩展。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="7d7e" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">fun </strong>&lt;ITEM&gt; RecyclerView.setUp(items: List&lt;ITEM&gt;,<br/>                              layoutResId: Int,<br/>                              bindHolder: View.(ITEM) -&gt; Unit,<br/>                              manager: RecyclerView.LayoutManager = LinearLayoutManager(<strong class="kf hv">this</strong>.<em class="kp">context</em>)): Kadapter&lt;ITEM&gt; {<br/><br/>    <strong class="kf hv">return </strong>Kadapter(items, layoutResId, <strong class="kf hv">{<br/>        </strong>bindHolder(<strong class="kf hv">it</strong>)<br/>    <strong class="kf hv">}</strong>).<em class="kp">apply </em><strong class="kf hv">{<br/>        </strong><em class="kp">layoutManager </em>= manager<br/>        <em class="kp">adapter </em>= <strong class="kf hv">this<br/>    }<br/></strong>}</span></pre><p id="d8e9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它将封装适配器和布局管理器，我们也可以改变布局管理器的默认实现。</p><h2 id="8e05" class="kj kk hu bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">第三步</h2><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lp"><img src="../Images/eefe35e6e1cd8221da294f146e3f762c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ZC7ZU-zUzWIXDMqIcwzdA.png"/></div></div></figure><p id="f0db" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">到目前为止，一切都很好，但是如果我们尝试单击列表中的项目，什么都不会发生。我们需要注意这一点。让我们实现onClickListener。</p><p id="9468" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为此，我们需要在抽象适配器中添加点击逻辑。我们的onCreateViewHolder变成了这样。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="0f9e" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">override fun </strong>onCreateViewHolder(parent: ViewGroup, viewType: Int): Holder {<br/>    <strong class="kf hv">val </strong>view = parent <em class="kp">inflate </em><strong class="kf hv">layoutResId<br/>    val </strong>viewHolder = Holder(view)<br/>    <strong class="kf hv">val </strong>itemView = viewHolder.<strong class="kf hv">itemView<br/>    </strong>itemView.setOnClickListener <strong class="kf hv">{<br/>        val </strong>adapterPosition = viewHolder.<em class="kp">adapterPosition<br/>        </em><strong class="kf hv">if </strong>(adapterPosition != RecyclerView.<em class="kp">NO_POSITION</em>) {<br/>            <strong class="kf hv">onItemClick</strong>(itemView, adapterPosition)<br/>        }<br/>    <strong class="kf hv">}<br/>    return </strong>viewHolder<br/>}</span><span id="ebe4" class="kj kk hu kf b fv lq km l kn ko"><strong class="kf hv">protected open fun </strong>onItemClick(itemView: View, position: Int) {<br/>}</span></pre><p id="dfcb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们还需要将onClick逻辑添加到我们之前创建的适配器实现和扩展中。kadapter的最终代码如下所示:</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="4a4c" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">class </strong>Kadapter&lt;ITEM&gt;(items: List&lt;ITEM&gt;,<br/>                     layoutResId: Int,<br/>                     <strong class="kf hv">private val bindHolder</strong>: View.(ITEM) -&gt; Unit)<br/>    : AbstractAdapter&lt;ITEM&gt;(items, layoutResId) {<br/><br/>    <strong class="kf hv">private var itemClick</strong>: ITEM.() -&gt; Unit = <strong class="kf hv">{}<br/><br/>    constructor</strong>(items: List&lt;ITEM&gt;,<br/>                layoutResId: Int,<br/>                bindHolder: View.(ITEM) -&gt; Unit,<br/>                itemClick: ITEM.() -&gt; Unit = <strong class="kf hv">{}</strong>) : <strong class="kf hv">this</strong>(items, layoutResId, bindHolder) {<br/>        <strong class="kf hv">this</strong>.<strong class="kf hv">itemClick </strong>= itemClick<br/>    }<br/><br/>    <strong class="kf hv">override fun </strong>onBindViewHolder(holder: Holder, position: Int) {<br/>        holder.<strong class="kf hv">itemView</strong>.<strong class="kf hv">bindHolder</strong>(<strong class="kf hv">itemList</strong>[position])<br/>    }<br/><br/>    <strong class="kf hv">override fun </strong>onItemClick(itemView: View, position: Int) {<br/>        <strong class="kf hv">itemList</strong>[position].<strong class="kf hv">itemClick</strong>()<br/>    }<br/>}</span></pre><p id="4766" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和用于扩展的最终代码</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="2b66" class="kj kk hu kf b fv kl km l kn ko"><strong class="kf hv">fun </strong>&lt;ITEM&gt; RecyclerView.setUp(items: List&lt;ITEM&gt;,<br/>                              layoutResId: Int,<br/>                              bindHolder: View.(ITEM) -&gt; Unit,<br/>                              itemClick: ITEM.() -&gt; Unit = <strong class="kf hv">{}</strong>,<br/>                              manager: RecyclerView.LayoutManager = LinearLayoutManager(<strong class="kf hv">this</strong>.<em class="kp">context</em>)): Kadapter&lt;ITEM&gt; {<br/>    <strong class="kf hv">return </strong>Kadapter(items, layoutResId, <strong class="kf hv">{<br/>        </strong>bindHolder(<strong class="kf hv">it</strong>)<br/>    <strong class="kf hv">}</strong>, <strong class="kf hv">{<br/>        </strong>itemClick()<br/>    <strong class="kf hv">}</strong>).<em class="kp">apply </em><strong class="kf hv">{<br/>        </strong><em class="kp">layoutManager </em>= manager<br/>        <em class="kp">adapter </em>= <strong class="kf hv">this<br/>    }<br/></strong>}</span></pre><p id="ab30" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在让我们看看我们取得了什么成就。</p><p id="74fa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们可以创建不带点击监听器和带点击监听器的适配器。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="3f3a" class="kj kk hu kf b fv kl km l kn ko">recyclerView.<em class="kp">setUp</em>(users, R.layout.<em class="kp">item_layout</em>, <strong class="kf hv">{<br/>    </strong>nameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">name<br/>    </strong>surNameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">surname<br/>}</strong>)</span></pre><p id="02c3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">点击一下</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="abd6" class="kj kk hu kf b fv kl km l kn ko">recyclerView.<em class="kp">setUp</em>(users, R.layout.<em class="kp">item_layout</em>, <strong class="kf hv">{<br/>    </strong>nameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">name<br/>    </strong>surNameText.<em class="kp">text </em>= <strong class="kf hv">it</strong>.<strong class="kf hv">surname<br/>}</strong>, <strong class="kf hv">{<br/>    </strong>toast(<strong class="kf hv">"Clicked $name"</strong>)<br/><strong class="kf hv">}</strong>)</span></pre><p id="1df7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">作为奖励，我们可以添加基本方法到我们的抽象适配器，如添加，删除，更新，当然使用diffUtils。</p><p id="94cd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">本文的底线是展示<a class="ae lr" href="https://hackernoon.com/tagged/kotlin" rel="noopener ugc nofollow" target="_blank"> Kotlin </a> + <a class="ae lr" href="https://hackernoon.com/tagged/android" rel="noopener ugc nofollow" target="_blank"> Android </a>的一些强大特性，这些特性使得代码更加灵活。现在如果有兴趣可以更进一步。</p><p id="cfd1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">感谢您阅读本文。你可以在</strong>  <strong class="je hv">那里找到完整的代码</strong> <a class="ae lr" href="https://github.com/armcha/Kadapter" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">。</strong></a></p><p id="cdae" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">让我们在</strong><a class="ae lr" href="https://twitter.com/ArmanChatikyan" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Twitter</strong></a><strong class="je hv"/><a class="ae lr" href="https://github.com/armcha/" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Github</strong></a><strong class="je hv"/><a class="ae lr" href="https://web.facebook.com/chatikyana" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">脸书</strong> </a> <strong class="je hv">上成为朋友吧。如果你喜欢这些文章，那么请用下面的掌声推荐这篇文章，让其他人也能看到。</strong></p><p id="6877" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们也很乐意听到你的意见和建议:)</p><p id="517a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">谢谢。</p><figure class="ka kb kc kd fq iv"><div class="bz el l di"><div class="ls lt l"/></div></figure></div></div>    
</body>
</html>