<html>
<head>
<title>Using ngrok with Azure Functions⚡</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将ngrok与Azure Functions⚡一起使用</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/using-ngrok-with-azure-functions-7e209e96538c?source=collection_archive---------3-----------------------#2017-08-26">https://medium.com/hackernoon/using-ngrok-with-azure-functions-7e209e96538c?source=collection_archive---------3-----------------------#2017-08-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="1af3" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">类固醇的无服务器调试💪</h2></div><p id="a118" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有了像Azure Functions Cli和Azure Functions tools for Visual Studio这样的东西，你就可以在本地机器上获得完整的开发和调试过程。这很好，因为你可以快速迭代和测试，而不需要先把代码推到云端，缺点是你不能从。3:第三方服务，即GitHub无法访问您本地运行的功能。</p><p id="7ed0" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">但是如果我说有一种方法可以让你鱼与熊掌兼得，那不是很好吗？</p><h1 id="9691" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated">ngrok</h1><p id="141c" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">ngrok简介，ngrok是一种工具和服务，可以让您安全地检查流量并将其传输到您的本地计算机。这是一项付费计划的免费服务，将为您提供额外的功能，如自定义和保留域名，IP地址白名单等。</p><h2 id="98e2" class="lc kg hu bd kh ld le lf kl lg lh li kp js lj lk kr jw ll lm kt ka ln lo kv lp dt translated">获得工具</h2><p id="3aff" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">ngrok可以跨平台用于MacOS、Windows、Linux和FreeBSD，它只是一个你可以从<a class="ae lq" href="https://ngrok.com/download" rel="noopener ugc nofollow" target="_blank">ngrok.com/download</a>下载并解压的二进制文件。如果你像我一样在Windows上运行Chocolatey，那么安装它只需要一个简单的命令方式:<br/> <code class="eh lr ls lt lu b">choco install -y ngrok.portable</code></p><h2 id="0bba" class="lc kg hu bd kh ld le lf kl lg lh li kp js lj lk kr jw ll lm kt ka ln lo kv lp dt translated">使用ngrok</h2><p id="9e7e" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">使用ngrok非常简单，一般来说，您可以使用本地服务监听的协议和端口来启动该工具。<br/> <code class="eh lr ls lt lu b">ngrok http 8080</code></p><figure class="lw lx ly lz fq ma fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/ad1d430aeed05b26fabf593282786eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*SwCPvaS2WZDsfiko8igAIg.png"/></div></figure><p id="19f6" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ngrok将启动，转发URL是您用来从互联网访问您的本地服务。</p><h2 id="581a" class="lc kg hu bd kh ld le lf kl lg lh li kp js lj lk kr jw ll lm kt ka ln lo kv lp dt translated">将ngrok与Azure函数一起使用</h2><figure class="lw lx ly lz fq ma fe ff paragraph-image"><div class="fe ff md"><img src="../Images/ca3962748679d93e153a510717601c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*muO2-F6DBCSMtwcBMOp5Pw.png"/></div></figure><p id="7ca0" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你可以通过查看主机启动时的输出来找出你的Azure功能的本地端口，你也可以在启动功能主机<br/> <code class="eh lr ls lt lu b">func host -p 8080</code>时使用端口开关来指定端口</p><p id="1a45" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">默认情况下，ngrok会将其临时域作为主机头转发给本地运行的服务，但由于Azure Functions host只监听主机名“localhost ”,我们需要使用主机头开关<br/> <code class="eh lr ls lt lu b">ngrok http 8080 --host-header localhost</code>来覆盖默认行为</p><h2 id="67b6" class="lc kg hu bd kh ld le lf kl lg lh li kp js lj lk kr jw ll lm kt ka ln lo kv lp dt translated">外部调用本地函数</h2><p id="19ec" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">要在外部使用本地运行的功能，您只需将功能主机提供的基本url替换为ngrok提供的临时url，即<br/> <code class="eh lr ls lt lu b"><a class="ae lq" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank">http://localhost:8080</a></code>变为<code class="eh lr ls lt lu b"><a class="ae lq" href="https://tempsubdomain.ngrok.io" rel="noopener ugc nofollow" target="_blank">https://tempsubdomain.ngrok.io</a></code>。</p><p id="70c7" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">假设你有一个名为<code class="eh lr ls lt lu b">GithubWebhookCSharp</code>的GitHub webhook，它的本地url是<code class="eh lr ls lt lu b"><a class="ae lq" href="http://localhost:8080/GithubWebhookCSharp" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/api/GithubWebhookCSharp</a></code>，外部url是<code class="eh lr ls lt lu b"><a class="ae lq" href="https://tempsubdomain.ngrok.io/GithubWebhookCSharp" rel="noopener ugc nofollow" target="_blank">https://tempsubdomain.ngrok.io/api/GithubWebhookCSharp</a></code>。</p><p id="02e8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后你可以把它设置成GitHub webhook</p><figure class="lw lx ly lz fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff me"><img src="../Images/91458996f5c4cb052a4ca3ab56cfa752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSljRrxX-2Uutb8s68tntg.png"/></div></div></figure><p id="336f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在，当GitHub webhook触发时，它将通过ngrok建立隧道，其有效载荷将被传递到您的本地，否则外部无法访问的函数</p><figure class="lw lx ly lz fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mj"><img src="../Images/668ab678b6501feae9263f21c41ea6ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-bnuTvWeqE_9ON84nIuHOg.png"/></div></div></figure><h2 id="ca59" class="lc kg hu bd kh ld le lf kl lg lh li kp js lj lk kr jw ll lm kt ka ln lo kv lp dt translated">检查交通</h2><p id="012f" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">ngrok真正的杀手锏是它提供了一个本地web界面，你可以在工具的输出中找到它的url</p><figure class="lw lx ly lz fq ma fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/be754911440debead23046663492665c.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*LeXhkj1-J4U_XD8e4NKOHA.png"/></div></figure><p id="c768" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个接口提供了对通过ngrok隧道的所有流量的深入了解，您可以看到响应/请求体和头，它还允许您尽可能多次地重放请求，而无需触发外部服务上的事件，这在调试、迭代实现和修复bug时非常有用！</p><figure class="lw lx ly lz fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff ml"><img src="../Images/fd0407ebe92f0eb86cb884e8354d3083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JiImAdJCLXRoiR1dXy5mnw.png"/></div></div></figure><h1 id="9943" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated">结论</h1><p id="50fa" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">使用ngrok这样的服务真的很强大，最终可以加快开发过程。</p></div></div>    
</body>
</html>