<html>
<head>
<title>Eloquent Relationships Cheat Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">雄辩的关系备忘单</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/eloquent-relationships-cheat-sheet-5155498c209?source=collection_archive---------0-----------------------#2017-10-02">https://medium.com/hackernoon/eloquent-relationships-cheat-sheet-5155498c209?source=collection_archive---------0-----------------------#2017-10-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="5d95" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Laravel雄辩的ORM版本5.5的备忘单。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/1ca405ce9ae8129ee0945a88360c4b5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-jP5kV0P5HxSaHxMfaaCrg.png"/></div></div></figure><h1 id="228e" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">一对一的关系</h1><h2 id="ed27" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">演示详情:</h2><p id="85f1" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">在这个演示中，我们有2个模型(<strong class="it hv">车主</strong>和<strong class="it hv">汽车</strong>，以及2个表(<strong class="it hv">车主</strong>和<strong class="it hv">汽车</strong>)。</p><h2 id="a552" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">业务规则:</h2><p id="fb97" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">车主</strong>可以拥有一辆<strong class="it hv">车</strong>。<br/>汽车<strong class="it hv">可以归一个<strong class="it hv">车主</strong>所有。</strong></p><h2 id="d322" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系图:</h2><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff ls"><img src="../Images/7f7fce375deb879e09b8b50d32d258e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFtdOGZWSzepjFh5ar7bMw.png"/></div></div></figure><h2 id="e3a7" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系详情:</h2><p id="a9fc" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">汽车</strong>表应该存储<strong class="it hv">车主</strong>T21的ID 。</p><h2 id="f11d" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">雄辩的模型:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="267f" class="kz kc hu lu b fv ly lz l ma mb">class Owner<br/>{<br/>    public function car()<br/>    {<br/>       return $this-&gt;hasOne(Car::class);<br/>    }<br/>}</span><span id="ef87" class="kz kc hu lu b fv mc lz l ma mb">class Car<br/>{<br/>    public function owner()<br/>    {<br/>        return $this-&gt;belongsTo(Owner::class);<br/>    }<br/>}</span></pre><h2 id="53c8" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">数据库迁移:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="54f5" class="kz kc hu lu b fv ly lz l ma mb">Schema::create('owners', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="6d41" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('cars', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');</span><span id="cce5" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('owner_id')-&gt;unsigned()-&gt;index()-&gt;nullable();<br/>    $table-&gt;foreign('owner_id')-&gt;references('id')-&gt;on('owners');<br/>});</span></pre><h2 id="b0f7" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">商店记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="4e2c" class="kz kc hu lu b fv ly lz l ma mb">// Create relation between Owner and Car.</span><span id="f895" class="kz kc hu lu b fv mc lz l ma mb">$owner-&gt;car()-&gt;save($car);</span><span id="83e6" class="kz kc hu lu b fv mc lz l ma mb">// Create relation between Car and Owner.</span><span id="3f31" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;owner()-&gt;associate($owner)-&gt;save();</span></pre><h2 id="6f5d" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">检索记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="9f18" class="kz kc hu lu b fv ly lz l ma mb">// Get Owner Car</span><span id="69ce" class="kz kc hu lu b fv mc lz l ma mb">$owner-&gt;car;</span><span id="c809" class="kz kc hu lu b fv mc lz l ma mb">// Get Car Owner</span><span id="60d5" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;owner;</span></pre><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff md"><img src="../Images/15e71bdc79313ca6038c4b006fcaa220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbabAc-KzDLgbDbhSZDVKQ.png"/></div></div></figure><h1 id="f8c9" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">一对多关系</h1><h2 id="b6e0" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">演示详情:</h2><p id="8be8" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">在这个演示中，我们有2个模型(<strong class="it hv">小偷</strong>和<strong class="it hv">汽车</strong>)和2个桌子(<strong class="it hv">小偷</strong>和<strong class="it hv">汽车</strong>)。</p><h2 id="a6f6" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">业务规则:</h2><p id="2e82" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">这个<strong class="it hv">小偷</strong>可以偷很多<strong class="it hv">车</strong>。<br/>汽车<strong class="it hv">可以被一个<strong class="it hv">小偷</strong>偷走。</strong></p><h2 id="8249" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系图:</h2><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff me"><img src="../Images/0258737bcc723512d79e86a7e7c253cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cn4si4bSwFESO1zIjVT0FA.png"/></div></div></figure><h2 id="bb3f" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系详情:</h2><p id="52be" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">汽车</strong>表应该存储<strong class="it hv">小偷ID </strong>。</p><h2 id="6a10" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">雄辩的模型:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="2f80" class="kz kc hu lu b fv ly lz l ma mb">class Thief<br/>{<br/>    public function cars()<br/>    {<br/>       return $this-&gt;hasMany(Car::class);<br/>    }<br/>}</span><span id="054c" class="kz kc hu lu b fv mc lz l ma mb">class Car<br/>{<br/>    public function thief()<br/>    {<br/>        return $this-&gt;belongsTo(Thief::class);<br/>    }<br/>}</span></pre><h2 id="9a4d" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">数据库迁移:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="973b" class="kz kc hu lu b fv ly lz l ma mb">Schema::create('thieves', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="36fd" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('cars', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');</span><span id="bf6c" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('thief_id')-&gt;unsigned()-&gt;index()-&gt;nullable();<br/>    $table-&gt;foreign('thief_id')-&gt;references('id')-&gt;on('thieves');<br/>});</span></pre><h2 id="b717" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">商店记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="1954" class="kz kc hu lu b fv ly lz l ma mb">// Create relation between Thief and Car.</span><span id="5410" class="kz kc hu lu b fv mc lz l ma mb">$thief-&gt;cars()-&gt;saveMany([<br/>   $car1, <br/>   $car2,<br/>]);</span><span id="1c6c" class="kz kc hu lu b fv mc lz l ma mb">// Or use the save() function for single model.</span><span id="9a81" class="kz kc hu lu b fv mc lz l ma mb">$thief-&gt;cars()-&gt;save($car);</span><span id="cad8" class="kz kc hu lu b fv mc lz l ma mb">// Create relation between Car and Thief.</span><span id="e8e1" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;thief()-&gt;associate($thief)-&gt;save();</span></pre><h2 id="5231" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">检索记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="7797" class="kz kc hu lu b fv ly lz l ma mb">// Get Thief Car</span><span id="e5bc" class="kz kc hu lu b fv mc lz l ma mb">$thief-&gt;cars;</span><span id="6483" class="kz kc hu lu b fv mc lz l ma mb">// Get Car Thief</span><span id="7a21" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;thief;</span></pre><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff md"><img src="../Images/15e71bdc79313ca6038c4b006fcaa220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbabAc-KzDLgbDbhSZDVKQ.png"/></div></div></figure><h1 id="7be0" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">多态一对多关系</h1><h2 id="c53f" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">演示详情:</h2><p id="042e" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">在这个演示中，我们有3个模型(<strong class="it hv">男人、女人</strong>和<strong class="it hv">汽车)、</strong>和3张桌子(<strong class="it hv">男人</strong>、<strong class="it hv">女人</strong>和<strong class="it hv">汽车</strong>)。</p><h2 id="5026" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">业务规则:</h2><p id="8eb8" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">男</strong>(买家)可以买很多<strong class="it hv">车</strong>。<br/><strong class="it hv">女</strong>(买家)可以买很多<strong class="it hv">车</strong>。<br/><strong class="it hv">车</strong>可以由一个买家(<strong class="it hv">男</strong>或<strong class="it hv">女</strong>)购买。</p><h2 id="a71a" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系图:</h2><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mf"><img src="../Images/b7e9bd473e905b62f0a195da4c609c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L2hZC1MjrJG1qGAQSnunFQ.png"/></div></div></figure><h2 id="4d58" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系详情:</h2><p id="8170" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">汽车</strong>表应存储<strong class="it hv">买方ID </strong>和<strong class="it hv">买方类型</strong>。<br/> <em class="mg">“买手”是对一群模特(男女)的称呼。而且不限于两个。买家类型是模型的真实名称。</em></p><h2 id="faee" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">雄辩的模型:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="46e9" class="kz kc hu lu b fv ly lz l ma mb">class Man<br/>{<br/>    public function cars()<br/>    {<br/>        return $this-&gt;morphMany(Car::class, 'buyer');<br/>    }<br/>}</span><span id="b887" class="kz kc hu lu b fv mc lz l ma mb">class Woman<br/>{<br/>    public function cars()<br/>    {<br/>        return $this-&gt;morphMany(Car::class, 'buyer');<br/>    }<br/>}</span><span id="0bb4" class="kz kc hu lu b fv mc lz l ma mb">class Car<br/>{<br/>    public function buyer()<br/>    {<br/>        return $this-&gt;morphTo();<br/>    }<br/>}</span></pre><h2 id="b771" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">数据库迁移:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="4c9b" class="kz kc hu lu b fv ly lz l ma mb">Schema::create('men', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="9f15" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('women', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="e057" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('cars', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');</span><span id="0334" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('buyer_id')-&gt;unsigned()-&gt;index()-&gt;nullable();<br/>    $table-&gt;string('buyer_type')-&gt;nullable();   <br/>    // or use $table-&gt;morphs(‘buyer’); instead of "buyer_id" and "buyer_type"</span><span id="23e8" class="kz kc hu lu b fv mc lz l ma mb">});</span></pre><h2 id="b742" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">商店记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="f7f2" class="kz kc hu lu b fv ly lz l ma mb">// Create relation between buyer (Man/Woman) and Car.</span><span id="0463" class="kz kc hu lu b fv mc lz l ma mb">$man-&gt;cars()-&gt;saveMany([<br/>   $car1, <br/>   $car2,<br/>]);</span><span id="ea38" class="kz kc hu lu b fv mc lz l ma mb">$woman-&gt;cars()-&gt;saveMany([<br/>   $car1, <br/>   $car2,<br/>]);</span><span id="138f" class="kz kc hu lu b fv mc lz l ma mb">// Or use the save() function for single model.</span><span id="dfc0" class="kz kc hu lu b fv mc lz l ma mb">$man-&gt;cars()-&gt;save($car);<br/>$woman-&gt;cars()-&gt;save($car);</span><span id="a248" class="kz kc hu lu b fv mc lz l ma mb">// Create relation between Car and buyer (Men/Women).</span><span id="959a" class="kz kc hu lu b fv mc lz l ma mb">$car1-&gt;buyer()-&gt;associate($man)-&gt;save();<br/>$car2-&gt;buyer()-&gt;associate($woman)-&gt;save();</span></pre><h2 id="e59f" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">检索记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="4e75" class="kz kc hu lu b fv ly lz l ma mb">// Get buyer (Man/Woman) Cars</span><span id="51f5" class="kz kc hu lu b fv mc lz l ma mb">$men-&gt;cars<br/>$women-&gt;cars</span><span id="cdfc" class="kz kc hu lu b fv mc lz l ma mb">// Get Car buyer (Man and Woman)</span><span id="d4b1" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;buyer</span></pre><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff md"><img src="../Images/15e71bdc79313ca6038c4b006fcaa220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbabAc-KzDLgbDbhSZDVKQ.png"/></div></div></figure><h1 id="4204" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">多对多关系</h1><h2 id="497e" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">演示详情:</h2><p id="d283" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">在这个演示中，我们有2个模型(<strong class="it hv"> Driver </strong>和<strong class="it hv"> Car)、</strong>和3个表(<strong class="it hv"> drivers </strong>、<strong class="it hv"> cars </strong>和一个名为<strong class="it hv"> car_driver </strong>的数据透视表)。</p><h2 id="dc61" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">业务规则:</h2><p id="c682" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">司机</strong>可以开很多<strong class="it hv">车</strong>。<br/><strong class="it hv">车</strong>可以由很多<strong class="it hv">司机</strong>驾驶。</p><h2 id="db3b" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系图:</h2><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff me"><img src="../Images/c8f2cba389430760c4ce64981a2cbb85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uKuKvRNmAQecSGkaFW6Clw.png"/></div></div></figure><h2 id="1af7" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系详情:</h2><p id="ae3a" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv"> Pivot </strong>表“car_driver”应存储<strong class="it hv">司机ID </strong>和<strong class="it hv">汽车ID </strong>。</p><h2 id="9bc8" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">雄辩的模型:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="8c8e" class="kz kc hu lu b fv ly lz l ma mb">class Driver<br/>{<br/>    public function cars()<br/>    {<br/>       return $this-&gt;belongsToMany(Car::class);<br/>    }<br/>}</span><span id="292b" class="kz kc hu lu b fv mc lz l ma mb">class Car<br/>{<br/>    public function drivers()<br/>    {<br/>        return $this-&gt;belongsToMany(Driver::class);<br/>    }<br/>}</span></pre><h2 id="d5af" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">数据库迁移:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="9d37" class="kz kc hu lu b fv ly lz l ma mb">Schema::create('drivers', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="6570" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('cars', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="d3cf" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('car_driver', function (Blueprint $table) {<br/>    $table-&gt;increments('id');</span><span id="41d6" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('car_id')-&gt;unsigned()-&gt;index();<br/>    $table-&gt;foreign('car_id')-&gt;references('id')-&gt;on('cars')-&gt;onDelete('cascade');</span><span id="12a6" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('driver_id')-&gt;unsigned()-&gt;index();<br/>    $table-&gt;foreign('driver_id')-&gt;references('id')-&gt;on('drivers')-&gt;onDelete('cascade');<br/>});</span></pre><h2 id="2f6c" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">商店记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="0621" class="kz kc hu lu b fv ly lz l ma mb">// Create relation between Driver and Car.</span><span id="7076" class="kz kc hu lu b fv mc lz l ma mb">$driver-&gt;cars()-&gt;attach([<br/>   $car1-&gt;id,<br/>   $car2-&gt;id,<br/>]);</span><span id="881c" class="kz kc hu lu b fv mc lz l ma mb">// Or use the sync() function to prevent duplicated relations.</span><span id="634b" class="kz kc hu lu b fv mc lz l ma mb">$driver-&gt;cars()-&gt;sync([<br/>   $car1-&gt;id,<br/>   $car2-&gt;id,<br/>]);</span><span id="787c" class="kz kc hu lu b fv mc lz l ma mb">// Create relation between Car and Driver.</span><span id="d8bd" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;drivers()-&gt;attach([<br/>   $driver1-&gt;id,<br/>   $driver2-&gt;id,<br/>]);</span><span id="1985" class="kz kc hu lu b fv mc lz l ma mb">// Or use the sync() function to prevent duplicated relations.</span><span id="bc6a" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;drivers()-&gt;sync([<br/>   $driver1-&gt;id,<br/>   $driver2-&gt;id,<br/>]);</span></pre><h2 id="7031" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">检索记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="cdf5" class="kz kc hu lu b fv ly lz l ma mb">// Get Driver Car</span><span id="fff4" class="kz kc hu lu b fv mc lz l ma mb">$driver-&gt;cars</span><span id="0429" class="kz kc hu lu b fv mc lz l ma mb">// Get Car Drivers</span><span id="ffe6" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;drivers</span></pre><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff md"><img src="../Images/15e71bdc79313ca6038c4b006fcaa220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbabAc-KzDLgbDbhSZDVKQ.png"/></div></div></figure><h1 id="bfcf" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">多态多对多关系</h1><h2 id="7ee2" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">演示详情:</h2><p id="eb2c" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">在这个演示中，我们有3个模型(<strong class="it hv">代客、车主</strong>和<strong class="it hv">汽车)、</strong>和4个表(<strong class="it hv">侍者</strong>、<strong class="it hv">车主、</strong> <strong class="it hv">汽车</strong>和<strong class="it hv">司机</strong>)。</p><h2 id="dd1d" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">业务规则:</h2><p id="38eb" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">代客</strong>(司机)可以开多辆<strong class="it hv">车</strong>。<br/><strong class="it hv">车主</strong>(司机)可以开多辆<strong class="it hv">车</strong>。<br/><strong class="it hv">车</strong>可由多名司机驾驶(<strong class="it hv">代客</strong>或/和<strong class="it hv">车主</strong>)。</p><h2 id="992d" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系图:</h2><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mf"><img src="../Images/eab3ecb594493eb08326aa13aebaa934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6ZvI_fdPZWWIfJb5rN0kQ.png"/></div></div></figure><h2 id="a216" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">关系详情:</h2><p id="a3d9" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated"><strong class="it hv">枢轴</strong>表“司机”应存储<strong class="it hv">司机</strong> <strong class="it hv"> ID </strong>、<strong class="it hv">司机</strong> <strong class="it hv">类型</strong>和<strong class="it hv">小车</strong> <strong class="it hv"> ID </strong>。<br/> <em class="mg">“司机”是对一群模特(代客和车主)的称呼。而且不限于两个。驱动类型是模型的真实名称。</em></p><h2 id="5783" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">雄辩的模型:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="1c05" class="kz kc hu lu b fv ly lz l ma mb">class Valet<br/>{<br/>    public function cars()<br/>    {<br/>        return $this-&gt;morphToMany(Car::class, 'driver');<br/>    }<br/>}</span><span id="0cbc" class="kz kc hu lu b fv mc lz l ma mb">class Owner<br/>{<br/>    public function cars()<br/>    {<br/>        return $this-&gt;morphToMany(Car::class, 'driver');<br/>    }<br/>}</span><span id="25ea" class="kz kc hu lu b fv mc lz l ma mb">class Car<br/>{<br/>    public function valets()<br/>    {<br/>        return $this-&gt;morphedByMany(Valet::class, 'driver');<br/>    }<br/><br/>    public function owners()<br/>    {<br/>        return $this-&gt;morphedByMany(Owner::class, 'driver');<br/>    }<br/>}</span></pre><h2 id="cd1c" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">数据库迁移:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="2417" class="kz kc hu lu b fv ly lz l ma mb">Schema::create('valets', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="b508" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('owners', function (Blueprint $table) {<br/>    $table-&gt;increments('id');<br/>    $table-&gt;string('name');<br/>});</span><span id="cb4a" class="kz kc hu lu b fv mc lz l ma mb">Schema::create('drivers', function (Blueprint $table) {<br/>    $table-&gt;increments('id');</span><span id="fa4e" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('driver_id')-&gt;unsigned()-&gt;index();<br/>    $table-&gt;string('driver_type');<br/>    // or use $table-&gt;morphs(‘driver’); instead of "driver_id" and "driver_type"</span><span id="8151" class="kz kc hu lu b fv mc lz l ma mb">    $table-&gt;integer('car_id')-&gt;unsigned()-&gt;index();<br/>    $table-&gt;foreign('car_id')-&gt;references('id')-&gt;on('cars')-&gt;onDelete('cascade');<br/>});</span></pre><h2 id="a4a8" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">商店记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="0d26" class="kz kc hu lu b fv ly lz l ma mb">// Create relation between driver (Valet/Owner) and Car.</span><span id="7519" class="kz kc hu lu b fv mc lz l ma mb">$valet-&gt;cars()-&gt;saveMany([$car1, $car2]);<br/>$owner-&gt;cars()-&gt;saveMany([$car1, $car2]);</span><span id="56a8" class="kz kc hu lu b fv mc lz l ma mb">// Or use the save() function for single model.</span><span id="69e5" class="kz kc hu lu b fv mc lz l ma mb">$valet-&gt;cars()-&gt;save($car1);<br/>$owner-&gt;cars()-&gt;save($car1);</span><span id="c224" class="kz kc hu lu b fv mc lz l ma mb">// Create relation between Car and driver (Valet/Owner).</span><span id="0ffc" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;valets()-&gt;attach([<br/>    $valet1-&gt;id,<br/>    $valet2-&gt;id,<br/>]);</span><span id="bf81" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;owners()-&gt;attach([<br/>    $owner1-&gt;id,<br/>    $owner2-&gt;id,<br/>]);</span><span id="efed" class="kz kc hu lu b fv mc lz l ma mb">// Or use the sync() function to prevent duplicated relations.</span><span id="3361" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;valets()-&gt;sync([<br/>    $valet1-&gt;id,<br/>    $valet2-&gt;id,<br/>]);</span><span id="2637" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;owners()-&gt;sync([<br/>    $owner1-&gt;id,<br/>    $owner2-&gt;id,<br/>]);</span></pre><h2 id="d513" class="kz kc hu bd kd la lb lc kh ld le lf kl jc lg lh kp jg li lj kt jk lk ll kx lm dt translated">检索记录:</h2><pre class="jq jr js jt fq lt lu lv lw aw lx dt"><span id="7f3c" class="kz kc hu lu b fv ly lz l ma mb">// Get driver (Valet/Owner) Cars</span><span id="8520" class="kz kc hu lu b fv mc lz l ma mb">$valet-&gt;cars<br/>$owner-&gt;cars</span><span id="1ce8" class="kz kc hu lu b fv mc lz l ma mb">// Get Car drivers (Valet and Owner)</span><span id="5cbb" class="kz kc hu lu b fv mc lz l ma mb">$car-&gt;owners<br/>$car-&gt;valets</span></pre><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff md"><img src="../Images/15e71bdc79313ca6038c4b006fcaa220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IbabAc-KzDLgbDbhSZDVKQ.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mh"><img src="../Images/1b6a7ee369d64de930849aefce75e037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LriA7vihVqVkPNrcyrdFvw.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mi"><img src="../Images/ec20af6d4ef1b8ac74ead34281728610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OARc0XRynFzeJbO2CthwA.png"/></div></div></figure></div><div class="ab cl mj mk hc ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hn ho hp hq hr"><blockquote class="mq mr ms"><p id="943f" class="ir is mg it b iu iv iw ix iy iz ja jb mt jd je jf mu jh ji jj mv jl jm jn jo hn dt translated"><strong class="it hv">在推特上关注我</strong> <a class="ae mw" href="https://twitter.com/Mahmoud_Zalt" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">马哈茂德·扎尔特</strong> </a> <strong class="it hv">。</strong></p></blockquote></div></div>    
</body>
</html>