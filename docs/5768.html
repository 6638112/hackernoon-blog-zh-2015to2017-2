<html>
<head>
<title>[Express.js] Measuring performance of HTTP Request</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[Express.js]测量HTTP请求的性能</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/express-js-measuring-performance-of-http-request-nodejs-javascript-react-redux-testing-time-speed-web-f7b7ceb6f586?source=collection_archive---------14-----------------------#2017-08-15">https://medium.com/hackernoon/express-js-measuring-performance-of-http-request-nodejs-javascript-react-redux-testing-time-speed-web-f7b7ceb6f586?source=collection_archive---------14-----------------------#2017-08-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/30f8c9f22f60cb8191548031eee0f7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xWwb3fCeJOO3B-4Mo1E8g.png"/></div></div></figure><p id="9f7a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ka kb kc kd b">express-watcher</code>是一个监控快速路由器的中间件，帮助观察R <strong class="je hv">响应时间</strong>、<strong class="je hv"> RAM、堆内存</strong>和<strong class="je hv"> CPU </strong>的信息。</p><p id="febb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在开发同构应用程序(React-Redux-ServerRendering)的过程中，跟踪性能问题变得越来越困难，因为性能会受到很多因素的影响:<br/> — Express服务器性能<br/> — API <br/> —组件设计(React) <br/> —算法<br/> —浏览器性能</p><p id="ebac" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个帮助我在开发阶段(<strong class="je hv">不是生产阶段)发现性能问题的工具！！！</strong>)。</p><h1 id="0faa" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">安装</h1><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="b582" class="lk kf hu kd b fv ll lm l ln lo">$ npm install --save express-watcher</span></pre><h1 id="0200" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">使用</h1><p id="1855" class="pw-post-body-paragraph jc jd hu je b jf lp jh ji jj lq jl jm jn lr jp jq jr ls jt ju jv lt jx jy jz hn dt translated">打印每个请求</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="1372" class="lk kf hu kd b fv ll lm l ln lo"><strong class="kd hv">var resourceMonitorMiddleware = require('express-watcher').resourceMonitorMiddleware</strong></span><span id="8225" class="lk kf hu kd b fv lu lm l ln lo"><em class="lv">// example without callback function</em></span><span id="4373" class="lk kf hu kd b fv lu lm l ln lo"><strong class="kd hv">app.use(resourceMonitorMiddleware)</strong></span></pre><p id="3923" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从每个请求中获取监控数据</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="6122" class="lk kf hu kd b fv ll lm l ln lo"><strong class="kd hv">var resourceMonitorMiddlewareCB = require('express-watcher').resourceMonitorMiddlewareCB</strong></span><span id="500c" class="lk kf hu kd b fv lu lm l ln lo"><em class="lv">// example with callback function</em></span><span id="23f3" class="lk kf hu kd b fv lu lm l ln lo">app.use(function(req, res, next){</span><span id="7c69" class="lk kf hu kd b fv lu lm l ln lo"><strong class="kd hv">resourceMonitorMiddlewareCB(req, res, next, function(diffJson){<br/>      console.log(' diffJson : ', diffJson)<br/>   })<br/>}</strong>)</span></pre></div><div class="ab cl lw lx hc ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hn ho hp hq hr"><h2 id="3517" class="lk kf hu bd kg md me mf kk mg mh mi ko jn mj mk ks jr ml mm kw jv mn mo la mp dt translated">1-监控每个响应</h2><p id="635f" class="pw-post-body-paragraph jc jd hu je b jf lp jh ji jj lq jl jm jn lr jp jq jr ls jt ju jv lt jx jy jz hn dt translated">将对象作为回调返回:</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="32e2" class="lk kf hu kd b fv ll lm l ln lo">{ diffRss: 0.0078125,<br/>  diffHeapTotal: 0,<br/>  diffHeapUsed: 0.012725830078125,<br/>  diffExternal: 0,<br/>  diffCpu: 0.000427 }</span></pre><p id="223d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和自动打印:</p><figure class="lc ld le lf fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/607ccb0e5da97085a16cd28b4b364220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/0*kEHSq4x4Hah8CqZg.png"/></div></figure><h2 id="0f8a" class="lk kf hu bd kg md me mf kk mg mh mi ko jn mj mk ks jr ml mm kw jv mn mo la mp dt translated">2-监控所有时间高位信息</h2><p id="88e1" class="pw-post-body-paragraph jc jd hu je b jf lp jh ji jj lq jl jm jn lr jp jq jr ls jt ju jv lt jx jy jz hn dt translated">关闭(CRT+c)节点过程时，打印所有高电平信息</p><p id="8be6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和自动打印:</p><figure class="lc ld le lf fq iv fe ff paragraph-image"><div class="fe ff mr"><img src="../Images/dbaa6eefc25988b062ea4c5f9b25584f.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/0*jIBm8to7R18FkkeA.png"/></div></figure><h1 id="4e6a" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">参考</h1><p id="882d" class="pw-post-body-paragraph jc jd hu je b jf lp jh ji jj lq jl jm jn lr jp jq jr ls jt ju jv lt jx jy jz hn dt translated"><a class="ae ms" href="https://www.npmjs.com/package/js-meter" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/js-meter</a></p><p id="9a23" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ms" href="https://www.npmjs.com/package/express-watcher" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/express-watcher</a></p></div></div>    
</body>
</html>