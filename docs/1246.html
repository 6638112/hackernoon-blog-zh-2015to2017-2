<html>
<head>
<title>What I learnt from building a chatbot without a framework (Part 1/2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我从构建一个没有框架的聊天机器人中学到了什么(第1/2部分)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/what-i-learnt-from-building-a-chatbot-without-a-framework-part-1-2-438ef9f4dab3?source=collection_archive---------1-----------------------#2016-10-01">https://medium.com/hackernoon/what-i-learnt-from-building-a-chatbot-without-a-framework-part-1-2-438ef9f4dab3?source=collection_archive---------1-----------------------#2016-10-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/3355367043592ab1db33d77d65c6ed67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kPEcJu6p_XBnULcRgw7qPQ.jpeg"/></div></div></figure><p id="1d72" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不通过外部的bot构建框架，直接将bot与bot API连接起来具有巨大的学习价值。</p><p id="4e18" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了提供一些背景，我构建的聊天机器人向用户发送每日Twitter动态。你不需要推特来使用它。如果你有一个Twitter账户，它可以作为你Twitter体验的补充，因为它向你传达的趋势是特定国家的。</p><h1 id="31bd" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated"><strong class="ak">我学到了很多关于某个平台上可能的交互的知识</strong></h1><p id="2f29" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">当聊天机器人和用户只能用明文交流时，这就相当简单了。然而，不同的聊天平台，如Facebook Messenger、Kik或Telegram，提供了不同的功能和交互，从本质上改变了用户体验。</p><p id="98b9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">了解什么是可能的最好方法是直接尝试他们的bot API，而不需要通过外部框架或库。</p><p id="f8d3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，Telegram有一个独特的内嵌查询功能，用户只需输入“@bot_name ..”从任何聊天中得到一些结果。因此，用户并不总是必须开始与机器人的私人聊天才能从中受益。</p><p id="3877" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦提交了查询，机器人就可以处理它并生成一个结果列表，结果列表可以用多种方式格式化。当用户选择一个结果时，消息将被发送到聊天室。出于性能原因，Telegram支持延迟加载和缓存。</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div class="fe ff ld"><img src="../Images/635ee2946792af59dfcc7b38b7c461d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*51jyhtU_l2dXGMxkvcvRyQ.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">A sample list of inline query results</figcaption></figure><p id="31ee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当我完成我的机器人时，我意识到仅仅给用户发送一份Twitter趋势列表是不够的。毕竟，用户可能希望看到与某个热门话题相关的推文，一种方法是通过特定的链接将用户导向Twitter。</p><p id="a033" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">谢天谢地，我发现Telegram API支持带有HTML <a>标签的自定义超链接，所以我可以让消息非常简洁！用户只需点击某个趋势，就可以打开Twitter，查看与之相关的推文。</a></p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/3bbb6aa3f174d9ed8f024336895115da.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*7V1pS1ENIDuH-F1U5lFn7w.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">A list of trends with selectable hyperlinks</figcaption></figure><p id="ea40" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">相比之下，Facebook Messenger目前不支持自定义超链接。如果我决定在Messenger中实现这个机器人，我可能必须分别显示趋势和它们的URL，这将导致一个非常长的消息。</p><p id="4237" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，不同的平台提供不同的功能和交互。了解它的最好方法是尝试一下。当您需要优化不同平台上的用户体验时，这从长远来看可能会带来巨大的好处。</p><h1 id="1866" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">我了解了服务信息</h1><p id="5650" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">我以为只有用户可以给我的机器人发消息。</p><p id="2117" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是，我惊讶地收到了不是用户直接发来的消息！这些消息被称为服务消息，本质上是管理性的。</p><p id="a72e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我意识到处理这些服务消息是有价值的。例如，当任何人(包括我的机器人)加入一个聊天组时，我会收到来自平台的服务消息，表明他是谁。如果是我的机器人加入了群组，我会发送介绍性消息作为回复，而不需要等待用户说“/开始”。相反，如果我的机器人被逐出一个聊天组，我会知道，并可以将该服务消息视为“/stop”消息。</p><h1 id="40ac" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">我处理了用户停止我的机器人的不同方式</h1><p id="c394" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">我通知用户，如果他们想取消订阅每日更新，就发送“/stop”。然而，我了解到并不是每个用户都会发送这条消息。</p><p id="d3d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Telegram聊天客户端允许用户停止聊天，方法是按住聊天，然后选择“删除并停止”。不幸的是，当这种情况发生时，我没有收到服务信息。当我试图向该用户发送每日更新时，Telegram会回复“403禁止，Bot被用户阻止”。</p><p id="7260" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我通过从订阅者列表中删除用户来处理这个错误，直到用户决定再次订阅。因此，我可以节省未来的服务器资源，因为我不会再尝试向该用户发送更新。此外，它允许我保持一个准确的用户数量计数。</p><h1 id="491a" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">框架呢？</h1><p id="a395" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">我还没有试过使用。然而，这些是我对bot框架的初步想法，纯粹是就其与各种聊天平台的API的接口能力而言。</p><p id="eb76" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">虽然最初使用框架可能会节省一些时间，但它们确实会带来一层复杂性，并且有各种限制。例如，由于框架需要相当通用以迎合许多用例，所以它们附带了您可能不需要的功能。它们可能不支持特定平台的所有API特性。</p><p id="8359" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">没有框架，我们仍然可以通过拥有良好的<a class="ae ln" href="https://hackernoon.com/tagged/software" rel="noopener ugc nofollow" target="_blank">软件</a>架构来构建一个支持多平台的bot。解析接收到的消息并发回自定义响应的接口需要是特定于平台的，但其他组件(如数据库和文本解释)可以是通用模块。因此，我们可以完全控制如何使用每个平台的API来获得最佳的用户体验。<a class="ae ln" href="https://hackernoon.com/tagged/furthermore" rel="noopener ugc nofollow" target="_blank">此外</a>，我们可以为我们想要使用的特性编写足够的代码。</p><p id="3926" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">虽然有更多的前期成本，但代码仍然是服务器端的。因此，支持两个聊天平台并不像支持原生Android和iOS应用程序那样昂贵。</p><p id="2ec3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就像在bot建设者之前出现的网站建设者和应用建设者一样，要意识到利弊。不要觉得一定要用！</p><h1 id="8129" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">结束第1/2部分</h1><p id="c70b" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在构建我的聊天机器人时，没有使用机器人框架，我了解了在我选择的平台上可能的不同交互，不同种类的消息，以及用户可以停止机器人的不同方式。因此，我对该平台的真正功能有了更好的了解。如果我最终使用跨平台框架，我会对它的局限性有更好的认识。</p><p id="8962" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在第2部分中，我将分享更多关于解析消息、处理时区和处理边界情况的内容。点击此处查看<a class="ae ln" rel="noopener" href="/@kevinze/what-i-learnt-from-building-a-chatbot-without-a-framework-part-2-2-61f4d8f6c644">第二部分</a>！</p><h2 id="2d58" class="lo kb hu bd kc lp lq lr kg ls lt lu kk jn lv lw ko jr lx ly ks jv lz ma kw mb dt translated">如果你觉得这篇文章很有见地，并希望看到更多，请❤和关注我！</h2><div class="le lf lg lh fq ab cb"><figure class="mc iv md me mf mg mh paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mc iv md me mf mg mh paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mc iv md me mf mg mh paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mi mj mk"><p id="f922" class="jc jd ml je b jf jg jh ji jj jk jl jm mm jo jp jq mn js jt ju mo jw jx jy jz hn dt translated"><a class="ae ln" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ln" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ln" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ln" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd ml je b jf jg jh ji jj jk jl jm mm jo jp jq mn js jt ju mo jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ln" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ln" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="le lf lg lh fq iv fe ff paragraph-image"><a href="https://goo.gl/Ahtev1"><div class="fe ff mp"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></a></figure><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="mq mr l"/></div></figure></div></div>    
</body>
</html>