<html>
<head>
<title>Let’s Build a Web App with Vue, Chart.js and an API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们用Vue、Chart.js和一个API来构建一个Web应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/lets-build-a-web-app-with-vue-chart-js-and-an-api-544eb81c4b44?source=collection_archive---------0-----------------------#2017-04-19">https://medium.com/hackernoon/lets-build-a-web-app-with-vue-chart-js-and-an-api-544eb81c4b44?source=collection_archive---------0-----------------------#2017-04-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/52b61af426f5313cebc94ebf31997676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dNalUVozyJe65knA-BrZow.png"/></div></div></figure><div class=""/><div class=""><h2 id="ec87" class="pw-subtitle-paragraph jc ie if bd b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ek translated">构建一个小型web应用程序的第一部分，它与npm API交互并生成漂亮的图表</h2></div><p id="f8ca" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">数据是美好的。借助现代技术，可视化数据和创造美好体验变得异常容易。在这份快速指南中，我们将介绍如何与国家预防机制互动💘API来获取一个包的下载统计数据，并用<a class="ae kq" href="http://www.chartjs.org/" rel="noopener ugc nofollow" target="_blank"> Chart.js </a>从这些数据中生成一个图表</p><h1 id="9c9d" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">⚡快速入门</h1><p id="bc45" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">我们将构建<a class="ae kq" href="http://npm-stats.org/" rel="noopener ugc nofollow" target="_blank">npm-stats.org</a>，并将使用以下工具:</p><ul class=""><li id="57aa" class="lo lp if jw b jx jy ka kb kd lq kh lr kl ls kp lt lu lv lw dt translated"><a class="ae kq" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>带<code class="eh lx ly lz ma b">vue-router</code></li><li id="1c93" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated"><a class="ae kq" href="http://www.chartjs.org/" rel="noopener ugc nofollow" target="_blank"> Chart.js </a></li><li id="3b48" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated"><a class="ae kq" href="http://vue-chartjs.org/#/" rel="noopener ugc nofollow" target="_blank"> vue-chartjs </a></li><li id="7052" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated"><a class="ae kq" href="https://github.com/vuejs/vue-cli" rel="noopener ugc nofollow" target="_blank"> vue-cli </a></li><li id="5e85" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated"><a class="ae kq" href="https://github.com/mzabriskie/axios" rel="noopener ugc nofollow" target="_blank"> axios </a></li></ul><p id="caf1" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">使用Vue.js，我们将构建应用程序的基本接口，并使用<code class="eh lx ly lz ma b">vue-router</code>进行路由。我们用<a class="ae kq" href="https://github.com/vuejs/vue-cli" rel="noopener ugc nofollow" target="_blank"> vue-cli </a>搭建我们的项目，这创建了我们的基本项目结构。对于图表生成，我们将使用Chart.js，并将其作为Vue的包装器，<a class="ae kq" href="http://vue-chartjs.org/#/" rel="noopener ugc nofollow" target="_blank"> vue-chartjs </a>。因为我们需要与API交互，所以我们使用<a class="ae kq" href="https://github.com/mzabriskie/axios" rel="noopener ugc nofollow" target="_blank"> axios </a>来发出http请求。然而，你可以随意将这个库与其他库交换。</p><h1 id="eb7b" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">🔧安装和设置</h1><p id="4efb" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">首先，我们需要安装vue-cli来支撑我们的项目。我希望您已经安装了node和npm的最新版本！🙏如果你安装了<a class="ae kq" href="https://yarnpkg.com/lang/en/" rel="noopener ugc nofollow" target="_blank">纱线</a>就更好了！如果没有，你真的应该！如果你不想要，就用npm的等价物替换掉yarn命令。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="410a" class="mo ks if ma b fv mp mq l mr ms">$ npm install -g vue-cli</span></pre><p id="6053" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">然后我们可以用vue-cli搭建我们的项目。如果你想可以启用单元和e2e测试，但是我们不会覆盖它们。🔥但是你需要检查vue路由器！</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="d5ca" class="mo ks if ma b fv mp mq l mr ms">$ vue init webpack npm-stats</span></pre><p id="dad9" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">然后，我们将cd放入我们的项目文件夹，并安装带有<code class="eh lx ly lz ma b">cd npm-stats &amp;&amp; yarn install</code>的依赖项。这样，我们的基本项目依赖项就安装好了。现在我们需要为我们的应用程序添加一个。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="2e1d" class="mo ks if ma b fv mp mq l mr ms">$ yarn add vue-chartjs chart.js axios</span></pre><p id="6d60" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">快速检查一下<code class="eh lx ly lz ma b">yarn run dev</code>是否一切正常。现在我们应该看到vue的样板页面。</p><p id="c021" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我们完事了。👏</p><h1 id="1d21" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">💪是时候建造了</h1><p id="681a" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">这里只是一个小小的免责声明，我不会把重点放在造型上。我想你可以自己让网站看起来更好💅所以我们只涉及javascript相关的代码。</p><p id="c3cd" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">另一个免责声明，这是一个相当小的MVP，然后现在超级干净的代码。我将在后面的阶段重构其中的一些。就像在现实世界里一样。</p><h2 id="382d" class="mo ks if bd kt mt mu mv kx mw mx my lb kd mz na ld kh nb nc lf kl nd ne lh nf dt translated">成分</h2><p id="e149" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">让我们想想我们需要什么组件。正如我们在屏幕截图中看到的，我们看到了一个输入您正在寻找的包名的输入框和一个按钮。可能是页眉和页脚以及图表本身。</p><p id="f6f5" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">你完全可以把按钮和输入框做成一个组件，但是我们并没有构建一个复杂的应用程序，为什么要这么麻烦呢？简单点。让它工作！</p><p id="e8a2" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">所以我最后用了以下组件:</p><ul class=""><li id="47f7" class="lo lp if jw b jx jy ka kb kd lq kh lr kl ls kp lt lu lv lw dt translated">components/Footer.vue</li><li id="9bd3" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">组件/Header.vue</li><li id="3852" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">components/LineChart.vue</li><li id="83d2" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">页面/Start.vue</li></ul><p id="0225" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我将跳过<em class="ng">页眉</em>和<em class="ng">页脚</em>，因为它们只包含徽标和一些链接。这里没什么特别的。<em class="ng">线图</em>和<em class="ng">开始</em>页面是重要的页面。</p><h2 id="3e22" class="mo ks if bd kt mt mu mv kx mw mx my lb kd mz na ld kh nb nc lf kl nd ne lh nf dt translated">折线图</h2><p id="4fc7" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">LineChart组件将是我们呈现图表的chart.js实例。我们需要导入Line组件并扩展它。我们现在创建两个道具。一个是数据，即下载次数，另一个是标签，例如日、周、年。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="8767" class="mo ks if ma b fv mp mq l mr ms">props: {<br/> chartData: {<br/>   type: Array,<br/>   required: false<br/> },<br/> chartLabels: {<br/>   type: Array,<br/>   required: true<br/> }<br/>},</span></pre><p id="8a44" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">因为我们希望所有的图表看起来都一样，所以我们在数据模型中定义了一些Chart.js样式选项，这些选项作为<em class="ng">选项</em>传递给<strong class="jw ig"> renderChart() </strong>方法。</p><p id="9586" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">因为我们现在只有一个数据集，所以我们可以构建数据集数组并绑定标签和数据。</p><figure class="mg mh mi mj fq hw"><div class="bz el l di"><div class="nh ni l"/></div></figure><h1 id="25e2" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">📺我们的开始页面</h1><p id="7729" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">因为我们的折线图组件已经启动并开始工作。是时候构建其余部分了。我们需要一个输入字段和按钮来提交包名。然后请求数据并将数据传递给我们的图表组件。</p><p id="82b3" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">所以，我们先想想我们需要什么数据，什么状态/数据模型。首先，我们需要一个<code class="eh lx ly lz ma b">package</code>数据模型，我们将在输入字段中使用<code class="eh lx ly lz ma b">v-model</code>。我们还希望将包的名称显示为标题。所以<code class="eh lx ly lz ma b">packageName</code>会很好。然后我们的两个数组用于请求的数据<code class="eh lx ly lz ma b">downloads</code>和<code class="eh lx ly lz ma b">labels</code>，当我们请求一个时间段时，我们需要设置<code class="eh lx ly lz ma b">period</code>。但是，也许请求出错了，所以我们需要<code class="eh lx ly lz ma b">errorMessage</code>和<code class="eh lx ly lz ma b">showError</code>。最后但同样重要的是<code class="eh lx ly lz ma b">loaded</code>，因为我们希望仅在请求发出后才显示图表。</p><h2 id="3847" class="mo ks if bd kt mt mu mv kx mw mx my lb kd mz na ld kh nb nc lf kl nd ne lh nf dt translated">npm API</h2><p id="ec1b" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">有各种端点可以下载一个包。一个是例如</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="f34f" class="mo ks if ma b fv mp mq l mr ms">GET <a class="ae kq" href="https://api.npmjs.org/downloads/point/%7Bperiod%7D%5B/%7Bpackage%7D%5D" rel="noopener ugc nofollow" target="_blank">https://api.npmjs.org/downloads/point/{period}[/{package}]</a></span></pre><p id="f573" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">然而，这个只有一个点的价值。所以总下载量。但是要绘制我们的酷图，我们需要更多的数据。所以我们需要范围端点。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="e3a1" class="mo ks if ma b fv mp mq l mr ms">GET <a class="ae kq" href="https://api.npmjs.org/downloads/range/%7Bperiod%7D%5B/%7Bpackage%7D%5D" rel="noopener ugc nofollow" target="_blank">https://api.npmjs.org/downloads/range/{period}[/{package}]</a></span></pre><p id="3fb2" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">周期可以定义为例如<code class="eh lx ly lz ma b">last-day</code>或<code class="eh lx ly lz ma b">last-month</code>或特定的日期范围<code class="eh lx ly lz ma b">2017-01-01:2017-04-19</code>，但是为了简单起见，我们将默认值设置为<code class="eh lx ly lz ma b">last-month</code>。在第二部分的后面，我们可以添加一些日期输入字段，以便用户可以设置日期范围。</p><p id="4d20" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">所以我们的数据模型看起来像这样:</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="4721" class="mo ks if ma b fv mp mq l mr ms">data () {<br/> return {<br/>  package: null,<br/>  packageName: ‘’,<br/>  period: ‘last-month’,<br/>  loaded: false,<br/>  downloads: [],<br/>  labels: [],<br/>  showError: false,<br/>  errorMessage: ‘Please enter a package name’<br/> }<br/>},</span></pre><h1 id="e623" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">💅模板</h1><p id="bf11" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">现在是时候构建模板了。我们需要5样东西:</p><ul class=""><li id="0560" class="lo lp if jw b jx jy ka kb kd lq kh lr kl ls kp lt lu lv lw dt translated">输入栏</li><li id="ee7d" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">按钮来触发搜索</li><li id="b456" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">错误消息输出</li><li id="1642" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">带有包名的标题</li><li id="3c07" class="lo lp if jw b jx mb ka mc kd md kh me kl mf kp lt lu lv lw dt translated">我们的图表。</li></ul><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="0d17" class="mo ks if ma b fv mp mq l mr ms">&lt;input<br/> class=”Search__input”<br/> <a class="ae kq" href="http://twitter.com/keyup" rel="noopener ugc nofollow" target="_blank">@keyup</a>.enter=”requestData”<br/> placeholder=”npm package name”<br/> type=”search” name=”search”<br/> v-model=”package”<br/> &gt;<br/>&lt;button class=”Search__button” <a class="ae kq" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>=”requestData”&gt;Find&lt;/button&gt;</span><span id="4fde" class="mo ks if ma b fv nj mq l mr ms">&lt;div class="error-message" v-if="showError"&gt;<br/>  {{ errorMessage }}<br/>&lt;/div&gt;</span><span id="97fd" class="mo ks if ma b fv nj mq l mr ms">&lt;h1 class="title" v-if="loaded"&gt;{{ packageName }}&lt;/h1&gt;<br/>&lt;line-chart v-if="loaded" :chart-data="downloads" :chart-labels="labels"&gt;&lt;/line-chart&gt;</span></pre><p id="2515" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">暂时忽略css类。我们的输入字段在输入时有一个keyup事件。所以如果你按下回车键，你就触发了<code class="eh lx ly lz ma b">requestData()</code>方法。我们将<code class="eh lx ly lz ma b">v-model</code>绑定到<code class="eh lx ly lz ma b">package</code></p><p id="7dd5" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">对于潜在的错误，我们有一个条件，只有当<code class="eh lx ly lz ma b">showError</code>为<em class="ng">真</em>时，我们才显示消息。可能出现两种类型的错误。一种是，有人试图在不输入任何名称的情况下搜索包裹，或者他输入了一个不存在的名称。</p><p id="af61" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">对于第一种情况，我们有默认的错误消息，对于第二种情况，我们将获取来自请求的错误消息。</p><p id="ab26" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">因此，我们的完整模板将如下所示:</p><figure class="mg mh mi mj fq hw"><div class="bz el l di"><div class="nh ni l"/></div></figure><h1 id="9adb" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">🤖java描述语言</h1><p id="cf40" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">现在是编码的时候了。首先我们将做我们的<code class="eh lx ly lz ma b">requestData()</code>方法。这相当简单。我们需要向端点发出请求，然后映射传入的数据。在我们的<strong class="jw ig"> response.data </strong>中，我们有一些关于这个包的信息:</p><figure class="mg mh mi mj fq hw fe ff paragraph-image"><div class="fe ff nk"><img src="../Images/8950b3648003c14f6fe23436e0a30afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*UB5wPbn6UMGZmWa1O7xiBQ.png"/></div><figcaption class="nl nm fg fe ff nn no bd b be z ek">response.data</figcaption></figure><p id="1657" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">比如开始日期、结束日期、包名和下载数组。然而，下载数组的结构是这样的:</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="1b9a" class="mo ks if ma b fv mp mq l mr ms">downloads: [<br/> {day: ‘2017–03–20’, downloads: ‘3’},<br/> {day: ‘2017–03–21’, downloads: ‘2’},<br/> {day: ‘2017–03–22’, downloads: ‘10’},<br/>]</span></pre><p id="54fa" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">但是我们需要将下载和日期分开，因为对于chart.js，我们只需要一个包含数据(下载)的数组和一个包含标签(日期)的数组。这是一个简单的工作<strong class="jw ig">地图</strong></p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="9e91" class="mo ks if ma b fv mp mq l mr ms">requestData () {<br/> axios.get(`<a class="ae kq" href="https://api.npmjs.org/downloads/range/${this.period}/${this.package}`" rel="noopener ugc nofollow" target="_blank">https://api.npmjs.org/downloads/range/${this.period}/${this.package}`</a>)<br/> .then(response =&gt; {<br/>   this.downloads = response.data.downloads.map(download =&gt; download.downloads)<br/>   this.labels = response.data.downloads.map(download =&gt; download.day)<br/>   this.packageName = response.data.package<br/>   this.loaded = true<br/> })<br/> .catch(err =&gt; {<br/>   this.errorMessage = err.response.data.error<br/>   this.showError = true<br/> })<br/>}</span></pre><p id="5a6d" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">现在，如果我们输入一个包名，比如vue并按enter键，就会发出请求，映射数据并呈现图表！但是等等。你什么也没看见。因为我们需要告诉vue-router为我们的起始页设置索引。</p><p id="bfbc" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在<code class="eh lx ly lz ma b">router/index.js</code>下，我们导入或寻呼并告诉路由器使用它</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="4f18" class="mo ks if ma b fv mp mq l mr ms">import Vue from ‘vue’<br/>import Router from ‘vue-router’<br/>import StartPage from ‘@/pages/Start’</span><span id="308a" class="mo ks if ma b fv nj mq l mr ms">Vue.use(Router)</span><span id="5522" class="mo ks if ma b fv nj mq l mr ms">export default new Router({<br/> routes: [<br/>   {<br/>     path: ‘/’,<br/>     name: ‘Start’,<br/>     component: StartPage<br/>   },<br/> ]<br/>})</span></pre><h1 id="7cc8" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">💎抛光剂</h1><p id="8f24" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">但是，我们还没有完成。我们有些问题，对吧？首先，如果我们不输入任何名字，我们的应用程序就会崩溃。如果你输入一个新的包并按回车键，我们会有问题。出错后，消息不会消失。</p><p id="73b2" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">嗯，是时候清理一下了。首先让我们创建一个新的方法来重置我们的状态。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="bf9e" class="mo ks if ma b fv mp mq l mr ms">resetState () {<br/> this.loaded = false<br/> this.showError = false<br/>},</span></pre><p id="2a27" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我们在axios api调用之前在我们的<code class="eh lx ly lz ma b">requestData()</code>方法中调用它。我们需要检查一下包裹的名称。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="3ba0" class="mo ks if ma b fv mp mq l mr ms">if (this.package === null <br/>    || this.package === ‘’ <br/>    || this.package === ‘undefined’) {<br/>  this.showError = true<br/>  return<br/>}</span></pre><p id="34b5" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">现在，如果我们试图搜索一个空的包名，我们会得到一个默认的错误消息。</p></div><div class="ab cl np nq hc nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="hn ho hp hq hr"><p id="ee35" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我知道，我们覆盖了很多，但让我们添加另一个很酷的小功能。我们有vue路由器，但没有真正使用它。在我们的根节点<code class="eh lx ly lz ma b">/</code>处，我们看到了带有输入字段的起始页。搜索之后，我们停留在我们的根页面。但是如果我们可以分享我们与统计数据的链接，那会很酷，不是吗？</p><p id="1d13" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">因此，在有效的搜索之后，我们将包名添加到我们的url中。</p><p id="337e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated"><code class="eh lx ly lz ma b">npm-stats.org/#/vue-chartjs</code></p><p id="24ec" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">如果我们单击该链接，我们需要获取包名并使用它来请求我们的数据。</p><p id="eeaa" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">让我们创建一个新的方法来设置我们的网址</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="a998" class="mo ks if ma b fv mp mq l mr ms">setURL () {<br/> history.pushState({ info: `npm-stats ${this.package}`}, this.package, `/#/${this.package}`)<br/> }</span></pre><p id="601a" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我们需要在我们的响应承诺中调用<code class="eh lx ly lz ma b">this.setURL()</code>。现在，在发出请求后，我们将包名添加到我们的URL中。但是，如果我们打开一个新的浏览器标签并调用它，什么也不会发生。因为我们需要告诉vue-router，我们的<code class="eh lx ly lz ma b">/</code>之后的所有内容也将指向起始页，并将字符串定义为查询参数。这非常简单。</p><p id="d131" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在我们的<code class="eh lx ly lz ma b">router/index.js</code>中，我们只需要在routes数组中设置另一条路径。我们称之为param包。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="4727" class="mo ks if ma b fv mp mq l mr ms">{<br/>  path: ‘/:package’,<br/>  component: StartPage<br/> }</span></pre><p id="e5a1" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">现在，如果您转到<code class="eh lx ly lz ma b">localhost:8080/#/react-vr</code>，您将看到起始页。但是没有图表。因为我们需要获取参数并使用它执行我们的请求。</p><p id="b021" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">回到我们的Start.vue，我们在安装的钩子中抓取参数。</p><pre class="mg mh mi mj fq mk ma ml mm aw mn dt"><span id="c1a3" class="mo ks if ma b fv mp mq l mr ms">mounted () {<br/> if (this.$route.params.package) {<br/>   this.package = this.$route.params.package<br/>   this.requestData()<br/> }<br/>},</span></pre><p id="ed46" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">就是这样！</p><figure class="mg mh mi mj fq hw"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="8e6d" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">你可以在<a class="ae kq" href="https://github.com/apertureless/npm-stats" rel="noopener ugc nofollow" target="_blank"> GitHub </a>查看完整的源代码，也可以在📺<a class="ae kq" href="http://npm-stats.org/" rel="noopener ugc nofollow" target="_blank">http://npm-stats.org/</a></p><h1 id="2e22" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">丰富</h1><p id="5c5a" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">但是，嘿，仍然有改进的空间。我们可以添加更多的图表。像每月统计，每年统计和添加日期字段来设置期间和许多其他事情。我将在<strong class="jw ig">第二部分</strong>中讲述其中一些！敬请关注！</p></div><div class="ab cl np nq hc nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="hn ho hp hq hr"><p id="b87c" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">第二部分:<a class="ae kq" href="https://hackernoon.com/lets-build-a-web-app-with-vue-chart-js-and-an-api-part-ii-39781b1d5acf" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/lets-build-a-web-app-with-vue-chart-js-and-an-API-part-ii-39781 B1 D5 ACF</a></p><div class="mg mh mi mj fq ab cb"><figure class="nw hw nx ny nz oa ob paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nw hw nx ny nz oa ob paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nw hw nx ny nz oa ob paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="oc od oe"><p id="f922" class="ju jv ng jw b jx jy jg jz ka kb jj kc of ke kf kg og ki kj kk oh km kn ko kp hn dt translated"><a class="ae kq" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kq" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kq" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae kq" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ju jv ng jw b jx jy jg jz ka kb jj kc of ke kf kg og ki kj kk oh km kn ko kp hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kq" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kq" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mg mh mi mj fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff oi"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>