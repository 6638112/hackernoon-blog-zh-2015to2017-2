<html>
<head>
<title>Connecting the dots in style: Build your own Dropbox Sync in 10 minutes!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以时尚的方式连接点:在10分钟内构建您自己的Dropbox Sync！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/connecting-the-dots-in-style-build-your-own-dropbox-sync-in-10-minutes-24d8f61ccb7d?source=collection_archive---------17-----------------------#2017-11-25">https://medium.com/hackernoon/connecting-the-dots-in-style-build-your-own-dropbox-sync-in-10-minutes-24d8f61ccb7d?source=collection_archive---------17-----------------------#2017-11-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d9d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在当今高度全球化的商业领域中，整合，或者说“连接各个点”，是很难避免的事情。幸运的是，集成，或者用更“企业y”的术语来说“企业集成”，不再意味着让你毛骨悚然的东西，这要归功于先进而用户友好的企业集成框架，例如<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/" rel="noopener ugc nofollow" target="_blank"> Project-X </a>。</p><p id="f0c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今天，我们将向简伸出援助之手，她是<em class="jq">快乐购物超市服务部</em>(没听过这个名字？是的，我也没有:)在建立她的最新客户反馈汇总机制的一部分。不过不用担心，因为我会一直帮助和指导你直到最后！</p><p id="5d53" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">HappiShoppin超市服务的公关部门开辟了接收顾客反馈的新渠道。除了前者，传统的平装反馈插件，他们现在通过他们的网站以及公共<a class="ae jp" href="https://hackernoon.com/tagged/dropbox" rel="noopener ugc nofollow" target="_blank"> Dropbox </a>文件夹接受电子反馈(除了社交媒体、Google Drive、<a class="ae jp" href="https://hackernoon.com/tagged/google" rel="noopener ugc nofollow" target="_blank"> Google </a> Forms等)。Jane是Dropbox驱动的反馈项目的负责人，她希望建立一个自动化系统，将任何新添加的Dropbox反馈同步到她的计算机上，这样她就可以在方便的时候离线查看这些反馈，而不必一直盯着Dropbox文件夹。</p><p id="83fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Jane决定构建一个简单的“Dropbox sync”集成流程，该流程会定期将反馈累积Dropbox文件夹中的新内容同步到她计算机上的本地文件夹中。</p><ul class=""><li id="7509" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">在HappiShoppin的共享Dropbox帐户上，<code class="eh ka kb kc kd b">/Feedback/Inbox</code>是客户可以放置反馈文档的文件夹，Jane希望将新收到的文档同步到她电脑上的<code class="eh ka kb kc kd b">/home/jane/dropbox-feedback</code>中。</li><li id="5dbc" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">Jane估计每天同步一次内容就足够了，因为公司在给定的一天内只收到有限数量的反馈；然而，在即将到来的圣诞节期间，该公司预计客户购买量将会激增，这可能意味着反馈提交量也会随之增加。</li><li id="698a" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">为了便于跟踪和维护，她希望将反馈文件组织到每日的子文件夹中。</li><li id="5b17" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">为了避免重复同步相同的反馈文件，Jane必须确保成功同步的文件从收件箱中删除，她希望通过将它们移动到不同的Dropbox文件夹来解决这个问题:<code class="eh ka kb kc kd b">/Feedback/Synced</code>。</li></ul><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff kj"><img src="../Images/78ec01c15ae8c0bb3862959864f86f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*EGWs1GU1Ye3Kn7EZdBg9Zw.png"/></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Dropbox Sync: Solution Overview</figcaption></figure><p id="91db" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，在我们开始之前，先简单介绍一下什么是Project-X，以及我们将要用它做什么:</p><ul class=""><li id="e266" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">Project-X是一个<a class="ae jp" href="http://randomizd.blogspot.com/2017/11/project-x-s01e01-pilot.html?m=1" rel="noopener ugc nofollow" target="_blank">消息引擎</a>，也可以称之为<a class="ae jp" href="https://en.m.wikipedia.org/wiki/Enterprise_service_bus" rel="noopener ugc nofollow" target="_blank">企业服务总线</a>(这对于我们将要处理的场景也是有效的)。</li><li id="d153" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">Project-X从<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/components_of_project_x/ingress_connectors.html" rel="noopener ugc nofollow" target="_blank">入口连接器</a>接收<em class="jq">事件</em>(或<em class="jq">消息</em>)，通过<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/components_of_project_x/processing_elements.html" rel="noopener ugc nofollow" target="_blank">处理元件</a>对其进行各种转换，并通过<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/components_of_project_x/egress_connectors.html" rel="noopener ugc nofollow" target="_blank">出口连接器</a>将其发送给其他系统。对于单个消息，可以以任何顺序发生任何数量的这种转换和发射。</li><li id="e783" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">上述消息生命周期被表示为一个<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/architecture_and_design/integration_flows_and_subflows.html" rel="noopener ugc nofollow" target="_blank">集成流程</a>。它有点类似于生产线上的传送带，尽管它可以更加灵活地处理诸如克隆、条件分支、循环和试捕流之类的东西。</li><li id="3384" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">一组集成项目组成一个<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/architecture_and_design/projects.html" rel="noopener ugc nofollow" target="_blank">集成项目</a>，当涉及到Project-X运行时(如<a class="ae jp" href="https://developer.adroitlogic.com/ultraesb-x/docs/17.07/" rel="noopener ugc nofollow" target="_blank"> UltraESB-X </a>)时，它是基本的部署单元。</li></ul><p id="144b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，在我们的情况下，我们应该:</p><ul class=""><li id="c916" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">创建新的集成项目</li><li id="6e9c" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">在项目中创建一个集成流，来表示Jane的场景</li><li id="51ea" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">添加必要的连接器和处理器，并将它们配置和连接在一起</li><li id="9c22" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">测试流程，看看我们组装的东西是否真的能够完成Jane期望的事情</li><li id="d0bd" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">将项目构建成可部署的工件，准备在UltraESB-X中部署</li></ul><p id="378c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然以上听起来像是相当多的工作，但我们已经有了一个很酷的IDE <a class="ae jp" href="https://www.adroitlogic.com/products/ultrastudio/" rel="noopener ugc nofollow" target="_blank"> UltraStudio </a>可以为我们完成大部分工作。有了UltraStudio，您所要做的就是<a class="ae jp" href="https://www.youtube.com/watch?v=aXfKjqXjqA0" rel="noopener ugc nofollow" target="_blank">拖放并连接</a>所需的连接器和处理元件，其他一切都会神奇地为您完成。您甚至可以在ide中尝试全新的解决方案，并在事件或消息通过您的集成流程时实时跟踪它们。</p><p id="33e7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以，在我们开始之前，让我们<a class="ae jp" href="https://developer.adroitlogic.com/ultrastudio/docs/17.07/installation.html" rel="noopener ugc nofollow" target="_blank">在您的系统上安装UltraStudio】(当然，除非您已经安装了它！).</a></p><p id="a609" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">准备就绪后，<a class="ae jp" href="https://developer.adroitlogic.com/ultrastudio/docs/17.07/project_creation.html" rel="noopener ugc nofollow" target="_blank">使用菜单栏上的<strong class="it hv">文件→新建→项目… </strong>选项，并选择<strong class="it hv">清空Ultra项目</strong>，创建一个新的Ultra项目</a>。创建项目时，在各自的向导页面上选择以下组件(不要担心，一会儿我们将实际了解它们是什么):</p><ul class=""><li id="4c81" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">连接器页面上的<strong class="it hv">定时器任务连接器</strong>和<strong class="it hv">下拉框连接器</strong></li><li id="d43d" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">处理器页面上的<strong class="it hv"> JSON处理器</strong>和<strong class="it hv">流量控制</strong>处理器</li></ul><figure class="kk kl km kn fq ko fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff kv"><img src="../Images/86254093adc9d2df913b83a3ac3641c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rdk_nK9v7bliV-zM0QgJhg.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">New Empty Ultra Project Wizard: Connector Selection</figcaption></figure><p id="fcd1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你没有耐心并且已经创建了一个项目，你可以通过菜单选项<strong class="it hv">工具→ Ultra Studio →组件注册表</strong>添加上述组件。</p><p id="be5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们可以开始创建一个新的集成流程<code class="eh ka kb kc kd b">dropbox-sync-flow</code>，打开<strong class="it hv">项目</strong>侧窗格，右键单击<code class="eh ka kb kc kd b">src/main/conf</code>目录。</p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff la"><img src="../Images/6b58b282b6124fb8ffeccd4e475c0ac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1k9uENYr9Jup_pOxklh33g.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Creating a New Integration Flow</figcaption></figure><p id="d606" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，在开始之前，有一些关于使用图形流UI的提示(以防你想知道它到底在哪里):</p><ul class=""><li id="9b1f" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">在内部，集成流是一个XML ( <a class="ae jp" href="https://docs.spring.io/spring/docs/3.0.x/spring-framework-reference/html/xsd-config.html" rel="noopener ugc nofollow" target="_blank"> Spring </a>)配置，为了方便起见，UltraStudio也可以将它表示为一个可组合的图。</li><li id="d402" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">当集成流文件在IDE中打开时，您可以使用出现在集成流文件底部的两个小选项卡在XML和图形视图之间切换。(这些标签在某些时候可能会丢失，例如当IDE执行<a class="ae jp" href="https://www.jetbrains.org/intellij/sdk/docs/basics/indexing_and_psi_stubs.html" rel="noopener ugc nofollow" target="_blank">索引</a>或<a class="ae jp" href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html" rel="noopener ugc nofollow" target="_blank"> Maven依赖解析</a>时；在这种时候，耐心是一种美德！)</li><li id="c2df" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">图形视图包含一个侧面板，其中包含当前已经添加到项目中的所有组件(连接器和处理器)(在创建时或通过组件注册表)。您可以通过点击面板上的可折叠标签来浏览它们，并通过简单地将它们拖放到画布中来将它们添加到流中。</li><li id="8a3c" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">为了模拟消息流，应该使用在组件端口之间绘制的线(出现在组件图标周围的不同颜色的小点)将组件连接在一起。当您看了一些现有的<a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/architecture_and_design/integration_flows_and_subflows.html#one-way-flow" rel="noopener ugc nofollow" target="_blank">集成流程</a>，或者将要开发的流程图(将在本文的后面出现)之后，您将会找到它的窍门。</li><li id="87c7" class="jr js hu it b iu ke iy kf jc kg jg kh jk ki jo jw jx jy jz dt translated">当一个组件需要配置参数时，只要您将一个元素拖放到画布中，就会自动打开一个配置窗格(您也可以稍后通过单击该组件来打开它)。如果配置面板上的标签或描述不够清楚，只需切换到<strong class="it hv">文档</strong>选项卡，并点击“阅读更多”URL访问该元素的完整文档(在您最喜欢的网络浏览器上)。此外，确保在做出任何更改后单击Save按钮(在底部或侧窗格上)。</li></ul><p id="4317" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用一个<a class="ae jp" href="https://developer.adroitlogic.com/connectors/docs/17.07/timer/timer_ingress_connector.html" rel="noopener ugc nofollow" target="_blank">定时器入口连接器</a>开始流动。这是一个连接器，用于触发时间驱动的消息流的周期性事件(类似于时钟滴答声)。让我们将其配置为触发一个事件，该事件将启动同步过程。为了灵活起见，我们将使用一个<a class="ae jp" href="http://www.unixgeeks.org/security/newbie/unix/cron-1.html" rel="noopener ugc nofollow" target="_blank"> cron表达式</a>来代替一个简单的周期性触发器。</p><p id="36e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">计划选项卡:</p><p id="0672" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">轮询CRON表达式</em> <br/> <code class="eh ka kb kc kd b">0/30 * * ? * *</code></p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff lb"><img src="../Images/9d1956ca35fd5e20e76ccde78b5a3c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*e65EcG37BxuWZXDoFtro1g.png"/></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Dropbox Sync: Timer Ingress Connector Configuration</figcaption></figure><p id="2706" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">尽管Jane希望只在每天下午6点运行检查，但为了方便起见，我们将轮询时间设置为每30秒一次；否则，你只能等到下午6点，看看是否一切正常:)</p><p id="1f84" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来添加一个<a class="ae jp" href="https://developer.adroitlogic.com/connectors/docs/17.07/dropbox/dropbox_egress_connector.html" rel="noopener ugc nofollow" target="_blank"> Dropbox出口连接器</a>，并在侧端口添加一个<a class="ae jp" href="https://developer.adroitlogic.com/connectors/docs/17.07/dropbox/dropbox_query_operations.html#list-entities" rel="noopener ugc nofollow" target="_blank">列表实体</a>连接器操作元素。您可以通过点击组件面板上<strong class="it hv">下拉框连接器</strong>的向下箭头图标来找到连接器操作，这将展开可用连接器操作的列表。</p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff lc"><img src="../Images/15cbab72a17c1da9a35e89747d0c89d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*ObSqm5ps9HIWXjdQbOfa3A.png"/></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Dropbox Egress Connector</figcaption></figure><p id="86b9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://developer.adroitlogic.com/project-x/docs/17.07/components_of_project_x/connector_operations.html" rel="noopener ugc nofollow" target="_blank">连接器操作</a>是一个附件，您可以将其附加到连接器上，它将以特定于连接器的方式对输出消息执行一些额外的处理。例如，对于Dropbox，我们有一个主连接器，有一堆连接器操作，代表不同的API操作，你可以对你的Dropbox帐户执行，如管理文件，搜索，下载等。</p><p id="c9ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用共享的Dropbox账户凭证(<a class="ae jp" href="https://www.dropbox.com/developers/support#api-keys" rel="noopener ugc nofollow" target="_blank"> App ID </a>和<a class="ae jp" href="https://blogs.dropbox.com/developers/2014/05/generate-an-access-token-for-your-own-account/" rel="noopener ugc nofollow" target="_blank">访问令牌</a>)配置<strong class="it hv"> Dropbox连接器</strong>，用<strong class="it hv">路径</strong> <code class="eh ka kb kc kd b">/Feedback/Inbox</code>配置连接器操作。</p><p id="e2e4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">收纳箱连接器</em>，基本标签:</p><p id="a7be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">客户端ID</em><br/>{您的Dropbox应用程序的客户端ID；访问<a class="ae jp" href="https://www.dropbox.com/developers/apps/create" rel="noopener ugc nofollow" target="_blank">https://www.dropbox.com/developers/apps/create</a>创建新应用程序}</p><p id="674f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">访问令牌</em><br/>{您的Dropbox账号的访问令牌，以上app下；按照<a class="ae jp" href="https://blogs.dropbox.com/developers/2014/05/generate-an-access-token-for-your-own-account/" rel="noopener ugc nofollow" target="_blank">https://blogs . Dropbox . com/developers/2014/05/generate-an-access-token-for-your-own-account/</a>获取访问令牌，供个人使用您自己的应用程序}</p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff ld"><img src="../Images/19aa093d694a74d5acd94c657131321c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtaHfK9izcEH_qXeJNixZQ.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Dropbox Sync: Connector Configuration</figcaption></figure><p id="4c28" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">列出实体</em>，基本页签:</p><p id="7d47" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">路径</em> <br/> <code class="eh ka kb kc kd b">/Feedback/Inbox</code></p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div class="fe ff le"><img src="../Images/9416e71b4f41fb312011704b03c1243f.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*axCX_oYXDYY2lihsl5625A.png"/></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Dropbox Sync Flow: Progress So Far</figcaption></figure><p id="bfd5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面的装置将返回一个<a class="ae jp" href="https://www.dropbox.com/developers/documentation/http/documentation#files-list_folder" rel="noopener ugc nofollow" target="_blank">列表文件夹响应</a>，包含当前在<code class="eh ka kb kc kd b">/Feedback/Inbox</code>中的所有文件，作为一个包装的<a class="ae jp" href="https://en.m.wikipedia.org/wiki/JSON" rel="noopener ugc nofollow" target="_blank"> JSON </a>有效负载:</p><pre class="kk kl km kn fq lf kd lg lh aw li dt"><span id="5624" class="lj lk hu kd b fv ll lm l ln lo">{<br/>  "entries": [{<br/>    ".tag": "file",<br/>    "name": <strong class="kd hv">"johndoe.docx"</strong>,<br/>    "id": "id:12345_67_890ABCDEFGHIJ",<br/>    ...<br/>  }, {<br/>    ".tag": "file",<br/>    "name": <strong class="kd hv">"janedoe.txt"</strong>,<br/>    "id": "id:JIHGF_ED_CBA9876543210",<br/>    ...<br/>  }],<br/>  ...<br/>}</span></pre><p id="5d8c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">啊，这就是我们一直在寻找的信息；坐在那里用黑体字写着。现在我们需要想办法把他们拉出来。</p><p id="a24e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来添加一个<a class="ae jp" href="https://developer.adroitlogic.com/processors/docs/17.07/json/json_path_extractor.html" rel="noopener ugc nofollow" target="_blank"> JSON路径提取器</a>处理器，使用<a class="ae jp" href="http://goessner.net/articles/JsonPath/index.html" rel="noopener ugc nofollow" target="_blank"> JSON路径</a>模式:<code class="eh ka kb kc kd b">$.entries[*].name</code>从上面的JSON响应中提取文件路径列表。这将把生成的文件名列表存储在一个名为<code class="eh ka kb kc kd b">files</code>的范围变量中，以供进一步处理。范围变量是一种临时存储，您可以在其中保留简单的值，以供稍后在流程中引用。</p><p id="d71c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">变量名</em> <br/> <code class="eh ka kb kc kd b">files</code></p><p id="b49e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq"> JSON路径<br/> </em> <code class="eh ka kb kc kd b">$.entries[*].name</code></p><p id="5579" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后添加一个<a class="ae jp" href="https://developer.adroitlogic.com/processors/docs/17.07/flow_control/for_each_loop.html" rel="noopener ugc nofollow" target="_blank"> ForEach循环</a>来迭代前面提到的范围变量，这样我们就可以分别处理每个观察到的文件。接下来的处理操作将在循环的单次迭代中进行。</p><p id="5f85" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">集合变量名<br/> </em> <code class="eh ka kb kc kd b">files</code></p><p id="19be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">收藏类型</em> <br/> <code class="eh ka kb kc kd b">COLLECTION</code></p><p id="6eb1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">迭代变量名<br/> </em> <code class="eh ka kb kc kd b">file</code></p><p id="8bb0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在添加一个新的Dropbox连接器(如前所述使用您的app和帐户凭证进行配置)，以及一个，<a class="ae jp" href="https://developer.adroitlogic.com/connectors/docs/17.07/dropbox/dropbox_transfer_operations.html#download-entity" rel="noopener ugc nofollow" target="_blank">下载实体</a>连接器操作，将当前迭代对应的文件(<code class="eh ka kb kc kd b">file</code>)从Dropbox下载到本地目录。</p><p id="b3f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">提示:</strong>当您从<strong class="it hv"> ForEach循环</strong>中绘制输出连接时，请注意最顶端的out端口是用于循环终止(退出)路径的，而不是用于下一次迭代的！</p><p id="be20" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">收纳箱连接器</em>，基本选项卡:</p><p id="16f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">客户端ID </em> <br/> <code class="eh ka kb kc kd b">{client ID for your Dropbox app}</code></p><p id="f41c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">访问令牌<br/> </em> <code class="eh ka kb kc kd b">{access token for your Dropbox account, under the above app}</code></p><p id="7007" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">下载实体</em>，基本页签:</p><p id="a8b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">路径<br/> </em> <code class="eh ka kb kc kd b">/Feedback/Inbox/@{variable.file}</code></p><p id="02cc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">目的地</em> <br/> <code class="eh ka kb kc kd b">/home/jane/dropbox-feedback/@{current.timestamp.yyyy-MM-dd_HH-mm}</code></p><p id="0b09" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来添加另一个Dropbox连接器(配置了您的应用程序和帐户凭证),使用<a class="ae jp" href="https://developer.adroitlogic.com/connectors/docs/17.07/dropbox/dropbox_file_management_operations.html#move-entity" rel="noopener ugc nofollow" target="_blank">移动实体</a>连接器操作，将原始文件移动到<code class="eh ka kb kc kd b">/Feedback/Synced</code>,这样我们就不会再次处理它。我们将连接器的<strong class="it hv">重试计数</strong>属性设置为3，以尽最大努力移动文件(以防我们在初始移动期间遇到任何临时错误，如网络故障)。我们还将在连接器操作上启用<strong class="it hv">自动重命名</strong>,以避免在不同时间将同名文件放置在<code class="eh ka kb kc kd b">/Feedback/Inbox</code>可能导致的任何问题(这可能会导致移动过程中的冲突)。</p><p id="2305" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">收纳箱连接器</em>，基本标签:</p><p id="a0a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">客户端ID </em> <br/> <code class="eh ka kb kc kd b">{client ID for your Dropbox app}</code></p><p id="cebb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">访问令牌<br/> </em> <code class="eh ka kb kc kd b">{access token for your Dropbox account, under the above app}</code></p><p id="a62a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">收纳箱连接器</em>，高级标签:</p><p id="9eb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">重试次数</em> <br/> <code class="eh ka kb kc kd b">3</code></p><p id="fbb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">移动实体</em>，基本选项卡:</p><p id="2770" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">路径</em> <br/> <code class="eh ka kb kc kd b">/Feedback/Inbox/@{variable.file}</code></p><p id="142c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">目的地</em> <br/> <code class="eh ka kb kc kd b">/Feedback/Synced/@{variable.file}</code></p><p id="ccb1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在添加一个<a class="ae jp" href="https://developer.adroitlogic.com/processors/docs/17.07/flow_control/successful_flow_end.html" rel="noopener ugc nofollow" target="_blank">成功流结束</a>元素来表示消息流已经成功完成。</p><p id="5c9b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们需要将处理元素连接在一起，类似于下面的最终流程图:</p><figure class="kk kl km kn fq ko fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff lp"><img src="../Images/dde773d88e6a0d87902061c5123e0c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhLIG_BjVwZWbchZAs0QQw.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Dropbox Sync: Complete Flow</figcaption></figure><p id="6eb9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，现在我们已经准备好测试我们全新的Dropbox同步流了！</p><p id="6581" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在继续之前，请确保您的Dropbox帐户包含<code class="eh ka kb kc kd b">/Feedback/Inbox</code>和<code class="eh ka kb kc kd b">/Feedback/Synced</code>目录。</p><p id="dced" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击菜单上的<strong class="it hv">运行→编辑配置… </strong>，选择左上角<strong class="it hv">添加新配置</strong> (+)按钮下的<strong class="it hv"> UltraESB-X服务器</strong>，创建一个<a class="ae jp" href="https://developer.adroitlogic.com/ultrastudio/docs/17.07/creating_running_flow.html#running-the-project-with-flows" rel="noopener ugc nofollow" target="_blank"> UltraStudio运行配置</a>。</p><p id="5243" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，一切就绪，从菜单中选择<strong class="it hv">运行→运行<em class="jq">配置名称</em> </strong>来启动您的项目！</p><p id="6909" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果一切正常，在一系列蓝色日志之后，您将在<strong class="it hv">运行</strong>窗口的末尾看到下面一行:</p><pre class="kk kl km kn fq lf kd lg lh aw li dt"><span id="ade6" class="lj lk hu kd b fv ll lm l ln lo">2017-11-23T11:45:27,554 [127.0.1.1-janaka-ENVY] [main] [system-] [XEN45001I013] INFO XContainer AdroitLogic UltraStudio UltraESB-X server started successfully in 1 seconds and 650 milliseconds</span></pre><p id="e05d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果在此之前您得到任何错误(红色)或警告(黄色)，您将不得不点击<strong class="it hv">运行</strong>窗口上的<strong class="it hv">停止</strong>(红色方块)来停止项目，并挖掘日志以获得可能出错的线索。</p><p id="b084" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦你启动并运行了，在你最喜欢的网络浏览器上打开你的<a class="ae jp" href="https://www.dropbox.com/home" rel="noopener ugc nofollow" target="_blank"> Dropbox账户</a>，并把一些文件放入<code class="eh ka kb kc kd b">/Feedback/Inbox</code>目录。</p><p id="f06f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几秒钟后(取决于您上面提供的cron表达式)，您放在那里的文件将神奇地出现在文件夹<code class="eh ka kb kc kd b">/home/jane/dropbox-feedback/</code>中。在这之后，如果你再次检查Dropbox帐户，你会注意到原始文件已经从<code class="eh ka kb kc kd b">/Feedback/Inbox</code>转移到<code class="eh ka kb kc kd b">/Feedback/Synced</code>，正如我们所料。</p><p id="1da3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，如果你将更多的文件放入<code class="eh ka kb kc kd b">/Feedback/Inbox</code>，它们将出现在<code class="eh ka kb kc kd b">/home/jane/dropbox-feedback</code>下的不同文件夹中(用新的时间戳命名)。这对Jane来说不是问题，因为在她的情况下，每天只触发一次流，因此每天只有一个目录。</p><p id="5328" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看到了吗？仅此而已！</p><p id="ef2c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，剩下的就是给Jane打电话，让她知道她的Dropbox集成任务已经准备就绪！</p></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><p id="fc60" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">原载于2017年11月25日</em><a class="ae jp" href="http://randomizd.blogspot.com/2017/11/connecting-dots-in-style-build-your-own.html" rel="noopener ugc nofollow" target="_blank"><em class="jq">randomizd.blogspot.com</em></a><em class="jq">。</em></p><figure class="kk kl km kn fq ko"><div class="bz el l di"><div class="lx ly l"/></div></figure></div></div>    
</body>
</html>