<html>
<head>
<title>Android Things Basics: Measure distance with Ultrasonic sensor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安卓事物基础:用超声波传感器测量距离</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/android-things-basics-measure-distance-with-ultrasonic-sensor-3196fe5d7d7c?source=collection_archive---------2-----------------------#2017-01-20">https://medium.com/hackernoon/android-things-basics-measure-distance-with-ultrasonic-sensor-3196fe5d7d7c?source=collection_archive---------2-----------------------#2017-01-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/ad8915b69aef57cd5a44f6b1a530a9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bC4J9d2KhvPSHjEKUz4-1g.png"/></div></div></figure><p id="97a7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这个Android Things项目中，我们将使用一个带有Raspberry Pi 3的超声波传感器来测量距离。</p><p id="c4b5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将使用标准的<a class="ae ka" href="https://hackernoon.com/tagged/gpio" rel="noopener ugc nofollow" target="_blank"> GPIO </a>读写方法，我们将学习如何使用传感器发送超声波，并且我们将发现一些问题。</p></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><h1 id="a13d" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">要求</h1><p id="1099" class="pw-post-body-paragraph jc jd hu je b jf lg jh ji jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz hn dt translated">我们用的是预装了<a class="ae ka" href="https://developer.android.com/things/preview/download.html" rel="noopener ugc nofollow" target="_blank"> Android Things开发者预览版</a>(版本1)的<a class="ae ka" href="https://www.raspberrypi.org/products/raspberry-pi-3-model-b/" rel="noopener ugc nofollow" target="_blank">树莓Pi 3 </a>。</p><p id="adbb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">传感器是一个<strong class="je hv"> HC-SR04超声波传感器</strong>。(我是从<a class="ae ka" href="https://www.amazon.de/gp/product/B00R2U8HK6/ref=oh_aui_detailpage_o03_s00?ie=UTF8&amp;psc=1" rel="noopener ugc nofollow" target="_blank">亚马逊</a>订购的。)</p><blockquote class="ll lm ln"><p id="8149" class="jc jd lo je b jf jg jh ji jj jk jl jm lp jo jp jq lq js jt ju lr jw jx jy jz hn dt translated">HC-SR04超声波传感器像蝙蝠或海豚一样使用声纳来确定到物体的距离。它在一个易于使用的封装中提供了高精度和稳定读数的出色的非接触式范围检测。从2厘米到400厘米或1英寸到13英尺。它的操作不受阳光或黑色物质的影响。</p></blockquote><p id="e2ef" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从<a class="ae ka" href="https://docs.google.com/document/d/1Y-yZnNhMYy7rwhAgyL_pfa39RsB-x2qR4vP8saG73rE" rel="noopener ugc nofollow" target="_blank">这里</a>你可以下载传感器的数据表。</p><h1 id="99cf" class="ki kj hu bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf dt translated">设置</h1><p id="9721" class="pw-post-body-paragraph jc jd hu je b jf lg jh ji jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz hn dt translated">和<a class="ae ka" href="https://hackernoon.com/android-things-basics-obstacle-avoidance-sensor-with-led-feedback-9127e13f2e76" rel="noopener ugc nofollow" target="_blank">上一个项目</a>一样，我建议按照Google的教程来准备你的Raspberry Pi 3，用于Android的东西开发。</p><p id="8e16" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请遵循以下步骤:</p><div class="lx ly fm fo lz ma"><a href="https://developer.android.com/things/hardware/raspberrypi.html" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab ej"><div class="mc ab md cl cj me"><h2 class="bd hv fv z el mf eo ep mg er et ht dt translated">树莓派3 |安卓的东西</h2><div class="mh l"><h3 class="bd b fv z el mf eo ep mg er et ek translated">Raspberry Pi 3 Model B是世界上最流行的单板计算机的最新迭代。它提供了一个四边形…</h3></div><div class="mi l"><p class="bd b gc z el mf eo ep mg er et ek translated">developer.android.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo ja ma"/></div></div></a></div><h1 id="6486" class="ki kj hu bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf dt translated">接线</h1><p id="4595" class="pw-post-body-paragraph jc jd hu je b jf lg jh ji jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz hn dt translated">现在是时候将传感器连接到我们的树莓派了。</p><figure class="mq mr ms mt fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mp"><img src="../Images/8e9574907965c9a9f23625b79b574571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ODZShyJXz7Hi_J9VEbGa-Q.jpeg"/></div></div></figure><p id="d826" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如图所示，<strong class="je hv">超声波传感器</strong>有4个引脚。<br/><strong class="je hv">VCC</strong>需要接5V电源引脚，<strong class="je hv"> GND </strong>显然要接地引脚，<strong class="je hv"> Trig(触发)</strong>和<strong class="je hv"> Echo </strong>引脚接GPIO。</p><p id="ae12" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我是这样把它和我的树莓派联系起来的:</p><ul class=""><li id="2d75" class="mu mv hu je b jf jg jj jk jn mw jr mx jv my jz mz na nb nc dt translated"><strong class="je hv"> VCC </strong> → 5V(针脚2)</li><li id="bed2" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated"><strong class="je hv">触发</strong> → GPIO 21 (BCM21，引脚40)</li><li id="a350" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated"><strong class="je hv">回应</strong> → GPIO 20 (BCM20，针脚38)</li><li id="cba6" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated"><strong class="je hv"> GND </strong> → GND(针脚34)</li></ul><p id="8171" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是它在一起的样子:<br/>(在左侧，您可以看到一个引脚排列图，显示了Raspberry Pi 3板的分线连接器暴露的可用端口的位置)</p><div class="mq mr ms mt fq ab cb"><figure class="ni iv nj nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/a76af038c38f5c9ef5435e12943baeef.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*V3vkURAOo2Ydk2pq3yHPUw.png"/></div></figure><figure class="ni iv no nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/2b7028c1a5c8d6ba8ef1a090fd16f61f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*bC4J9d2KhvPSHjEKUz4-1g.png"/></div></figure></div><h1 id="e925" class="ki kj hu bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf dt translated">软件</h1><p id="4250" class="pw-post-body-paragraph jc jd hu je b jf lg jh ji jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz hn dt translated">要配置一个新的项目，你可以遵循来自Google的(已经提到的)教程，或者你可以使用并修改我们的<a class="ae ka" href="https://hackernoon.com/android-things-basics-obstacle-avoidance-sensor-with-led-feedback-9127e13f2e76" rel="noopener ugc nofollow" target="_blank">以前的应用程序</a>的源代码。</p><div class="lx ly fm fo lz ma"><a href="https://developer.android.com/things/training/first-device/create-studio-project.html" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab ej"><div class="mc ab md cl cj me"><h2 class="bd hv fv z el mf eo ep mg er et ht dt translated">创建一个Android事物项目| Android事物</h2><div class="mh l"><h3 class="bd b fv z el mf eo ep mg er et ek translated">Things应用程序使用的结构与为手机和平板电脑设计的结构相同。这种相似性意味着您可以修改您的…</h3></div><div class="mi l"><p class="bd b gc z el mf eo ep mg er et ek translated">developer.android.com</p></div></div></div></a></div></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="fb9d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我们开始实现必要的代码之前，我先解释一下超声波传感器的工作原理:</p><ul class=""><li id="d3e0" class="mu mv hu je b jf jg jj jk jn mw jr mx jv my jz mz na nb nc dt translated">要开始测量，<strong class="je hv">Trig(Trig)</strong>引脚必须接收到一个<strong class="je hv">高电平</strong> (5V)的脉冲至少10us (10微秒)</li><li id="36e0" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">这将启动传感器，它将以40kHz发射出8个周期的超声波脉冲，并等待反射的超声波脉冲</li><li id="d5e6" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">当传感器检测到超声波时，它会将<strong class="je hv"> Echo </strong>引脚设置为<strong class="je hv"> HIGH </strong> (5V)并延迟一个与距离成比例的周期(宽度)。</li><li id="27e1" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">为了获得距离，我们需要测量回波脉冲的<strong class="je hv">宽度。</strong></li></ul><p id="5a36" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是它在时序图上的样子:</p><figure class="mq mr ms mt fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff np"><img src="../Images/aa7705330645ccb7b4542d3689a4ce1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TX4VRS4zPPomw585llwKYw.png"/></div></div><figcaption class="nq nr fg fe ff ns nt bd b be z ek">The timing diagram of HC-SR04 (<a class="ae ka" href="https://docs.google.com/document/d/1Y-yZnNhMYy7rwhAgyL_pfa39RsB-x2qR4vP8saG73rE/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="2d1b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们看看代码！</p><p id="9b33" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，我们声明GPIO引脚:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="41ec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我们需要设置<strong class="je hv"> Echo </strong>引脚(<strong class="je hv"> BCM20 </strong>)进行读取:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="5b48" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和<strong class="je hv">触发</strong> ( <strong class="je hv"> BCM21 </strong>)引脚进行写操作:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="921e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在好戏开始了。</p><p id="ceee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们需要<strong class="je hv">发送一个10us脉冲</strong>到<strong class="je hv">触发</strong>引脚，并且<strong class="je hv">监听回声</strong>以获得响应脉冲的开始和结束。</p><p id="0919" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我将向您展示两种方法，因为我在某些情况下发现了一些性能问题。(在执行不充分的代码中，我的实现可能不正确)</p><h2 id="e974" class="nw kj hu bd kk nx ny nz ko oa ob oc ks jn od oe kw jr of og la jv oh oi le oj dt translated">1.履行</h2><p id="81ca" class="pw-post-body-paragraph jc jd hu je b jf lg jh ji jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz hn dt translated">第一个是<strong class="je hv">“老派方式”</strong>，你如何在Arduino设备上，或在C或<a class="ae ka" href="https://hackernoon.com/tagged/python" rel="noopener ugc nofollow" target="_blank"> Python </a>中完成，例如在Linux操作系统下的Raspberry Pi上。这是一种通用的、同步的、过程化的方式，你没有回调、异步的方法。这段代码执行得很好，就像你用C或Python实现它一样好。</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="ddfe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以用不同的方式运行这个代码，用一个<em class="lo">处理程序</em>，或者只是在一个新的<em class="lo">线程</em>中，等等…</p><p id="0163" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我现在在一个单独的<em class="lo">线程</em>中运行它:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="0650" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">工作正常。<br/>你可以在传感器前面放一个东西，把它移动得更远更近，你就会在控制台里看到以厘米为单位的距离。</p><p id="ed96" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">(我将在<strong class="je hv"> <em class="lo">调查结果</em> </strong> <em class="lo"> </em>部分提到注释行)</p><h2 id="02cc" class="nw kj hu bd kk nx ny nz ko oa ob oc ks jn od oe kw jr of og la jv oh oi le oj dt translated">2.履行</h2><p id="ae31" class="pw-post-body-paragraph jc jd hu je b jf lg jh ji jj lh jl jm jn li jp jq jr lj jt ju jv lk jx jy jz hn dt translated">第二种方式是Android Things API提供的<strong class="je hv">异步</strong> <em class="lo"> GpioCallback() </em> <strong class="je hv">方式</strong>。</p><p id="9203" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了使用回调，我们需要在<strong class="je hv"> ECHO </strong>引脚上注册我们的监听器:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="5538" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我还定义了一个回调<em class="lo">处理程序</em>，因为它对测量有影响。<br/>我花了很多时间来获得异步实现的正确结果，这也很有帮助。</p><p id="c2da" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通常你只需用<em class="lo">registerGpioCallback(GpioCallback callback)</em>方法注册你的回调。这意味着您的监听器将在您调用register方法的同一个<em class="lo">线程</em>上被调用。有时候(在很多基本的例子中)这就是UI <em class="lo">线程</em>。UI的缓慢会影响你的回调。</p><p id="a975" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我们的案例<strong class="je hv">中，距离测量的准确度</strong>受到1.5厘米 <strong class="je hv">的影响。</strong></p><p id="b733" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们准备好<em class="lo">处理器</em>:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="e1ae" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下面是我们异步“读取”距离的方法:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="ba59" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">基本上它什么也不做，除了触发传感器上的测量。<br/>真正的计算发生在回调中:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="39fd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要运行整个计算，我们也可以使用我们在1中使用的分离的<em class="lo">线程</em>方式。实现，或者我们可以使用一个<em class="lo">处理器</em>来执行我们的计算:</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="8ddc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">完成了。<br/>运行您的代码并检查ADB日志中的测量值。它工作得相当好。</p><p id="b028" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">(哦，对了，如果不需要的话，不要忘记关闭这两个实现中的资源)</p><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><h2 id="7179" class="nw kj hu bd kk nx ny nz ko oa ob oc ks jn od oe kw jr of og la jv oh oi le oj dt translated">调查的结果</h2><ul class=""><li id="5198" class="mu mv hu je b jf lg jj lh jn ok jr ol jv om jz mz na nb nc dt translated">在两种实现中，测量结果的精度是相同的(在一定范围内)。</li><li id="e07c" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">与1的最小可测距离。实施在8cm左右。(与用C或Python编写代码一样)</li><li id="b2b2" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">与2的最小可测距离。实施在12cm左右。</li><li id="da0a" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">如果我们在回调中使用大量计算，在<strong class="je hv">回波</strong>高/低脉冲的捕捉之间，这将影响您的测量。<br/>您会看到许多注释日志行。如果你把它们放回去，最小可测量距离将是20厘米左右，因为设备需要一些时间来处理你的记录。如果你用纳秒来衡量你的时间，这很重要！</li><li id="3d00" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">您还可以体验这些方法的持续时间。<br/>在<em class="lo"> while循环</em>的第一个实现中，如果你把时间记录方法放回去，你会看到。<br/>处理一个<em class="lo"> Log.d() </em>方法比给一个变量赋值要多花将近10倍的时间。</li><li id="533c" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">避免从UI线程。<br/>例如，如果您在UI线程上结合了繁重的计算或日志记录和回调，您将会看到对您的测量的巨大影响。最小可测距离可以轻松跳到30cm以上。</li></ul><h2 id="1065" class="nw kj hu bd kk nx ny nz ko oa ob oc ks jn od oe kw jr of og la jv oh oi le oj dt translated">笔记</h2><ul class=""><li id="1b39" class="mu mv hu je b jf lg jj lh jn ok jr ol jv om jz mz na nb nc dt translated">示例应用程序中不处理错误案例。</li><li id="b7f8" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">传感器的测量能力是不同的。我从亚马逊订购了一包HC-SR04传感器(一包3个，相同的传感器)，例如，其中一个只能正确测量160厘米，另一个可以正确测量240-300厘米。</li><li id="db81" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">如果您想正确测量，您需要首先用尺子或卷尺验证距离，然后修改您的代码。</li><li id="deb7" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">当您测量距离时，我建议进行2-3次测量并计算平均值，因为结果有1-2厘米的偏差。</li><li id="05b1" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">务必检查传感器的数据表，以实现正确的算法</li></ul></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="a1b9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我无法在2中重现同样的表现。第一个例子中的实现。</p><p id="d60b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">也许我错过了一些东西，我以错误的方式实现了一些东西，或者这是Android中的一个API问题。</p><p id="0eee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我还不确定。我仍在不断地思考和测试，希望我能弄明白。</p><p id="1226" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您有任何想法，任何意见，请随时发表评论或给我发电子邮件，或者修改项目来源:</p><div class="lx ly fm fo lz ma"><a href="https://github.com/Danesz/AndroidThings-UltrasonicSensor" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab ej"><div class="mc ab md cl cj me"><h2 class="bd hv fv z el mf eo ep mg er et ht dt translated">danesz/Android things-超声波传感器</h2><div class="mh l"><h3 class="bd b fv z el mf eo ep mg er et ek translated">在GitHub上创建一个帐户，为机器人-超声波传感器的发展做出贡献。</h3></div><div class="mi l"><p class="bd b gc z el mf eo ep mg er et ek translated">github.com</p></div></div><div class="mj l"><div class="on l ml mm mn mj mo ja ma"/></div></div></a></div><div class="mq mr ms mt fq ab cb"><figure class="ni iv oo nk nl nm nn paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ni iv oo nk nl nm nn paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ni iv oo nk nl nm nn paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ll lm ln"><p id="f922" class="jc jd lo je b jf jg jh ji jj jk jl jm lp jo jp jq lq js jt ju lr jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ka" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd lo je b jf jg jh ji jj jk jl jm lp jo jp jq lq js jt ju lr jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mq mr ms mt fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff op"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="mq mr ms mt fq iv"><div class="bz el l di"><div class="oq nv l"/></div></figure></div></div>    
</body>
</html>