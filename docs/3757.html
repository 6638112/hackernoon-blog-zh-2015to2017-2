<html>
<head>
<title>Rich Typescript Logger Decorators for Easy Coding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">丰富的Typescript Logger Decorators便于编码</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/rich-typescript-logger-decorator-for-easy-coding-fc2ff73684c6?source=collection_archive---------3-----------------------#2017-04-21">https://medium.com/hackernoon/rich-typescript-logger-decorator-for-easy-coding-fc2ff73684c6?source=collection_archive---------3-----------------------#2017-04-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/d88643410f938a7a5960d6ed76995054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*s82fSZDuNWp-u5xNNsPNDg.png"/></div></figure><p id="b6ea" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> <em class="jw">这篇</em>文章</strong> <strong class="ja hv"> <em class="jw">原本出现在</em></strong><a class="ae jx" href="https://dormoshe.io/articles/rich-typescript-logger-decorators-for-easy-coding-5" rel="noopener ugc nofollow" target="_blank"><strong class="ja hv"><em class="jw">dormoshe . io</em></strong></a></p><p id="80c3" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">你在为你的函数写日志上浪费了多少时间？有多少次你改变了你的函数名，却忘了在日志消息中改变名字？有多少次你发现自己后悔没有添加一个日志来知道函数是否被调用？</p><p id="c512" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">不再有</strong>遗憾，<strong class="ja hv">不再有</strong>忘记，<strong class="ja hv">不再有</strong>浪费时间——只需使用神奇的打字稿功能——装饰者。</p><p id="125e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在本文中，我们将回顾rich logger decorators和它们的酷选项。在不久的将来，我将发表另一篇文章来解释如何构建这样的装饰器。</p></div><div class="ab cl jy jz hc ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hn ho hp hq hr"><h1 id="4781" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="ec28" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">你可以在我的GitHub <a class="ae jx" href="https://github.com/dormd/rich-logger-decorator" rel="noopener ugc nofollow" target="_blank">资源库</a>中找到装饰器，并通过<a class="ae jx" href="https://www.npmjs.com/package/rich-logger-decorator" rel="noopener ugc nofollow" target="_blank"> npm </a>使用它们。如果有进一步的改进，请提出拉取请求。</p><h2 id="2119" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">装置</h2><p id="412f" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated"><code class="eh lw lx ly lz b">npm i rich-logger-decorator</code></p><h2 id="56b0" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">基本用法</h2><p id="be61" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">在这个例子中，我们将只使用<code class="eh lw lx ly lz b">ClassLogger</code>装饰器来记录所有的类方法。</p><figure class="ma mb mc md fq iv"><div class="bz el l di"><div class="me mf l"/></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">Basic example</figcaption></figure><p id="34dd" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">控制台看起来像这样:</p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/972f9e2037b73b0691a683203b1f9f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*UdTJmJDt8Wt_sxbUrS16dw.png"/></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">Basic example output</figcaption></figure><h2 id="46c9" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">混合装饰和选择</h2><p id="ec58" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">在这个例子中，我们使用带有默认选项的<code class="eh lw lx ly lz b">ClassLogger </code>和<code class="eh lw lx ly lz b">DiableMethodLogger </code>装饰器和带有定制选项的<code class="eh lw lx ly lz b">MethodLogger</code>装饰器。</p><figure class="ma mb mc md fq iv"><div class="bz el l di"><div class="me mf l"/></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">Mixed example</figcaption></figure><p id="db56" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">控制台看起来像这样:</p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/d88643410f938a7a5960d6ed76995054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*s82fSZDuNWp-u5xNNsPNDg.png"/></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">Mixed example output</figcaption></figure></div><div class="ab cl jy jz hc ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hn ho hp hq hr"><h1 id="7e99" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">@Logger装饰者</h1><p id="0061" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">伐木工是主要的装饰者。如果我们想精确一点，这是一个装饰工厂，因为这个函数正在获取一个参数并返回一个函数，但它不是主题。Logger decorator需要位于您想要记录的函数之上。日志消息将在功能开始之前和功能结束之后打印。这个装饰器可以获得定义流行为的选项，并最终影响日志消息。</p><p id="436d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">当选项不提供时，装饰器使用defaultFunctionLoggerOptions对象。这些选项由FunctionLoggerOptions接口定义。</p><h2 id="7a3d" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">FunctionLoggerOptions</h2><p id="26ef" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">这是Logger decorator选项参数的接口。</p><figure class="ma mb mc md fq iv"><div class="bz el l di"><div class="me mf l"/></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">Function logger options interface</figcaption></figure><p id="8677" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如您所见，该接口包含一些属性。</p><ul class=""><li id="fb5d" class="ml mm hu ja b jb jc jf jg jj mn jn mo jr mp jv mq mr ms mt dt translated"><strong class="ja hv"> withArgs </strong> —该属性可以是布尔值或字符串数组。当值为<strong class="ja hv"> <em class="jw"> false </em> </strong>时，参数及其值将不会成为日志消息的一部分。当值为<strong class="ja hv"> <em class="jw">真</em> </strong>时，所有的自变量及其值都将成为日志消息的一部分。当值是字符串 的<strong class="ja hv"> <em class="jw">数组时，数组中包含的参数名称将成为日志消息的一部分。</em></strong></li><li id="ebf4" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv"> withTime </strong> —当值为真时，时间将成为日志消息的一部分。</li><li id="57d8" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv"> withClassProperties </strong> —当值为<strong class="ja hv"> <em class="jw"> true </em> </strong>且函数是类的方法时，类属性及其值将成为日志消息的一部分。该选项也可以是类的属性名 的<strong class="ja hv"> <em class="jw">数组(行为与<code class="eh lw lx ly lz b"><em class="jw">withArgs</em></code>相似，只是针对类属性)。</em></strong></li><li id="542e" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv">log function</strong>—替代传统<code class="eh lw lx ly lz b">console.info</code>的功能。这个函数将在原始函数开始和结束时用日志消息来调用。</li><li id="e505" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv"> formatAndLogFunction </strong> —获取装饰器流的结果字符串并记录定制消息的函数。此函数获取时间、类名(如果存在)、函数名、开始/结束日志、参数及其值的字符串数组以及类属性及其值的字符串数组。</li></ul><p id="b005" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">所有选项都是可选的。</p><h2 id="fb21" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">DefaultFunctionLoggerOptions</h2><p id="4c77" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">defaultFunctionLoggerOptions是一个具有LoggerOptions默认值的对象。默认值为:</p><ul class=""><li id="6d16" class="ml mm hu ja b jb jc jf jg jj mn jn mo jr mp jv mq mr ms mt dt translated"><strong class="ja hv"> withArgs </strong> —真</li><li id="5136" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv"> withTime </strong> —真</li><li id="f2df" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv">with class properties</strong>—false</li><li id="ecce" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv">log function</strong>—console . info函数</li><li id="b31f" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv">formatAndLogFunction</strong>—无默认值。当值不存在时，默认行为发生。</li></ul></div><div class="ab cl jy jz hc ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hn ho hp hq hr"><h1 id="a55a" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">@ClassLogger decorator</h1><p id="16a9" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">由类使用的<strong class="ja hv">类记录器</strong>。当您将装饰器放在类定义的顶部时，类中的所有方法都会被自动记录。这是如此方便，把装饰和观看神奇的事情发生。</p><p id="3c1f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">作为<strong class="ja hv"> Logger </strong> decorator，decorator可以获得定义流行为并最终影响日志消息的选项。<br/>当选项不提供时，装饰工使用的<code class="eh lw lx ly lz b">defaultClassLoggerOptions</code>。选项由<code class="eh lw lx ly lz b">ClassLoggerOptions</code>界面定义。</p><h2 id="b786" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">ClassLoggerOptions</h2><p id="b0de" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">这是<strong class="ja hv">类记录器</strong>装饰选项参数的接口。</p><figure class="ma mb mc md fq iv"><div class="bz el l di"><div class="me mf l"/></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">Class logger options interface</figcaption></figure><p id="1e55" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如您所见，该接口包含一些属性。</p><ul class=""><li id="2b05" class="ml mm hu ja b jb jc jf jg jj mn jn mo jr mp jv mq mr ms mt dt translated"><strong class="ja hv">method options</strong>—修饰类的方法的选项。与Logger函数装饰器的选项相同。</li><li id="de2f" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv">logged method names</strong>—正在记录的方法名称的数组。当该选项未定义时，将记录所有的类方法。</li></ul><p id="046b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">所有选项都是可选的。</p><h2 id="ade2" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">DefaultClassLoggerOptions</h2><p id="a8b8" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated"><code class="eh lw lx ly lz b">defaultClassLoggerOptions</code>是一个对象，默认值为<code class="eh lw lx ly lz b">ClassLoggerOptions</code>。默认值为:</p><ul class=""><li id="037d" class="ml mm hu ja b jb jc jf jg jj mn jn mo jr mp jv mq mr ms mt dt translated"><strong class="ja hv">方法选项</strong>—与函数装饰器的<code class="eh lw lx ly lz b">defaultLoggerOptions</code>相同。</li><li id="b5c9" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated"><strong class="ja hv">logged method names</strong>—未定义(因此所有的类方法都将被记录)</li></ul></div><div class="ab cl jy jz hc ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hn ho hp hq hr"><h1 id="94ee" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">附加装饰者</h1><p id="bee5" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">为了更方便的使用，我们将看到两个装饰者，让我们的生活更容易。</p><h2 id="e35f" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">@DisableLogger装饰者</h2><p id="c22a" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">当你使用<strong class="ja hv"> ClassLogger </strong> decorator(没有方法数组选项)时，所有的类方法都会被记录。为了禁用被记录的特定方法，您可以将<strong class="ja hv">disable logger</strong>decorator放在方法定义之前。与方法数组选项相比，这是防止记录器行为的一个更清晰的方法，因为第二个选项限制我们在数组中写入方法名。</p><h2 id="e753" class="li kg hu bd kh lj lk ll kl lm ln lo kp jj lp lq kt jn lr ls kx jr lt lu lb lv dt translated">@LoggerWithoutArgs decorator</h2><p id="ae61" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">这个decorator是Logger decorator的语法糖，其<em class="jw">的Args </em>选项为false。也就是说，参数及其值不会成为日志消息的一部分。如果将提供其他选项，装饰者将使用它们，除了带有Args的<em class="jw">选项。</em></p></div><div class="ab cl jy jz hc ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hn ho hp hq hr"><h1 id="c0b4" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">结论</h1><p id="2ccb" class="pw-post-body-paragraph iy iz hu ja b jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv hn dt translated">装饰器可以通过NPM<a class="ae jx" href="https://www.npmjs.com/package/rich-logger-decorator" rel="noopener ugc nofollow" target="_blank"><strong class="ja hv">rich-logger-decorator</strong></a>包使用。从现在开始，日志功能比以往任何时候都更容易使用。你所需要的就是使用rich-logger-decorator，就这样。您可以用选项配置装饰器，只需编码…</p><p id="6700" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">文章的下一部分可以在这里找到<a class="ae jx" rel="noopener" href="/@6107923b20dc/4a7e776b22a6">。</a></p><figure class="ma mb mc md fq iv fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/522b2e4ace3cfcecd43bba30fcf0a317.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*cA1Y2VmIvRnUJUvjUPNZ2A.png"/></div></figure><p id="47ab" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> <em class="jw">你可以关注我的</em></strong><a class="ae jx" href="https://www.dormoshe.io" rel="noopener ugc nofollow" target="_blank"><strong class="ja hv"><em class="jw">dormo she . io</em></strong></a><strong class="ja hv"><em class="jw">或者</em></strong><a class="ae jx" href="https://twitter.com/DorMoshe" rel="noopener ugc nofollow" target="_blank"><strong class="ja hv"><em class="jw">Twitter</em></strong></a><strong class="ja hv"><em class="jw">阅读更多关于Angular、JavaScript和web开发的内容。</em>T50】</strong></p></div></div>    
</body>
</html>