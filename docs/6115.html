<html>
<head>
<title>0–100 in Django: Starting an app the right way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django的0–100:以正确的方式启动应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/0-100-in-django-starting-an-app-the-right-way-badd141ef439?source=collection_archive---------7-----------------------#2017-09-04">https://medium.com/hackernoon/0-100-in-django-starting-an-app-the-right-way-badd141ef439?source=collection_archive---------7-----------------------#2017-09-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/64405f85c1aab90d29ae92410d106b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ddGwfxl1-w1-kmuJgFgxg.png"/></div></div></figure><p id="4bc8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" rel="noopener" href="/@jeremytiki/0-100-in-django-the-perfect-environment-a906827028fc">在我们上一个教程</a>中，我们介绍了如何设置一个基本的Django项目。现在，您应该有一个如下所示的目录:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="5d85" class="kk kl hu kg b fv km kn l ko kp">0to100<br/>├── CHANGELOG.rst<br/>├── .gitignore<br/>├── .git<br/>│   └── HEAD<br/>│   ...<br/>├── README.rst<br/>├── docs<br/>├── requirements<br/>│   └── base.txt<br/>├── setup.py<br/>└── tutorial<br/>    ├── manage.py<br/>    └── tutorial<br/>        ├── __init__.py<br/>        ├── settings.py<br/>        ├── urls.py<br/>        └── wsgi.py</span><span id="be5e" class="kk kl hu kg b fv kq kn l ko kp">4 directories, 9 files</span></pre><h1 id="554b" class="kr kl hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">启动你的应用</h1><p id="ec85" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated"><a class="ae ka" href="https://docs.djangoproject.com/en/1.11/intro/tutorial01/" rel="noopener ugc nofollow" target="_blank">Django项目的教程</a>很好地介绍了如何创建你的第一个应用，但是他们忽略了一些重要的概念。为了简洁和快速，本教程没有解释所有的内容，而是跳过了很多内容。在我们开始构建app之前，到底什么是app？</p><h2 id="b492" class="kk kl hu bd ks lt lu lv kw lw lx ly la jn lz ma le jr mb mc li jv md me lm mf dt translated">了解什么是应用程序。</h2><p id="3963" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">首先要明白app到底是什么。与大多数MVC(或MTV)框架不同，Django强迫你将代码分解成独立的“应用程序”这些应用程序应该是完全独立的，可重用的，可插入的。这非常有用，因为这意味着您可以在多个项目中共享功能。</p><p id="7d60" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，假设你有一个博客应用程序和一个照片库应用程序。现在，您可能希望在这两者中添加一个共同的功能，那就是为照片和博客文章添加“标签”的能力。现在，您可以将该功能写入两个应用程序中，最终得到一堆做完全相同事情的重复代码。Django的首选方法是添加一个名为“tags”的新应用程序。这个应用程序将包含与添加、删除和编辑来自其他应用程序的标签相关的所有数据和逻辑。</p><p id="8c9b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这种自我包含的能力也意味着你可以与他人共享你的代码，他们也可以使用它。例如，如果你不想写你自己的标签库，你可以运行<code class="eh mg mh mi kg b">pip install taggit</code>，现在你有了一个别人写的独立的标签库。由于taggit的编写方式，它可以用于任何其他应用程序。</p><h2 id="cf60" class="kk kl hu bd ks lt lu lv kw lw lx ly la jn lz ma le jr mb mc li jv md me lm mf dt translated">你怎么决定什么应该是一个app？</h2><p id="56ae" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">这可能是Django新开发者面临的最大问题。你怎么知道什么时候某些功能应该被拆分？由于编程的性质，这方面没有硬性规定。我通常遵循的想法是:“如果你不能用一句话来解释你的应用程序是做什么的，那么它应该不止是一个应用程序”，到目前为止，这个想法对我很有用。</p><h2 id="99f5" class="kk kl hu bd ks lt lu lv kw lw lx ly la jn lz ma le jr mb mc li jv md me lm mf dt translated">startapp的工作原理</h2><p id="0ec5" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">那么足够的散文和理论，让我们实际上写一些代码！要在Django中启动应用程序，请确保您位于第一个“教程”文件夹中。从现在开始，我将把它称为你的django项目文件夹’(带有<code class="eh mg mh mi kg b">manage.py</code>的那个)。此文件夹将存放您的所有应用程序。现在运行:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="b156" class="kk kl hu kg b fv km kn l ko kp">$ python manage.py startapp polls<br/>$ ls<br/>db.sqlite3  manage.py  polls  tutorial</span></pre><p id="242f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在你可以看到我们现在有了一个名为<code class="eh mg mh mi kg b">polls</code>的新文件夹。虽然看起来startapp做了一些神奇的事情来创建这个应用程序，但实际上并没有。所发生的只是用提供的名称创建一个文件夹(即polls)，复制一些文件，并添加一个配置文件(apps.py)。事实上，您可以在终端或文件浏览器中创建自己的应用程序，只需创建1个文件夹和2个文件。一个应用程序文件夹所需要的就是文件夹、一个<code class="eh mg mh mi kg b">__init__.py</code>和一个<code class="eh mg mh mi kg b">apps.py</code>。</p><h2 id="4ffb" class="kk kl hu bd ks lt lu lv kw lw lx ly la jn lz ma le jr mb mc li jv md me lm mf dt translated">创造了什么？</h2><p id="6043" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">那么<code class="eh mg mh mi kg b">startapp</code>究竟创造了什么？让我们来看一看并分解每个文件:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="60bc" class="kk kl hu kg b fv km kn l ko kp">$ tree polls<br/>polls<br/>├── admin.py<br/>├── apps.py<br/>├── __init__.py<br/>├── migrations<br/>│   └── __init__.py<br/>├── models.py<br/>├── tests.py<br/>└── views.py</span></pre><p id="4d43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先是<strong class="je hv"> admin.py </strong>文件。这个文件是你放置所有Djangos内置管理配置的地方。</p><p id="b397" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来是<strong class="je hv"> apps.py，</strong>这个文件用于Djangos内部的app registery，主要用来存储元数据。在大多数情况下，你不会修改这么多。</p><p id="b86c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我们有了<strong class="je hv"> __init__。py </strong>文件。这个文件实际上是Pythons确定模块的约定。当你尝试运行<code class="eh mg mh mi kg b">import library</code>或<code class="eh mg mh mi kg b">from library import x</code>时，Python会搜索Python路径中的所有文件夹。如果文件夹有__init__。py文件，Python也将在该文件夹中搜索，否则它将被忽略。因此，如果我们希望能够从我们的<code class="eh mg mh mi kg b">polls</code>应用程序导入代码，我们需要__init__.py。</p><p id="b086" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们有了<strong class="je hv">迁移</strong>文件夹。迁移是Django构建数据库的方式。我们将在后面讨论这个问题，但是当我们开始处理模型时，您会看到“迁移”被添加到这个文件夹中。</p><p id="13f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我们有了<strong class="je hv"> models.py </strong>这个文件是你应该存储与这个应用程序相关的所有模型的地方。模型是Django理解数据库的方式，也是您希望数据存储的方式。</p><p id="0083" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来我们有<strong class="je hv">测试。有时你会看到这是一个<strong class="je hv">测试</strong>文件夹。该文件/文件夹用于添加单元和集成测试。这是我们将在后面更详细讨论的内容，但基本上，测试是您编写的代码，以确保您的代码按照您期望的方式运行。</strong></p><p id="d6c6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后我们有<strong class="je hv">的观点。这是存储我们所有业务逻辑的文件。我们将在这个文件中定义与这个应用程序相关的所有视图，包括基于类的视图和函数视图。在其他框架中，您可能会将Djangos视图称为“控制器”。</strong></p><h2 id="e0cf" class="kk kl hu bd ks lt lu lv kw lw lx ly la jn lz ma le jr mb mc li jv md me lm mf dt translated">等等，还没完，是吗？</h2><p id="7cc8" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">如果您以前使用过Django或其他MVC框架，您可能会注意到缺少了一些东西。没有地方存储静态文件或模板(其他框架中的视图)。默认情况下<code class="eh mg mh mi kg b">startapp</code>不会创建这些，但是您可以通过运行:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="62ee" class="kk kl hu kg b fv km kn l ko kp">$ mkdir static templates<br/>$ ls<br/>admin.py  apps.py  __init__.py  migrations  models.py  static  templates  tests.py  views.py</span></pre><p id="76fe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这工作得非常好，现在Django会自动开始在<code class="eh mg mh mi kg b">polls/static</code>中寻找静态文件，在<code class="eh mg mh mi kg b">polls/templates</code>中寻找模板。</p><p id="b8f9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了便于组织，你也可以添加更多的文件！我将回顾其他几个相对常见的文件:</p><ul class=""><li id="a6df" class="mj mk hu je b jf jg jj jk jn ml jr mm jv mn jz mo mp mq mr dt translated"><strong class="je hv"> urls.py </strong> —用于存储应用程序特定的URL到视图的映射</li><li id="9df4" class="mj mk hu je b jf ms jj mt jn mu jr mv jv mw jz mo mp mq mr dt translated"><strong class="je hv"> forms.py </strong> —通常用于存储Djangos表单库子类</li><li id="af59" class="mj mk hu je b jf ms jj mt jn mu jr mv jv mw jz mo mp mq mr dt translated"><strong class="je hv"> signals.py </strong> —常用于存储Django中的<a class="ae ka" href="https://docs.djangoproject.com/en/1.11/topics/signals/" rel="noopener ugc nofollow" target="_blank">信号</a>。</li><li id="41fa" class="mj mk hu je b jf ms jj mt jn mu jr mv jv mw jz mo mp mq mr dt translated"><strong class="je hv"> api.py — </strong>第三方库line Django Rest Framework和TastyPie常用来存储api信息。</li><li id="e688" class="mj mk hu je b jf ms jj mt jn mu jr mv jv mw jz mo mp mq mr dt translated"><strong class="je hv"> managers.py </strong> —用于存储查询集管理器</li></ul><p id="72c8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，许多第三方应用程序使用类似于<strong class="je hv"> api.py </strong>的独立文件来存储每个应用程序的配置。</p><h2 id="274c" class="kk kl hu bd ks lt lu lv kw lw lx ly la jn lz ma le jr mb mc li jv md me lm mf dt translated">注册您的应用程序</h2><p id="8d3b" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">现在你已经创建了一个应用程序，你知道它的功能，但是Django仍然不知道你的应用程序！为了让Django知道你的应用程序，你需要编辑<code class="eh mg mh mi kg b">tutorial/settings.py</code>文件。一旦你打开搜索<code class="eh mg mh mi kg b">INSTALLED_APPS</code>，你应该会看到一个类似这样的部分:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="eeb4" class="kk kl hu kg b fv km kn l ko kp">INSTALLED_APPS = [<br/>     'django.contrib.admin',<br/>     'django.contrib.auth',<br/>     'django.contrib.contenttypes',<br/>     'django.contrib.sessions',<br/>     'django.contrib.messages',<br/>     'django.contrib.staticfiles',<br/>]</span></pre><p id="3b0f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是你启动时Django将使用的所有应用程序的列表。为了让Django知道你的新投票应用程序，只需在列表末尾添加<code class="eh mg mh mi kg b">'polls',</code>:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="cea1" class="kk kl hu kg b fv km kn l ko kp">INSTALLED_APPS = [<br/>     'django.contrib.admin',<br/>     'django.contrib.auth',<br/>     'django.contrib.contenttypes',<br/>     'django.contrib.sessions',<br/>     'django.contrib.messages',<br/>     'django.contrib.staticfiles',<br/>     'polls',<br/>]</span></pre><p id="7db2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样。您已经正式创建了一个全新的应用程序，并使其与Django兼容！它还没有做很多事情，但是我们将在下一个教程中开始解决这个问题。</p></div></div>    
</body>
</html>