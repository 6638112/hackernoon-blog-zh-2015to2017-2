<html>
<head>
<title>Server-side rendering and Redux: from React to Inferno</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">服务器端渲染和Redux:从React到Inferno</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/server-side-rendering-and-redux-from-react-to-inferno-96af029bdbcc?source=collection_archive---------6-----------------------#2017-01-11">https://medium.com/hackernoon/server-side-rendering-and-redux-from-react-to-inferno-96af029bdbcc?source=collection_archive---------6-----------------------#2017-01-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="01fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">React是新的Javascript趋势的主要参与者。它的基于开源组件的环境使得web开发变得更加容易和愉快。</p><p id="7591" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有了它的概念，我们能够在老伙伴JS上创建强大的网络<a class="ae jp" href="https://hackernoon.com/tagged/apps" rel="noopener ugc nofollow" target="_blank">应用</a>。</p><p id="c7ee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，它也有一些缺点，其中之一与应用程序的大小有关(库本身重45 kb)。开发新的轻量级库的新趋势已经到来，随之而来的是地狱:【https://www.infernojs.org/】T4</p><p id="f666" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最酷的是:“地狱”是一种反应。所以，如果你喜欢使用React，Inferno对你来说绝对不是一个大问题。</p><p id="1aa4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这一页中，我将展示这一点，用React编写了一个服务器端渲染的小示例；同样的例子也是用Inferno写的。</p><p id="a541" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我也在用Redux，即使我这里不是真的需要，我用它只是为了好玩:)</p><p id="cbd7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该代码由一个虚拟页面组成，该页面显示了从后端API检索到的音乐专辑列表。完整的代码(在React和Inferno中)，以及后端服务器，可以在这里找到:<a class="ae jp" href="https://github.com/morris-ribs/server-side-rendering" rel="noopener ugc nofollow" target="_blank"><strong class="it hv">https://github.com/morris-ribs/server-side-rendering</strong></a></p><p id="c259" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们讨论三个部分:服务器呈现、入口点和组件。</p><p id="fc9d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该代码基于<a class="ae jp" href="http://redux.js.org/docs/recipes/ServerRendering.html" rel="noopener ugc nofollow" target="_blank">http://redux.js.org/docs/recipes/ServerRendering.html</a></p></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><h2 id="bde0" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jc ki kj kk jg kl km kn jk ko kp kq kr dt translated"><strong class="ak"/>服务器渲染</h2><p id="9d33" class="pw-post-body-paragraph ir is hu it b iu ks iw ix iy kt ja jb jc ku je jf jg kv ji jj jk kw jm jn jo hn dt translated">在入口点中，我们添加了在服务器端呈现应用程序的代码，并将其发送到客户端。</p><p id="3472" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是React的代码:</p><pre class="kx ky kz la fq lb lc ld le aw lf dt"><span id="ba4a" class="jx jy hu lc b fv lg lh l li lj">// server.js</span><span id="c0dc" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">import React from 'react';<br/>import { renderToString } from 'react-dom/server';<br/>import {Provider} from 'react-redux';<br/>import { match, RouterContext } from 'react-router';</strong><br/>import express from 'express';<br/>import routes from '../src/routes';<br/>import configureStore from '../src/store/configureStore';<br/>import {getDataSuccess} from '../src/actions/discActions';<br/>import {fetchData} from '../src/api/DiscApiClient';</span><span id="2377" class="jx jy hu lc b fv lk lh l li lj"> ...<br/>const port = 9800;<br/>const app = express();</span><span id="ed63" class="jx jy hu lc b fv lk lh l li lj">// This is fired every time the server side receives a request<br/>app.use(handleRender);</span><span id="3a76" class="jx jy hu lc b fv lk lh l li lj">function handleRender(req, res) {<br/> <strong class="lc hv"> match({ routes, location: req.url }, (error, redirectLocation, renderProps) =&gt;</strong> {<br/>    if (error) {<br/>      res.status(500).send(error.message);<br/>    } else if (redirectLocation) {<br/>      res.redirect(302, redirectLocation.pathname + redirectLocation.search);<br/>    } else if (renderProps) {</span><span id="e842" class="jx jy hu lc b fv lk lh l li lj">fetchData().then(discs =&gt; {<br/>        // Compile an initial state<br/>        let preloadedState = {};<br/>        <br/>        // Create a new Redux store instance<br/>        const store = configureStore(preloadedState);<br/>        store.dispatch(getDataSuccess(discs));</span><span id="7a85" class="jx jy hu lc b fv lk lh l li lj">// You can also check renderProps.components or renderProps.routes for<br/>        // your "not found" component or route respectively, and send a 404 as<br/>        // below, if you're using a catch-all route.<br/>       <strong class="lc hv"> const html = renderToString(&lt;Provider store={store}&gt;&lt;RouterContext {...renderProps} /&gt;&lt;/Provider&gt;);</strong></span><span id="ce3a" class="jx jy hu lc b fv lk lh l li lj">// Grab the initial state from our Redux store<br/>        const finalState = store.getState();</span><span id="4d54" class="jx jy hu lc b fv lk lh l li lj">// Send the rendered page back to the client<br/>        res.status(200).send(renderFullPage(html, finalState));      <br/>      }).catch(error =&gt; { <br/>          res.status(500).send(error.message);<br/>      });<br/>    } else {<br/>      res.status(404).send('Not found');<br/>    }<br/>  });<br/>}</span><span id="e047" class="jx jy hu lc b fv lk lh l li lj">// the contents to be rendered on server-side<br/>function renderFullPage(html, preloadedState) {<br/> return `<br/>    &lt;!DOCTYPE html&gt;<br/>      &lt;html lang="en"&gt;<br/>        &lt;head&gt;<br/>          &lt;title&gt;Discs Test&lt;/title&gt;<br/>            &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>            &lt;meta charset="utf-8"&gt;<br/>            &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>            &lt;link href="<a class="ae jp" href="https://fonts.googleapis.com/css?family=Roboto" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/css?family=Roboto</a>" rel="stylesheet"&gt;<br/>        &lt;/head&gt;<br/>        &lt;body&gt;<br/>          &lt;div id="app"&gt;${html}&lt;/div&gt;<br/>          &lt;script&gt;<br/>            // WARNING: See the following for Security isues with this approach:<br/>            // <a class="ae jp" href="http://redux.js.org/docs/recipes/ServerRendering.html#security-considerations" rel="noopener ugc nofollow" target="_blank">http://redux.js.org/docs/recipes/ServerRendering.html#security-considerations</a><br/>            window.__PRELOADED_STATE__ = ${JSON.stringify(preloadedState)}<br/>          &lt;/script&gt;<br/>          &lt;script src="/bundle.js"&gt;&lt;/script&gt;<br/>        &lt;/body&gt;<br/>      &lt;/html&gt;<br/>      `;<br/>}</span><span id="b80f" class="jx jy hu lc b fv lk lh l li lj">// listen in the port 9800<br/>app.listen(port, function(err) {<br/>  if (err) {<br/>    console.log(err);<br/>  } else {<br/>    open(`<a class="ae jp" href="http://localhost:${port}`" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`</a>);<br/>  }<br/>});</span></pre><p id="1bca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">而现在，Inferno中的代码(使用<strong class="it hv"><em class="ll">Inferno-server</em></strong>，<strong class="it hv"><em class="ll">Inferno-router</em></strong>和<strong class="it hv"><em class="ll">Inferno-redux</em></strong>)。</p><p id="08aa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里主要的区别是，我们调用<strong class="it hv"> <em class="ll"> match </em> </strong>函数，从中获取<em class="ll"> renderProps </em>对象，然后在我们的<strong class="it hv"><em class="ll">router context</em></strong>中使用它:</p><pre class="kx ky kz la fq lb lc ld le aw lf dt"><span id="169d" class="jx jy hu lc b fv lg lh l li lj">// server.js</span><span id="d953" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">import Inferno from 'inferno';</strong><br/><strong class="lc hv">import { renderToString } from 'inferno-server';<br/>import {Provider} from 'inferno-redux';<br/>import { match, RouterContext } from 'inferno-router';</strong><br/>import routes from '../src/routes';<br/>import configureStore from '../src/store/configureStore';<br/>import {getDataSuccess} from '../src/actions/discActions';<br/>import {fetchDara} from '../src/api/DiscApiClient';</span><span id="7aa9" class="jx jy hu lc b fv lk lh l li lj">const port = 9800;<br/>const app = express();</span><span id="0379" class="jx jy hu lc b fv lk lh l li lj">// This is fired every time the server side receives a request<br/>app.use(handleRender);</span><span id="ead4" class="jx jy hu lc b fv lk lh l li lj">function handleRender(req, res) {<br/>  <strong class="lc hv">const renderProps = match(routes, req.originalUrl);</strong><br/>  if (renderProps.redirect) {<br/>    res.redirect(renderProps.redirect);<br/>  } else if (renderProps) {<br/>      <br/>    fetchData().then(discs =&gt; {<br/>      // Compile an initial state<br/>      let preloadedState = {};<br/>      <br/>      // Create a new Redux store instance<br/>      const store = configureStore(preloadedState);<br/>      store.dispatch(getDataSuccess(discs));<br/>      <br/>      // You can also check renderProps.components or renderProps.routes for<br/>      // your "not found" component or route respectively, and send a 404 as<br/>      // below, if you're using a catch-all route.<br/>      <strong class="lc hv">const html = renderToString(&lt;Provider store={store}&gt;&lt;RouterContext {...renderProps} /&gt;&lt;/Provider&gt;);</strong></span><span id="63cf" class="jx jy hu lc b fv lk lh l li lj">// Grab the initial state from our Redux store<br/>      const finalState = store.getState();</span><span id="2261" class="jx jy hu lc b fv lk lh l li lj">// Send the rendered page back to the client<br/>      res.status(200).send(renderFullPage(html, finalState));   <br/>    }).catch(error =&gt; { <br/>        res.status(500).send(error.message);<br/>    });<br/>  } else {<br/>    res.status(404).send('Not found');<br/>  }<br/>}</span><span id="798a" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">// Exactly like in React!</strong> <br/>function renderFullPage(html, preloadedState) {<br/> return `<br/>    &lt;!DOCTYPE html&gt;<br/>      &lt;html lang="en"&gt;<br/>        &lt;head&gt;<br/>          &lt;title&gt;Discs Test&lt;/title&gt;<br/>            &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br/>            &lt;meta charset="utf-8"&gt;<br/>            &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;<br/>            &lt;link href="<a class="ae jp" href="https://fonts.googleapis.com/css?family=Roboto" rel="noopener ugc nofollow" target="_blank">https://fonts.googleapis.com/css?family=Roboto</a>" rel="stylesheet"&gt;<br/>        &lt;/head&gt;<br/>        &lt;body&gt;<br/>          &lt;div id="app"&gt;${html}&lt;/div&gt;<br/>          &lt;script&gt;<br/>            // WARNING: See the following for Security isues with this approach:<br/>            // <a class="ae jp" href="http://redux.js.org/docs/recipes/ServerRendering.html#security-considerations" rel="noopener ugc nofollow" target="_blank">http://redux.js.org/docs/recipes/ServerRendering.html#security-considerations</a><br/>            window.__PRELOADED_STATE__ = ${JSON.stringify(preloadedState)}<br/>          &lt;/script&gt;<br/>          &lt;script src="/bundle.js"&gt;&lt;/script&gt;<br/>        &lt;/body&gt;<br/>      &lt;/html&gt;<br/>      `;<br/>}</span><span id="1b16" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">// Exactly like in React!</strong><br/>app.listen(port, function(err) {<br/>  if (err) {<br/>    console.log(err);<br/>  } else {<br/>    open(`<a class="ae jp" href="http://localhost:${port}`" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`</a>);<br/>  }<br/>});</span></pre></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="4b09" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">入口点</strong></p><p id="f073" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是我们将要设置Redux存储和提供程序的地方</p><p id="2e3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在反应过来的时候，是这样的:</p><pre class="kx ky kz la fq lb lc ld le aw lf dt"><span id="d72e" class="jx jy hu lc b fv lg lh l li lj">// src/index.js</span><span id="817a" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">import React from 'react';<br/>import {render} from 'react-dom';<br/>import {Provider} from 'react-redux';<br/>import {Router, browserHistory} from 'react-router';</strong><br/>import configureStore from './store/configureStore';<br/>import routes from './routes';<br/>import {loadData} from './actions/discActions';</span><span id="44c0" class="jx jy hu lc b fv lk lh l li lj">// Grab the state from a global variable injected into the server-generated HTML<br/>const preloadedState = window.__PRELOADED_STATE__;</span><span id="88f3" class="jx jy hu lc b fv lk lh l li lj">const store = configureStore(preloadedState);<br/>store.dispatch(loadDiscs());</span><span id="60a0" class="jx jy hu lc b fv lk lh l li lj">render(<br/>    <strong class="lc hv">&lt;Provider store={store}&gt;<br/>        &lt;Router history={browserHistory} routes={routes} /&gt;<br/>    &lt;/Provider&gt;</strong>,<br/>    document.getElementById('app')<br/>);</span></pre><p id="fb26" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在Inferno中，我们将进行一些更改，例如传递路由器中的主要组件:</p><pre class="kx ky kz la fq lb lc ld le aw lf dt"><span id="4277" class="jx jy hu lc b fv lg lh l li lj">// src/index.js</span><span id="d4ec" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">import Inferno from 'inferno';<br/>import configureStore from './store/configureStore';<br/>import { createBrowserHistory } from 'history';<br/>import {Provider} from 'inferno-redux';<br/>import {Router, Route, IndexRoute} from 'inferno-router';</strong><br/>import {loadData} from './actions/discActions';<br/>import App from './components/App';<br/>import DiscPage from './components/disc/DiscPage';</span><span id="eb30" class="jx jy hu lc b fv lk lh l li lj">// in Inferno, we need to create the browser history from another library<br/><strong class="lc hv">const browserHistory = createBrowserHistory();</strong></span><span id="66d9" class="jx jy hu lc b fv lk lh l li lj">// Grab the state from a global variable injected into the server-generated HTML<br/>const preloadedState = window.__PRELOADED_STATE__;</span><span id="58df" class="jx jy hu lc b fv lk lh l li lj">const store = configureStore(preloadedState);<br/>store.dispatch(loadData());</span><span id="f4c3" class="jx jy hu lc b fv lk lh l li lj">// the main App component goes as a param to Router<br/>// The component page goes into the <br/><strong class="lc hv">Inferno</strong>.render(<br/>    <strong class="lc hv">&lt;Provider store={store}&gt;<br/>        &lt;Router history={browserHistory} component={ App }&gt;<br/>                &lt;IndexRoute component={DiscPage} /&gt;<br/>        &lt;/Router&gt;<br/>    &lt;/Provider&gt;</strong>,<br/>    document.getElementById('app')<br/>);</span></pre></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="626b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">相册显示组件</strong></p><p id="443c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，该组件表示页面上相册列表的显示。</p><p id="2454" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在《反应》中，我这样写道:</p><pre class="kx ky kz la fq lb lc ld le aw lf dt"><span id="bccd" class="jx jy hu lc b fv lg lh l li lj"><strong class="lc hv">// App.js</strong></span><span id="019a" class="jx jy hu lc b fv lk lh l li lj">// This component handles the App template used on every page<br/><strong class="lc hv">import React, {PropTypes} from 'react';</strong></span><span id="3b7f" class="jx jy hu lc b fv lk lh l li lj">class App extends <strong class="lc hv">React.Component</strong> {<br/>    render() {<br/>        return(<br/>            &lt;div&gt;<br/>                {this.props.children}<br/>            &lt;/div&gt;<br/>        );<br/>    }<br/>}</span><span id="0753" class="jx jy hu lc b fv lk lh l li lj">App.propTypes = {<br/>    children: PropTypes.object.isRequired<br/>};</span><span id="8adf" class="jx jy hu lc b fv lk lh l li lj">export default App;</span><span id="abf5" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">// DiscPage.js</strong><br/>import {connect} from 'react-redux';<br/>import Disc from './DiscComponent';</span><span id="2744" class="jx jy hu lc b fv lk lh l li lj">/* eslint-disable no-console */<br/>class DiscPage extends <strong class="lc hv">React.</strong>Component {<br/>    constructor(props, context) {<br/>        super(props, context);</span><span id="442a" class="jx jy hu lc b fv lk lh l li lj">this.state = {<br/>          discs: Object.assign({}, this.props.discs)<br/>        };<br/>    }<br/>    <br/>    render() {<br/>        const discsToDisplay = (this.props.discs.albums) ? this.props.discs.albums : [];<br/>        return (<br/>            &lt;div&gt;<br/>                &lt;Disc discs={discsToDisplay} /&gt;<br/>            &lt;/div&gt;<br/>        );<br/>    }<br/>}</span><span id="97d4" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">DiscPage.propTypes = {<br/>    discs: PropTypes.object.isRequired<br/>};</strong></span><span id="fd9d" class="jx jy hu lc b fv lk lh l li lj">function mapStateToProps(state) {<br/>    return {        <br/>        discs: state.discs<br/>    };<br/>}</span><span id="5fc0" class="jx jy hu lc b fv lk lh l li lj">const connectedStateAndProps = connect(mapStateToProps);</span><span id="cdea" class="jx jy hu lc b fv lk lh l li lj">export default connectedStateAndProps(DiscPage);</span><span id="f628" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">// DiscComponent.js</strong><br/>class DiscComponent extends <strong class="lc hv">React.</strong>Component {<br/>    constructor(props, context) {<br/>        super(props, context);<br/>    }</span><span id="c5e3" class="jx jy hu lc b fv lk lh l li lj">render() {<br/>        return ( <br/>            &lt;div&gt;<br/>                &lt;ul&gt; <br/>                    {this.props.discs.map(disc =&gt; <br/>                        &lt;li key={disc.id}&gt;{disc.title} - {disc.artist} ({disc.year})&lt;/li&gt;<br/>                    )} <br/>                &lt;/ul&gt;             <br/>            &lt;/div&gt;<br/>        );<br/>    }<br/>}</span><span id="17fc" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">DiscComponent.propTypes = {<br/>    discs: PropTypes.array.isRequired<br/>};</strong></span><span id="2b8b" class="jx jy hu lc b fv lk lh l li lj">export default DiscComponent;</span></pre><p id="06dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在地狱里。你可以看到我们不需要声明组件的正确类型。</p><p id="72fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除此之外，<strong class="it hv"> <em class="ll">组件</em> </strong>类进来另一个库，<strong class="it hv">魔族-组件</strong>:</p><pre class="kx ky kz la fq lb lc ld le aw lf dt"><span id="51c4" class="jx jy hu lc b fv lg lh l li lj"><strong class="lc hv">// App.js</strong><br/>// This component handles the App template used on every page<br/><strong class="lc hv">import Inferno from 'inferno';<br/>import Component from 'inferno-component';</strong></span><span id="57c3" class="jx jy hu lc b fv lk lh l li lj">class App extends <strong class="lc hv">Component </strong>{<br/>    render() {<br/>        return(<br/>            &lt;div&gt;<br/>                { this.props.children }<br/>            &lt;/div&gt;<br/>        );<br/>    }<br/>}</span><span id="685c" class="jx jy hu lc b fv lk lh l li lj">export default App;</span><span id="a1d7" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">// DiscPage.js</strong><br/>import Disc from './DiscComponent';<br/><strong class="lc hv">import {connect} from 'inferno-redux';</strong></span><span id="8879" class="jx jy hu lc b fv lk lh l li lj">class DiscPage extends <strong class="lc hv">Component </strong>{<br/> render() {<br/>  const discsToDisplay = (this.props.discs.albums) ? this.props.discs.albums : [];<br/>        return (<br/>            &lt;div&gt;<br/>                &lt;Disc discs={discsToDisplay} /&gt;<br/>            &lt;/div&gt;<br/>        );<br/> }<br/>}</span><span id="9ffe" class="jx jy hu lc b fv lk lh l li lj">function mapStateToProps(state) {<br/>    return {        <br/>        discs: state.discs<br/>    };<br/>}</span><span id="d9c6" class="jx jy hu lc b fv lk lh l li lj">// with <strong class="lc hv">inferno-redux</strong>, we can connect components to the immutable store just like in React<br/>const connectedStateAndProps = connect(mapStateToProps);</span><span id="3a2b" class="jx jy hu lc b fv lk lh l li lj">export default connectedStateAndProps(DiscPage);</span><span id="6cef" class="jx jy hu lc b fv lk lh l li lj"><strong class="lc hv">// DiscComponent.js - just like in React</strong><br/>class DiscComponent extends <strong class="lc hv">Component </strong>{<br/>    constructor(props, context) {<br/>  super(props, context);<br/> }</span><span id="e70e" class="jx jy hu lc b fv lk lh l li lj">render() {        <br/>        return ( <br/>            &lt;div&gt;<br/>                &lt;ul&gt; <br/>                    {this.props.discs.map(disc =&gt; <br/>                        &lt;li key={disc.id}&gt;{disc.title} - {disc.artist} ({disc.year})&lt;/li&gt;<br/>                    )} <br/>                &lt;/ul&gt;             <br/>            &lt;/div&gt;<br/>        );<br/>    }<br/>}</span><span id="4665" class="jx jy hu lc b fv lk lh l li lj">export default DiscComponent;</span></pre></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="2b48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">现在我们比较一下尺寸</strong></p><p id="3b3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如你所见，使用服务器端渲染和Redux编写应用程序与React和Inferno没有太大区别。</p><p id="2c02" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，让我们看看这两个库之间捆绑的JS的大小是否真的有差异，以及路由、redux和服务器渲染的相应大小。(<strong class="it hv">注意:我用的是React </strong>的15.0.2版本)</p><p id="096f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">React(版本15.0.2): 308 Kb</p><figure class="kx ky kz la fq ln fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff lm"><img src="../Images/fd99181a10e4ee173af1f903cb1bc57f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wpos_sBW60nwdW3hxWhZ0g.png"/></div></div></figure><p id="a1a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">inferno(1.0版):170 Kb</p><figure class="kx ky kz la fq ln fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff lm"><img src="../Images/5a1146b999e65e5976e577c8102928c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0KXePZ-si4JmFe6UifDNw.png"/></div></div></figure></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><h1 id="7318" class="lu jy hu bd jz lv lw lx kd ly lz ma kh mb mc md kk me mf mg kn mh mi mj kq mk dt translated"><strong class="ak">结论</strong></h1><p id="23ba" class="pw-post-body-paragraph ir is hu it b iu ks iw ix iy kt ja jb jc ku je jf jg kv ji jj jk kw jm jn jo hn dt translated">Inferno带来了一个强大而轻便的库，对于习惯于在React中工作的开发人员来说非常友好。</p><p id="5458" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它带来了React生态系统的所有优点，并有可能使用其最先进的功能。对于轻量级的基于web组件的app来说确实是个不错的选择(重量只有7 kb)。</p><p id="3d3a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">React团队已经在努力利用库的大小并提高性能。当它来的时候，真的很值得看一看。</p><p id="f24b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">两个库上有趣的链接(以及更多！):</p><ol class=""><li id="bb1c" class="ml mm hu it b iu iv iy iz jc mn jg mo jk mp jo mq mr ms mt dt translated"><a class="ae jp" href="https://facebook.github.io/react/" rel="noopener ugc nofollow" target="_blank">反应</a></li><li id="ab6a" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae jp" href="https://www.infernojs.org/" rel="noopener ugc nofollow" target="_blank">地狱</a></li><li id="837c" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae jp" rel="noopener" href="/javascript-inside/introduction-to-functional-front-ends-with-inferno-side-effects-and-routing-a8b226c47b0f#.p987v04m9">Inferno功能前端简介——副作用和路由</a></li><li id="560a" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae jp" rel="noopener" href="/@sapegin/react-and-redux-single-page-applications-resources-22cd859b0c1d#.7rfim853s"> React和Redux单页面应用资源</a></li></ol><div class="kx ky kz la fq ab cb"><figure class="mz ln na nb nc nd ne paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mz ln na nb nc nd ne paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mz ln na nb nc nd ne paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nf ng nh"><p id="f922" class="ir is ll it b iu iv iw ix iy iz ja jb ni jd je jf nj jh ji jj nk jl jm jn jo hn dt translated">黑客中午是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is ll it b iu iv iw ix iy iz ja jb ni jd je jf nj jh ji jj nk jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kx ky kz la fq ln fe ff paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="fe ff nl"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kx ky kz la fq ln"><div class="bz el l di"><div class="nm nn l"/></div></figure></div></div>    
</body>
</html>