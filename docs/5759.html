<html>
<head>
<title>Single command deployment for single page apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">单页面应用的单命令部署</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/single-command-deployment-for-single-page-apps-29941d62ef97?source=collection_archive---------5-----------------------#2017-08-15">https://medium.com/hackernoon/single-command-deployment-for-single-page-apps-29941d62ef97?source=collection_archive---------5-----------------------#2017-08-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="50f5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">开发一个单页面的应用程序是很难的。从一开始，您就需要做出许多决定——比如选择一个框架、设置文件夹结构、配置linter等等。</p><p id="200d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些任务中的一些更容易，因为围绕你最喜欢的框架和web开发的工具生态系统。例如，像<a class="ae jp" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> Create React App </a>、<a class="ae jp" href="https://cli.angular.io" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>和<a class="ae jp" href="https://github.com/choojs/create-choo-app" rel="noopener ugc nofollow" target="_blank"> Create Choo App </a>这样的工具会帮助你在几秒钟内设置好你喜欢的框架。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/7d852eb532ac8478905763644c9ff9fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iezxAvUyNYn2WcUbY8_TzQ.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Photo by <a class="ae jp" href="https://unsplash.com/photos/3l3RwQdHRHg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jonatan Pie</a> on <a class="ae jp" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9253" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通常，当您开始新项目时，您甚至没有足够的时间来考虑部署。在某些时候，你需要公开你的应用程序，因为你想把它展示给你的客户、朋友，或者在你找第一份工作的时候把它添加到你的文件夹中。</p><p id="a143" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，如何快速选择部署应用程序的最佳位置呢？部署工具也有很多。如果你用一些新的闪亮的东西，它会为生产规模，或者你会被迫作出另一个决定改变它吗？你可以使用Github页面，但是你需要的服务人员的HTTPS呢？</p><p id="8f7b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">亚马逊提供了一些可以扩展的东西，结合了用于静态网站托管的<a class="ae jp" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> <em class="kg">简单存储服务</em></a><em class="kg">【S3】</em>和作为CDN的<em class="kg"/><a class="ae jp" href="https://aws.amazon.com/cloudfront/" rel="noopener ugc nofollow" target="_blank"><em class="kg">CloudFront</em></a>是一种廉价但可扩展的方式来交付你的单页应用。虽然这两个也需要一些时间来准备，如果你不熟悉亚马逊网络服务，甚至需要更多时间。</p><p id="3f68" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不过，还有一种更简单的方法——引入Scotty.js  ，这是一个简单的CLI工具，可以帮助你用一个命令将你的网站或单页应用部署到亚马逊S3和CloudFront。</p><h1 id="2ee2" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">把我传送上去，斯科特</h1><p id="80a8" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">Scotty背后的主要思想是用一个命令将你的静态网站或单页应用程序部署到亚马逊生态系统。</p><p id="d506" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它将部署你的静态网站，设置HTTPS的CDN，甚至在一分钟左右的时间内将网站URL复制到你的剪贴板，这取决于你的互联网速度和网站/应用程序的大小。</p><p id="8fbc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于单页应用程序，它还将配置重定向，因此<em class="kg"> pushState </em>可以开箱即用。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/6287f3f573045d99b42196aa47730e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*G1WsRKk5awFpZGgXleH9nw.gif"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Beam me up, Scotty</figcaption></figure><p id="8eeb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们通过一个简单的React应用程序来看看它的运行情况。</p><h1 id="e064" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">创建React应用</h1><p id="f906" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">在部署之前，我们需要应用程序，所以让我们使用Create React App创建一个简单的应用程序。</p><p id="457a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，通过从终端运行<code class="eh ll lm ln lo b">create react app</code>命令创建一个示例应用程序:</p><pre class="jr js jt ju fq lp lo lq lr aw ls dt"><span id="9cc7" class="lt ki hu lo b fv lu lv l lw lx">create-react-app scotty-cra-example</span></pre><p id="02c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你没有安装create-react-app命令，你可以从https://www.npmjs.com/package/create-react-app的NPM这里得到它:<a class="ae jp" href="https://www.npmjs.com/package/create-react-app" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="b485" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者，如果您使用的是NPM v5，您可以运行Create React App命令，而不用使用新的<code class="eh ll lm ln lo b">npx</code>命令全局安装它:</p><pre class="jr js jt ju fq lp lo lq lr aw ls dt"><span id="539c" class="lt ki hu lo b fv lu lv l lw lx">npx create-react-app -- scotty-cra-example</span></pre><p id="7884" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">了解更多<code class="eh ll lm ln lo b">npx</code>在这里:<a class="ae jp" rel="noopener" href="/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b">https://medium . com/@ maybe Katz/introducing-npx-an-NPM-package-runner-55 f 7d 4 BD 282 b</a>。</p><p id="3cd1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们添加<a class="ae jp" href="https://reacttraining.com/react-router/" rel="noopener ugc nofollow" target="_blank"> React路由器</a>来演示推状态支持是如何工作的。为此，请输入您的新项目并安装React Router作为依赖项:</p><pre class="jr js jt ju fq lp lo lq lr aw ls dt"><span id="7f5f" class="lt ki hu lo b fv lu lv l lw lx">cd <!-- -->scotty-cra-example</span><span id="0ce8" class="lt ki hu lo b fv ly lv l lw lx">npm install <!-- -->react-router-dom<!-- --> --save</span></pre><p id="0a2e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在一切都已安装完毕，让我们将React Router添加到项目中——在您最喜欢的编辑器中打开“src/App.js”文件，并将其更新为React Router的基本示例(<a class="ae jp" href="https://reacttraining.com/react-router/web/example/basic" rel="noopener ugc nofollow" target="_blank">https://reacttraining.com/react-router/web/example/basic</a>):</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek"><a class="ae jp" href="https://reacttraining.com/react-router/web/example/basic" rel="noopener ugc nofollow" target="_blank">React Router basic example</a></figcaption></figure><p id="12b4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，如果您使用<code class="eh ll lm ln lo b">npm start</code>启动您的应用程序，它应该可以工作，看起来与这张截图类似:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mb"><img src="../Images/c2d5f313d5c03ad70f6226686f68384b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1qRfS4Esd9yjWDf8efdpDQ.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Basic React app with React Router on localhost</figcaption></figure><p id="8ae8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">是时候使用<code class="eh ll lm ln lo b">npm run build</code>节点脚本来构建你的应用了。这将在项目的根目录下创建一个名为“build”的文件夹。</p><h1 id="5fb0" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">部署应用程序</h1><p id="54c7" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">首先运行以下命令，将NPM的Scotty.js作为一个全局包安装:</p><pre class="jr js jt ju fq lp lo lq lr aw ls dt"><span id="9ce6" class="lt ki hu lo b fv lu lv l lw lx">npm install scottyjs -g</span></pre><p id="758d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Scotty的先决条件是:</p><ul class=""><li id="b089" class="mc md hu it b iu iv iy iz jc me jg mf jk mg jo mh mi mj mk dt translated">带有NPM的Node.js (v4+)</li><li id="f002" class="mc md hu it b iu ml iy mm jc mn jg mo jk mp jo mh mi mj mk dt translated"><a class="ae jp" href="https://hackernoon.com/tagged/aws" rel="noopener ugc nofollow" target="_blank"> AWS </a>账户</li><li id="f353" class="mc md hu it b iu ml iy mm jc mn jg mo jk mp jo mh mi mj mk dt translated">AWS凭据—设置教程:<a class="ae jp" href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html" rel="noopener ugc nofollow" target="_blank">http://docs . AWS . Amazon . com/CLI/latest/user guide/CLI-chap-getting-started . html</a></li></ul><p id="4bc3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后只需运行以下命令:</p><pre class="jr js jt ju fq lp lo lq lr aw ls dt"><span id="26c4" class="lt ki hu lo b fv lu lv l lw lx">scotty --spa --source ./build</span></pre><p id="c46e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个命令告诉Scotty您的应用程序是单页应用程序(SPA ),并且您的项目的源代码在“build”文件夹中。</p><blockquote class="mq"><p id="4a71" class="mr ms hu bd mt mu mv mw mx my mz jo ek translated">Bucket名称对所有用户都是全局的，这意味着您需要为您的应用程序想出一个唯一的名称——重用“scotty-cra-example”是行不通的。</p></blockquote><p id="1124" class="pw-post-body-paragraph ir is hu it b iu na iw ix iy nb ja jb jc nc je jf jg nd ji jj jk ne jm jn jo hn dt translated">从您的终端运行此命令将部署应用程序，并为您提供两个URL，如下所示:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nf"><img src="../Images/b910705c7b632558412a235f6b312cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OhbUmaiiRI7BxVBWysdtxA.gif"/></div></div></figure><p id="1651" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">第一个，也添加到您的剪贴板，是一个到AWS S3的HTTP链接。第二个是同样支持HTTPS的CloudFront URL。</p><h2 id="85d0" class="lt ki hu bd kj ng nh ni kn nj nk nl kr jc nm nn kv jg no np kz jk nq nr ld ns dt translated">CDN和HTTPS</h2><p id="9637" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">Scotty将在CloudFront CDN上设置您的项目，这意味着它将被缓存并分发到不同的区域以减少延迟。</p><p id="0eec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它还将免费设置HTTPS，因此您的应用程序将随时可供服务人员或任何需要安全连接的人使用。</p><blockquote class="mq"><p id="c63e" class="mr ms hu bd mt mu mv mw mx my mz jo ek translated">直播app:<a class="ae jp" href="https://d1reyqfbyftmjg.cloudfront.net" rel="noopener ugc nofollow" target="_blank">https://d1reyqfbyftmjg.cloudfront.net</a></p></blockquote><h1 id="3d43" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks nt ku kv kw nu ky kz la nv lc ld le dt translated">它是如何工作的</h1><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nw"><img src="../Images/0679b240b491af899a80f5aff2502ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kc35ZosoqNygGde0aFsoyw.png"/></div></div></figure><p id="0c45" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">斯科特背后没有魔法。它在幕后使用了Node.js的AWS SDK。</p><p id="11a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，它检查您是否已经有一个默认区域。不幸的是，AWS没有通过AWS SDK给我们一个默认区域。Scotty有一个小型的LevelDB数据库来存储这些信息。如果该区域不存在并且没有提供，Scotty会要求您选择它。</p><p id="51d5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下一步是创建一个bucket。如果没有提供bucket name，Scotty将使用当前文件夹的名称。请记住，bucket名称对于所有用户都是全局的，因此，您需要为您的bucket取一个唯一的名称。</p><p id="7dc3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建bucket后，Scotty将使用AWS SDK将您的项目上传到AWS S3。如果没有提供源标志，当前文件夹将被用作源。</p><p id="a28b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后一步，如果你的项目是一个网站或单页应用，Scotty将在HTTPS的支持下建立CloudFront CDN。SPA和website的区别在于，Scotty将所有不存在的页面重定向回index.html，这使得pushState可以开箱即用。</p></div><div class="ab cl nx ny hc nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="hn ho hp hq hr"><p id="eb31" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下一步是什么？</p><p id="2971" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">试试Scotty，让我知道有什么可以改进的地方。很高兴收到拉取请求，因为欢迎新功能和改进。</p><blockquote class="mq"><p id="bcd6" class="mr ms hu bd mt mu mv mw mx my mz jo ek translated">Github库:【https://github.com/stojanovic/scottyjs T2】</p></blockquote><p id="4a94" class="pw-post-body-paragraph ir is hu it b iu na iw ix iy nb ja jb jc nc je jf jg nd ji jj jk ne jm jn jo hn dt translated">Scotty目前的想法是只为AWS保留一个小库，但这并不意味着它不能改变。</p><p id="1d3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，还缺少一些东西，比如设置自定义域名和配置文件以便于协作。</p><p id="362f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">希望你会喜欢👽</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="oe ma l"/></div></figure></div></div>    
</body>
</html>