<html>
<head>
<title>How I’ve captured all passwords trying to ssh into my server!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何捕获所有试图通过ssh进入我的服务器的密码的！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-ive-captured-all-passwords-trying-to-ssh-into-my-server-d26a2a6263ec?source=collection_archive---------4-----------------------#2017-12-03">https://medium.com/hackernoon/how-ive-captured-all-passwords-trying-to-ssh-into-my-server-d26a2a6263ec?source=collection_archive---------4-----------------------#2017-12-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="8a31" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，ssh会记录ssh尝试，不管成功与否，它不会记录他们尝试过的密码。</p><p id="2b50" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以我认为稍微修改ssh来记录他们的密码是个好主意。</p><p id="ac7c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以我们开始吧，你需要快速编译openssh、zlib和openssl</p><p id="5fb2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">注意，你必须有构建基础gcc glibc-devel和其他… </strong></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="ju jv l"/></div></figure><p id="3225" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">没有什么需要注意的，除了:</p><pre class="jp jq jr js fq jw jx jy jz aw ka dt"><span id="6dfa" class="kb kc hu jx b fv kd ke l kf kg">sed -e 's/struct passwd \* pw = authctxt-&gt;pw;/logit("Honey: Username: %s Password: %s", authctxt-&gt;user, password);\nstruct passwd \* pw = authctxt-&gt;pw;/' -i auth-passwd.c</span></pre><p id="6745" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我基本上是在结构定义之前注入了一个小的<strong class="it hv"> logit() </strong>调用，如果你想了解更多，可以查看一下<strong class="it hv"> auth-passwd.c </strong>的代码。</p><p id="3933" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以这将编译zlib，openssl和openssh，并将其前缀为</p><pre class="jp jq jr js fq jw jx jy jz aw ka dt"><span id="2eb1" class="kb kc hu jx b fv kd ke l kf kg">/opt/openssh2</span></pre><p id="99fb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以按如下方式启动openssh:</p><pre class="jp jq jr js fq jw jx jy jz aw ka dt"><span id="be32" class="kb kc hu jx b fv kd ke l kf kg">/opt/openssh2/dist/sbin/sshd -f /opt/openssh2/dist/etc/sshd_config</span></pre><p id="f7e7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这应该会让守护进程运行起来，您可以尝试几次通过ssh登录的虚假尝试:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/0b80926d8311ba1f3dc8f585b0b69c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0ScRZa28o90p2-VX2CftA.png"/></div></div></figure><p id="d8b4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">10个小时后，结果相当有趣:</p><p id="4825" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，我点击的国家:(感谢<a class="ae ko" href="http://ipheatmap.azurewebsites.net" rel="noopener ugc nofollow" target="_blank">ipheatmap.azurewebsites.net</a>)</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kp"><img src="../Images/226a7cfcaa2214569c002fa4d503448c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5OrOB1LSuPIC9RIgOlrFIA.png"/></div></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Countries that sshed to my box</figcaption></figure><pre class="jp jq jr js fq jw jx jy jz aw ka dt"><span id="6588" class="kb kc hu jx b fv kd ke l kf kg">"HR Pula"<br/>"CN Wuchuan"<br/>"KR Seoul"<br/>"DE Frankfurt am Main"<br/>"NL "<br/>"CN Shenzhen"<br/>"RU Yekaterinburg"<br/>"RU Nyagan"<br/>"US Boydton"<br/>"CN Kunshan"<br/>"CN Hefei"<br/>"TH Kamphaeng Phet"<br/>"CN Beijing"<br/>"HK Hong Kong"<br/>"IL Tel Aviv"<br/>"FR "<br/>"PL Inowrocław"<br/>"PL Krakow"<br/>"IT Giugliano in Campania"<br/>"FR Paris"<br/>"GB London"<br/>"VN Hanoi"<br/>"VN Hanoi"<br/>"VN Hanoi"<br/>"CN Zhengding"<br/>"CN Dongyangshi"<br/>"CN Qingdao"<br/>"CN Bengbu"<br/>"CN Shanghai"<br/>"US Los Angeles"<br/>"IN Bengaluru"<br/>"KR Seoul"<br/>"KR Bucheon-si"<br/>"KR Yangsan"<br/>" "<br/>"JP "<br/>"CL "<br/>"FR "<br/>"JP Tokyo"<br/>"US Buffalo"<br/>"HK "<br/>"CN Lianyungang"<br/>"CN Beijing"<br/>"US Chicago"<br/>"AR Villa Allende"<br/>"US Piscataway"<br/>"AL "<br/>"BR Recife"<br/>"IT Soci"<br/>"CO Bucaramanga"<br/>"AR "<br/>"TR Ağrı"<br/>"FR "<br/>"CA Montreal"<br/>"MY Kuala Selangor"<br/>"FR Ivry-sur-seine"<br/>"FR "</span></pre><p id="1a56" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">(感谢<a class="ae ko" href="http://ipinfo.io" rel="noopener ugc nofollow" target="_blank"> ipinfo.io </a>)(可以卷曲，jq一下)</p><p id="f173" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">所以现在最常用的密码！</strong></p><pre class="jp jq jr js fq jw jx jy jz aw ka dt"><span id="c59a" class="kb kc hu jx b fv kd ke l kf kg">46 password<br/>     43 123456<br/>     36 1234<br/>     29 admin<br/>     29 12345<br/>     17 abc123<br/>     16 root<br/>     11 support<br/>     10 test<br/>     10 123<br/>      9 ubnt<br/>      9 fucker<br/>      9 fake<br/>      8 raspberry<br/>      8 guest<br/>      8 admin123<br/>      7 password123<br/>      7 default<br/>      7 123456789<br/>      6 user<br/>      6 alpine<br/>      6 12345678<br/>      6 111111<br/>      5 wubao<br/>      5 ubuntu<br/>      5 raspberrypi<br/>      5 manager<br/>      5 git<br/>      5 1234567<br/>      4 system<br/>      4 operator<br/>      4 mysql<br/>      4 1<br/>      4 000000<br/>      4<br/>      3 waldo<br/>      3 tomcat<br/>      3 postgres<br/>      3 pi</span></pre><p id="ae9c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">使用最多的用户是:(计算尝试次数)</strong></p><pre class="jp jq jr js fq jw jx jy jz aw ka dt"><span id="1844" class="kb kc hu jx b fv kd ke l kf kg">1689 root<br/>     72 admin<br/>     31 test<br/>     24 postgres<br/>     21 jenkins<br/>     14 user<br/>     13 mysql<br/>     12 support<br/>     12 fake<br/>     11 nagios<br/>     11 deploy<br/>     10 oracle<br/>     10 guest<br/>      9 mother<br/>      9 hadoop<br/>      8 vagrant<br/>      8 tomcat<br/>      8 pi<br/>      8 git<br/>      7 ubuntu<br/>      6 zabbix<br/>      6 weblogic<br/>      6 user1<br/>      6 debian<br/>      6 backup<br/>      5 prueba</span></pre><p id="9754" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我正在注册完整的<a class="ae ko" href="https://gist.github.com/anonymous/210ea139db3e07cfe40a537a28f8e4de" rel="noopener ugc nofollow" target="_blank">东西</a>，所以你可以在那里找到你最喜欢的密码:)</p></div></div>    
</body>
</html>