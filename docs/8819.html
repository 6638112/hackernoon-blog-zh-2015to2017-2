<html>
<head>
<title>Python WebSocket Client Connect to Node.js WebSocket Server µWebSocket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python WebSocket客户端连接到Node.js WebSocket服务器WebSocket</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/python-websocket-client-connect-to-node-js-websocket-server-%C2%B5websocket-2580012901e2?source=collection_archive---------3-----------------------#2017-12-16">https://medium.com/hackernoon/python-websocket-client-connect-to-node-js-websocket-server-%C2%B5websocket-2580012901e2?source=collection_archive---------3-----------------------#2017-12-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="0b6d" class="pw-post-body-paragraph iv iw hu ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">为从摄像机到服务器的Raspberry Pi实时流视频构建Python应用程序</p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="fe ff jt"><img src="../Images/c5a4dce87e31818871213487fcc7cd24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5WY8VoSCAgBg7PIITA9YQ.png"/></div></div></figure><p id="bfcd" class="pw-post-body-paragraph iv iw hu ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">使用Python语言为RaspberryPi 3，pi Zero w设置和创建从摄像机到服务器的视频流应用程序。</p><h2 id="6e7b" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">设置直播视频流的服务器</h2><p id="4bb8" class="pw-post-body-paragraph iv iw hu ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hn dt translated">看到这个<a class="ae lf" href="https://hackernoon.com/nginx-nginx-rtmp-module-ffmpeg-build-live-video-streaming-server-88a52f7bab6f" rel="noopener ugc nofollow" target="_blank">帖子</a></p><h2 id="0dca" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">Python开发工具</h2><p id="cfa8" class="pw-post-body-paragraph iv iw hu ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hn dt translated">我推荐你和我使用Pycharm。只需下载社区版，它是免费的【https://www.jetbrains.com/pycharm/download T2】</p><h2 id="1810" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">在开发环境中设置Python</h2><p id="7e8b" class="pw-post-body-paragraph iv iw hu ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hn dt translated">当我们将应用程序部署到Raspberry Pi时，我们不需要安装Python，因为它在默认情况下是在MacOs &amp; on Raspberry Pi设备上启用的。(Pi 3，Pi Zero W…)在这里下载安装Python【https://www.python.org/downloads/<a class="ae lf" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"/></p><h2 id="9d94" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">设置Pip (Python包索引)</h2><p id="93ea" class="pw-post-body-paragraph iv iw hu ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hn dt translated">我们使用Pip来管理所有的python包，所以要设置Pip只需遵循这个<a class="ae lf" href="https://pip.pypa.io/en/latest/installing/" rel="noopener ugc nofollow" target="_blank">https://pip.pypa.io/en/latest/installing/</a>对于Ubuntu或其他linux，我推荐遵循这个文档:<a class="ae lf" href="https://packaging.python.org/guides/installing-using-linux-tools/#installing-pip-setuptools-wheel-with-linux-package-managers" rel="noopener ugc nofollow" target="_blank">https://packaging . python . org/guides/installing-using-Linux-tools/# installing-Pip-setup tools-wheel-with-Linux-package-managers</a></p><pre class="ju jv jw jx fq lg iu lh li aw lj dt"><span id="e0ff" class="kf kg hu iu b fv lk ll l lm ln">curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py</span><span id="d461" class="kf kg hu iu b fv lo ll l lm ln">sudo python get-pip.py</span></pre><h2 id="cb6a" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">Websocket客户端库</h2><p id="a4ca" class="pw-post-body-paragraph iv iw hu ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hn dt translated">autobahn-python是一个很好的库，我们将在这个项目中使用Websocket客户端<a class="ae lf" href="https://github.com/crossbario/autobahn-python" rel="noopener ugc nofollow" target="_blank">https://github.com/crossbario/autobahn-python</a>，所以我们的RaspberryPi将连接到websocket服务器作为客户端。我们可以控制它捕捉视频/图片或随时停止。我们可以检查它的状态是连接到互联网还是离线。</p><pre class="ju jv jw jx fq lg iu lh li aw lj dt"><span id="8d23" class="kf kg hu iu b fv lk ll l lm ln">pip install autobahn[twisted]</span></pre><p id="e8b7" class="pw-post-body-paragraph iv iw hu ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">在MacOs上，如果运行该命令后出现错误，请使用以下命令</p><pre class="ju jv jw jx fq lg iu lh li aw lj dt"><span id="cc68" class="kf kg hu iu b fv lk ll l lm ln">pip install autobahn[twisted] --user</span></pre><h2 id="2e10" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">我们将使用的Python库</h2><p id="4ab9" class="pw-post-body-paragraph iv iw hu ix b iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo le jq jr js hn dt translated">高速公路，扭曲，子流程</p><blockquote class="lp lq lr"><p id="c5bc" class="iv iw ls ix b iy iz ja jb jc jd je jf lt jh ji jj lu jl jm jn lv jp jq jr js hn dt translated"><strong class="ix hv">示例代码使用子流程</strong></p></blockquote><pre class="ju jv jw jx fq lg iu lh li aw lj dt"><span id="b9ef" class="kf kg hu iu b fv lk ll l lm ln">cmd = 'ffmpeg -re -i /Users/toan/Tutorials/stream/video.mkv -c:v libx264 -preset veryfast -maxrate 3000k -bufsize 6000k -pix_fmt yuv420p -g 50 -c:a aac -b:a 160k -ac 2 -ar 44100 -f flv rtmp://localhost/live/tabvn'<br/>subprocess.call(cmd, shell=True)</span></pre><blockquote class="lp lq lr"><p id="8261" class="iv iw ls ix b iy iz ja jb jc jd je jf lt jh ji jj lu jl jm jn lv jp jq jr js hn dt translated">或者使用Popen</p></blockquote><pre class="ju jv jw jx fq lg iu lh li aw lj dt"><span id="5842" class="kf kg hu iu b fv lk ll l lm ln">cmd = 'ffmpeg -re -i /Users/toan/Tutorials/stream/video.mkv -c:v libx264 -preset veryfast -maxrate 3000k -bufsize 6000k -pix_fmt yuv420p -g 50 -c:a aac -b:a 160k -ac 2 -ar 44100 -f flv rtmp://localhost/live/tabvn'<br/>streaming_process = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE)</span></pre><h2 id="d064" class="kf kg hu bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz dt translated">Websocket客户端的示例Python应用程序</h2><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="lw lx l"/></div></figure><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="ly lx l"/></div></figure><blockquote class="lp lq lr"><p id="6081" class="iv iw ls ix b iy iz ja jb jc jd je jf lt jh ji jj lu jl jm jn lv jp jq jr js hn dt translated">观看视频:<a class="ae lf" href="https://www.youtube.com/watch?v=cV8uwjV4kaE" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=cV8uwjV4kaE</a></p><p id="12e6" class="iv iw ls ix b iy iz ja jb jc jd je jf lt jh ji jj lu jl jm jn lv jp jq jr js hn dt translated">github:<a class="ae lf" href="https://github.com/tabvn/video-streaming-service" rel="noopener ugc nofollow" target="_blank">https://github.com/tabvn/video-streaming-service</a></p></blockquote></div></div>    
</body>
</html>