<html>
<head>
<title>Handy Varnish 4 top and log commands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">方便的Varnish 4 top和log命令</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/handy-varnish-4-top-and-log-commands-d650efd45c15?source=collection_archive---------10-----------------------#2017-07-26">https://medium.com/hackernoon/handy-varnish-4-top-and-log-commands-d650efd45c15?source=collection_archive---------10-----------------------#2017-07-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="311c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">升级到<a class="ae jp" href="https://hackernoon.com/tagged/varnish" rel="noopener ugc nofollow" target="_blank"> Varnish </a> 4后，我发现我的旧Varnish 3 top和log命令不再工作，并发现很难找到Varnish 4 top和<a class="ae jp" href="https://hackernoon.com/tagged/log" rel="noopener ugc nofollow" target="_blank"> log </a>示例的列表。</p><p id="adc1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是一些我经常使用并发现有用的Varnish 4 top和log命令。</p><p id="4bf0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">查看最常请求的后端URL</strong><br/><code class="eh jq jr js jt b">sudo varnishtop -i BereqURL</code></p><p id="6a85" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">查看顶级IP地址</strong> <br/> <code class="eh jq jr js jt b">sudo varnishtop -i ReqStart</code></p><p id="43d0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">查看前X位转发IP地址</strong> <br/> <code class="eh jq jr js jt b">sudo varnishtop -C -I ReqHeader:X-Forwarded-For</code></p><p id="4ceb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">查看顶级用户代理</strong> <br/> <code class="eh jq jr js jt b">sudo varnishtop -C -I ReqHeader:User-Agent</code></p><p id="6716" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">查看特定主机的请求</strong> <br/> <code class="eh jq jr js jt b">varnishlog -q “BereqHeader ~ ‘^Host: example.com’”</code></p><p id="2757" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">查看对特定URL的请求</strong> <br/> <code class="eh jq jr js jt b">varnishlog -q “ReqURL ~ ‘/my/path/’”</code></p><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="jz ka l"/></div></figure></div></div>    
</body>
</html>