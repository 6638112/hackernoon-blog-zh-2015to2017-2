<html>
<head>
<title>Data Visualization — Experiment 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据可视化—实验2</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/data-visualization-experiment-2-1809f9a05ad4?source=collection_archive---------31-----------------------#2017-11-27">https://medium.com/hackernoon/data-visualization-experiment-2-1809f9a05ad4?source=collection_archive---------31-----------------------#2017-11-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="0e8a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好吧。第二轮。战斗！</p><p id="6383" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以，最后一次，我无意中发现，我的大多数帖子都是在一天中的什么时候发布的。这一次，我再次意外地得到了与我计划的不同的结果——我想我最终会得到这个结果，但是现在，我的目标是获得一个我每天发布的帖子数量的度量，从而看看我是否能找出一周中哪一天是最多的(最少的？)有成效。当然，这离我的最终目标还有一步之遥(希望实验3能解决这个问题)。让我们来看看方法论——</p><p id="9221" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">第一步——我如何获取数据？</em>T3】</strong></p><p id="e71a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">还记得我上次是如何下载我的全部数据并用scrapy在网上搜集的吗？好吧，这次我使用API来获取数据，因为对于更高层次的特定性，有时仅仅HTML抓取是不够的。从前面的例子中可以很容易地获取时间戳，但是这里我需要很难从下载的Data.zip文件中获取的日期值。因此，这些数据将包括我从2008年加入FB到11月23日的所有帖子，直到我检索我的帖子细节。</p><p id="8d62" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">a)获取您的用户访问令牌— <br/>我确信有一种OAuth API方法可以做到这一点，但我是通过从Graph API explorer或访问令牌工具手动生成访问令牌来做到这一点的。前者允许您选择对访问令牌的权限，以及可以打开令牌的API，还允许您查看令牌的到期时间(从创建之时算起大约一个小时)。这才是烦人的地方。除了安全性之外，我真的很喜欢访问令牌有更长的过期时间，但是我确信一旦我找到了生成访问令牌的API，我就可以让我的脚本——见下文——在每次遇到401时自动获取它)</p><p id="20f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">b)获取必要的API—<br/>鉴于我的pivot的性质，只需要feed API就可以完成这项工作。但是在我的下一篇博文中，我将使用reactions API的结果，所以这也是我最后在这里使用的，与feed API结合使用。</p><p id="5420" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">典型的feed API调用如下所示—<br/><a class="ae jq" href="https://graph.facebook.com/v2.5/10152460834423273/feed?limit=25&amp;access_token=EAACEdEose0cBANI6UZBB77zEUEOpKNhxyZAuLJozw2uQ18bNIW18Qp1zxSUh6OZC0gONp3B5ZCZCZABqdqWxkg9rcvdleay0BVciZCZA46TMkYog60RZBdnwfpZAaVVMhMKgN90RLMAeJWoKk1eBydwXZAU16oZCmoCF1BpCLKK3e4kUGudMHMV11ZBPHZAobYwFUgybgZD" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/v2.5/10152460834423273/feed?limit = 25&amp;access _ token = eaacedeose 0 cbani6 uzbb 77 zeueopknhxyzauljozw 2 uq 18 bniw 18 qp 1 zxsuh 6 ozc 0 gon p3b 5 zczabqdqwxkg 9 rcvdleay 0 bvcizcza 46 tmgyog 60 rzbdnwfpzaavvmhmkgn 90 rlmaejwokk 1 ebydwxza u 16 ozcmocf 1 bpclkk 3 e 4 kugudmmv 11 zbphzaobyfugybgzd【中</a></p><ul class=""><li id="f762" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">版本号很重要，因为有些API是依赖于版本的。例如，reactions API需要v2.6或更高版本。</li><li id="1f4b" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">第二个URI参数是用户ID，也可以从Graph API explorer中获得。</li><li id="8c5c" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">第三个参数limit是可选的，因为默认值是25。如果您想要指定更高的值，例如每页获取更多的结果，您可以包括它。</li><li id="bbeb" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">第四个参数是在步骤(a)中获得的访问令牌本身</li><li id="6005" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">第五个参数“直到”是用词不当。它实际上指示了当您想要获取#limit帖子时的起始日期时间对象。</li></ul><p id="ae84" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该API的响应形式如下:</p><blockquote class="kf kg kh"><p id="b5f8" class="ir is jp it b iu iv iw ix iy iz ja jb ki jd je jf kj jh ji jj kk jl jm jn jo hn dt translated">{<br/>" data ":[<br/>{ " message ":" FB _ Post body _ 1 "<br/>" created _ time ":" 2017–11–27t 12:47:50+0000 "<br/>" id ":" 1012460834423273 _ 10156427233338273 " }，<br/>{ " message ":" FB _ Post body _ 2 "【T10<br/>。<br/> 25个条目】、<br/>“分页”:{ <br/>“上一个”:“长讨厌的link1”、<br/>“下一个”:“长讨厌的link 2”}<br/>}</p></blockquote><p id="b13e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我认为，如果您可以自己找出该页面上最后一篇文章的日期，将其转换为纪元时间，并在上面提到的“until”参数中使用该值，那么看似有用的“next”链接就没有必要了。</p><p id="cec8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">还有，在回复里是一个不显眼的小“<strong class="it hv"> id </strong>”。这个小怪物实际上是你的<em class="jp">用户id </em>和帖子的<em class="jp"> id </em>本身的合并，产生了另一个唯一的<em class="jp"> id </em>。这是在Reactions API中使用的<em class="jp"> id </em>,它导致获得该帖子的所有反应，这些反应被枚举为</p><blockquote class="kl"><p id="d383" class="km kn hu bd ko kp kq kr ks kt ku jo ek translated">{“喜欢”、“生气”、“哇”、“哈哈”、“喜欢”}</p></blockquote><p id="d458" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">一个典型的反应API是这样的——</p><p id="5d11" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jq" href="https://graph.facebook.com/v2.6/10152460834423273_10156395770753273/reactions?limit=25&amp;access_token=EAACEdEose0cBANI6UZBB77zEUEOpKNhxyZAuLJozw2uQ18bNIW18Qp1zxSUh6OZC0gONp3B5ZCZCZABqdqWxkg9rcvdleay0BVciZCZA46TMkYog60RZBdnwfpZAaVVMhMKgN90RLMAeJWoKk1eBydwXZAU16oZCmoCF1BpCLKK3e4kUGudMHMV11ZBPHZAobYwFUgybgZD" rel="noopener ugc nofollow" target="_blank">https://graph . Facebook . com/v 2.6/10152460834423273 _ 10156395770753273/reactions？limit = 25&amp;access _ token = eaacedeose 0 cbani6 uzbb 77 zeueopknhxyzauljozw 2 uq 18 bniw 18 qp 1 zxsuh 6 ozc 0 gon p3b 5 zczabqdqwxkg 9 rcvdleay 0 bvcizcza 46 tmgyog 60 rzbdnwfpzaavvmhmkgn 90 rlmaejwokk 1 ebydwxza u 16 ozcmocf 1 bpclkk 3 e 4 kugudmmv 11 zbphzaobyfugybgzd【中</a></p><p id="1cdd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">答案是—</p><blockquote class="kf kg kh"><p id="949e" class="ir is jp it b iu iv iw ix iy iz ja jb ki jd je jf kj jh ji jj kk jl jm jn jo hn dt translated">{ <br/>"数据":[<br/>{<br/>" id ": " 1022218239209614 "，<br/>"姓名": "姓名1 "，<br/>"类型":"哈哈"<br/> }，<br/> { <br/> "id": "86372147016752 "，<br/>"姓名":"姓名2 "，<br/>"类型":"哇"<br/> }，"<br/>。</p><p id="6fd7" class="ir is jp it b iu iv iw ix iy iz ja jb ki jd je jf kj jh ji jj kk jl jm jn jo hn dt translated">]、<br/>"分页":{ <br/>"光标":{ <br/>"之前":" tvrv nu 9 ezazbnamn 5 tlrvee 5 urxnakeyttvrfmu 9 qyzrprfkwt 0 rbek 56 a3 hnek 14 twc 9 pqzdzd "、<br/>"之后":" TLR jmk 1 ewxpnvff 6 T2 pfmu 1 urxdneke 0 mpnnk 1 qvtbnrgsytvrzaee 13 pt 0 ZD "<br/>)、【T2access _ token = eaacedeose 0 cbani6 uzbb 77 zeueopknhxyzauljozw 2 uq 18 bniw 18 qp 1 zxs uh 6 oz c0 gonp 3 b5 zczabqdqwxkg 9 rcvdleay 0 bvcizcza 46 tmgyog 60 rzbdnwfpzaavvmhmkgn 90 rlmaejwokk 1 ebydwxza u 16 ozcmocf 1 BPC lkk 3 e 4 kugudmmv 11 zbbhzaobyfugybgzd&amp;pretty = 1【t33</p></blockquote><p id="3497" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">还记得以前只有一个相似按钮的美好时光吗？现在已经没有了，所以即使是简单的Like API也只返回你在帖子上得到的“喜欢”反应的数量。所以如果你想知道你的帖子的总反应数，上面提到的API就是你想要的。</p><p id="6979" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">无论如何，就像我前面提到的，为了跟踪帖子的数量，我可以使用Feed API，但是使用Feed，然后是Reactions API，并煞费苦心地进行API调用，每次只限于25次(我不想因为进行太多的API调用而被FB阻止——事后看来这很愚蠢，因为网站上的每次点击都是API调用)， 获取每页的最后一个日期，并在下一个API调用中替换它，我最终生成了一个包含大约4500个条目的{每个帖子的总反应，日期}的CSV。 接下来，我计算了每个日期的帖子数量，并从中获得了另一个CSV—{ # posts per Date，Date}。</p><p id="eb0c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在整个过程中使用了<strong class="it hv">Python</strong>——请求、Numpy和CSV。对于一些测试图，我也使用了matplotlib。下面提供了相同的IPython笔记本。</p><blockquote class="kl"><p id="b7e2" class="km kn hu bd ko kp kq kr ks kt ku jo ek translated">现在数据准备好了。</p></blockquote><p id="085b" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">第二步——以一种漂亮的格式绘制所有这些内容</em> </strong></p><p id="dd67" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上次，我用了一个气泡图来突出最大使用时间。这一次，考虑到它要平移很长一段时间，我决定使用D3再次渲染日历热图。JS。现在我意识到有很多不同的方法来可视化这些数据。但这是我选的。很快就要和别人一起玩了:)</p><p id="e5a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为此，我使用了[1]的变体，将时间段从2008年的Q1开始，而不是像[1]中那样从去年开始。此外，我修改了一些更多的参数，以适应我的用例，在平移的宽度，地图的颜色范围，标题等方面。</p><p id="efbb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">结果就是这张热图——下面是其中的一个例子。</p><figure class="lb lc ld le fq lf fe ff paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="fe ff la"><img src="../Images/9fcc1166a03388b8b7e2b15b604951ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*51gW6LO6TWVp3RJgJFlo5w.png"/></div></div></figure><p id="9234" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">第三步:假装这并没有浪费太多时间，并试着证明所有这些潜在告诉我的东西——</em></strong></p><p id="c681" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这仍然是我最终目标的中间步骤。但这告诉我的是一周中的哪几天我在FB上最活跃，这并不能说明什么，因为我在过去的90天里一直在发帖子。但是较暗的红色确实表明有大量的创意帖子(上下文——我在我的feed上发布原创内容——双关语、涂鸦；出于谦逊，我不会对质量发表评论。啊，元讽刺。).</p><p id="9cc5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这也让我能够证实我所知道的事情——那些我在脸书完全不活跃的日子。上图前半部分相对广阔的空地表明我暂时没有使用社交网络这个浪费时间的工具。</p><blockquote class="kl"><p id="dec7" class="km kn hu bd ko kp kq kr ks kt ku jo ek translated">但我并不嫉妒。它为我提供了一个实践和扩展我的数据可视化(并最终有望预测)知识的途径。</p></blockquote><p id="71a8" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">笔记、坑洼、补充学习— </em> </strong></p><p id="0a04" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">“不是每个API调用都有好结果。其中一些变坏了"</em>:当我获得401时，我遇到了一些解析错误，因为我使用的<em class="jp"> id </em>是由于朋友在我的时间线上的帖子。在那之后，我只过滤了我的<em class="jp"> id </em>上的呼叫，并验证了200个OK状态代码，只有在这些代码之后才应该进行解析。</p><blockquote class="kl"><p id="b58e" class="km kn hu bd ko kp kq kr ks kt ku jo ek translated"><em class="lm">实用性:</em>这项研究可能会扩展到数字营销用例，营销人员可以计算出他们在页面上最活跃的时间，而不是他们的个人资料。</p></blockquote><p id="060b" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated"><em class="jp">学习:</em>热图很酷。但是，如果能够点击每个部分并展开它，每天都能获得更多见解，那就更酷了。我还不知道该怎么做。我会在以后的实验中学习并记在这里。</p><p id="d8a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">接下来是什么？</em> </strong></p><ul class=""><li id="d4f5" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">我生成的热图和我粘贴到下面的链接需要大约45秒的时间来加载，因为它加载了大量的数据。我需要阅读关于缓存和加载页面，以加快速度。我知道我最终会想出办法的，但是专业人士的建议将是最受欢迎的。</li><li id="fea1" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">希望不会再有偏差，我将最终真正挖掘并观想“我最初想要的”。</li></ul><p id="5621" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">参考资料— </em> </strong></p><p id="3aeb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">【https://developers.facebook.com/tools-and-support/】<br/>https://github.com/DKirwan/calendar-heatmap<a class="ae jq" href="https://developers.facebook.com/tools-and-support/" rel="noopener ugc nofollow" target="_blank"/></p><p id="6285" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">源代码和其他中间数据— </em> </strong></p><div class="ln lo fm fo lp lq"><a href="https://github.com/abhiii5459/fb_usage/tree/master/Experiment_2_PostsVisualized/Facebook_Analysis_19_11_2017" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab ej"><div class="ls ab lt cl cj lu"><h2 class="bd hv fv z el lv eo ep lw er et ht dt translated">abhiii 5459/FB _用法</h2><div class="lx l"><h3 class="bd b fv z el lv eo ep lw er et ek translated">在GitHub上创建一个帐户，为fb_usage开发做贡献。</h3></div><div class="ly l"><p class="bd b gc z el lv eo ep lw er et ek translated">github.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me lk lq"/></div></div></a></div><p id="d5e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我将很快展开自述文件，指出哪些文件需要关注，以防有人有兴趣投稿。现在可以说，“Reactions1.ipynb”、“后处理. ipynb”和FB-FrontEnd文件夹在这里起主要作用。</p><p id="b5f6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">仔细看看热图</strong>——(等45秒:-/嘿，你等爆米花等了整整两分钟，不是吗？)—不过说真的，需要加速。</p><div class="ln lo fm fo lp lq"><a href="https://cdn.rawgit.com/abhiii5459/fb_usage/468c834f/Experiment_2_PostsVisualized/Facebook_Analysis_19_11_2017/FB-FrontEnd/fb_results_viz.html" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab ej"><div class="ls ab lt cl cj lu"><h2 class="bd hv fv z el lv eo ep lw er et ht dt translated">D3.js日历热图</h2><div class="lx l"><h3 class="bd b fv z el lv eo ep lw er et ek translated">编辑描述</h3></div><div class="ly l"><p class="bd b gc z el lv eo ep lw er et ek translated">cdn.rawgit.com</p></div></div></div></a></div><p id="f062" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢阅读！</p></div></div>    
</body>
</html>