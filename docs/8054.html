<html>
<head>
<title>JavaScript DOM and how to navigate it with a <form> example, Part 2: Collecting form values</form></title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript DOM以及如何使用</h1><form> example, Part 2: Collecting form values
<blockquote>原文：<a href="https://medium.com/hackernoon/javascript-dom-and-how-to-navigate-it-with-a-form-example-part-2-collecting-form-values-7d881120bc5e?source=collection_archive---------8-----------------------#2017-11-17">https://medium.com/hackernoon/javascript-dom-and-how-to-navigate-it-with-a-form-example-part-2-collecting-form-values-7d881120bc5e?source=collection_archive---------8-----------------------#2017-11-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="03b6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第1部分中，我快速回顾了DOM和一些CSS选择器，它们有助于从一个<a class="ae jp" href="https://hackernoon.com/tagged/html" rel="noopener ugc nofollow" target="_blank"> HTML </a>表单中收集值。</p><p id="353d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这一部分中，当您没有特别容易使用的index.html时，例如当您不能只使用getElementByID()时，我将研究捕捉这些值的不同方法。这将包括需要考虑的事情，比如作用域、事件侦听器、关于CSS选择器的更多内容，以及我在编写代码时用来检查代码的一些技巧。</p><h1 id="c07f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">收集表单数据</h1><h2 id="f706" class="ko jr hu bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb dt translated">第一，注意范围</h2><p id="6b5e" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">在<a class="ae jp" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>中的作用域决定了被赋值的不同变量的可访问性。变量可以是局部的，也可以是全局的。全局变量在整个领域的任何地方都可以访问，而局部变量只能在函数内部访问。</p><p id="9700" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如:</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="3b92" class="ko jr hu lm b fv lq lr l ls lt">// Global variables are declared outside of a function and accessible within it </span><span id="24a1" class="ko jr hu lm b fv lu lr l ls lt">var name = "Marcella" </span><span id="2377" class="ko jr hu lm b fv lu lr l ls lt">function sayHi(name) {<br/>console.log(`Hi ${name}`) <br/>}<br/>// console logs "Hi Marcella" </span><span id="cc4e" class="ko jr hu lm b fv lu lr l ls lt"><br/>// Local variables are declared within a function and outside the   // function are undefined </span><span id="dcd9" class="ko jr hu lm b fv lu lr l ls lt">function sayBye() {<br/>var myName = "Marcella"<br/>}</span><span id="78f3" class="ko jr hu lm b fv lu lr l ls lt">console.log(myName) <br/>//reference Error</span></pre><p id="8e3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以在Chrome Dev Tools的控制台中看到这一点，这是测试你正在编写的JavaScript的好地方。</p><figure class="lh li lj lk fq lw fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/bc0198b015d5d72d78e073130917be39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*tFTCVoYBjurmacFkIUDKmA.png"/></div></figure><h2 id="1859" class="ko jr hu bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb dt translated">与此相关，当你调用值时要注意</h2><p id="a462" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">假设我有一个带有名称字段的HTML表单，代码如下所示</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="b3ae" class="ko jr hu lm b fv lq lr l ls lt">index.html</span><span id="532f" class="ko jr hu lm b fv lu lr l ls lt">...<br/>&lt;form&gt;<br/>                &lt;div&gt;<br/>                    &lt;label&gt;Name<br/>                        &lt;input type="text" name="name"&gt;<br/>                    &lt;/label&gt;<br/>                &lt;/div&gt;<br/>&lt;/form&gt;<br/>...</span></pre><p id="13e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我写了一点JavaScript来获取输入字段的值。下面是我知道的一些事情。</p><ol class=""><li id="7be2" class="lz ma hu it b iu iv iy iz jc mb jg mc jk md jo me mf mg mh dt translated">我不能使用getElementByID()。某种查询选择器可能是最好的选择</li><li id="fc28" class="lz ma hu it b iu mi iy mj jc mk jg ml jk mm jo me mf mg mh dt translated">我希望该字段的值基于某个特定事件进行更新</li><li id="2bdd" class="lz ma hu it b iu mi iy mj jc mk jg ml jk mm jo me mf mg mh dt translated">我想确保我不会返回一个未定义的值或错误</li></ol><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="988a" class="ko jr hu lm b fv lq lr l ls lt">//index.js</span><span id="0115" class="ko jr hu lm b fv lu lr l ls lt">window.onload = function(event) {<br/>    //console.log("I'm connected!")</span><span id="2aa9" class="ko jr hu lm b fv lu lr l ls lt">   let form = document.forms[0];<br/>   let nameField;</span><span id="9c64" class="ko jr hu lm b fv lu lr l ls lt">    document.addEventListener("change", function(event){<br/>      nameField= form.querySelector('input[name="name"]').value;<br/>      console.log(nameField);<br/>    })</span><span id="4e1b" class="ko jr hu lm b fv lu lr l ls lt">}</span></pre><p id="f398" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我的策略</p><ol class=""><li id="aeb4" class="lz ma hu it b iu iv iy iz jc mb jg mc jk md jo me mf mg mh dt translated">在我做任何事情之前，我在控制台上记录了“我已连接”，并检查以确保我的JavaScript文件和我的index.html正在通信。我对每一步都进行控制台日志记录，因为没有什么能像假设的那样，因为事情很简单，一切都很顺利，然后两个小时后，你有一个无法追踪的愚蠢错误，这实际上只是因为你在200行代码前声明的变量没有按照你预期的方式定义</li><li id="acc7" class="lz ma hu it b iu mi iy mj jc mk jg ml jk mm jo me mf mg mh dt translated">我对输入值使用了on change。还有其他事件侦听器可以在这里工作，可能是与表单提交相关的东西，但是我发现这个很容易在控制台中测试。它会在用户键入时更新该值。我也喜欢让我的每个功能管理最少的进程。与其用一个巨大的函数收集每个表单字段的值然后提交，我宁愿把事情分解成每个字段一个函数，用一个合适的事件监听器和CSS选择器，然后用一个函数管理提交。</li><li id="d107" class="lz ma hu it b iu mi iy mj jc mk jg ml jk mm jo me mf mg mh dt translated">我在事件侦听器外声明了form变量，这样我就可以在整个文件中使用它。但是，我在事件侦听器中定义变量，这意味着只有当输入字段中有值时，变量才会被定义。</li></ol><h2 id="1052" class="ko jr hu bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb dt translated">确保您使用了正确的事件监听器</h2><p id="36a9" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">这似乎是显而易见的，但是请仔细检查您正在使用的事件侦听器。如果您使用额外的JavaScript框架或库来编写，这些框架或库具有不同的约定或调用事件侦听器的方式，只需花一点时间来查找即可。</p><p id="b1b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你在使用。onchange ，你想写什么</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="9641" class="ko jr hu lm b fv lq lr l ls lt"><em class="mn">object</em>.onchange = function(){<em class="mn">myScript</em>};</span></pre><p id="54d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您使用的是addEventListener</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="52c2" class="ko jr hu lm b fv lq lr l ls lt"><em class="mn">object</em>.addEventListener("change", <em class="mn">myScript</em>);</span></pre><p id="6c0c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一个实际例子</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="0c70" class="ko jr hu lm b fv lq lr l ls lt">document.addEventListener("change", function(event) {<br/>      myOption=form.querySelector('select[name="myOptions"]').value;<br/>      console.log(myOption)<br/>    })</span></pre><h2 id="c36c" class="ko jr hu bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb dt translated">确保你得到了一个有帮助的值</h2><p id="97ab" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">如果您有一个复选框或单选按钮的表单字段，请使用。价值可能不是你的最佳选择。带有复选框，如果您使用。值，则无论复选框是选中还是取消选中，返回值都是“开”。布尔值会有用得多，使用。选中将返回一个布尔值。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="84ae" class="ko jr hu lm b fv lq lr l ls lt">document.addEventListener("change", function(event) {<br/>      selected=form.querySelector('input[name="selected"]').checked;<br/>      console.log(selected)<br/>    })</span><span id="a0b2" class="ko jr hu lm b fv lu lr l ls lt">//console logs either true or false</span></pre><h1 id="c2b8" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">使用表单数据创建对象</h1><p id="95cd" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">一旦有了表单数据，有两个可能的步骤，要么将它作为预览呈现在页面上，要么提交到后端。</p><h2 id="a1c3" class="ko jr hu bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb dt translated">为什么要使用对象</h2><p id="fa24" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">在用户决定提交之前从表单中添加数据并将其呈现到页面上是预览信息的一种很好的方式。本质上，您需要做的就是编写一个函数，从表单中收集信息，创建新元素，并在“添加”事件(可能是一个按钮onclick)上将文本呈现到页面上。使用对象还可以简化向数据库发送信息的过程。您可以一次创建该对象，并将其用于多种用途。</p><p id="d5d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是一个非常简单的对象创建示例，将该对象的数据字符串呈现到文档正文中。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="748e" class="ko jr hu lm b fv lq lr l ls lt">let addButton = form.querySelector("button.add")<br/>    // console.log(addButton) - to check it's the right element</span><span id="35bf" class="ko jr hu lm b fv lu lr l ls lt">addButton.addEventListener("click", createNewPerson)</span><span id="6a83" class="ko jr hu lm b fv lu lr l ls lt">function createNewPerson(event) {<br/>    event.preventDefault()<br/>      Person = new Object<br/>      Person.name = nameField<br/>      Person.age = ageField<br/>      Person.profession = professionField<br/>      addPersonToEvent(Person)<br/>    }</span><span id="4b17" class="ko jr hu lm b fv lu lr l ls lt">function addPersonToEvent(person) {</span><span id="f947" class="ko jr hu lm b fv lu lr l ls lt">        let newPerson = "Name: " + person.name + ", Age: " + person.age + ", Profession: " + person.profession        <br/>        let thisAttendee = document.createTextNode(newPerson)<br/>        let linebreak = document.createElement("br")<br/>        document.body.appendChild(thisAttendee)<br/>    }</span></pre><p id="26e5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这里，我做了几件事。我选择了表单上的add按钮，并向它添加了一个事件侦听器——记住使用正确的语法——从表单中获取信息，用它创建一个新对象，然后使用。appendChild()。</p><p id="e9b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第3部分中，我将介绍页面上数据的完整CRUD功能，战略性地呈现信息(而不仅仅是document.body，它附加在末尾),并准备将JSON发送到后端。</p><h2 id="7595" class="ko jr hu bd js kp kq kr jw ks kt ku ka jc kv kw ke jg kx ky ki jk kz la km lb dt translated">资源</h2><div class="mo mp fm fo mq mr"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd hv fv z el mw eo ep mx er et ht dt translated">Object.create()</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">Object.create()方法使用指定的原型对象和属性创建一个新对象。</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">developer.mozilla.org</p></div></div><div class="na l"><div class="nb l nc nd ne na nf lx mr"/></div></div></a></div><div class="mo mp fm fo mq mr"><a href="https://www.sitepoint.com/demystifying-javascript-variable-scope-hoisting/" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd hv fv z el mw eo ep mx er et ht dt translated">揭开JavaScript变量范围和提升的神秘面纱</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">本文着眼于JavaScript编程的两个基础——可变范围和提升。</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">www.sitepoint.com</p></div></div><div class="na l"><div class="ng l nc nd ne na nf lx mr"/></div></div></a></div><div class="mo mp fm fo mq mr"><a href="https://www.w3schools.com/cssref/css_selectors.asp" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd hv fv z el mw eo ep mx er et ht dt translated">CSS选择器参考</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">组织良好，易于理解的网站建设教程，有很多如何使用HTML，CSS，JavaScript的例子…</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">www.w3schools.com</p></div></div><div class="na l"><div class="nh l nc nd ne na nf lx mr"/></div></div></a></div><div class="mo mp fm fo mq mr"><a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd hv fv z el mw eo ep mx er et ht dt translated">EventTarget.addEventListener()</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">方法将指定的EventListener兼容对象添加到event…</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">developer.mozilla.org</p></div></div><div class="na l"><div class="ni l nc nd ne na nf lx mr"/></div></div></a></div><figure class="lh li lj lk fq lw"><div class="bz el l di"><div class="nj nk l"/></div></figure></div></div>    
</form></body>
</html>