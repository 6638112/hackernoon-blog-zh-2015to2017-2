<html>
<head>
<title>Time of check to time of use (TOCTOU): A race condition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检查时间到使用时间(TOCTOU):一种竞争条件</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/time-of-check-to-time-of-use-toctou-a-race-condition-99c2311bd9fc?source=collection_archive---------4-----------------------#2017-02-20">https://medium.com/hackernoon/time-of-check-to-time-of-use-toctou-a-race-condition-99c2311bd9fc?source=collection_archive---------4-----------------------#2017-02-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/74a2380a285e588ed7ad5f1d10119156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0r7afkqtiI619siWO7Ieg.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Race condition</figcaption></figure><p id="3a4d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">为了更好地理解这个概念，对这个主题的解释从一个真实生活中的例子开始。</p></div><div class="ab cl ke kf hc kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hn ho hp hq hr"><p id="f9f0" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是下午，当约翰去办公室，他告诉他的妻子莎哈娜，他将在晚上5:00。他告诉她到时候把茶准备好。</p><p id="9ce9" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">莎哈娜照顾她的丈夫。所以她做的第一件事是检查泡茶所需的所有材料是否都在。一切都很好，除了糖，糖的量少一些，但足以为她的丈夫泡茶。</p><p id="012e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">她感到很满足，在她丈夫来之前睡了几个小时。当她睡觉的时候，他们的女仆来了，做她的日常家务。</p><p id="b85d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">完成任务后，她觉得累了，所以她想喝杯茶。通常，她在使用厨房里的任何东西之前都会问莎哈娜，但是，因为莎哈娜正在睡觉，她继续为自己泡了一杯茶。</p><p id="251a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">她看到厨房里备有泡茶所需的一切。几分钟后茶就准备好了。她喝完就走了。</p><p id="79bc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">至此，故事看起来有点简单，但问题现在开始了。</p><p id="feba" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">莎哈娜醒了，因为她确信每种成分都有足够的量泡茶，她开始泡茶。</p><p id="61bd" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在制作过程中间，她意识到糖不在那里。<br/>天啊！！</p><p id="d7f5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">她现在该做什么？</p><p id="78f1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这就是TOCTOU(检查时间到更新时间)概念的由来。</p><h2 id="b24b" class="km kn hu bd ko kp kq kr ks kt ku kv kw jr kx ky kz jv la lb lc jz ld le lf lg dt translated">什么是<em class="lh">托头</em>？</h2><p id="7506" class="pw-post-body-paragraph jg jh hu ji b jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz lm kb kc kd hn dt translated">维基百科称</p><blockquote class="ln lo lp"><p id="25a0" class="jg jh kl ji b jj jk jl jm jn jo jp jq lq js jt ju lr jw jx jy ls ka kb kc kd hn dt translated">在软件开发中，从检查时间到使用时间(TOCTTOU或TOCTOU，发音为“TOCK too”)是一类软件错误，由系统在检查条件(如安全凭证)和使用检查结果之间的变化引起。这是竞争条件的一个例子。</p></blockquote><p id="d2f3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">TOCTOU指出，如果在某个进程检查某个条件的时刻和同一进程基于该条件采取行动的时刻之间，系统的状态发生变化，就会出现竞争条件。</p><p id="596a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">上面写的例子有什么关系？</strong></p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff lt"><img src="../Images/9b86bf684ab59db80aee06d7305fbac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*yKoYNzf3_1AA-cvFM_g5cQ.jpeg"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Race condition</figcaption></figure><p id="d1b6" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果我们看到上面的例子，shahana和maid是两个试图访问一个公共资源的进程，这个资源就是<strong class="ji hv"> sugar </strong>。</p><p id="e11c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">当单个资源(对象/变量)被多个进程访问和修改时，在并发编程环境中也会出现同样的情况。</p><p id="664d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="kl">操作系统可以暂停正在运行的进程，允许另一个进程使用CPU一段时间。</em></p><p id="53ee" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在可能发生的情况是，新的进程也正在修改被前一个进程访问的同一资源，因此发生争用情况的机会爆发了！！</p><p id="d58c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果你喜欢这篇文章，请点击♥按钮，这样其他媒体用户可能会发现它，也会喜欢它。</p></div></div>    
</body>
</html>