<html>
<head>
<title>Training Custom Models Using Turi Create</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Turi Create训练自定义模型</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/training-custom-models-using-turi-create-94fcc218fd6b?source=collection_archive---------19-----------------------#2017-12-20">https://medium.com/hackernoon/training-custom-models-using-turi-create-94fcc218fd6b?source=collection_archive---------19-----------------------#2017-12-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/8e7f313fbd17083ef8f5f07afa0072de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCPCFY3wrSjApnZ57h5NLw.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek"><a class="ae jg" href="https://tctechcrunch2011.files.wordpress.com/2015/02/shutterstock_175625024.jpg" rel="noopener ugc nofollow" target="_blank">https://tctechcrunch2011.files.wordpress.com/2015/02/shutterstock_175625024.jpg</a></figcaption></figure><p id="0d78" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在我的上一篇文章中，我谈到了将TensorFlow模型集成到iOS应用程序中。我们使用了<strong class="jj hv"> tfcoreml </strong> <a class="ae jg" href="https://hackernoon.com/tagged/tool" rel="noopener ugc nofollow" target="_blank">工具</a>来执行模型之间的转换。虽然tfcoreml工具是一个强大的工具，但它不是非常友好的开发者。文档的缺乏和寻找正确的操作符来使你的模型工作需要大量的时间和精力。</p><p id="5517" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最近，苹果发布了一款名为<a class="ae jg" href="https://github.com/apple/turicreate" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv"> Turi Create </strong> </a>的工具，能够训练定制的<a class="ae jg" href="https://hackernoon.com/tagged/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>模型。这意味着你可以开发出可以识别你家庭不同成员的模型，只要你用大量的图像训练这个模型……大量的。</p><p id="4fe9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我将把重点放在猫和狗上，而不是确定家庭成员，它们也被称为大家庭的成员。我们将建立一个自定义模型，可以识别图像是猫还是狗。</p><h2 id="6978" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">下载猫和狗的图片</h2><p id="37e2" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">第一步，下载大量的猫狗图片。这是必要的，因为我们将使用这些图像来训练我们的定制模型。我们可以利用ImageNet之类的服务，而不是从Google Images下载图片，这可能需要很长时间。转到<a class="ae jg" href="http://image-net.org" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>并搜索cat。这会带来很多不同的结果。我们选择了“<strong class="jj hv">真实的猫</strong>”，这将带你到一个新的页面，在那里你可以下载所有猫图片的网址。</p><p id="8db4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">注意</strong>:即使您可以在ImageNet上成功创建一个帐户，但您仍然无法获得下载实际图像的许可。你必须下载网址。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/91811d3545fcd208d446c3188d2411be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9P5xjKZVbkuS0X6sSIc1GA.png"/></div></div></figure><p id="2d36" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">继续下载猫狗数据集的网址。现在，您已经有了数据集的URL，我们需要下载与每个URL相关联的图像。</p><p id="557e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我编写了一个简单的Python脚本，它从文件中读取URL，然后将图像下载到脚本中变量指定的文件夹中，如下所示。我不是Python语言的专家，但是下面的脚本现在可以用了！</p><figure class="lg lh li lj fq iv"><div class="bz el l di"><div class="lk ll l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Downloading and Saving Images Using Python</figcaption></figure><p id="7299" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">转到终端并执行脚本。</p><pre class="lg lh li lj fq lm ln lo lp aw lq dt"><span id="127b" class="kf kg hu ln b fv lr ls l lt lu">python download_images.py</span></pre><p id="9233" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这将开始将图像下载到指定的文件夹中，如下所示:</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lv"><img src="../Images/28f3ff23705fcf1ca2189bd16801ccce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*giTCbiTo-gAq9NDSLrBrgQ.png"/></div></div></figure><p id="fd16" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下载所有图像的过程需要一段时间！老实说，5-8分钟后，我强行停止了脚本。对狗的网址重复同样的过程，确保你把图片放在它们各自的文件夹中，即猫的图片放在“<strong class="jj hv">猫</strong>文件夹中，狗的图片放在“<strong class="jj hv">狗</strong>文件夹中。</p><p id="3c9b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">一旦图像被下载，我们就可以标记和训练我们的定制模型来识别狗和猫。</p><h2 id="3b2c" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">标记和训练模型</h2><p id="6f72" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">在我们开始训练我们的模型之前，我们首先需要标记这些图片是“<strong class="jj hv">猫</strong>还是“<strong class="jj hv">狗</strong>”。幸运的是，Turi Create文档包含了所有必要的代码，可以基于不同的文件夹成功地标记图像。</p><figure class="lg lh li lj fq iv"><div class="bz el l di"><div class="lk ll l"/></div></figure><p id="3478" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最后一行data.explore()甚至会打开一个Turi Create Image Visualizer，您可以在其中看到图像及其标签。现在我们已经标记了我们的图像，是时候训练它们了。</p><p id="78eb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">幸运的是，所有训练模型的代码都在Turi Create文档中提供。非常感谢！:)</p><figure class="lg lh li lj fq iv"><div class="bz el l di"><div class="lk ll l"/></div></figure><p id="3ac5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在训练模型之后，我们将其导出为核心ML格式，这允许我们将其集成到我们的iOS应用程序中。</p><h2 id="82e8" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">将模型集成到iOS应用程序中</h2><p id="e81c" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">我已经有一个应用程序设置，它通过一个图像列表，并预测每个图像。简单地，拖放模型和一些未标记的图片，你就可以开始了。我回到ImageNet，下载了一个单独的数据集，里面有狗和猫的图片。我这样做是因为我不想使用用于训练模型的相同数据集。下面是为了测试新模型而添加到Xcode项目中的几张图片的截图。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/7d55279062cf408b5a3b1e14cf99cde2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*e6rho5jmncV-StDVwHgNhA.png"/></div></figure><p id="a4bf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">结果如下所示:</p><figure class="lg lh li lj fq iv"><div class="bz el l di"><div class="lx ll l"/></div></figure><p id="3afb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我希望你喜欢这篇文章！</p><h2 id="9192" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">参考</h2><ul class=""><li id="3ffd" class="ly lz hu jj b jk la jo lb js ma jw mb ka mc ke md me mf mg dt translated"><a class="ae jg" href="https://hackernoon.com/building-not-hotdog-with-turi-create-and-core-ml-in-an-afternoon-231b14738edf" rel="noopener ugc nofollow" target="_blank">用Turi Create和Core ML在一个下午打造不一样的热狗</a></li><li id="9a34" class="ly lz hu jj b jk mh jo mi js mj jw mk ka ml ke md me mf mg dt translated"><a class="ae jg" href="https://github.com/apple/turicreate" rel="noopener ugc nofollow" target="_blank"> Turi创建</a></li></ul><p id="f5ad" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你想支持我的文章，请查看我在www.azamsharp.com的Udemy课程。所有Udemy课程都附有一张10美元的优惠券。我希望你喜欢这些课程。</p><figure class="lg lh li lj fq iv"><div class="bz el l di"><div class="mm ll l"/></div></figure></div></div>    
</body>
</html>