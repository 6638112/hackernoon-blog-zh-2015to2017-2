<html>
<head>
<title>My first steps in deep learning — recognising handwritten digits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我深度学习的第一步——识别手写数字</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/my-first-steps-in-deep-learning-recognising-handwritten-digits-f72e72936ea4?source=collection_archive---------7-----------------------#2017-04-05">https://medium.com/hackernoon/my-first-steps-in-deep-learning-recognising-handwritten-digits-f72e72936ea4?source=collection_archive---------7-----------------------#2017-04-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><h1 id="60b2" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">序</h1><p id="28ca" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这不是教程。这是我第一次在没有相关背景经验的情况下深入学习的描述。我不是深度学习方面的专家，以下内容很可能包含错误和误解。如果你找到一些，请让我知道。</p><p id="c059" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">所有源代码都可以在以下位置找到:</p><p id="7b0c" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated"><a class="ae ks" href="https://github.com/Miksu82/DigitRecognizer" rel="noopener ugc nofollow" target="_blank">https://github.com/Miksu82/DigitRecognizer</a></p><h1 id="4d5b" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">背景</h1><p id="e146" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我作为专业软件开发人员已经工作了将近10年，大部分时间我都在为Android和iOS平台开发软件。长期以来，我一直对数据以及如何从我们每天创建的大量数据中提取有价值的信息感兴趣。</p><p id="50aa" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">在那段时间里，我读了一些机器学习博客帖子，看了一些讲座和Youtube视频。最近，我听到了越来越多关于深度学习的消息，但直到现在，我还没有真正采取任何实际步骤来真正尝试我读过的任何技术。大约一个月前，我从<a class="ae ks" href="https://reddit.com/r/programming" rel="noopener ugc nofollow" target="_blank"> /r/programming </a>找到了<a class="ae ks" href="https://hackernoon.com/learning-ai-if-you-suck-at-math-p5-deep-learning-and-convolutional-neural-nets-in-plain-english-cda79679bbe3" rel="noopener ugc nofollow" target="_blank">的这篇文章</a>，最终决定尝试一些深度学习的东西。</p><h1 id="7ffb" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">该项目</h1><p id="098c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">如何开始学习新的东西？对我来说，最好的学习方法是亲自动手，而不是去查阅教科书(我通常在遇到问题后，或者我有了一些有用的东西，但不知道为什么有用时，会求助于教科书和文档)。为了开始，我需要选择一个项目。我的项目有两个主要要求</p><ol class=""><li id="836b" class="kt ku hu jr b js kn jw ko ka kv ke kw ki kx km ky kz la lb dt translated">我需要能够在合理的时间内用我2岁的Macbook Pro训练我的深度学习模型。</li><li id="9e2f" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km ky kz la lb dt translated">我想在真实世界的情况下尝试该模型，而不仅仅是相信训练/测试数据分割</li></ol><p id="1f20" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">第一个需求排除了巨大的数据集，第二个需求排除了所有我不容易生成新数据的数据集。</p><p id="afcb" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">我已经听说过MNIST数据集，并认为它是一个很好的候选，因为图像非常小，很容易编写一个Android应用程序来绘制到屏幕上。然后我还发现了<a class="ae ks" href="https://www.google.com.mx/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjHlv_JyovTAhUL8mMKHUkbCP0QFggcMAA&amp;url=https%3A%2F%2Fdeeplearning4j.org%2F&amp;usg=AFQjCNETbYCvvHS7BAxKuNiwcyE2pcrF7g" rel="noopener ugc nofollow" target="_blank"> Deeplearning4j </a>使得将<a class="ae ks" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>(稍后会详细介绍)模型导入Java成为可能。</p><p id="fbf1" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">我以为我已经准备好启动我的Android手写数字识别应用程序了。</p><h1 id="062b" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">设置环境</h1><p id="c764" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">重要的事情先来。我需要用一些深度学习框架来设置我的机器。正如我已经提到的，我通过阅读<a class="ae ks" href="https://hackernoon.com/learning-ai-if-you-suck-at-math-8bdfb4b79037" rel="noopener ugc nofollow" target="_blank">学习人工智能如果你数学很差</a>的博客帖子开始了整个事情。从那里，我了解了如何通过使用Docker图像来建立一个<a class="ae ks" href="https://github.com/floydhub/dl-docker" rel="noopener ugc nofollow" target="_blank">深度学习环境，我决定使用它。通过克隆上面链接中提到的Github repo并按照说明操作，我很快就设置好了环境，没有任何故障。不幸的是，正如说明中解释的那样，我不能使用GPU来训练我的模型，但我认为这在这一点上没有关系。</a></p><h1 id="00f1" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">构建模型</h1><p id="0e9b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在<a class="ae ks" href="https://hackernoon.com/learning-ai-if-you-suck-at-math-8bdfb4b79037" rel="noopener ugc nofollow" target="_blank">如果你数学很差的话学习人工智能</a>博客文章中的例子使用了<a class="ae ks" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>来建立模型，所以我决定也用它。Keras是<a class="ae ks" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>和<a class="ae ks" href="http://deeplearning.net/software/theano/" rel="noopener ugc nofollow" target="_blank"> Theano </a>框架的抽象层，使得描述深度学习网络的层次变得更加容易。描述完各层后，通过使用<a class="ae ks" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>或<a class="ae ks" href="http://deeplearning.net/software/theano/" rel="noopener ugc nofollow" target="_blank">the no</a>作为后端来构建模型。Keras还支持将模型持久化到一个文件中，并且<a class="ae ks" href="https://www.google.com.mx/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjHlv_JyovTAhUL8mMKHUkbCP0QFggcMAA&amp;url=https%3A%2F%2Fdeeplearning4j.org%2F&amp;usg=AFQjCNETbYCvvHS7BAxKuNiwcyE2pcrF7g" rel="noopener ugc nofollow" target="_blank"> Deeplearning4j </a>可以导出这些模型以便在Java应用程序中使用。因此，这似乎是一个非常合适的选择。</p><h2 id="1edb" class="lh is hu bd it li lj lk ix ll lm ln jb ka lo lp jf ke lq lr jj ki ls lt jn lu dt translated">学习使用Keras</h2><p id="5ef7" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在开始使用MNIST数据之前，我想了解一下Keras是如何使用的。我再次启动谷歌，看看我能找到什么。我想出了这篇文章，看起来是一个很好的开始。在花了几个小时试图弄清楚一个皮马印第安人是否患有糖尿病之后，我决定是时候检验一下MNIST的数据了。</p><h2 id="44d6" class="lh is hu bd it li lj lk ix ll lm ln jb ka lo lp jf ke lq lr jj ki ls lt jn lu dt translated">使用MNIST数据进行培训</h2><p id="5a90" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我很确定，如果我在谷歌上搜索“MNIST·克拉斯”，我会找到大量描述如何训练模型识别手写数字的例子。我认为Keras repo中的例子也有这一点。但是那样就像作弊一样，所以我决定试试别的方法。</p><p id="b5e4" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">我已经尝试过一个二元结果的模型。一个人可能有糖尿病，也可能没有。但是在MNIST的例子中，我可以有10个不同的输出(0-9之间的数字)。显然是一个非常不同的问题。</p><p id="01ee" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">在有第一个教程的同一个网站上，我还找到了一个多类分类教程。我试图跟着它走，但哪儿也去不了。原因在于，在教程中，输入数据是描述鸢尾花不同部分长度的1×4矢量，而在MNIST，输入数据是28×28图像。事后看来，这是显而易见的，但当我第一次开始摆弄这个教程时，情况并非如此。</p><p id="8c0e" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">所以回到起点。如何在没有找到完整答案的情况下入门？最后，问题是关于图像的分类，我记得<a class="ae ks" href="https://hackernoon.com/learning-ai-if-you-suck-at-math-8bdfb4b79037" rel="noopener ugc nofollow" target="_blank">学人工智能如果你数学很差</a>的博客帖子有类似的内容。我再次查看了一下，那个博客的<a class="ae ks" href="https://hackernoon.com/learning-ai-if-you-suck-at-math-p5-deep-learning-and-convolutional-neural-nets-in-plain-english-cda79679bbe3" rel="noopener ugc nofollow" target="_blank">第5部分</a>有一个使用ImageNet数据进行图像分类的例子。我决定以此为起点。</p><p id="3cc1" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">在输入矩阵后，我得到了MNIST的正确形式，这样它就可以输入到Keras中。我首先完全按照示例中的定义尝试了这些层</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="e5a3" class="lh is hu ma b fv me mf l mg mh">model = Sequential()</span><span id="094b" class="lh is hu ma b fv mi mf l mg mh">model.add(Convolution2D(nb_filters, kernel_size[0], kernel_size[1],<br/>                        border_mode='valid',<br/>                        input_shape=input_shape))<br/>model.add(Activation('relu'))<br/>model.add(Convolution2D(nb_filters, kernel_size[0], kernel_size[1]))<br/>model.add(Activation('relu'))<br/>model.add(MaxPooling2D(pool_size=pool_size))<br/>model.add(Dropout(0.25))<br/>model.add(Flatten())<br/>model.add(Dense(256))<br/>model.add(Activation('relu'))<br/>model.add(Dropout(0.5))<br/>model.add(Dense(nb_classes))<br/>model.add(Activation('softmax'))</span></pre><p id="abea" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">但那并不奏效。我刚刚得到了大约10%的准确度。我决定做我在调试时做的事情——让事情更简单。我开始去除图层。我只留下了两个卷积层，池层和最后一个致密层。总是需要最后一个密集层来限制不同类别的数量，在本例中是10个。我真的不明白为什么有两个卷积层，或者池层的意义何在，但读了博客后，我有点明白它们是有用的。所以我有了这个:</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="804b" class="lh is hu ma b fv me mf l mg mh">model = Sequential()<br/>model.add(Convolution2D(nb_filters, kernel_size[0], kernel_size[1],<br/>                        border_mode='valid',<br/>                        input_shape=input_shape))<br/>model.add(Activation('relu'))<br/>model.add(Convolution2D(nb_filters, kernel_size[0], kernel_size[1]))<br/>model.add(Activation('relu'))<br/>model.add(MaxPooling2D(pool_size=pool_size))<br/>model.add(Flatten())<br/>model.add(Dense(nb_classes))<br/>model.add(Activation('softmax'))</span></pre><p id="0118" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">但是仍然没有成功。所以我进一步减少了它们(并将激活函数作为参数更改为<em class="mj"> add </em> function):</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="7748" class="lh is hu ma b fv me mf l mg mh">model = Sequential()<br/>model.add(Convolution2D(nb_filters, kernel_size[0], kernel_size[1],<br/>                        border_mode='valid',<br/>                        input_shape=input_shape<br/>                        activation='relu'))<br/>model.add(MaxPooling2D(pool_size=pool_size))<br/>model.add(Flatten())<br/>model.add(Dense(nb_classes), activation='softmax')</span></pre><p id="c4a6" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">…但没有成功。我仍然只能得到大约10%的测试数据准确性。所以我开始改变不同的参数，比如内核大小、池大小、过滤器数量(我仍然不知道这些参数的真正含义)，但是没有任何东西可以提高精确度。</p><p id="55df" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">直到我把第一个激活函数改成了<em class="mj"> sigmoid。我有97%的准确率。</em>我不知道为什么<em class="mj"> sigmoid </em>对这个数据有效，而<em class="mj">整流器</em>无效，但这是我将来需要弄清楚的事情<em class="mj">。现在我终于设置好了我的图层。</em></p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="b500" class="lh is hu ma b fv me mf l mg mh">model = Sequential()<br/>model.add(Convolution2D(nb_filters,<br/>                        kernel_size[0],<br/>                        kernel_size[1],<br/>                        border_mode='valid',<br/>                        input_shape=input_shape,<br/>                        activation='sigmoid'))<br/>model.add(MaxPooling2D(pool_size=pool_size))<br/>model.add(Flatten())<br/>model.add(Dense(nb_classes, activation='softmax'))</span></pre><p id="9fd1" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">现在我可以训练模型了。我之前只使用了训练数据的子集和几个时期来训练模型，因为使用所有的训练数据花费了太多的时间。在我2015年初的Macbook Pro中，仅使用CPU，用MNIST数据集中的所有60000幅训练图像和20个时期来训练模型需要大约16分钟。如果有人知道如果我使用GPU会提高多少，请添加评论。</p><h1 id="b818" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">将模型导入Android</h1><p id="179d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">现在我已经训练好了我的模型，是时候把它加载到Android上并画一些数字了。我首先实现了绘图代码，根据我的经验和堆栈溢出中的几个例子，这些代码非常简单。</p><p id="4fe8" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">为了在Android中使用Deeplearning4j，我遵循了这个教程。在为Android项目配置<em class="mj"> multidex </em>支持(出于某种原因，我需要添加</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="befc" class="lh is hu ma b fv me mf l mg mh"><strong class="ma hv">compile</strong> <strong class="ma hv">‘com.android.support:multidex:1.0.1’</strong></span></pre><p id="d8ac" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">给我的依赖者，虽然医生说如果<em class="mj"> minSdkVersion </em>是21或更高就没有必要了)我终于得到了要构建的所有东西。但是当我让项目运行时，Deeplearning4j代码抛出了这个异常:</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="c8d0" class="lh is hu ma b fv me mf l mg mh">java.lang.UnsatisfiedLinkError: dalvik.system.PathClassLoader[DexPathList[[zip file "/data/app/com.kaamos.digitdetector-1/base.apk"],nativeLibraryDirectories=[/data/app/com.kaamos.digitdetector-1/lib/arm, /data/app/com.kaamos.digitdetector-1/base.apk!/lib/armeabi, /vendor/lib, /system/lib]]] couldn't find "libjnihdf5.so"</span></pre><p id="77fa" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">嗯…那是什么？我开始谷歌搜索，但找不到任何相关的东西。我尝试了教程中的<a class="ae ks" href="https://github.com/hathibelagal/Deeplearning4JOnAndroid" rel="noopener ugc nofollow" target="_blank">示例项目</a>，它工作得很好。唯一的区别是，在我的项目中，我使用了<a class="ae ks" href="https://deeplearning4j.org/model-import-keras" rel="noopener ugc nofollow" target="_blank"> Deeplearning4j Keras模型导入库</a>，它不在我用作参考的示例项目中。我深入研究了Keras和Deeplearning4j文档，发现Keras将模型保存为HDF5格式，这似乎与我看到的异常有关。Deeplearning4j一定是用某个库来读取HDF5格式，而那个库不见了。现在我只需要找到那个库，并试着把它编译到Android上。</p><p id="8907" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">因此，我通过运行以下命令检查了我的Android项目中的所有依赖项</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="d4d8" class="lh is hu ma b fv me mf l mg mh">./gradlew app:dependencies</span></pre><p id="8aa4" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">结果列表很大，但吸引我眼球的是这个</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="dbcb" class="lh is hu ma b fv me mf l mg mh">||+--- org.bytedeco.javacpp-presets:hdf5-platform:1.10.0-patch1-1.3<br/>||| \--- org.bytedeco.javacpp-presets:hdf5:1.10.0-patch1-1.3<br/>|||   \--- org.bytedeco:javacpp:1.3 -&gt; 1.3.2</span></pre><p id="cff5" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">看起来像是一个具有组id<em class="mj">org . byte deco . javacpp-presets</em>的工件正在处理HDF5文件。回到谷歌，我找到了那个项目的Github repo以及如何在Android上构建HDF5库的很好的说明。因此，我克隆了回购，并按照说明进行操作，得到了以下错误:</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="56f3" class="lh is hu ma b fv me mf l mg mh">Error: Platform "android-arm" is not supported</span></pre><p id="b60f" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">啊？再次回到谷歌，但我找不到任何东西。然后，我试图找到在<em class="mj"> org.bytedeco.javacpp. </em>中打印该字符串的位置，这导致我从<em class="mj"> org.bytedeco.javacpp </em>构建脚本中找到了该注释:</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="a302" class="lh is hu ma b fv me mf l mg mh"># HDF5 does not currently support cross-compiling:<br/># <a class="ae ks" href="https://support.hdfgroup.org/HDF5/faq/compile.html" rel="noopener ugc nofollow" target="_blank">https://support.hdfgroup.org/HDF5/faq/compile.html</a></span></pre><p id="b979" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">好吧，所以这在Android上没用。我决定用Swing创建普通的Java应用程序。</p><h1 id="2cf0" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">将模型导入Java</h1><p id="72ac" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这是相当直接的。我只是不得不学一点如何使用Swing，在用Android和iOS构建ui多年后，这感觉真的很奇怪，但我设法得到了一些像样的东西。第一个算法执行以下步骤:</p><ul class=""><li id="e754" class="kt ku hu jr b js kn jw ko ka kv ke kw ki kx km mk kz la lb dt translated">画一个数字</li><li id="5d5d" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">找到手指的边缘</li><li id="a71e" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">向较大的尺寸(宽度或高度)添加5个白色像素的填充</li><li id="e79f" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">在较短的维度上添加白色像素，使图像呈方形</li><li id="5a85" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">缩放到28x28图像，因为这是模型预期的输入大小</li></ul><p id="111f" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">结果很糟糕。数字1通常被认为是正确的，但是其他的都被认为是错误的。</p><p id="69ae" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">我开始觉得哪里不对了。</p><ul class=""><li id="aa44" class="kt ku hu jr b js kn jw ko ka kv ke kw ki kx km mk kz la lb dt translated">可能输入的数字线条粗细与训练数据中的不同</li><li id="e433" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">训练图像是灰度的，而来自应用程序的图像是黑白的。</li></ul><p id="80dc" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">我试图用不同的方法来解决这些问题(尝试不同的线条粗细，尝试用不同的渐变来绘制数字，将训练数据改为黑白，等等)。)但无济于事。所以回到程序员最喜欢的朋友。谷歌和栈溢出。我找到了<a class="ae ks" href="http://stackoverflow.com/questions/40627099/poor-performance-on-digit-recognition-with-cnn-trained-on-mnist-dataset" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。它引用了MNIST官方文件:</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="3f71" class="lh is hu ma b fv me mf l mg mh">The original black and white (bilevel) images from NIST were size normalized to fit in a 20x20 pixel box while preserving their aspect ratio. The resulting images contain grey levels as a result of the anti-aliasing technique used by the normalization algorithm. the images were centered in a 28x28 image by computing the center of mass of the pixels, and translating the image so as to position this point at the center of the 28x28 field.</span></pre><p id="432b" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">将我的算法更改为:</p><ul class=""><li id="9cfb" class="kt ku hu jr b js kn jw ko ka kv ke kw ki kx km mk kz la lb dt translated">画一个数字</li><li id="1ce7" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">找到手指的边缘</li><li id="6f0b" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">缩放至20x20，同时保持纵横比</li><li id="05f8" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">计算质心</li><li id="e018" class="kt ku hu jr b js lc jw ld ka le ke lf ki lg km mk kz la lb dt translated">将20x20的图像输入到28x28的背景中，这样质心就在中间。</li></ul><p id="ca2e" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">…瞧。我几乎每次都能正确识别数字。</p><p id="a241" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">直到我让女朋友测试app。不知何故，她画的数字2经常被认为是3或7。不知道为什么。</p><h1 id="ce49" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">后续步骤</h1><p id="7c11" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我对第一次深度学习的尝试还算满意。我学到了很多。尤其是输入数据必须准确地(而不是几乎)作为训练数据来构建，以及深度学习算法对人类无法识别的数据中的微小中断非常敏感。<a class="ae ks" href="https://actu.epfl.ch/news/when-deep-learning-mistakes-a-coffee-maker-for-a-c/" rel="noopener ugc nofollow" target="_blank">这似乎也是一个活跃的研究领域</a>。</p><p id="9eb9" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">接下来，我希望我能找到时间来理解我的训练算法实际上是做什么的。几乎每一行对我来说仍然是一个什么样的黑匣子，所以我想是时候回到我从大学毕业后就没有打开过的数学课本上了。</p><p id="b6d9" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">也感谢所有的建议…</p><blockquote class="ml mm mn"><p id="231d" class="jp jq mj jr b js kn ju jv jw ko jy jz mo kp kc kd mp kq kg kh mq kr kk kl km hn dt translated"><a class="ae ks" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ks" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ks" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae ks" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="jp jq mj jr b js kn ju jv jw ko jy jz mo kp kc kd mp kq kg kh mq kr kk kl km hn dt translated">要了解更多信息，请<a class="ae ks" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">阅读我们的“关于”页面</a>、<a class="ae ks" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书上点赞/给我们发消息</a>，或者简单地说，<a class="ae ks" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="jp jq mj jr b js kn ju jv jw ko jy jz mo kp kc kd mp kq kg kh mq kr kk kl km hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ks" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ks" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>