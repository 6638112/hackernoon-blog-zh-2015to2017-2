<html>
<head>
<title>A Procedural Landscape Experiment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">程序性景观实验</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-procedural-landscape-experiment-4efe1826906f?source=collection_archive---------10-----------------------#2017-05-24">https://medium.com/hackernoon/a-procedural-landscape-experiment-4efe1826906f?source=collection_archive---------10-----------------------#2017-05-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="1912" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">快脏(？)Rust的99 LoC中的程序生成</h2></div><p id="5fff" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">几天前，我试图创建一个程序化的景观生成器。下面是实际结果:<a class="ae kf" href="https://rap2hpoutre.github.io/landscape-site/" rel="noopener ugc nofollow" target="_blank">https://rap2hpoutre.github.io/landscape-site/</a></p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff kg"><img src="../Images/15494ffe978a26793b244b8583cd13e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OYOz__xSF8pGp3G7kTCQuw.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Sometimes there is a moon or a sun.</figcaption></figure><p id="4a59" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我喜欢知道事物是如何运作的；这是我如何建造的。</p><h1 id="4333" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">山脉</h1><p id="588c" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">我不是一个好的程序员，也不知道如何创造山。我在栈交换上找到这个答案:<a class="ae kf" href="https://gamedev.stackexchange.com/a/93531/81351" rel="noopener ugc nofollow" target="_blank">https://gamedev.stackexchange.com/a/93531/81351</a></p><p id="6103" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以，我把这段代码转换成了Rust，因为我喜欢Rust是有原因的。首先，我创建了一个<code class="eh lt lu lv lw b">Mountain</code>结构。</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="81a3" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh lt lu lv lw b">points</code>是每个顶点的“y”位置:在640x480的图像上，有640个点，从0(最高)到480(最低)不等。</p><p id="02e3" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后我创建了两个相关的函数:一个用于初始化点的<code class="eh lt lu lv lw b">new</code>方法和一个用于渲染山脉每个像素的<code class="eh lt lu lv lw b">draw</code>方法。</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="8265" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是最长的部分(它很脏，但不是最丑的！)，觉得只是对我提到的StackExchange帖子的改编复制/粘贴。</p><p id="4eea" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh lt lu lv lw b">new</code>方法采用一组参数<code class="eh lt lu lv lw b">y_amp</code>，这是当前山脉的边界(最大高度和最小高度)。这些点用随机的相邻值初始化。</p><p id="15db" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh lt lu lv lw b">draw</code>方法引用了我们正在绘制的图像和两种颜色:山脉的初始颜色(<code class="eh lt lu lv lw b">color</code>)和雾的颜色(<code class="eh lt lu lv lw b">c_fog</code>)，这是创建渐变所必需的。对于每个<code class="eh lt lu lv lw b">point</code>，从图像的顶部到底部画一条渐变“线”，混合雾色和初始色。</p><p id="acf6" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我本可以使用常量(640、480等。)，为变量选择更好的名称并添加注释但是，嘿！没时间了！要快，要脏。</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff lz"><img src="../Images/6916960449713d95cacc558676c2e02d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xo7v-A34EusGbMT02GX55w.png"/></div></div></figure><h1 id="37b1" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">随机颜色助手</h1><p id="160e" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">这个程序的主要任务是生成随机的颜色。我创建了一个小助手来生成颜色:</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="c67b" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="ma">我忘了说所有的函数和结构，像</em><code class="eh lt lu lv lw b"><em class="ma">Rgb</em></code><em class="ma"/><code class="eh lt lu lv lw b"><em class="ma">RgbImage</em></code><em class="ma"/><code class="eh lt lu lv lw b"><em class="ma">interpolate</em></code><em class="ma">等等。来源于优秀的、部分记载的和或多或少的厩“</em><a class="ae kf" href="https://crates.io/crates/image" rel="noopener ugc nofollow" target="_blank"><em class="ma"/></a><em class="ma">”和“</em><a class="ae kf" href="https://crates.io/crates/imageproc" rel="noopener ugc nofollow" target="_blank"><em class="ma">image proc</em></a><em class="ma">”板条箱(一个板条箱就是一个锈库)。</em></p><p id="4671" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我写的<code class="eh lt lu lv lw b">rgb_rand</code>函数可以从红色范围、绿色范围、蓝色范围中随机生成一种颜色。从现在起，我将在任何地方使用它。</p><h1 id="c53f" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">渐变天空和随机月亮</h1><p id="bca1" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">在<code class="eh lt lu lv lw b">rgb_rand</code>函数的帮助下，我可以初始化一个随机的天空颜色，一个随机的雾颜色，和一个随机的月亮颜色。</p><p id="bbf9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">天空。它可以是浅色、深色或浅蓝色，让我们扔1D3:</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="dc2f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">雾有完全随机的颜色和行星(月球？孙？谁在乎呢。)颜色是天空和随机颜色的混合:</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="8ca8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在让我们画出一切。所以我从天空开始(我们的基础图像缓冲区):</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="4fdc" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后程序用<code class="eh lt lu lv lw b">gen_weighted_bool</code>扔硬币后往往会画出星球。这个星球只是一个实心圆。有时，另一个实心圆会用天空的颜色画出来，创造出新月的效果。</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="b171" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后在我们画的所有东西上应用渐变。</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="44fd" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有了主函数中的所有代码，我们现在有了一个带月亮的渐变天空。</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff mb"><img src="../Images/963916546b3bc0fa8c04a90168ff2461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RsVkAlSLmWMcaWNnSU8AUA.png"/></div></div></figure><h1 id="9342" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">渐变天空中柔和的山脉</h1><p id="c3bd" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">是时候在这个渐变的天空上添加一些山脉了。</p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="0cb8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">简而言之，我只是定义了一个山脉随机数<code class="eh lt lu lv lw b">mountain_count</code>，然后是一个基色<code class="eh lt lu lv lw b">c_mountain</code>。然后我们对每一条山脉进行迭代，构建并绘制我们在第一步中创建的<code class="eh lt lu lv lw b">Mountain</code>。</p><p id="3be8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">深山的颜色随着天空的颜色变得柔和了。记住雾的颜色也和山脉混合在一起，使它们看起来不那么平坦。</p><p id="d5f2" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">可能我忘了什么，完整代码在这里:<a class="ae kf" href="https://github.com/rap2hpoutre/landscape/blob/master/src/main.rs" rel="noopener ugc nofollow" target="_blank">https://github . com/rap 2 HP outre/landscape/blob/master/src/main . RS</a></p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff lz"><img src="../Images/ec0ea04a90f2215b1fab7dddfc3804ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NpH8kF4uwk97FmSQvsXZ8Q.png"/></div></div></figure><h1 id="96ae" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">最后的想法</h1><p id="a24e" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">我喜欢程序化的生成，我喜欢阅读关于程序化的东西是如何被创造出来的，即使我大部分时间都不明白。这篇文章是对我编写的代码的描述，显然不是关于Rust的指南或教程。结果并不超级性感，但我喜欢创造它。我还建立了一个小网站，每分钟都有新的风景出现。装在相框里，因为我想让它看起来有艺术感！这就是:<a class="ae kf" href="https://rap2hpoutre.github.io/landscape-site/" rel="noopener ugc nofollow" target="_blank">https://rap2hpoutre.github.io/landscape-site/</a></p><p id="11ef" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我的主要灵感来自于<a class="ae kf" href="https://en.wikipedia.org/wiki/Navarre" rel="noopener ugc nofollow" target="_blank">纳瓦拉</a>山脉。这里有一个比我的好得多的项目列表，也是我搜罗的他们的想法:</p><ul class=""><li id="4e9d" class="mc md hu jl b jm jn jp jq js me jw mf ka mg ke mh mi mj mk dt translated">【https://foopod.github.io/sunset/ T4】</li><li id="1ab1" class="mc md hu jl b jm ml jp mm js mn jw mo ka mp ke mh mi mj mk dt translated"><a class="ae kf" href="http://v21.io/softlandscapes/" rel="noopener ugc nofollow" target="_blank">http://v21.io/softlandscapes/</a></li><li id="348c" class="mc md hu jl b jm ml jp mm js mn jw mo ka mp ke mh mi mj mk dt translated"><a class="ae kf" href="https://www.reddit.com/r/proceduralgeneration/comments/606y33/procedurally_generated_landscapes/" rel="noopener ugc nofollow" target="_blank">https://www . Reddit . com/r/procedural generation/comments/606 y33/procedural _ generated _ landscapes/</a></li><li id="9e38" class="mc md hu jl b jm ml jp mm js mn jw mo ka mp ke mh mi mj mk dt translated"><a class="ae kf" href="http://imgur.com/a/3Fmuf" rel="noopener ugc nofollow" target="_blank">http://imgur.com/a/3Fmuf</a></li><li id="72aa" class="mc md hu jl b jm ml jp mm js mn jw mo ka mp ke mh mi mj mk dt translated"><a class="ae kf" href="https://gamedev.stackexchange.com/questions/93511/how-can-i-generate-a-2d-mountain-landscape-procedurally" rel="noopener ugc nofollow" target="_blank">https://game dev . stack exchange . com/questions/93511/how-can-I-generate-a-2d-mountain-landscape-procedurally</a></li></ul><p id="708f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我很乐意回答问题，听取建议或面对批评。</p><p id="d3ed" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">感谢@dorhan_的点评！</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/efa9aa4f1e7f5666db7238c6afa77aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*-w_jO2URWhtloRnIphj1qQ.png"/></div></figure><div class="kh ki kj kk fq ab cb"><figure class="mr kl ms mt mu mv mw paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mr kl ms mt mu mv mw paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mr kl ms mt mu mv mw paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mx my mz"><p id="f922" class="jj jk ma jl b jm jn iv jo jp jq iy jr na jt ju jv nb jx jy jz nc kb kc kd ke hn dt translated"><a class="ae kf" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae kf" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kf" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>的机会。</p><p id="708a" class="jj jk ma jl b jm jn iv jo jp jq iy jr na jt ju jv nb jx jy jz nc kb kc kd ke hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kf" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kf" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff nd"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>