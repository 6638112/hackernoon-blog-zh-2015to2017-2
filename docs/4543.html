<html>
<head>
<title>How to Animate the Items of a React Native FlatList</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何激活React本机平面列表的项目</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-animate-the-items-of-a-react-native-flatlist-32c8cbf7ea3d?source=collection_archive---------0-----------------------#2017-06-07">https://medium.com/hackernoon/how-to-animate-the-items-of-a-react-native-flatlist-32c8cbf7ea3d?source=collection_archive---------0-----------------------#2017-06-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/f92e115364642afbd45ff5b5a46bd0f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CwMOVeKYz6i3uUYpoQyieQ.jpeg"/></div></div></figure><div class=""/><p id="9ea2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最近有人问我关于React原生列表中的动画项目——特别是添加和删除项目时的动画。这就是我们今天要讲的内容！为此，我们将使用<code class="eh ka kb kc kd b">FlatList</code>组件和<code class="eh ka kb kc kd b">Animated</code>库。</p><p id="01a6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">GitHub 上有完整的源代码<a class="ae ke" href="https://github.com/spencercarli/animated-react-native-flatlist-demo" rel="noopener ugc nofollow" target="_blank">。列表行的起点在<code class="eh ka kb kc kd b">ListRow-start.js</code>中，完成的代码可以在<code class="eh ka kb kc kd b">ListRow-finished.js</code>中看到。</a></p><h2 id="f993" class="kf kg if bd kh ki kj kk kl km kn ko kp jn kq kr ks jr kt ku kv jv kw kx ky kz dt translated">出发点</h2><p id="82b9" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">现在，当按下“Add Person”按钮时，我们向<a class="ae ke" href="https://randomuser.me/" rel="noopener ugc nofollow" target="_blank">随机用户API </a>请求获取一个用户。然后我们将它添加到组件状态的<code class="eh ka kb kc kd b">people</code>数组中。看看下面的视频，看看我们从哪里开始。</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lj lk l"/></div><figcaption class="ll lm fg fe ff ln lo bd b be z ek">Want more React Native videos? Be sure to subscribe!</figcaption></figure><h2 id="3ef5" class="kf kg if bd kh ki kj kk kl km kn ko kp jn kq kr ks jr kt ku kv jv kw kx ky kz dt translated">动画条目</h2><p id="dcd5" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">为了方便演示我们的动画，我们将为列表项的插入制作动画。当一个新的项目被添加到<code class="eh ka kb kc kd b">people</code>数组时，我们将改变行的不透明度，并通过变换改变缩放和旋转。</p><p id="7bb4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">值得注意的是，在<code class="eh ka kb kc kd b">TouchableOpacity</code>中我们使用了一个<code class="eh ka kb kc kd b">Animated.View</code>，它允许我们使用动画值来修改组件。</p><p id="a556" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，我们将创建一个新的动画值，当组件挂载时，我们将使用<code class="eh ka kb kc kd b">Animated.timing</code>将该值从0更改为1。</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lp lk l"/></div></figure><p id="e0ce" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我们需要从这些值驱动我们的UI。在<code class="eh ka kb kc kd b">render</code>函数中，我们使用动画值来调整不透明度和比例(直接调整，因为0到1是我们想要的)和旋转。我们插入了<code class="eh ka kb kc kd b">rotate</code>属性，这样我们就可以将0到1转换成对该属性有用的数据。</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lp lk l"/></div></figure><p id="c746" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这留给我们这样的东西(改变<code class="eh ka kb kc kd b">ANIMATION_DURATION</code>变量来减慢或加快动画)。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/c0524935497c6cf517b0261755bbb102.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*njLrsrMqHEqNWmVOXMp7yg.gif"/></div></figure><h2 id="b568" class="kf kg if bd kh ki kj kk kl km kn ko kp jn kq kr ks jr kt ku kv jv kw kx ky kz dt translated">动画移除</h2><p id="d31f" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">如果你看一下启动代码，你可以看到我们的组件上有一个函数叫做<code class="eh ka kb kc kd b">onRemove</code>，它调用<code class="eh ka kb kc kd b">this.props.onRemove()</code>。没用吧？不会太久的！我们现在要做的是撤销我们在<code class="eh ka kb kc kd b">componentDidMount</code>中所做的一切。我们不能在<code class="eh ka kb kc kd b">componentWillUnmout</code>中这样做，因为组件将在任何动画运行之前消失！</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lp lk l"/></div></figure><p id="300f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您测试一下，您会发现它实际上并没有做任何事情——行只是像以前一样消失了。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/dd75486f28c60ded9111d1d251fd261c.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*Wfvyl7NCtCx2QRFqakiyOQ.gif"/></div></figure><p id="107b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你注释掉<code class="eh ka kb kc kd b">onRemove</code>函数，你可以看到动画正在发生。</p><p id="de55" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们能做的就是在动画完成时调用<code class="eh ka kb kc kd b">onRemove</code>函数。<code class="eh ka kb kc kd b">.start()</code>函数接受一个回调函数，这个函数将在动画完成时被调用。</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lp lk l"/></div></figure><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/fcdaa7cb47864b76b4e8cdbcb6e11f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*X1z2Vg6B4cqlzaZoC7HWXg.gif"/></div></figure><p id="5f10" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">更好！不过还是不太好，如果你移除了两个项目之间的一个项目，那么一旦该行被移除，下一行就会跳到新的位置。这没有我们想要的那么顺利。</p><p id="7450" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将再次使用插值来调整行高。这样，当元素动画出来(淡入淡出、缩放、旋转)时，它下面的行将开始移动到位。这样，当该元素实际上从阵列中移除时，不会有用户可感知的跳跃。</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lp lk l"/></div></figure><p id="e634" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">嘣！我们现在为每一行项目添加或删除时留下一些微妙而巧妙的动画。查看下面的视频，观看最终产品的演示。玩一下<code class="eh ka kb kc kd b">ANIMATION_DURATION</code>，这样你就能完全看清发生了什么。</p><blockquote class="lr"><p id="7294" class="ls lt if bd lu lv lw lx ly lz ma jz ek translated">你喜欢这个教程吗？我有一门<a class="ae ke" href="http://learn.handlebarlabs.com/p/react-native-basics-build-a-currency-converter" rel="noopener ugc nofollow" target="_blank">免费课程，向你展示如何用React Native </a>构建一个应用。涵盖了组件设计，Redux，Redux Saga，还有更多动画！</p></blockquote><figure class="mb mc md me mf hw"><div class="bz el l di"><div class="lj lk l"/></div><figcaption class="ll lm fg fe ff ln lo bd b be z ek">Want more React Native videos? Be sure to subscribe!</figcaption></figure><p id="84f3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mg">疑问？让我知道！</em></p><div class="lf lg lh li fq ab cb"><figure class="mh hw mi mj mk ml mm paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mh hw mi mj mk ml mm paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mh hw mi mj mk ml mm paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mn mo mp"><p id="f922" class="jc jd mg je b jf jg jh ji jj jk jl jm mq jo jp jq mr js jt ju ms jw jx jy jz hn dt translated"><a class="ae ke" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ke" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ke" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ke" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd mg je b jf jg jh ji jj jk jl jm mq jo jp jq mr js jt ju ms jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ke" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ke" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lf lg lh li fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mt"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>