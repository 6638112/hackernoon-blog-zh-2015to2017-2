<html>
<head>
<title>PyCharm and Apache Spark on Mac OS X</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">麦克OS X上的皮查姆和阿帕奇火花</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/pycharm-and-apache-spark-on-mac-os-x-990af6dc6f38?source=collection_archive---------1-----------------------#2016-01-10">https://medium.com/hackernoon/pycharm-and-apache-spark-on-mac-os-x-990af6dc6f38?source=collection_archive---------1-----------------------#2016-01-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><blockquote class="ir is it"><p id="bf81" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">如果你不知道如何在Mac上设置Spark，请参考<a class="ae jt" rel="noopener" href="/@pradyumnadoddala/apache-spark-1-6-0-setup-on-mac-os-x-yosemite-d58076e8064e#.5uangvtd5">之前的故事</a>。</p></blockquote><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff ju"><img src="../Images/a3d42c653bf774fdf8f3517f08a1ff50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFYVaDRvY6KlKpQ7Cyv8jg.jpeg"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Photo by Pradyumna Doddala using Photopea</figcaption></figure><p id="c863" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt kn translated"><span class="l ko kp kq bm kr ks kt ku kv di">现在你已经在你的Mac上安装并构建了<a class="ae jt" href="https://hackernoon.com/tagged/spark" rel="noopener ugc nofollow" target="_blank"> Spark </a>。让我们做一些更改来运行IDE。</span></p><h2 id="10f7" class="kw kx hu bd ky kz la lb lc ld le lf lg kk lh li lj kl lk ll lm km ln lo lp lq dt translated">步伐</h2><p id="e514" class="pw-post-body-paragraph iu iv hu ix b iy lr ja jb jc ls je jf kk lt ji jj kl lu jm jn km lv jq jr js hn dt translated">在bash_profile中设置变量</p><pre class="jv jw jx jy fq lw lx ly lz aw ma dt"><span id="eaf0" class="kw kx hu lx b fv mb mc l md me">sudo vim ~/.bash_profile</span></pre><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div class="fe ff mf"><img src="../Images/bcbe909d0dbbdaf13d98b0fe4ae895a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*mVUx8P45UDcEjY3YYHEhXw.png"/></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">vim editor</figcaption></figure><pre class="jv jw jx jy fq lw lx ly lz aw ma dt"><span id="9a68" class="kw kx hu lx b fv mb mc l md me">export SPARK_HOME=/usr/local/spark</span><span id="e769" class="kw kx hu lx b fv mg mc l md me">export PATH=$PATH:$SPARK_HOME</span></pre><p id="9f78" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">现在打开PyCharm。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mh"><img src="../Images/2d814dedf6e081b75aa2a77ed8d56734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzEMaLvoKoabaBhYFviT0w.png"/></div></div></figure><p id="56ec" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">创建一个新项目，并使用纯Python模板。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mh"><img src="../Images/ebb2cc89dc5057ea484f1a0fdf365936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2nJQ2L7c1TiXG3GLHRQSwg.png"/></div></div></figure><p id="dbcc" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">现在让我们创建一个名为“随便你想取什么名字”的python文件。</p><div class="jv jw jx jy fq ab cb"><figure class="mi jz mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/d6c302ea3a9bb37d99df176f9d67f24e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dvpAwTlMuf71i1Qbt_-UsQ.png"/></div></figure><figure class="mi jz mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/a9b1e8ebc6a2ae10ab7408ebe91bc155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*UoVBlvFlcXqx5KGWsN1nGQ.png"/></div></figure></div><p id="78e8" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">将Spark python库添加到解释器中。</p><div class="jv jw jx jy fq ab cb"><figure class="mi jz mo mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/a97fb9a4559fdf0e0dd8f40b32c33f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*gxihKbOjd6yia-wb0PwVlQ.png"/></div></figure><figure class="mi jz mp mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/64c9f69b62760f7058abe3ea61eac4f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*IVwJ2gBo2_AfxRtiwsNA-Q.png"/></div></figure><figure class="mi jz mo mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/90e87c5897424eae49c9ffa1f2fa3771.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*7IAy-AFU1OMpfKILd2rOmA.png"/></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek mq di mr ms">Steps for adding the /usr/local/spark/python as the library for the Project Interpreter.</figcaption></figure></div><div class="ab cb"><figure class="mi jz mt mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/da19008757506abef8be50b71afc68b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*qcunzaWaV1K8P52thvsYHQ.png"/></div></figure><figure class="mi jz mu mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/68079e595887ccdf5c49ec7b84371202.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*wuA23uGk5gFeuROXdKsAzg.png"/></div></figure><figure class="mi jz mv mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/e9864edc5360e0ff208222a79b435b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*BTPaRnjg025hBoN-kR0IWA.png"/></div></figure></div><h2 id="e25c" class="kw kx hu bd ky kz la lb lc ld le lf lg kk lh li lj kl lk ll lm km ln lo lp lq dt translated">字数统计程序</h2><p id="bf03" class="pw-post-body-paragraph iu iv hu ix b iy lr ja jb jc ls je jf kk lt ji jj kl lu jm jn km lv jq jr js hn dt translated">对于字数统计<a class="ae jt" href="https://hackernoon.com/tagged/program" rel="noopener ugc nofollow" target="_blank">程序</a>，你需要一个文本文件。</p><p id="5eb7" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">首先创建一个样本文本文件，我将给出我已经在这篇文章中写的部分文本作为输入。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mw"><img src="../Images/fcd7f0f69a35bc88468e93a3b4dd5ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E0WQxN4dI7lgVVa0JGPMww.png"/></div></div></figure><p id="c04c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">最后这个程序，</p><pre class="jv jw jx jy fq lw lx ly lz aw ma dt"><span id="33b4" class="kw kx hu lx b fv mb mc l md me"><strong class="lx hv">import </strong>os<br/><br/>os.environ["SPARK_HOME"] = "/usr/local/spark"</span><span id="d9fe" class="kw kx hu lx b fv mg mc l md me"><strong class="lx hv">from </strong>operator <strong class="lx hv">import </strong>add<br/><br/><strong class="lx hv">from </strong>pyspark <strong class="lx hv">import </strong>SparkContext<br/><br/><strong class="lx hv">if </strong>__name__ == "__main__":<br/>    sc = SparkContext(appName="PythonWordCount")<br/>    lines = sc.textFile("sample.txt", 1)<br/>    counts = lines.flatMap(<strong class="lx hv">lambda </strong>x: x.split(' ')) \<br/>        .map(<strong class="lx hv">lambda </strong>x: (x, 1)) \<br/>        .reduceByKey(add)<br/>    output = counts.collect()<br/>    <strong class="lx hv">for </strong>(word, count) <strong class="lx hv">in </strong>output:<br/>        <strong class="lx hv">print</strong>("%s: %i" % (word, count))<br/><br/>    sc.stop()</span></pre><h2 id="8418" class="kw kx hu bd ky kz la lb lc ld le lf lg kk lh li lj kl lk ll lm km ln lo lp lq dt translated">奔跑</h2><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mw"><img src="../Images/aff3d0a87d28ccda558a83ae2bfa0031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CVENmCOl3IyCZv2GqkW9Hw.png"/></div></div></figure><p id="b0b2" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">第一次跑步基本上是一场灾难，因为我们错过了许多小事。</p><p id="4dbc" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">所以如果我们可以快速浏览一下错误，它说一个名为py4j.java_gateway的模块丢失了。</p><p id="164f" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">所以我们必须把它交给翻译。</p><p id="a882" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">再次打开首选项，打开当前的解释器设置并添加名为<strong class="ix hv"> py4j-0.9-src.zip </strong>的库</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mx"><img src="../Images/f139835067128b003afb0c686085bfff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0LyYXPTgyxhfOhhrvk5fw.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Adding the missing lib.</figcaption></figure><p id="0ed3" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">现在让我们重新运行代码。</p><p id="ecfa" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">我们可以在下面的屏幕截图中看到，单词和相应的计数是可见的。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff my"><img src="../Images/c082be65756ae6bbba1e5ca05ff96b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LPJ4hkTwcgC3JO_4DLyopA.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Final Run.</figcaption></figure><p id="0224" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">我希望这能让您在接下来的几天里忙于尝试神奇的Apache Spark。</p></div><div class="ab cl mz na hc nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="hn ho hp hq hr"><p id="dc3d" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">如果你做到了这一点，你就成功了！！祝您愉快！</p><p id="46de" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">如果这对你有所帮助，就拍拍屁股走人。它鼓励我写更多的帖子。谢谢你的支持。</p><p id="3904" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated"><strong class="ix hv"><em class="iw"/></strong><a class="ae jt" href="https://twitter.com/pradyumna_d" rel="noopener ugc nofollow" target="_blank"><strong class="ix hv"><em class="iw">@ pradyumna _ d</em></strong></a><strong class="ix hv"><em class="iw">|</em></strong><em class="iw">文件您的加密货币税使用</em><strong class="ix hv"><em class="iw"/></strong><a class="ae jt" href="https://bear.tax" rel="noopener ugc nofollow" target="_blank"><strong class="ix hv"><em class="iw">bear tax</em></strong></a><strong class="ix hv"><em class="iw">！”</em> </strong></p><figure class="jv jw jx jy fq jz"><div class="bz el l di"><div class="ng nh l"/></div></figure></div></div>    
</body>
</html>