<html>
<head>
<title>Creating insanely fast image classifiers with MobileNet in TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用TensorFlow中的MobileNet创建超快的图像分类器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991?source=collection_archive---------0-----------------------#2017-07-11">https://medium.com/hackernoon/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991?source=collection_archive---------0-----------------------#2017-07-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="8d90" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">"这就像热狗不是热狗，而是为了道路."</h2></div><p id="1f76" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">MobileNets是一个新的卷积神经网络家族，它将会让你大吃一惊，今天我们将在一个自定义数据集上训练一个。</p><p id="32bf" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有几件事让MobileNets变得很棒:</p><ol class=""><li id="92f4" class="kf kg hu jl b jm jn jp jq js kh jw ki ka kj ke kk kl km kn dt translated">它们小得惊人</li><li id="af09" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn dt translated">他们快得惊人</li><li id="ea61" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn dt translated">它们非常准确</li><li id="75e0" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke kk kl km kn dt translated">它们很容易针对资源和准确性进行调整</li></ol><p id="0f05" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为什么这很重要？很多移动深度<a class="ae kt" href="https://hackernoon.com/tagged/learning" rel="noopener ugc nofollow" target="_blank">学习</a>任务实际上都是在云端执行的。当你想对一张图片进行分类时，这张图片会被发送到一个网络服务，在一个远程服务器上进行分类，然后结果会被发送回你的手机。</p><p id="96ed" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这种情况正在迅速改变。你手机上的计算能力正在迅速增加，计算机视觉所需的<a class="ae kt" href="https://hackernoon.com/tagged/network" rel="noopener ugc nofollow" target="_blank">网络</a>复杂性正在缩小(这要感谢像SqueezeNet和MobileNet这样的架构)。</p><p id="0e70" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">除了没有互联网连接的人工智能的明显优势之外，在速度饥渴的情况下，向云端发送图像是不切实际的，就像我们在<a class="ae kt" href="http://coast.ai" rel="noopener ugc nofollow" target="_blank">海岸线</a>开发的车辆安全应用程序。</p><p id="3681" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">至此，让我们学习以下内容:</p><ul class=""><li id="93b4" class="kf kg hu jl b jm jn jp jq js kh jw ki ka kj ke ku kl km kn dt translated">什么是移动网络？</li><li id="85c3" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">如何使用TensorFlow构建自定义数据集来训练MobileNet</li><li id="0a3f" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">如何使用TensorFlow训练预先在ImageNet上训练的MobileNet</li><li id="3a98" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">MobileNets在Inception V3中的表现</li><li id="c81d" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">如何使用经过再培训的MobileNet对图像进行分类</li></ul><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/17fafc5b8f3178276775adbae9228246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABXyqKiGauuI-GXukp5QFw.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">We’ll use MobileNets to build a road, not road classifer to identify images like this one.</figcaption></figure><h1 id="74ea" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">什么是移动网络？</h1><p id="e567" class="pw-post-body-paragraph jj jk hu jl b jm md iv jo jp me iy jr js mf ju jv jw mg jy jz ka mh kc kd ke hn dt translated">MobileNets是由谷歌的研究人员设计的一类卷积神经网络。它们被称为“移动优先”,因为它们是从基础上设计的，是资源友好的，运行迅速，就在你的手机上。</p><p id="e479" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">MobileNet架构与“传统”CNN架构之间的主要区别在于，MobileNet将卷积分成3×3深度方向的conv和1×1点方向的conv，而不是单个3×3卷积层后跟batch norm和ReLU。为什么这如此重要的细节可以在<a class="ae kt" href="https://arxiv.org/pdf/1704.04861.pdf" rel="noopener ugc nofollow" target="_blank"> MobileNet论文</a>中找到，我强烈建议你去读一读。</p><p id="b323" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那么有什么问题呢？准确性。手机网络通常不如我们所熟悉和喜爱的更大、资源更密集的网络准确。但是发现资源/准确性的权衡才是MobileNets真正闪光的地方。</p><p id="b1c5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">MobileNets提供了两个参数，我们可以调整这两个参数来适应我们的实际问题的资源/精度权衡:宽度乘数和分辨率乘数。宽度乘数允许我们细化网络，而分辨率乘数改变图像的输入维度，减少每一层的内部表示。</p><p id="aa08" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">谷歌<a class="ae kt" href="https://research.googleblog.com/2017/06/mobilenets-open-source-models-for.html" rel="noopener ugc nofollow" target="_blank">开源了MobileNet架构</a>，发布了16个ImageNet检查点，每个检查点对应不同的参数配置。这为我们训练自己的分类器提供了一个极好的起点，这些分类器<em class="mi">小得惊人</em>快得惊人<em class="mi">。</em></p><p id="bc89" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mi">要了解更多关于MobileNets如何工作的信息，请阅读</em> <a class="ae kt" href="https://arxiv.org/pdf/1704.04861.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> MobileNets:用于移动视觉应用的高效卷积神经网络</em> </a> <em class="mi">。</em></p><h1 id="14df" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">如何构建自己的数据集来训练MobileNet</h1><p id="f6b2" class="pw-post-body-paragraph jj jk hu jl b jm md iv jo jp me iy jr js mf ju jv jw mg jy jz ka mh kc kd ke hn dt translated">我们今天面临的挑战是建立一个图像分类器，它可以检测图像是否是道路。就像<a class="ae kt" href="https://www.youtube.com/watch?v=ACmydtFDTGs" rel="noopener ugc nofollow" target="_blank">热狗，不是热狗</a>，而是为了道路。</p><p id="445e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为什么是路，不是路？在<a class="ae kt" href="https://coast.ai" rel="noopener ugc nofollow" target="_blank">海岸线</a>，我们正在利用使用计算机视觉的移动应用程序为您的汽车开发安全功能。与所有视力问题一样，用户隐私至关重要。因此，当用户打开我们应用程序中的摄像头时，我们首先检查的是它是否看到了道路。如果没有，我们就关掉摄像头。我们希望能够快速完成这项工作，并尽可能降低用户的计算成本。</p><p id="f8b4" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因为我们正在处理一个自定义问题，所以我们需要从创建数据集开始。我们的目标是收集10，000张图像，大致平均分成50/50路/非路。</p><p id="e053" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们将从几个不同的地方获取数据:</p><ul class=""><li id="8862" class="kf kg hu jl b jm jn jp jq js kh jw ki ka kj ke ku kl km kn dt translated">从海岸线驾驶数据集中随机采样的4000幅明显的道路图像</li><li id="3984" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">2000张显然不是从ImageNet数据集中随机抽取的道路图像</li><li id="7aa7" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">3，000个从互联网上采样的明显不是道路的场景，以确保分类器不只是学习天空，而不是天空</li><li id="411a" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">还从互联网上采样了1，000个不太明显的道路场景，以确保分类器不会识别挡风玻璃反射或海岸线数据中的其他共性</li></ul><p id="460e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们将每个图像放入两个文件夹中的一个，每个文件夹代表该图像的类别:<code class="eh mj mk ml mm b">road</code>和<code class="eh mj mk ml mm b">not-road</code>。这就是我们为再培训准备图像所要做的一切！</p><p id="6a6d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然而，虽然从互联网上抓取<a class="ae kt" href="https://search.creativecommons.org/" rel="noopener ugc nofollow" target="_blank"> CC图像</a>是一个给你的数据集增加多样性的好地方，但它也有一个缺点:标签很嘈杂。例如，通过搜索“道路景观”找到的图像可能有道路前方和中心，背景中有一个不错的场景，或者它可能是远处有一条小路的山区场景。</p><div class="kw kx ky kz fq ab cb"><figure class="mn la mo mp mq mr ms paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><img src="../Images/204581ce5361e818cd3006e0e53808dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*rLaaBLfAW4KhpsDlq4oa-w.jpeg"/></div></figure><figure class="mn la mt mp mq mr ms paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><img src="../Images/06f42a3ab0ab5ee5e9c62ada4f23b799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*IS6ATUFFompAyj5fsq4VYQ.jpeg"/></div><figcaption class="lh li fg fe ff lj lk bd b be z ek mu di mv mw">Two images both labeled “road”. For our problem, the first should be “not road” and the second should be “road”. Left: <a class="ae kt" href="https://www.flickr.com/photos/82036561@N00/7524452224" rel="noopener ugc nofollow" target="_blank">“Scenic Mountain Road”</a> by <a class="ae kt" href="https://www.flickr.com/people/82036561@N00/" rel="noopener ugc nofollow" target="_blank"><em class="mx">Tyler Thompson</em></a><em class="mx"> </em>is licensed under <a class="ae kt" href="https://creativecommons.org/licenses/by/2.0" rel="noopener ugc nofollow" target="_blank">CC BY 2.0</a> Right: <a class="ae kt" href="https://www.flickr.com/photos/zionfiction/21808267691" rel="noopener ugc nofollow" target="_blank">“150927-road-scenic-bypass-mountains.jpg”</a> by <a class="ae kt" href="https://www.flickr.com/people/zionfiction/" rel="noopener ugc nofollow" target="_blank"><em class="mx">r. nial bradshaw</em></a><em class="mx"> </em>is licensed under <a class="ae kt" href="https://creativecommons.org/licenses/by/2.0" rel="noopener ugc nofollow" target="_blank">CC BY 2.0</a></figcaption></figure></div><p id="9b2c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以通过浏览每张图片并手工标记来解决这个问题，但当我们有深度学习时为什么要这样做呢？！相反，我们在我们所有的数据上重新训练一个大网络(像Inception V3)，特别注意不要通过早期停止和大量数据扩充来过度适应我们的训练数据。然后我们运行数据集的每个图像(甚至是我们刚刚用来训练的那些图像！)并跟踪它分类不正确或没有多少把握的图像。然后，我们浏览每一个图像，如果适用的话，将它们移动到相应的类别中。这大大减少了我们必须手动清理的图像数量。多次使用这项技术帮助我们在初始阶段提高了7个百分点的准确率。</p><p id="d0b2" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们有5000幅道路图像和5000幅非道路图像，在这样的结构中…</p><pre class="kw kx ky kz fq my mm mz na aw nb dt"><span id="f4d0" class="nc lm hu mm b fv nd ne l nf ng">data/<br/>  road/[images...]<br/>  not-road/[images...]</span></pre><p id="45d5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">…我们将使用TensorFlow和迁移学习在我们的自定义数据集上微调MobileNets。</p><h1 id="ba8c" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">如何重新训练在ImageNet上预训练的MobileNet</h1><p id="7174" class="pw-post-body-paragraph jj jk hu jl b jm md iv jo jp me iy jr js mf ju jv jw mg jy jz ka mh kc kd ke hn dt translated">TensorFlow附带了很棒的工具，您可以使用这些工具来重新训练MobileNets，而无需实际编写任何代码。这是刚出版的东西:不到一周前<a class="ae kt" href="https://github.com/tensorflow/tensorflow/commit/055500bbcea60513c0160d213a10a7055f079312" rel="noopener ugc nofollow" target="_blank">增加了对MobileNet的再培训支持</a>！</p><div class="kw kx ky kz fq ab cb"><figure class="mn la nh mp mq mr ms paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><img src="../Images/d0b2be9b853dbb7b7585b262615e4ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*RHlMa6yGVMvx82uhf73PxQ.jpeg"/></div></figure><figure class="mn la nh mp mq mr ms paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><img src="../Images/b4d448ab97c65fefaf91b70743dd9d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ljUcKVNqW2qQ4_vGc5Icwg.jpeg"/></div><figcaption class="lh li fg fe ff lj lk bd b be z ek mu di mv mw">A couple very obviously road images from the Coastline dataset.</figcaption></figure></div><p id="b9c7" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您尚未下载，请派生和/或复制TensorFlow repo:</p><pre class="kw kx ky kz fq my mm mz na aw nb dt"><span id="25a2" class="nc lm hu mm b fv nd ne l nf ng">git clone https://github.com/tensorflow/tensorflow.git</span></pre><p id="6501" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在，您可以使用示例文件夹中的脚本在您自己的数据上重新训练MobileNet。</p><p id="c89f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">但是等等！您应该使用哪个MobileNet？这个问题问得好。让我们重新训练一个小组合，看看他们表现如何。为了开始培训，我们将从TensorFlow repo的根目录运行以下命令:</p><pre class="kw kx ky kz fq my mm mz na aw nb dt"><span id="a88a" class="nc lm hu mm b fv nd ne l nf ng">python tensorflow/examples/image_retraining/retrain.py \<br/>    --image_dir ~/ml/blogs/road-not-road/data/ \<br/>    --learning_rate=0.0001 \<br/>    --testing_percentage=20 \<br/>    --validation_percentage=20 \<br/>    --train_batch_size=32 \<br/>    --validation_batch_size=-1 \<br/>    --flip_left_right True \<br/>    --random_scale=30 \<br/>    --random_brightness=30 \<br/>    --eval_step_interval=100 \<br/>    --how_many_training_steps=600 \<br/>    --architecture mobilenet_1.0_224</span></pre><p id="dcd6" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mj mk ml mm b">architecture</code>标志是我们告诉再训练脚本我们想要使用哪个版本的MobileNet的地方。1.0对应于宽度乘数，可以是1.0、0.75、0.50或0.25。224对应于图像分辨率，可以是224、192、160或128。例如，为了训练最小的版本，您可以使用<code class="eh mj mk ml mm b">--architecture mobilenet_0.25_128</code>。</p><p id="46ca" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">其他一些重要参数:</p><ul class=""><li id="f84d" class="kf kg hu jl b jm jn jp jq js kh jw ki ka kj ke ku kl km kn dt translated">learning_rate:这是你想玩的东西。我发现0.0001很好用。</li><li id="e9f6" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">测试和验证百分比:脚本会将您的数据分为train/val/test。它将使用train来训练，val每隔“eval_step_interval”提供性能更新，测试将在“how_many_training_steps”之后运行，以给出您的最终分数。</li><li id="82b6" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">validation_batch_size:将此值设置为-1会告诉脚本使用您的所有数据进行验证。当您没有很多数据时(比如只有10，000张图像)，在这里使用-1来减少评估步骤之间的差异是一个好主意。</li></ul><p id="c087" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在对几个模型架构进行再培训之后，我们来看看他们的对比如何。</p><h1 id="a833" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">将MobileNet参数及其性能与初始状态进行比较</h1><p id="12d2" class="pw-post-body-paragraph jj jk hu jl b jm md iv jo jp me iy jr js mf ju jv jw mg jy jz ka mh kc kd ke hn dt translated">在对Inception进行600步训练以获得基线(通过将<code class="eh mj mk ml mm b">— architecture</code>标志设置为<code class="eh mj mk ml mm b">inception_v3)</code>，我们达到了95.9%)。训练进行了18分钟。(这里有很大的提升空间，但是我们没有一整天的时间！)产生的检查点大小为84mb。通过运行1，000张图像进行快速测试表明，它可以在NVIDIA GeForce 960m GPU上以大约19fps的速度对图像进行分类。</p><p id="8524" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mi">先不说:为什么“只有”95.9%而不是100%？这似乎是一个非常简单的问题，对吗？嗯，除了我们可以对训练参数进行充分的调整(我们实际上在另一次使用不同配置的相同数据中实现了98.9%)，事实证明类之间的区别比表面上看起来更微妙。拿这些案例来说:</em></p><ul class=""><li id="1b5a" class="kf kg hu jl b jm jn jp jq js kh jw ki ka kj ke ku kl km kn dt translated"><em class="mi">图像是树林中一条单车道的土路:这是一条路还是一条小径？我都不知道。</em></li><li id="5888" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">远处有一条路，是一处风景名胜。是一幅画还是一条路，还是画中只有一条路？景区什么时候移班？</li><li id="baec" class="kf kg hu jl b jm ko jp kp js kq jw kr ka ks ke ku kl km kn dt translated">这是一张艺术照，前景是一对手牵着手的夫妇，背景是一条经过时间推移的街道。路还是不路？抛硬币。</li></ul><p id="931e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那么，移动互联网的表现如何呢？不奇怪，不太好。然而，权衡利益是令人震惊的。</p><p id="8877" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用最大的MobileNet (1.0，224)，我们只需要4分钟的训练就可以达到95.5%的准确率。最终的模型大小只有17mb，可以在相同的GPU上以大约135fps的速度运行。</p><p id="cf62" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于那些保持分数的人来说，这比<strong class="jl hv">快7倍，大小是</strong>的四分之一。所有这些只损失了0.4%的精度。</p><figure class="kw kx ky kz fq la fe ff paragraph-image"><div class="fe ff ni"><img src="../Images/8c039c0e8f67848e8b5768a28e50d7cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/1*BQLT4rq8Upbb8-Nkhr9VcA.gif"/></div></figure><p id="4a1b" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最小的MobileNet (0.24，128)怎么样，用量化权重？大的准确度折衷，仅达到89.2%。但是看看这个:每秒450帧，而这个模型只占用930kb的内存。那是千字节！</p><figure class="kw kx ky kz fq la fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/54ca44d4211319aeeacfa67ea46c2d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*QLsdeD8P1X19mIFLA734ww.gif"/></div></figure><h1 id="f2c5" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">使用重新培训的MobileNet对图像进行分类</h1><p id="acce" class="pw-post-body-paragraph jj jk hu jl b jm md iv jo jp me iy jr js mf ju jv jw mg jy jz ka mh kc kd ke hn dt translated">现在，您已经在自定义数据集上对MobileNet进行了重新训练，是时候尝试一下了。毫不奇怪，TensorFlow也附带了一个脚本来完成这一任务。</p><pre class="kw kx ky kz fq my mm mz na aw nb dt"><span id="628c" class="nc lm hu mm b fv nd ne l nf ng">python3 tensorflow/examples/label_image/label_image.py \ <br/>  --graph=/tmp/mobilenet_0.50_192.pb \<br/>  --labels=/tmp/output_labels.txt \<br/>  --image=/home/harvitronix/ml/blogs/road-not-road/test-image.jpg \<br/>  --input_layer=input \<br/>  --output_layer=final_result \<br/>  --input_mean=128 \<br/>  --input_std=128 \<br/>  --input_width=192 \<br/>  --input_height=192</span></pre><figure class="kw kx ky kz fq la fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff kv"><img src="../Images/b9527201333e42c82d90fe88f359a15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lTLV8TNU4w4ABi2QMbF7Pw.jpeg"/></div></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">Our network classifies this as road, with confidence of 0.686811. Not too confidence, but hey, that’s a FAST road!</figcaption></figure><p id="fc52" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mi">题外话:应该注意的是，在我们相当简单的两类问题中，精度权衡并不是那么大。对于有1，001个类的ImageNet来说，准确性的权衡要重要得多。<a class="ae kt" href="https://research.googleblog.com/2017/06/mobilenets-open-source-models-for.html" rel="noopener ugc nofollow" target="_blank">见</a></em>此处的<em class="mi">表</em>  <em class="mi">。</em></p><h1 id="cab0" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">后续步骤</h1><p id="120e" class="pw-post-body-paragraph jj jk hu jl b jm md iv jo jp me iy jr js mf ju jv jw mg jy jz ka mh kc kd ke hn dt translated">好的，MobileNets的全部意义就是在移动设备上运行，对吗？敬请期待！在我们的下一篇文章中，我们将创建一些专门构建的训练数据，再次进行微调，并将经过重新训练的MobileNet加载到Android应用程序中。我们将看到它在移动设备上运行的速度有多快，在现实世界中有多准确。</p><blockquote class="nk nl nm"><p id="b619" class="jj jk mi jl b jm jn iv jo jp jq iy jr nn jt ju jv no jx jy jz np kb kc kd ke hn dt translated"><em class="hu">更新</em>:第二部现已上线！不要错过<a class="ae kt" href="https://hackernoon.com/building-an-insanely-fast-image-classifier-on-android-with-mobilenets-in-tensorflow-dc3e0c4410d4" rel="noopener ugc nofollow" target="_blank">用TensorFlow </a>中的MobileNets在Android上构建一个速度惊人的图像分类器。</p></blockquote><figure class="kw kx ky kz fq la"><div class="bz el l di"><div class="nq nr l"/></div></figure></div></div>    
</body>
</html>