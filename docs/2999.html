<html>
<head>
<title>TopHN — A fun side project built with Vue.js and RethinkDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">top HN——一个用Vue.js和RethinkDB构建的有趣的附带项目</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/tophn-a-fun-side-project-built-with-vue-js-and-rethinkdb-f22159641c1b?source=collection_archive---------7-----------------------#2017-03-05">https://medium.com/hackernoon/tophn-a-fun-side-project-built-with-vue-js-and-rethinkdb-f22159641c1b?source=collection_archive---------7-----------------------#2017-03-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/77ea12f1cf590e2858bb7a8a5cabf2fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NUs1bMPhu_0SV_z8uijL9Q.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">TopHN running in a side window so I can see news bubbling up and down in real time while I work away… (Yes, what you see is some actual code from the project — don’t laugh!).</figcaption></figure><p id="5aea" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在过去的几年里，我一直试图不断推动我老化的大脑，我发现最好的方法之一就是每个月左右尝试学习一种新的编程语言、框架或方法，只是为了保持技能的敏锐。</p><p id="8f21" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我一直对NoSQL数据库又爱又恨，我已经在纯SQL系统上工作了几十年，所以我想尝试一下。我也努力学习了一下<a class="ae ke" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> Javascript </a>前端框架，并希望提高我在该领域的技能。</p><p id="e796" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">所以在刚刚过去的这个周末，我决定和<a class="ae ke" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>以及<a class="ae ke" href="https://rethinkdb.com/" rel="noopener ugc nofollow" target="_blank"> RethinkDB </a>一起“堕落和肮脏”。程序员之间有很多关于React vs Vue vs Angular等的善意玩笑。我想亲自看看哪个更适合我的编程风格。我已经在Angular v1和我的移动应用程序开发中做了很多工作(使用Cordova和<a class="ae ke" href="https://ionicframework.com/" rel="noopener ugc nofollow" target="_blank"> Ionic </a>)，并且想看看Angular v2和我提到的其他框架是否会是一个简单的过渡。</p><p id="bba9" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">长话短说，我对Angular v2的理解和反应有点困难。在一天结束时，Vue.js似乎更自然，对我来说可能更接近Angular v1，我发现自己能够理解概念，并在短时间内开始组装一个基本的应用程序。</p><p id="4b45" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">RethinkDB 最近也出现在新闻中，他们的<a class="ae ke" href="https://rethinkdb.com/blog/rethinkdb-shutdown/" rel="noopener ugc nofollow" target="_blank">母公司关闭了</a>，尽管数据库本身看起来将作为开源继续存在。我一直很喜欢RethinkDB管理控制台的外观，以及在各种平台上安装的方便性，所以我决定在我的开发Mac上安装它并尝试一下。</p><h1 id="4a4f" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">该项目</h1><p id="54b2" class="pw-post-body-paragraph jg jh hu ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">最大的问题是——建造什么？我想做一些真正有用的东西，而不是又一个一次性的项目。然后，上周的一天，当我正在浏览<a class="ae ke" href="https://news.ycombinator.com/news" rel="noopener ugc nofollow" target="_blank">黑客新闻</a>时，我突然想到。</p><p id="f6c3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，我喜欢浏览黑客新闻，了解最新的技术文章，但我发现自己经常做的事情之一是(a)每隔几分钟刷新主“头条新闻”屏幕，看看人们在谈论什么，以及什么进入了前30名，以及(b)检查我最近亲自发布的消息，看看是否有任何回复。 并且经常在屏幕上方查看我的因果平衡，看看我发布的任何内容是否有大量的支持或反对。</p><p id="005e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这三件事似乎是我在网站上的主要活动(除了阅读文章)，所以我决定看看我是否可以建立一个小的辅助项目来使它更容易。于是<a class="ae ke" href="https://tophn.info/" rel="noopener ugc nofollow" target="_blank">拓丰</a>诞生了！</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/50e7b655c6c7815118749a9e240ea36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eV38EdwYyrGqPAQHHsLjBQ.png"/></div></div></figure><p id="b931" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">拓丰简单来说是什么？嗯，它基本上是在你的网络屏幕上实时显示头条新闻。公平地说，现在已经有很多其他的黑客实时新闻了，很多都比我的好得多——但是我希望我的解决方案非常具体。其他大多数显示评论和其他细节，但我希望我的解决方案只是一个“仪表板”风格的视图，显示与我相关的重要内容(希望其他大多数用户也是如此)。</p><p id="c250" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">首先，我决定看看<a class="ae ke" href="https://github.com/HackerNews/API" rel="noopener ugc nofollow" target="_blank">的HackerNews API </a>。我很兴奋地看到这是基于谷歌的<a class="ae ke" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>。两年前，我在几个移动编程工作中使用过Firebase，非常喜欢他们用来发布变更的异步“推送”系统。我考虑过是否直接使用Firebase feed，但最终决定不使用，因为我将进行一些其他的数据操作和轮询，我不想让更多的轮询请求直接扰乱Firebase feed，而是尝试在RethinkDB中复制HN数据集。</p><p id="b74c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">所以我继续在云中设置了一个专用的RethinkDB服务器。按照他们的指示，这是小菜一碟。在同一台服务器上，我构建了一个小的Node.js应用程序(只有大约30行代码)，它的唯一目的是侦听来自Firebase的HN API提要，获取当前数据，并将其快照保存在我的RethinkDB数据库中。</p><p id="a37d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">《黑客新闻》实际上发布了一些非常酷的内容——大约每30秒，一份排名前500的文章列表就会以JSON字符串的形式发布出去。此外，他们有一个专门的feed，每20到30秒就会推出一个变更列表。这包括已经被改变或输入到他们的系统中的文章和评论id的列表，以及已经改变了他们的状态的任何用户的用户id(即，进行了简档改变，或者他们的因果报应被某人增加/减少，或者张贴了评论等)。).</p><p id="cc63" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我决定使用这两个提要作为构建复制数据集的基础。每次推出“前500名”提要时，我都会获取文章的id，在RethinkDB中快速查看它们是否已经存在，如果不存在，我会单独询问缺失的文章，并将它们放在RethinkDB中。这样做了几天后，我的数据库里就有了数万篇文章。</p><p id="64ac" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我还会嗅出“变化”提要，扫描那里的文章，看看我是否已经有了它们，如果没有就复制它们。用户也一样。每次在“更改”提要中提到某个用户时，我都会抓取他们更新后的个人资料并保存在RethinkDB中。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ln"><img src="../Images/ec492a68ade1ae856508157e14c82a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q5LXzdKD9gK4edtwzdCO3A.png"/></div></div></figure><p id="c5d3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">上面的屏幕截图显示了RethinkDB管理控制台，这是一个非常酷的工具，用于检查服务器性能，以及测试查询和管理数据表和碎片。</p><p id="dbdc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">到目前为止一切顺利。复制的数据库每隔几秒钟就会被数据填满。现在的问题是——如何处理它？</p><p id="73cf" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我很高兴看到RethinkDB也有一个“<a class="ae ke" href="https://rethinkdb.com/docs/changefeeds/javascript/" rel="noopener ugc nofollow" target="_blank">变更()</a>”特性，可以在数据变更发生时发布。但与Firebase工具不同的是，这些不仅仅是客户端工具，还需要某种服务器平台来实现这些功能。所以我决定使用另一个Node.js应用程序作为服务器后端，使用Vue.js作为界面元素的前端。</p><p id="21b5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我还需要使用<a class="ae ke" href="https://github.com/socketio/socket.io" rel="noopener ugc nofollow" target="_blank"> socket.io </a>在两者之间建立一个连接。我有点失望，如果没有它，似乎没有任何本机方法可以将更改从服务器推/拉到客户端，但是嘿——我们都在学习新的东西，构建一个套接字驱动的应用程序肯定是我以前没有做过的事情(至少不是从头开始)。</p><p id="178d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">所以，一天结束时，第二个Node.js应用程序将位于不同的服务器上，并等待用户访问该站点。现在，用户可以做几件事。他们可以简单地访问网站的顶级URL，并实时查看排名前30的提要。我的意思是几乎实时。随着新文章的发表，或者它们在前30名中上下移动，页面视图会上下显示它们，并显示最新的分数和评论计数器。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div class="fe ff lo"><img src="../Images/cc8ff55d2494b70dd5a4336b69d653df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*ji6G-UWDdtCAemp70Fqs5Q.png"/></div></figure><p id="e9f4" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果用户选择输入他们的HN用户名，该页面还会额外实时显示用户的Karma余额，以及在过去几分钟内发生了多少变化的符号。没有什么比虚荣指标更能让人兴奋了！</p><p id="eea0" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">此外，如果输入他们的用户名，页面将显示他们最近发表的10条左右的评论和故事，因此他们可以关注对评论的任何回复等。</p><p id="ddfb" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">第二个Node.js服务器本质上是一个推/拉服务器。它会悄悄地将前30个列表更改推送到与其连接的所有web浏览器。它还将为用户指定了用户名的任何浏览器设置一个自定义的推送事件处理程序。如你所料，这需要一点管理和服务器资源，所以我希望我永远不会经历HackerNews的“死亡拥抱”,一群人同时登录，因为我真的不知道在它尖叫着停止之前它会扩展到什么程度。</p><p id="3c09" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">Vue.js组件纯粹坐在那里，监听来自服务器推送的JSON数据包，然后相应地格式化它们，并在网页上显示它们，而不必刷新。</p><p id="e100" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我还没有进入我如何在这里建立它的疯狂的细节，但是如果有任何兴趣并且我得到许多请求，那么我将公开发布一些代码片段并且进入我如何建立各种组件的更深的细节。</p><p id="e7ef" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">总而言之，我对4到5天的兼职编码感到非常满意。我认为这是一个有用的工具，正如你从标题图片中看到的，我倾向于在旁边开一个窄的Chrome窗口，这样我就可以关注新闻事件，看它们上下浮动。网页也是完全响应的，并且为了可移植性，应该可以在大多数移动浏览器上工作。</p><p id="e549" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">你是黑客新闻成员吗？何不看看<a class="ae ke" href="https://tophn.info" rel="noopener ugc nofollow" target="_blank"> https://tophn.info </a>让我知道你的想法？</p><div class="lj lk ll lm fq ab cb"><figure class="lp iv lq lr ls lt lu paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="lp iv lq lr ls lt lu paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="lp iv lq lr ls lt lu paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lv lw lx"><p id="f922" class="jg jh ly ji b jj jk jl jm jn jo jp jq lz js jt ju ma jw jx jy mb ka kb kc kd hn dt translated"><a class="ae ke" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ke" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ke" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae ke" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jg jh ly ji b jj jk jl jm jn jo jp jq lz js jt ju ma jw jx jy mb ka kb kc kd hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ke" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ke" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mc"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="md me l"/></div></figure></div></div>    
</body>
</html>