<html>
<head>
<title>A URL Shortener Service using Go, Iris and Bolt</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Go、Iris和Bolt的URL缩写服务</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-url-shortener-service-using-go-iris-and-bolt-4182f0b00ae7?source=collection_archive---------7-----------------------#2017-03-15">https://medium.com/hackernoon/a-url-shortener-service-using-go-iris-and-bolt-4182f0b00ae7?source=collection_archive---------7-----------------------#2017-03-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="2c7b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你关注社交媒体网站，比如推特、谷歌和T2，你会注意到我们没有使用完整的网址，而是使用了一个友好的缩写，比如t.co/EvDSyOOPTH的T4。</p><p id="f122" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在自己的域名中拥有自己的缩写网址不是很好吗？</p><p id="2835" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们先来复习一下基础。</p><h1 id="c522" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">工具</h1><p id="04ee" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">编程语言对我们来说只是工具，但我们需要一种安全、快速且“跨平台”的编程语言来为我们的服务提供动力。</p><p id="4c81" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> Go </a>是一种发展迅速的<a class="ae jp" href="http://www.tiobe.com/tiobe-index/" rel="noopener ugc nofollow" target="_blank">开源编程语言，旨在构建简单、快速、可靠的软件。看看</a><a class="ae jp" href="https://github.com/golang/go/wiki/GoUsers" rel="noopener ugc nofollow" target="_blank">这里</a>哪些伟大的公司使用Go来增强他们的服务。</p><h2 id="39fe" class="kt jr hu bd js ku kv kw jw kx ky kz ka jc la lb ke jg lc ld ki jk le lf km lg dt translated">安装Go编程语言</h2><p id="e159" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">关于下载和安装Go的详细信息可以在<a class="ae jp" href="https://golang.org/dl/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="lm ln l"/></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">Maybe <a class="ae jp" href="https://www.youtube.com/watch?v=WT5mTznJBS0" rel="noopener ugc nofollow" target="_blank">Windows </a>or <a class="ae jp" href="https://www.youtube.com/watch?v=5qI8z_lB5Lw" rel="noopener ugc nofollow" target="_blank">Mac OS X</a> user?</figcaption></figure><blockquote class="ls lt lu"><p id="5504" class="ir is lv it b iu iv iw ix iy iz ja jb lw jd je jf lx jh ji jj ly jl jm jn jo hn dt translated">这篇文章不包含对语言本身的介绍，如果你是一个新手，我建议你把这篇文章收藏起来，<a class="ae jp" href="https://github.com/golang/go/wiki/Learn" rel="noopener ugc nofollow" target="_blank">学习语言的基础知识，以后再回来。</a></p></blockquote><h2 id="7382" class="kt jr hu bd js ku kv kw jw kx ky kz ka jc la lb ke jg lc ld ki jk le lf km lg dt translated">依赖关系</h2><p id="4265" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在过去，已经有很多文章引导用户不要使用web框架，因为它们“不好”。我必须告诉你，没有这样的事情，它总是取决于你将要使用的(web)框架。在生产层面，通常，我们没有时间为大公司的应用程序编写所有需要的代码。简而言之:<strong class="it hv">好的框架对任何开发者、公司或初创公司都是有用的工具，坏的是浪费时间，简单明了</strong>。</p><p id="3f9f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您只需要两个必需的依赖项和一个可选的依赖项:</p><ul class=""><li id="f6b3" class="lz ma hu it b iu iv iy iz jc mb jg mc jk md jo me mf mg mh dt translated">Iris ，我们的网络框架</li><li id="7a7f" class="lz ma hu it b iu mi iy mj jc mk jg ml jk mm jo me mf mg mh dt translated"><a class="ae jp" href="https://github.com/etcd-io/bbolt" rel="noopener ugc nofollow" target="_blank"> Bolt(现在的bbolt) </a>，一个嵌入式的键/值数据库</li><li id="9126" class="lz ma hu it b iu mi iy mj jc mk jg ml jk mm jo me mf mg mh dt translated"><a class="ae jp" href="https://en.wikipedia.org/wiki/Universally_unique_identifier" rel="noopener ugc nofollow" target="_blank"> UUID </a>库，将帮助我们生成短网址</li></ul><p id="ef44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用go软件包安装是一项简单的任务，只需打开您的终端并执行以下命令:</p><pre class="lh li lj lk fq mn mo mp mq aw mr dt"><span id="a9c4" class="kt jr hu mo b fv ms mt l mu mv">$ go get -u github.com/kataras/iris/v12@latest<br/>$ go get -u github.com/etcd-io/bbolt<br/>$ go get -u github.com/satori/go.uuid</span></pre><h1 id="ba1f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">最大的部分</h1><p id="379b" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">很好，如果我们都在同一个页面上，那么是时候学习如何创建一个URL Shortener server了，它将易于部署并且可以扩展得更多！</p><p id="6c17" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了创建一个短链接，我们生成一个随机字符串，并使用Bolt存储原始URL，并将我们的随机字符串作为键。当一个“GET”请求被发送到缩短的URL时，我们从Bolt中检索原始的URL。如果这样的值存在，我们重定向，否则我们用相应的消息响应。</p><blockquote class="ls lt lu"><p id="394a" class="ir is lv it b iu iv iw ix iy iz ja jb lw jd je jf lx jh ji jj ly jl jm jn jo hn dt translated">为了简单起见，我们假设项目位于<em class="hu">$ GOPATH/src/you/shortener</em>目录下，包名为<em class="hu"> main </em>。</p></blockquote><p id="12f4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的<strong class="it hv">前端</strong>简单得可笑，它只包含一个索引页面及其“样式”，模板位于<code class="eh mw mx my mo b">./templates</code>文件夹，样式位于<code class="eh mw mx my mo b">./resources/css</code>文件夹。</p><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="mz ln l"/></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">./templates/index.html</figcaption></figure><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="mz ln l"/></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">./resources/css/style.css</figcaption></figure><p id="b4f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">直接转到<strong class="it hv">数据库</strong>级别，我们将创建一个简单的实现，它将能够<strong class="it hv">保存</strong>一个缩短的URL(key)及其原始/完整的URL(value)，<strong class="it hv">基于key检索</strong>一个完整的URL，并将所有注册的URL的总数返回给数据库。</p><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="mz ln l"/></div></figure><p id="0e0f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们创建我们的<strong class="it hv">工厂</strong>，它将<strong class="it hv">为我们生成</strong>缩短的URL！</p><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="mz ln l"/></div></figure><p id="fa86" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们应该创建一个<strong class="it hv">主文件</strong>，它将连接并组合所有组件来运行一个http服务器，该服务器将为我们的小型URL Shortener服务提供服务。</p><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="mz ln l"/></div></figure><p id="57ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">还有…让我们构建并运行我们的应用程序吧！</p><pre class="lh li lj lk fq mn mo mp mq aw mr dt"><span id="c637" class="kt jr hu mo b fv ms mt l mu mv">$ cd $GOPATH/src/github.com/myname/url-shortener<br/>$ go build # build <br/>$ ./url-shortener # run</span></pre><h1 id="2b19" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">奖金</strong>部分</h1><p id="cc30" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">测试我们的应用程序总是一件有用的事情，因此我会给你一个如何用Iris测试这类网络应用程序的初步想法，直接看下面的代码。</p><figure class="lh li lj lk fq ll"><div class="bz el l di"><div class="mz ln l"/></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">./main_test.go</figcaption></figure><p id="0ab3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正在运行测试…</p><pre class="lh li lj lk fq mn mo mp mq aw mr dt"><span id="4db8" class="kt jr hu mo b fv ms mt l mu mv">$ cd $GOPATH/src/github.com/myname/url-shortener<br/>$ go test -v # test</span></pre><h1 id="8625" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">就这样，很简单。对吗？</h1><p id="cce1" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">分享你对这篇文章的想法，让我知道你打算用Go + Iris构建什么样的应用程序！</p><p id="bd99" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢您花时间阅读整篇文章，我很佩服您的耐心:)</p><blockquote class="ls lt lu"><p id="0e57" class="ir is lv it b iu iv iw ix iy iz ja jb lw jd je jf lx jh ji jj ly jl jm jn jo hn dt translated">完整的源代码位于<a class="ae jp" href="https://github.com/kataras/iris/tree/master/_examples/tutorial/url-shortener" rel="noopener ugc nofollow" target="_blank">这里</a>。如果您有任何进一步的问题，请随时在下面留言或在这里提问。</p></blockquote><h2 id="980a" class="kt jr hu bd js ku kv kw jw kx ky kz ka jc la lb ke jg lc ld ki jk le lf km lg dt translated">上次更新时间</h2><p id="25ed" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我在2019年11月03日<strong class="it hv">更新了源代码和文章的链接</strong>，以便基于<a class="ae jp" href="https://github.com/etcd-io/bbolt/releases/tag/v1.3.1-etcd.7" rel="noopener ugc nofollow" target="_blank">https://github.com/etcd-io/bbolt/releases/tag/v1.3.1-etcd.7</a>(2018年8月29日发布)和Iris导入路径基于在<a class="ae jp" href="https://github.com/kataras/iris/issues/1370" rel="noopener ugc nofollow" target="_blank">https://github.com/kataras/iris/issues/1370</a>的投票，用CoreOS的新<a class="ae jp" href="https://github.com/etcd-io/bbolt" rel="noopener ugc nofollow" target="_blank"><strong class="it hv">【https://github.com/etcd-io/bbolt】</strong></a>替换(存档的)【https://github.com/boltdb/bolt</p></div></div>    
</body>
</html>