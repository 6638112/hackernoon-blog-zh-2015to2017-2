<html>
<head>
<title>Type safe CSS Modules with Flow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带流的类型安全CSS模块</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/type-safe-css-modules-with-flow-dd95e761bbe5?source=collection_archive---------7-----------------------#2017-06-20">https://medium.com/hackernoon/type-safe-css-modules-with-flow-dd95e761bbe5?source=collection_archive---------7-----------------------#2017-06-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/8cdf070f5cb04862611a336961f764a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k1Qza6ToJzWKp45oIBjaKw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">CSS Modules + Flow = type safety and editor autocompletion</figcaption></figure><p id="1670" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我一直梦想着使用<a class="ae ke" href="https://github.com/css-modules/css-modules" rel="noopener ugc nofollow" target="_blank"> CSS模块</a>时的类型安全和编辑器自动完成。这个有几个打字稿工具(见<a class="ae ke" rel="noopener" href="/@sapegin/css-modules-with-typescript-and-webpack-6b221ebe5f10">这个</a>和<a class="ae ke" href="https://github.com/Quramy/typed-css-modules" rel="noopener ugc nofollow" target="_blank">这个</a>)，但是我没有找到任何针对<a class="ae ke" href="https://flow.org/" rel="noopener ugc nofollow" target="_blank">流</a>的实体工具。</p><p id="2f74" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="kf">TL；我做了一些</em> <a class="ae ke" href="https://github.com/skovhus/css-modules-flow-types" rel="noopener ugc nofollow" target="_blank"> <em class="kf">的新工具</em> </a> <em class="kf">，当我在一个代码库上试用它们时，Flow发现</em> <strong class="ji hv"> <em class="kf">有很多死代码(和潜在的bug)</em></strong><em class="kf">…</em>😬</p><h1 id="a099" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">问题</h1><p id="ac43" class="pw-post-body-paragraph jg jh hu ji b jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz li kb kc kd hn dt translated">很容易拼错类名或忘记更新。移除. css文件中的类后的js使用者。例如，类<code class="eh lj lk ll lm b">foo</code>可能没有在<code class="eh lj lk ll lm b">Button.css</code>中定义:</p><pre class="ln lo lp lq fq lr lm ls lt aw lu dt"><span id="eb20" class="lv kh hu lm b fv lw lx l ly lz">/* @flow */<br/>import styles from './Button.css';</span><span id="a1e0" class="lv kh hu lm b fv ma lx l ly lz">const Button = () =&gt; &lt;button className={styles.foo} /&gt;;</span></pre><h1 id="aac1" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">解决方法</h1><p id="2d88" class="pw-post-body-paragraph jg jh hu ji b jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz li kb kc kd hn dt translated">为了教授关于CSS模块文件的流程，我们可以创建一个定义文件<code class="eh lj lk ll lm b">Button.css.flow</code>，包含由<code class="eh lj lk ll lm b">Button.css</code>暴露的类名。通过这样做，我们可以:</p><ul class=""><li id="09e5" class="mb mc hu ji b jj jk jn jo jr md jv me jz mf kd mg mh mi mj dt translated">显示不存在的类的使用的静态类型检查</li><li id="dbd9" class="mb mc hu ji b jj mk jn ml jr mm jv mn jz mo kd mg mh mi mj dt translated">CSS类的编辑器自动完成(用于支持流的编辑器)</li></ul><p id="1cfe" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">来产生这些。流文件我在想两个用例。一个使用简单的CLI，另一个使用webpack。</p><h1 id="71d5" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">解决方案:CLI</h1><p id="1c26" class="pw-post-body-paragraph jg jh hu ji b jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz li kb kc kd hn dt translated">css-modules-flow-types-cli 是一个快速生成的cli。流文件。</p><p id="959f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们安装它:</p><pre class="ln lo lp lq fq lr lm ls lt aw lu dt"><span id="8f13" class="lv kh hu lm b fv lw lx l ly lz">npm install --save-dev css-modules-flow-types-cli</span><span id="49de" class="lv kh hu lm b fv ma lx l ly lz"># Or<br/>yarn install -D css-modules-flow-types-cli</span></pre><p id="fe7b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后在您的源目录上运行CLI:</p><pre class="ln lo lp lq fq lr lm ls lt aw lu dt"><span id="f0f2" class="lv kh hu lm b fv lw lx l ly lz">css-modules-flow-types src</span></pre><p id="c32b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我建议在您的CI系统(如Travis或Circle)上使用CLI来确保所有。在运行流之前，流文件是最新的。这将在部署之前捕获潜在的样式错误。</p><p id="9df2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">另一个用例是开发和更改CSS模块文件时的快速反馈循环。CLI为此提供了一个观察模式，但是我自己希望避免在开发时需要运行另一个工具。因为很多人已经运行了webpack，所以我做了一个小的加载器来使用style-loader的令牌。</p><h1 id="a850" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">解决方案:webpack加载器</h1><p id="c54c" class="pw-post-body-paragraph jg jh hu ji b jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz li kb kc kd hn dt translated"><a class="ae ke" href="https://www.npmjs.com/package/css-modules-flow-types-loader" rel="noopener ugc nofollow" target="_blank">CSS-modules-flow-types-loader</a>是webpack loader keeping。通过使用来自<code class="eh lj lk ll lm b">style-loader</code>的令牌更新的流文件。我建议在作为webpack-dev-server设置的一部分进行开发时使用它。这将会稍微降低速度，因为加载程序可能需要写很多文件。</p><p id="d6c7" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">要开始使用:</p><pre class="ln lo lp lq fq lr lm ls lt aw lu dt"><span id="6eab" class="lv kh hu lm b fv lw lx l ly lz">npm install --save-dev css-modules-flow-types-loader</span></pre><p id="9912" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后更新您的webpack配置:</p><pre class="ln lo lp lq fq lr lm ls lt aw lu dt"><span id="f4b9" class="lv kh hu lm b fv lw lx l ly lz">{<br/>  test: /<strong class="lm hv">\.</strong>css$/,  // or the file format you are using<br/>  use: [<br/>    'style-loader',<br/>    '<!-- -->css-modules-flow-types-loader<!-- -->',  // right after style-loader<br/>    // Other loaders like css-loader after this:<br/>    ...<br/>  ]<br/>}</span></pre><p id="e842" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后坐下来享受CSS模块被流进行类型检查。🍺</p><p id="b246" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">请让我知道你的想法…并给github一个小⭐️。</p><div class="mp mq fm fo mr ms"><a href="https://github.com/skovhus/css-modules-flow-types" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab ej"><div class="mu ab mv cl cj mw"><h2 class="bd hv fv z el mx eo ep my er et ht dt translated">skov HUS/CSS-模块-流程-类型</h2><div class="mz l"><h3 class="bd b fv z el mx eo ep my er et ek translated">css-modules-flow-types -使用Webpack loader或CLI从css模块文件创建流类型定义👾</h3></div><div class="na l"><p class="bd b gc z el mx eo ep my er et ek translated">github.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng ja ms"/></div></div></a></div><div class="ln lo lp lq fq ab cb"><figure class="nh iv ni nj nk nl nm paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nh iv ni nj nk nl nm paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nh iv ni nj nk nl nm paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nn no np"><p id="f922" class="jg jh kf ji b jj jk jl jm jn jo jp jq nq js jt ju nr jw jx jy ns ka kb kc kd hn dt translated"><a class="ae ke" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ke" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ke" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ke" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jg jh kf ji b jj jk jl jm jn jo jp jq nq js jt ju nr jw jx jy ns ka kb kc kd hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ke" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ke" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ln lo lp lq fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nt"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>