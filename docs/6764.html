<html>
<head>
<title>Error Boundaries in React v16.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React v16.0中的错误边界</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/error-boundaries-in-react-v16-0-2ab67b780329?source=collection_archive---------15-----------------------#2017-10-03">https://medium.com/hackernoon/error-boundaries-in-react-v16-0-2ab67b780329?source=collection_archive---------15-----------------------#2017-10-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/b6de19d3cc0fd446ff487f3c87664cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCdK2059wDnPpTj6bARSwA.png"/></div></div></figure><p id="4988" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">v16已经上市，所以它成了镇上的新话题。是的，React已经迁移到麻省理工学院许可证。</p><p id="d527" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">React v16推出了一些新功能，<strong class="je hv">错误边界</strong>就是其中之一。所以，这篇文章是关于错误界限的，比如它们是什么，如何使用它们等等。</p><p id="8f36" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在react中，渲染期间的任何运行时错误都会使React处于中断状态，并且整个组件树会从根中卸载，需要刷新才能恢复。</p><p id="98fa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这可以通过使用一个名为Error Boundaries的特殊React组件来防止，该组件在运行时出现错误时提供一个回退UI，如try-catch块。</p><p id="63bf" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些组件使用一种特殊的生命周期方法来实现，这种方法可以捕捉子组件树中的任何错误。React v15有这个名为<strong class="je hv"><em class="kb">unstable _ handle error</em></strong>的方法，但是对错误边界的支持非常有限。这个unstable_handleError方法不再工作，因为React v16提供了一个名为<strong class="je hv"><em class="kb">componentDidCatch</em></strong>的新方法。</p><p id="7eb6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">错误边界仅捕获子组件的错误。自身内部的任何错误都不会被捕获，并且该错误将传播其上最近的错误边界。任何错误边界未捕捉到的任何错误都将传播到根，使整个应用程序崩溃/连根拔起。请看下面的笔和要点。</p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="kg kh l"/></div></figure><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="ki kh l"/></div><figcaption class="kj kk fg fe ff kl km bd b be z ek">A pen describing all the scenarios that may happen with an Error Boundary Component</figcaption></figure></div><div class="ab cl kn ko hc kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hn ho hp hq hr"><p id="3471" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">React团队内部曾讨论过保留一个损坏的UI是否比完全移除它更好。但是他们已经在他们的产品中使用了。例如，Facebook Messenger将侧边栏、信息面板、对话日志和消息输入的内容包装到单独的错误边界中。如果这些UI区域中的某个组件崩溃了，其余的组件仍然可以交互。</p><blockquote class="ku"><p id="9e32" class="kv kw hu bd kx ky kz la lb lc ld jz ek translated">这完全取决于你的产品设计。</p></blockquote><p id="2dfb" class="pw-post-body-paragraph jc jd hu je b jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv li jx jy jz hn dt translated">React团队还鼓励使用JS错误报告服务，这样人们可以了解生产中发生的未处理的异常，并修复它们。</p></div><div class="ab cl kn ko hc kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hn ho hp hq hr"><h1 id="f064" class="lj lk hu bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg dt translated">错误堆栈</h1><p id="411f" class="pw-post-body-paragraph jc jd hu je b jf mh jh ji jj mi jl jm jn mj jp jq jr mk jt ju jv ml jx jy jz hn dt translated">React v16在开发中将渲染过程中出现的所有错误打印到控制台。除了错误消息和<a class="ae ka" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> javascript </a>堆栈之外，它还提供了<strong class="je hv">组件堆栈</strong>,因此现在人们可以看到组件到底是在哪里崩溃的。</p><p id="fc05" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你也可以使用babel plugin<a class="ae ka" href="https://www.npmjs.com/package/babel-plugin-transform-react-jsx-source" rel="noopener ugc nofollow" target="_blank">babel-plugin-transform-react-jsx-source</a>在组件栈中看到文件名和行号。</p></div><div class="ab cl kn ko hc kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hn ho hp hq hr"><h1 id="44f5" class="lj lk hu bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg dt translated">移民</h1><p id="0582" class="pw-post-body-paragraph jc jd hu je b jf mh jh ji jj mi jl jm jn mj jp jq jr mk jt ju jv ml jx jy jz hn dt translated">如果一个人正在使用React v15的<em class="kb"> unstable_handleError </em>并且想要迁移到React v16，React团队已经提供了一个<a class="ae ka" href="https://github.com/reactjs/react-codemod#error-boundaries" rel="noopener ugc nofollow" target="_blank"> codemod </a>。</p></div><div class="ab cl kn ko hc kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hn ho hp hq hr"><h1 id="7a8c" class="lj lk hu bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg dt translated">资源</h1><p id="98bf" class="pw-post-body-paragraph jc jd hu je b jf mh jh ji jj mi jl jm jn mj jp jq jr mk jt ju jv ml jx jy jz hn dt translated"><a class="ae ka" href="https://reactjs.org/blog/2017/07/26/error-handling-in-react-16.html" rel="noopener ugc nofollow" target="_blank">丹·阿布拉莫夫的React v16 </a>中的错误处理</p></div><div class="ab cl kn ko hc kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hn ho hp hq hr"><blockquote class="ku"><p id="06e2" class="kv kw hu bd kx ky kz la lb lc ld jz ek translated">我目前正在浦那的Raja软件实验室用React开发一些很酷的东西。你可以在推特上找到我。</p></blockquote></div><div class="ab cl kn ko hc kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hn ho hp hq hr"><blockquote class="mm mn mo"><p id="3b93" class="jc jd kb je b jf jg jh ji jj jk jl jm mp jo jp jq mq js jt ju mr jw jx jy jz hn dt translated">如果你喜欢这篇文章，请点击拍手图标。</p></blockquote><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="ms kh l"/></div></figure></div></div>    
</body>
</html>