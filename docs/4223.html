<html>
<head>
<title>You know, for search..</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你知道，为了搜索..</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/you-know-for-search-de62b6126a86?source=collection_archive---------8-----------------------#2017-05-19">https://medium.com/hackernoon/you-know-for-search-de62b6126a86?source=collection_archive---------8-----------------------#2017-05-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="8f8d" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">rubygems.org现在使用弹性搜索</h2></div><p id="1587" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">随着它在2010年2月8日的首次发布，elasticsearch是如此的古老以至于让人感觉有点怀旧。如今，数千家公司使用elasticsearch进行全文搜索、自动补全、<a class="ae kf" href="https://www.elastic.co/products/logstash" rel="noopener ugc nofollow" target="_blank">日志处理</a>和<a class="ae kf" href="https://www.elastic.co/products/kibana" rel="noopener ugc nofollow" target="_blank">分析</a>。</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff kg"><img src="../Images/4c58e4174e6806b1c7a034cd7dd4b362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OynzdKUGelMiSuDG-50erw.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Railscast - <a class="ae kf" href="http://railscasts.com/episodes/306-elasticsearch-part-1" rel="noopener ugc nofollow" target="_blank">#306 ElasticSearch Part 1</a></figcaption></figure><p id="cb0d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Rubygems.org的搜索功能没有达到标准。无论如何，在使用像操作符一样的<a class="ae kf" href="https://www.postgresql.org/docs/8.3/static/functions-matching.html" rel="noopener ugc nofollow" target="_blank">时，不要抱太大希望。它又慢又笨拙，你只能搜索rubygem的名字。至少，新的搜索方式要快得多。</a></p><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="d8fe" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我认为这是elasticsearch的一项成就，一旦我浏览了他们的文档并观看了几个视频，我就能够对现有的实现做出有意义的改变。此外，有用法示例的文档是最好的❤文档</p><h1 id="1a1a" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated">搜索多个字段</h1><p id="ec47" class="pw-post-body-paragraph jj jk hu jl b jm lr iv jo jp ls iy jr js lt ju jv jw lu jy jz ka lv kc kd ke hn dt translated">默认情况下，查询将与gem的名称、描述和摘要相匹配。每个匹配的结果都有一个相关性分数，它由以下三个因素决定:</p><p id="32eb" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">术语频率</strong> -查询术语在名称、描述或摘要中出现得越频繁，相关性得分越高。</p><p id="b8ba" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">逆文档频率</strong> -出现在许多文档中的术语(如the、a、gems等)比更不常用的术语得分低。</p><p id="9a83" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">字段长度标准</strong> -在更长的字段中匹配，如摘要和描述，得分低于名称。(<a class="ae kf" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/scoring-theory.html" rel="noopener ugc nofollow" target="_blank">阅读更多</a>)</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff lw"><img src="../Images/95e97d393320a749a0b44cad4c569034.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*ZyZPyPOtojAeVRF-slGmJA.jpeg"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek"><a class="ae kf" href="http://geekandpoke.typepad.com/geekandpoke/2011/01/nosql.html" rel="noopener ugc nofollow" target="_blank">Geek And Poke</a></figcaption></figure><p id="9d56" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它变得更好；)我们使用gem下载来提高搜索结果的分数。这确保了受欢迎的和社区认可的宝石在搜索页面上排名更高。</p><p id="3681" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">亚马逊elasticsearch服务的Elasticsearch 5 支持及时地让我们在使用它之前更新了实例。Elasticsearch 5在相关性评分方面做了一些<a class="ae kf" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/breaking_50_search_changes.html#_scoring_changes" rel="noopener ugc nofollow" target="_blank">漂亮的改进</a>。</p><h1 id="2452" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated">过滤器和高级搜索页面</h1><p id="7fcc" class="pw-post-body-paragraph jj jk hu jl b jm lr iv jo jp ls iy jr js lt ju jv jw lu jy jz ka lv kc kd ke hn dt translated">在elasticsearch中，查询字符串支持自己的迷你语言，可用于定制您的查询。搜索页面上显示的过滤选项已经提供了有用的默认值，可以限制您的搜索，只匹配名称、描述、摘要、最近一周或最近一个月更新的内容。</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff lx"><img src="../Images/b326911f0eec03d9b05e12986daf165b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RkoErYfLqzx19LFPpKthOw.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek"><a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=active" rel="noopener ugc nofollow" target="_blank">Search active</a> on rubygems.org</figcaption></figure><p id="e1d8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可以使用<a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=ruby+AND+rails" rel="noopener ugc nofollow" target="_blank">和</a>和<a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=ruby+OR+rails" rel="noopener ugc nofollow" target="_blank">或</a>运算符来组合您的查询词。查询字符串还支持<a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=active*" rel="noopener ugc nofollow" target="_blank">通配符</a>、<a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=activo~" rel="noopener ugc nofollow" target="_blank">模糊性</a>、<a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=active+AND+downloads%3A%5B20000+TO+100000%5D" rel="noopener ugc nofollow" target="_blank">范围</a>、<a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=rails%5E3+db" rel="noopener ugc nofollow" target="_blank">增强</a>和<a class="ae kf" href="https://www.elastic.co/guide/en/elasticsearch/reference/5.1/query-dsl-query-string-query.html#query-string-syntax" rel="noopener ugc nofollow" target="_blank">更多</a>。当你想做一点实验时，请查看我们的<a class="ae kf" href="https://rubygems.org/search/advanced" rel="noopener ugc nofollow" target="_blank">高级搜索页面</a>。</p><h1 id="a82b" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated">建议和分析者</h1><p id="b634" class="pw-post-body-paragraph jj jk hu jl b jm lr iv jo jp ls iy jr js lt ju jv jw lu jy jz ka lv kc kd ke hn dt translated">你有没有因为太懒而无法正确输入查询中的所有字符？不要害怕！弹性搜索建议支持你。当没有找到匹配的结果时，搜索页面会建议您可能想要输入的查询。</p><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/48d94de9e5a2d595d42c3d4290a15e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*sH1_62wdpICIO_AA4CnEcw.png"/></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek"><a class="ae kf" href="https://rubygems.org/search?utf8=%E2%9C%93&amp;query=raols" rel="noopener ugc nofollow" target="_blank">Search raols</a> on rubygems.org</figcaption></figure><p id="7809" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Elasticsearch的<a class="ae kf" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-analyzers.html" rel="noopener ugc nofollow" target="_blank">预打包分析器</a>有可感知的默认值，可以直接使用。分析器确保当你搜索<a class="ae kf" href="https://github.com/rubygems/rubygems.org/issues/1412" rel="noopener ugc nofollow" target="_blank"> rails async、async rails或async-rail </a>时，你得到相同的结果。我们用<em class="kw">模式</em>解析器解析名称，用<em class="kw">英文</em>解析器解析摘要和描述。</p><h1 id="955d" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated">后面的路</h1><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/8b2b06b71c5c25346d6bae72252a8c3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*VBtwDGtGfeTOIlOqVJ4bJg.jpeg"/></div></figure><p id="ae15" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我对我们最终得到的代码并不感到骄傲。我写了一个方法，它返回两个值ಠ_ಠ</p><p id="3ac3" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有时候，我要么自己摸索出正确的解决方案，要么在陷入困境后得到了关键的帮助。自主学习新事物伴随着机遇和挑战。</p><p id="faed" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">elastic search<a class="ae kf" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-explain.html" rel="noopener ugc nofollow" target="_blank">explain API</a>在跟踪得分问题时派上了用场。elasticsearch-rails上的<a class="ae kf" href="https://github.com/elastic/elasticsearch-rails/blob/master/elasticsearch-rails/README.md#rails-application-templates" rel="noopener ugc nofollow" target="_blank"> rails应用程序模板</a>是一个很好的参考资源。弹性搜索模型gem也有一些很好的例子。</p><h1 id="2d20" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated">前方道路</h1><p id="f092" class="pw-post-body-paragraph jj jk hu jl b jm lr iv jo jp ls iy jr js lt ju jv jw lu jy jz ka lv kc kd ke hn dt translated">大量的工作尚待完成。我们还没有将rubygem.org搜索api切换到elasticsearch。我们已经有了为搜索字段添加自动完成功能的PR<a class="ae kf" href="https://github.com/rubygems/rubygems.org/pull/1315" rel="noopener ugc nofollow" target="_blank">,但是我对使用typehead.js </a>有点怀疑。我不确定我们是否需要一个<em class="kw">建议引擎</em>，当<em class="kw">一些有用的东西</em>可以用更少的代码来编写的时候。</p><p id="8fe9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果您遇到任何问题或有改进建议，请随时访问我们的问题板。</p><div class="kh ki kj kk fq ab cb"><figure class="ma kl mb mc md me mf paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ma kl mb mc md me mf paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ma kl mb mc md me mf paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mg mh mi"><p id="f922" class="jj jk kw jl b jm jn iv jo jp jq iy jr mj jt ju jv mk jx jy jz ml kb kc kd ke hn dt translated"><a class="ae kf" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kf" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kf" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kf" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jj jk kw jl b jm jn iv jo jp jq iy jr mj jt ju jv mk jx jy jz ml kb kc kd ke hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kf" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kf" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kh ki kj kk fq kl fe ff paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="fe ff mm"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kh ki kj kk fq kl"><div class="bz el l di"><div class="mn ky l"/></div></figure></div></div>    
</body>
</html>