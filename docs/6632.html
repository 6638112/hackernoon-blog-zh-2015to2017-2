<html>
<head>
<title>UhOh, did I break WhatsApp’s “Last Seen” feature?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">哦，我破坏了WhatsApp的“最后一次看到”功能了吗？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/uhoh-did-i-break-whatsapps-last-seen-feature-dbde54ecf79b?source=collection_archive---------5-----------------------#2017-09-27">https://medium.com/hackernoon/uhoh-did-i-break-whatsapps-last-seen-feature-dbde54ecf79b?source=collection_archive---------5-----------------------#2017-09-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="b879" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">更新:</em> </strong> <em class="jp">这是我在2017年9月做的一个概念验证。我没想到这个项目会有如此大的反响。正如许多人提到的，代码不再工作了，因为WhatsApp Web一直在改变它的代码。但是，我鼓励您在GitHub </em>  <em class="jp">上分叉</em> <a class="ae jq" href="https://github.com/mnafees/UhOh" rel="noopener ugc nofollow" target="_blank"> <em class="jp">我的项目，让它为您自己的需要工作。</em></a></p><p id="4db1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">自从我12岁开始编程以来，我总是喜欢破坏东西，而不是创造东西。从那时起，尝试深入一个软件的功能，尝试各种方法来破坏一个特性就成了一种爱好。既然我已经告诉你了，你一定已经猜到这篇文章是关于破坏一个软件的特性的。但更重要的是，这也是我试图(或者你可以说是一个概念验证)向你展示如今没有什么是私人的，如果你知道如何闯入什么，那么你知道如何闯入它。</p><p id="c0b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于这个特殊的尝试，我试图打破WhatsApp给你的隐私功能之一。我经常使用WhatsApp与家人和朋友交流，几乎一整天都是如此，这是一款非常棒的软件。和许多其他通讯应用一样，WhatsApp也赋予你控制隐私的权利。其中一个功能是隐藏你的“最后一次被看到”状态。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff jr"><img src="../Images/d76dba5ce1d88eead76be00f2dfdf0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMTNRfO60oPSwbChxsaauw.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">WhatsApp gives you the ability to hide your “Last Seen” status from others</figcaption></figure><p id="956a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">而且效果很好！我总是把这个设置为“无名小卒”，因为我不想让别人知道我最后一次上网是什么时候，而且我相信数百万其他人也是这样做的。但它有那么安全吗？我能不打破它吗？嗯，这是我开始深入研究的时候。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff kh"><img src="../Images/e0a57b3d7db895493a19c3c765deef10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*py9h7yxxjj5d6cjfUw4NWw.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The homepage for web.whatsapp.com</figcaption></figure><p id="71fa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">事实证明，WhatsApp也有一个网络界面，可以用来直接从你的浏览器聊天。太好了！在这里，我可以很容易地查看源代码，找到它的底层工作原理。我就是这么做的。我浏览了所有让WhatsApp网络工作的脚本，发现了一些有趣的东西。如果你在网站上浏览JS控制台，输入<em class="jp"> Store </em>并按回车键，你会看到一个特定的输出。这就是WhatsApp Web在你的浏览器上存储和检索内容的方式。它有一个'<em class="jp">商店'</em>对象。<em class="jp">商店类型。Presence.models </em>瞧！现在，您可以查看联系人的一些详细信息。其中一个小细节是检查用户是否在线，类似于<em class="jp"> __x_isOnline </em>，发现这一点后，我非常高兴我可能已经找到了“最后一次看到”隐私功能的解决方法，只需记录用户何时在线以及何时离线。但是经过一些实验后，我发现这不是一个可靠的方法。为什么？因为当我试图用我的定制JS代码摆弄param <em class="jp"> __x_isOnline </em>时，它消失了。(<strong class="it hv"> <em class="jp"> PS。</em> </strong> <em class="jp">如果你明白这是为什么那么请告诉我！)</em></p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff ki"><img src="../Images/3a69212c25b54921b6953b41db2ba1ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*oeGwlqbn_uGzfJTkZDQraA.png"/></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">A user has the “online” label to indicate his/her presence</figcaption></figure><p id="ef5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但我显然不会这么轻易放弃。我想，如果我试着一次只锁定一个联系人，然后玩玩DOM会怎么样。因此，当用户上网时，他/她在网页中的名字下面会有一个“在线”标签。所以我做了同样的事情，继续查看DOM的变化，并相应地记录活动。成功了！我可以看到我在WhatsApp上的某个联系人何时上线，何时下线。因此，即使他/她打开了“最后一次看到”隐私选项，我仍然可以跟踪他/她何时上线和下线。这很可怕，对吧？这是我写的一小段代码。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff kj"><img src="../Images/2eb43580c8541747f0b9b053cd77c40c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*0doXK-dwyZWW7I6CiCiM4Q.png"/></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Kind of the same as your “Last Seen” eh?</figcaption></figure><p id="177f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我称这个小黑客为“<a class="ae jq" href="https://github.com/mnafees/UhOh" rel="noopener ugc nofollow" target="_blank"> UhOh </a>”，因为啊哈，我刚刚使用WhatsApp自己的网络客户端破坏了它的“上次查看”隐私功能吗？</p><h1 id="f449" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">它是如何工作的</h1><p id="6d4a" class="pw-post-body-paragraph ir is hu it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hn dt translated">对于所有的程序员，我用<a class="ae jq" href="https://github.com/GoogleChrome/puppeteer" rel="noopener ugc nofollow" target="_blank">木偶师</a>来做这件事。是谷歌Chrome团队自己发布的Chrome无头节点API。我简单地自动化了打开浏览器页面的过程，前往https://web.whatsapp.com的<a class="ae jq" href="https://web.whatsapp.com" rel="noopener ugc nofollow" target="_blank"/>，选择我想要数据的联系人，并开始“观察”DOM操作。所有这些都是自动发生的，您可以在控制台中获得日志。更多技术细节可以在我的GitHub回购<a class="ae jq" href="https://github.com/mnafees/UhOh/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="cf7e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以我在这里的尝试并不是要吓唬人，而是要告诉你“隐私”的概念在当今世界并不是一个非常正确的概念。事情很容易被破坏，你可以通过几行代码被跟踪，而你甚至可能不知道。</p></div></div>    
</body>
</html>