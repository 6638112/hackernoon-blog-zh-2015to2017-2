<html>
<head>
<title>Beginner’s Guide to Tor on Ubuntu</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ubuntu上的Tor初学者指南</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/beginners-guide-to-tor-on-ubuntu-33f81194698?source=collection_archive---------2-----------------------#2016-06-20">https://medium.com/hackernoon/beginners-guide-to-tor-on-ubuntu-33f81194698?source=collection_archive---------2-----------------------#2016-06-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/7c1c7f7c55ad9c0a37933225a81e920a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFtv6e41mXqzNNtDK0v-iA.jpeg"/></div></div></figure><p id="b09d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Tor是一个能让你在网上隐藏身份的软件。这是一个开放的网络，有助于抵御流量分析，并授予您高度的隐私。</p><blockquote class="kb"><p id="7013" class="kc kd hu bd ke kf kg kh ki kj kk jz ek translated">Tor通过将你的通信在一个由世界各地的志愿者运行的分布式中继网络中来回传递来保护你(被称为洋葱路由):它防止有人监视你的互联网连接来了解你访问了什么网站，它还防止你访问的网站了解你的物理位置。</p></blockquote><h2 id="1349" class="kl km hu bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf dt translated">等等，我听说过洋葱，但是这个洋葱路由是什么？</h2><figure class="lh li lj lk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lg"><img src="../Images/070be91d52cb8488945145dc51658bd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*Kq_3YplWm_w7rShNAVT_3w.png"/></div></div></figure><p id="6ec2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在洋葱路由中，要发送的数据封装在加密层中，就像洋葱的层一样。然后，产生的加密数据通过一系列称为洋葱路由器的网络节点传输，每个节点都“剥离”(或解密)一层加密，揭示数据的下一个目的地。解密最后一层后，数据到达目的地。发送者保持匿名，因为每个中介只知道紧接的前一个和后一个节点的位置。</p><h1 id="91db" class="ll km hu bd kn lm ln lo kr lp lq lr kv ls lt lu ky lv lw lx lb ly lz ma le mb dt translated">如何在Ubuntu上安装Tor</h1><p id="dadd" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">按照以下步骤在<a class="ae ka" href="https://hackernoon.com/tagged/ubuntu" rel="noopener ugc nofollow" target="_blank"> Ubuntu </a>上安装Tor:</p><h2 id="8810" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">1.添加源条目</h2><p id="0336" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">先搞清楚你用的是哪个版本的Ubuntu。然后从下面的列表中选择该版本，并使用您使用的编辑器或简单地通过cat命令将这些行添加到文件<strong class="je hv"> /etc/apt/sources.list </strong>中。</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="1ae5" class="kl km hu mn b fv mr ms l mt mu">$ sudo cat &gt;&gt; /etc/apt/sources.list</span></pre><ul class=""><li id="00ec" class="mv mw hu je b jf jg jj jk jn mx jr my jv mz jz na nb nc nd dt translated">如果你用的是Ubuntu 14.xx</li></ul><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="0284" class="kl km hu mn b fv mr ms l mt mu"><em class="ne">deb http://deb.torproject.org/torproject.org trusty main<br/>deb-src http://deb.torproject.org/torproject.org trusty main</em></span></pre><ul class=""><li id="65b8" class="mv mw hu je b jf jg jj jk jn mx jr my jv mz jz na nb nc nd dt translated">如果你用的是Ubuntu 15.xx</li></ul><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="4ad2" class="kl km hu mn b fv mr ms l mt mu"><em class="ne">deb http://deb.torproject.org/torproject.org wily main<br/>deb-src http://deb.torproject.org/torproject.org wily main</em></span></pre><ul class=""><li id="122c" class="mv mw hu je b jf jg jj jk jn mx jr my jv mz jz na nb nc nd dt translated">如果你用的是Ubuntu 16.xx</li></ul><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="a3b9" class="kl km hu mn b fv mr ms l mt mu"><em class="ne">deb http://deb.torproject.org/torproject.org xenial main<br/>deb-src http://deb.torproject.org/torproject.org xenial main</em></span></pre><h2 id="1c5f" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">2.添加GPG键</h2><p id="8620" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">通过在终端中运行以下命令，添加用于对包进行签名的gpg密钥:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="b6cd" class="kl km hu mn b fv mr ms l mt mu">$ sudo gpg — keyserver keys.gnupg.net — recv 886DDD89<br/>$ sudo gpg — export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | sudo apt-key add -</span></pre><h2 id="3995" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">3.安装Tor</h2><p id="06f4" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">现在运行以下命令来安装Tor。</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="f648" class="kl km hu mn b fv mr ms l mt mu">$ sudo apt-get update<br/>$ sudo apt-get install tor deb.torproject.org-keyring</span></pre><h1 id="c17c" class="ll km hu bd kn lm ln lo kr lp lq lr kv ls lt lu ky lv lw lx lb ly lz ma le mb dt translated">使用Tor</h1><h2 id="671b" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">1.配置Tor</h2><blockquote class="kb"><p id="aec7" class="kc kd hu bd ke kf kg kh ki kj kk jz ek translated">如果您从源代码编译Tor，tor将torrc文件放在/usr/local/etc/tor/torrc中，如果您安装了预构建的软件包，则放在/etc/tor/torrc或/etc/torrc中。</p></blockquote><p id="d349" class="pw-post-body-paragraph jc jd hu je b jf nf jh ji jj ng jl jm jn nh jp jq jr ni jt ju jv nj jx jy jz hn dt translated">Tor自带控制口，可以用来，duh，控制tor。为了使用控制端口与tor通信，强烈建议您设置一种身份验证方法，以防止其他任何人访问它。推荐的方法是使用密码。如果您选择使用密码进行身份验证，请首先运行此命令以获取一个哈希密码，该密码将在下一步的配置文件中使用:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="f252" class="kl km hu mn b fv mr ms l mt mu">$ tor --hash-password "passwordhere"<br/><em class="ne">16:AC5FB526B90B4ED06027C6C4343EF87075B63B9A25822EE198622EE4D6</em></span></pre><p id="a802" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">打开torrc文件<em class="ne">(如果你遵循了上面的安装过程，那么你的torrc文件很可能会位于</em><strong class="je hv"><em class="ne">/etc/tor/torrc</em></strong><em class="ne">)</em>并取消注释这些行:<br/> 1 .控制端口<br/> 2。CookieAuthentication <strong class="je hv">或</strong>HashedControlPassword<br/><em class="ne">(如果您选择取消对HashedControlPassword的注释，请复制您在上一步中获得的散列密码并粘贴到那里)</em> <br/>这些行如下所示:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="c9d1" class="kl km hu mn b fv mr ms l mt mu"><em class="ne"># This provides a port for our script to talk with. If you set this then be</em><br/><em class="ne"># sure to also set either CookieAuthentication *or* HashedControlPassword!</em><br/><em class="ne">#</em><br/><em class="ne"># You could also use ControlSocket instead of ControlPort, which provides a</em><br/><em class="ne"># file based socket. You don't need to have authentication if you use</em><br/><em class="ne"># ControlSocket. For this example however we'll use a port.</em><br/><br/><strong class="mn hv">ControlPort 9051 <em class="ne"># &lt;--- uncomment this ControlPort line</em></strong><br/><br/><em class="ne"># Setting this will make Tor write an authentication cookie. Anything with</em><br/><em class="ne"># permission to read this file can connect to Tor. If you're going to run</em><br/><em class="ne"># your script with the same user or permission group as Tor then this is the</em><br/><em class="ne"># easiest method of authentication to use.</em><br/><br/><strong class="mn hv">CookieAuthentication 1 <em class="ne">#either uncomment this or below password line</em></strong><br/><br/><em class="ne"># Alternatively we can authenticate with a password. To set a password first</em><br/><em class="ne"># get its hash...</em><br/><em class="ne">#</em><br/><em class="ne"># % tor --hash-password "my_password"</em><br/><em class="ne"># 16:E600ADC1B52C80BB6022A0E999A7734571A451EB6AE50FED489B72E3DF</em><br/><em class="ne">#</em><br/><em class="ne"># ... and use that for the HashedControlPassword in your torrc.</em><br/><br/><strong class="mn hv">HashedControlPassword 16:E600ADC1B52C80BB6022A0E999A7734571A451EB6AE50FED489B72E3DF</strong></span></pre><blockquote class="kb"><p id="98fe" class="kc kd hu bd ke kf nk nl nm nn no jz ek translated">Cookie认证仅仅意味着您的凭证是Tor的数据目录中的文件内容。</p></blockquote><p id="ea8f" class="pw-post-body-paragraph jc jd hu je b jf nf jh ji jj ng jl jm jn nh jp jq jr ni jt ju jv nj jx jy jz hn dt translated">现在使用以下命令重新启动Tor:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="6d21" class="kl km hu mn b fv mr ms l mt mu">$ sudo /etc/init.d/tor restart</span></pre><h2 id="8319" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">2.如何通过Tor控制端口进行认证</h2><p id="86f3" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">如果您想要通过Tor进行身份验证，以便与Tor控制端口进行通信(例如，启动新会话)，您可以这样做:(如果您选择了cookie身份验证，您可以只使用身份验证，不需要任何密码)</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="ae0c" class="kl km hu mn b fv mr ms l mt mu">$ echo -e 'AUTHENTICATE "passwordhere"\r\nsignal NEWNYM\r\nQUIT' | nc 127.0.0.1 9051</span></pre><p id="bf33" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">默认情况下，Tor在端口9050上打开一个SOCKS代理。要直接使用SOCKS，可以将应用程序直接指向Tor(本地主机端口9050)。对于不使用代理的应用程序，您可以使用<a class="ae ka" href="https://gitweb.torproject.org/torsocks.git/" rel="noopener ugc nofollow" target="_blank"> torsocks </a>。</p><h2 id="0266" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">3.如何安装torsocks</h2><p id="5177" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">要安装torsocks，您可以直接运行以下命令:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="898a" class="kl km hu mn b fv mr ms l mt mu">$ sudo apt-get install torsocks</span></pre><p id="0532" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">或者，</strong>直接从源代码安装(这样可以获得最新版本和最新补丁):</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="454d" class="kl km hu mn b fv mr ms l mt mu">$ git clone https://git.torproject.org/torsocks.git<br/>$ cd torsocks<br/>$ ./autogen.sh<br/>$ ./configure<br/>$ make<br/>$ sudo make install</span></pre><p id="9832" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在让我们使用托索克斯！首先，让我们获取公共ip地址。</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="a6c5" class="kl km hu mn b fv mr ms l mt mu">$ curl 'https://api.ipify.org'<br/><em class="ne">75.119.16.140</em></span></pre><p id="8d9e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它说75.119.16.140是我的公共ip，现在在curl命令前使用torsocks:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="6673" class="kl km hu mn b fv mr ms l mt mu">$<strong class="mn hv"> torsocks </strong>curl 'https://api.ipify.org'<br/><em class="ne">31.45.26.14</em></span></pre><p id="a36d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，我们现在有了一个不同的ip地址，用于浏览互联网。</p><h2 id="4631" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated">4.给控制发信号以创建新的电路(或路径)</h2><p id="9a7f" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">你可以告诉Tor控制启动一个新的Tor电路。这里需要注意的一点是，新的电路不一定意味着新的IP地址。为此，我们使用上面已经介绍过的命令:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="9df4" class="kl km hu mn b fv mr ms l mt mu">$ echo -e 'AUTHENTICATE "passwordhere"\r\nsignal NEWNYM\r\nQUIT' | nc 127.0.0.1 9051</span></pre><p id="f4e5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">或者</strong>，如果你想使用远程登录:</p><pre class="lh li lj lk fq mm mn mo mp aw mq dt"><span id="e6fa" class="kl km hu mn b fv mr ms l mt mu">$ telnet localhost 9051<br/><em class="ne">Trying 127.0.0.1...<br/>Connected to localhost.</em><br/><em class="ne">Escape character is '^]'.</em><br/>AUTHENTICATE "my_password"<br/><em class="ne">250 OK</em><br/>SIGNAL NEWNYM<br/><em class="ne">250 OK</em><br/>QUIT<br/><em class="ne">250 closing connection<br/>Connection closed by foreign host.</em></span></pre><h2 id="1a7b" class="kl km hu bd kn ko mh kq kr ks mi ku kv jn mj kx ky jr mk la lb jv ml ld le lf dt translated"><strong class="ak"> 5。为Tor使用Python控制器库</strong></h2><p id="ca78" class="pw-post-body-paragraph jc jd hu je b jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz hn dt translated">Stem是官方支持的Python控制器库。你可以在这里找到关于如何安装Stem的所有内容和一些好的教程。</p></div><div class="ab cl np nq hc nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="hn ho hp hq hr"><p id="39b6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章仅用于教育目的。</p><div class="lh li lj lk fq ab cb"><figure class="nw iv nx ny nz oa ob paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nw iv nx ny nz oa ob paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nw iv nx ny nz oa ob paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="oc od oe"><p id="f922" class="jc jd ne je b jf jg jh ji jj jk jl jm of jo jp jq og js jt ju oh jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ka" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd ne je b jf jg jh ji jj jk jl jm of jo jp jq og js jt ju oh jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lh li lj lk fq iv fe ff paragraph-image"><a href="https://goo.gl/Ahtev1"><div class="fe ff oi"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></a></figure><figure class="lh li lj lk fq iv"><div class="bz el l di"><div class="oj ok l"/></div></figure></div></div>    
</body>
</html>