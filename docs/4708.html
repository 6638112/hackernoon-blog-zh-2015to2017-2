<html>
<head>
<title>In a personalized world: How cookies make your performance tests more reliable</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在一个个性化的世界中:cookies如何使您的性能测试更加可靠</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-cookies-make-your-performance-tests-more-reliable-57accc9a8327?source=collection_archive---------17-----------------------#2017-06-15">https://medium.com/hackernoon/how-cookies-make-your-performance-tests-more-reliable-57accc9a8327?source=collection_archive---------17-----------------------#2017-06-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d4f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">“预热”您的测试工具，获得更好的性能测试。下面是我们如何用WebPageTest实现的。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/caa7b722e81d29237c6a410e50c0d96d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuYmeSguRx6HpsXlUJtnYA.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Did I manage to find a photo of both a computer, a graph and some cookies? You bet I did. (Where? <a class="ae kg" href="https://www.pexels.com/photo/beverage-black-coffee-business-chart-33972/" rel="noopener ugc nofollow" target="_blank">At Pexels</a>)</figcaption></figure><p id="f213" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">我在Ekstra Bladet Udvikling/Development的部分工作是监控丹麦最大、最繁忙的网站之一的网站性能。</em></p><p id="deb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">当你测试和衡量一个网站的性能时，重要的是你的工具看起来尽可能真实的用户体验。利用我们目前在Ekstra Bladet开发中使用的性能工具，这是可能的，但是需要做一些小改动。阅读这是如何可能的，你可以做些什么来开始。</em></p></div><div class="ab cl kh ki hc kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hn ho hp hq hr"><h1 id="4e2c" class="ko kp hu bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">🕐挑战</h1><p id="8845" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">性能是影响用户体验的一个重要因素。如果你有一个网站(比如ekstrabladet.dk)包含大量的<strong class="it hv">广告</strong>，这些广告都会对技术性能产生影响，那么这一点尤其正确。</p><p id="383b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回到2016年7月，我用业绩总结了我们的工作，并在媒体here上发表了<a class="ae kg" rel="noopener" href="/@larskjensen/your-ads-performance-is-your-performance-bcf7f3657a9f"> <em class="jp">【你的广告业绩就是你的业绩】</em> </a>。在这里，我写了我们的表现在多大程度上受到我们无法控制的技术的影响。</p><p id="c5ff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除此之外，广告技术也发生了很多变化，ekstrabladet.dk也不例外。广告客户越来越喜欢接触他们希望能接受他们信息的用户。他们通过使用一系列承诺提供帮助的技术合作伙伴来做到这一点，他们试图根据用户的cookies等来匹配内容。</p><p id="90dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当从广告商到用户的价值链中发生了如此多的事情时，似乎奇怪的是<strong class="it hv">的表现仍然被广泛地通过将一堆URL扔进一个工具</strong>来衡量，该工具然后访问并衡量它们——然后向我们展示结果。许多广告(以及将它们与用户匹配的技术)依赖于cookie，而“冷浏览器”像性能工具中的那些没有cookie。</p><p id="766b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，如果你能<strong class="it hv">“预热”测试浏览器，从而使它对网站上的各种技术和广告更有吸引力，这将是非常好的，但只有在有目标时才会出现。</strong></p><h1 id="6ad5" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕑这个概念</h1><p id="1d82" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">不久前，我读了一篇文章(很遗憾，尽管我尝试了很多次，还是找不到它……否则我会链接到它),其中一个性能工具背后的公司提出了一个解决方案。他们让他们的工具<strong class="it hv">访问一系列URL地址，然后才访问实际性能测试发生的URL</strong>。</p><p id="c399" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这样做的好处是，测试浏览器建立了一个cookie配置文件(从它访问过的地方),这突然让各种个性化技术变得更有趣。</p><p id="efcf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在文章中，该公司讲述了新的测量方法如何显示一个网站实际上比他们想象的更慢<strong class="it hv">。这意味着，对于真实用户来说，加载网站所花的时间比很多人在测试性能时信任的冷测试浏览器要长。</strong></p><h1 id="d3e4" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕒工具</h1><p id="d89e" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">我决定用ekstrabladet.dk进行同样的实验。从某种意义上说，我们用于性能测试的工具已经可以做到这一点。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/b28f77b49113b16d717f0d44e783fc6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*oL8X2rz2IIM-k7my516BMw.png"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">WebPageTest is (part of) the beating heart in SpeedCurve.</figcaption></figure><p id="3a43" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们<strong class="it hv">使用</strong><a class="ae kg" href="https://speedcurve.com/'" rel="noopener ugc nofollow" target="_blank"><strong class="it hv">speed curve</strong></a><strong class="it hv">进行持续的性能测试</strong>，而我们使用<a class="ae kg" href="https://www.webpagetest.org/'" rel="noopener ugc nofollow" target="_blank"><strong class="it hv">web page test</strong></a><strong class="it hv">进行我们的“临时”(不时)测试</strong>。SpeedCurve是建立在WebPageTest之上的，所以实际上我们只使用了一个工具。我在WebPageTest中使用的<strong class="it hv">脚本类型</strong>(稍后我将回到这一点)在我们拥有的企业版SpeedCurve中得到支持。万岁。</p><p id="8bc3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">根据SpeedCurve的Steve Souders的推荐，我决定在一些手动的WebPageTest测试中对其进行测试。我想在本文中与你分享的就是这些测试的结果。</p><h1 id="12cb" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕓设置</h1><h2 id="a8e5" class="lx kp hu bd kq ly lz ma ku mb mc md ky jc me mf lc jg mg mh lg jk mi mj lk mk dt translated">🕔找到网址</h2><p id="fba5" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">第一步是获取一些我可以让WebPageTest访问的好的URL来预热测试浏览器。我和销售/后勤/AdOps团队的一些同事聊过，他们给了我<strong class="it hv">以下地址，他们认为这些地址可能会很有趣</strong>:</p><ul class=""><li id="d3a2" class="ml mm hu it b iu iv iy iz jc mn jg mo jk mp jo mq mr ms mt dt translated"><a class="ae kg" href="http://superbrugsen.dk/tilbudsavis/" rel="noopener ugc nofollow" target="_blank">http://superbrugsen.dk/tilbudsavis/</a></li><li id="36b4" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae kg" href="https://www.alka.dk/bilforsikring" rel="noopener ugc nofollow" target="_blank">https://www.alka.dk/bilforsikring</a></li><li id="35ec" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae kg" href="http://www.nykredit.dk/dit-liv/bolig/ny-bolig" rel="noopener ugc nofollow" target="_blank">http://www.nykredit.dk/dit-liv/bolig/ny-bolig</a></li><li id="03fb" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae kg" href="https://danskespil.dk/oddset?intcmp=top_menu_oddset_brand" rel="noopener ugc nofollow" target="_blank">https://danskespil.dk/oddset?intcmp=top_menu_oddset_brand</a></li><li id="ffbb" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo mq mr ms mt dt translated"><a class="ae kg" href="http://www.circlek.dk/dk_DK/pg1334082175653/privat/extraClub.html" rel="noopener ugc nofollow" target="_blank">http://www . circlek . DK/DK _ DK/pg 1334082175653/privat/extra club . html</a></li></ul><p id="1249" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里我们使用的是有限元URL。可能是因为我要求的是“一把”——所以数字5在这个上下文中没有意义。</p><h2 id="5330" class="lx kp hu bd kq ly lz ma ku mb mc md ky jc me mf lc jg mg mh lg jk mi mj lk mk dt translated">🕕写剧本</h2><p id="dc3e" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">现在我们希望WebPageTest在访问我们想要测量的ekstrabladet.dk上的文章之前访问这些URL。这里我们使用内置于WebPageTest 中的脚本接口<strong class="it hv">。</strong></p><p id="3566" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">幸运的是<a class="ae kg" href="https://sites.google.com/a/webpagetest.org/docs/using-webpagetest/scripting" rel="noopener ugc nofollow" target="_blank">脚本是WebPageTest文档的一部分</a>，所以很容易上手。</p><p id="16a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在文档页面上，您可以找到以下示例:</p><pre class="jr js jt ju fq mz na nb nc aw nd dt"><span id="53ae" class="lx kp hu na b fv ne nf l ng nh">logData    0<br/><br/>// put any urls you want to navigate<br/>navigate    www.aol.com<br/>navigate    news.aol.com<br/><br/>logData    1<br/><br/>// this step will get recorded<br/>navigate    news.aol.com/world</span></pre><p id="db3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">WebPageTest脚本的工作方式是发出各种命令(在本例中为“navigate”和“logData”)以及一个或多个参数(在本例中为0/1或URL)。这些to必须是由制表符分隔的<strong class="it hv">。记住这一点很重要。</strong></p><p id="7116" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面的例子从访问“www.aol.com”开始，然后转到“news.aol.com”。但是因为测试浏览器被指示不保存性能测试的任何数据(“logData”被设置为0)，所以可以说它不做任何笔记。</p><p id="a0cc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，当它导航到“news.aol.com/world”时，它会这样做，因为“logData”被设置为1。其实挺符合逻辑的。</p><p id="b983" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这种情况下，它可以用来衡量我所说的“缓存成功”。也就是说，当用户以前使用相同的资源(图片、CSS、JS文件等)访问过另一个页面时，这个页面加载起来有多容易/多快。).<strong class="it hv">这也可以通过访问同一个URL两次</strong>并仅保存上次访问的性能测试来衡量。</p><p id="1aec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们可以使用这个函数来实现我们想要的目标。不是因为我们想衡量缓存的优势(这五个广告商网站可能不与ekstrabladet.dk共享资源)，而是因为<strong class="it hv">页面上加载的数据/信息隐藏在浏览器缓存中，并作为cookie</strong>。</p><p id="8fa4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我们想要编写一个脚本来访问这五个URL，然后在ekstrabladet.dk的frontpage上进行性能测试，它看起来会像这样:</p><pre class="jr js jt ju fq mz na nb nc aw nd dt"><span id="0d37" class="lx kp hu na b fv ne nf l ng nh">logData 0<br/>navigate http://superbrugsen.dk/tilbudsavis/<br/>navigate https://www.alka.dk/bilforsikring<br/>navigate http://www.nykredit.dk/dit-liv/bolig/ny-bolig<br/>navigate https://danskespil.dk/oddset?intcmp=top_menu_oddset_brand<br/>navigate http://www.circlek.dk/dk_DK/pg1334082175653/privat/extraClub.html<br/>logData 1<br/>navigate http://ekstrabladet.dk</span></pre><p id="1d53" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你需要脚本的复制粘贴版本，我已经把它上传为一个. txt文件😉</p><h2 id="5788" class="lx kp hu bd kq ly lz ma ku mb mc md ky jc me mf lc jg mg mh lg jk mi mj lk mk dt translated">🕖定义您的测量范围</h2><p id="33c1" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">对于这些测试，我选择关注<strong class="it hv">文章</strong>的性能。到目前为止，我们的许多表现工作都集中在首页，但我们目前正在我们的网站上推出一种新的文章设计——我们工作方式的一部分是<strong class="it hv">“移动优先”</strong>，所以看看文章的移动版是有意义的。因此，我让WebPageTest模拟iPhone 6。</p><p id="0c62" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我选择使用位于爱尔兰的WebPageTest服务器。还有一些离丹麦很近的，比如德国——但是我已经在爱尔兰用了很长时间了，所以为了比较起见，我还是坚持用那个。</p><p id="07c5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，当你从另一个国家或遥远的地方测试/测量性能时，你<strong class="it hv">不应该过于依赖实际值</strong>。9秒的加载时间不一定是9秒，因为爱尔兰的一些测试是这样说的。另一方面，<strong class="it hv">你信任可比的测量/测试</strong>。就像，如果你在你的网站上偶然发现了一些东西，加载时间从10到5仍然减少了一半，当然，只要之前/之后的测试是在相同的位置以相同的方式进行的。类似的测试正是我们想要做的。</p><p id="104a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我决定在我们的娱乐版(“闪电侠！”)，因为它是具有新闻设计和附带功能的部分之一。</p><p id="0242" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我测试了10篇文章。发布和测试的时间都分散在几天内:</p><ol class=""><li id="bb1f" class="ml mm hu it b iu iv iy iz jc mn jg mo jk mp jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/ingen-skilsmissekommentarer-fra-aqua-lene/6690431" rel="noopener ugc nofollow" target="_blank"><em class="jp">Ingen skilsmissekommentarer fra Aqua-Lene</em></a></li><li id="328c" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/dansk-grandprixvinder-er-blevet-gift/6696197" rel="noopener ugc nofollow" target="_blank"><em class="jp">Dansk grandprixvinder er blevet gift</em></a></li><li id="edc7" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/line-baun-derfor-flyttede-jeg-hjemmefra/6696409" rel="noopener ugc nofollow" target="_blank"> <em class="jp">线包:Derfor flyttede jeg hjemmefra</em></a></li><li id="c0b9" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/kongelige/danskekongelige/dronningen-om-sin-barndom-en-saetning-foragtede-jeg/6698598" rel="noopener ugc nofollow" target="_blank"><em class="jp"/></a></li><li id="5a36" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/paradise-deltager-ville-vaere-politiker-derfor-er-planen-droppet/6705500" rel="noopener ugc nofollow" target="_blank"/></li><li id="ecba" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/efter-facebook-fight-jeg-foeler-mig-som-en-beskidt-luder/6704016" rel="noopener ugc nofollow" target="_blank"> <em class="jp">在脸书战斗之后:—杰格·福勒·米格·索姆恩·贝斯基德</em> </a></li><li id="88af" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/udlandkendte/her-er-verdens-bedst-betalte-kendis/6704970" rel="noopener ugc nofollow" target="_blank"><em class="jp"/></a></li><li id="7c0f" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/smukke-helenas-hund-passer-paa-missen/6705222" rel="noopener ugc nofollow" target="_blank"><em class="jp"/>T37】</a></li><li id="0027" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/aerlig-line-baun-om-sit-livs-kiks-jeg-ville-da-oenske-jeg-aldrig-havde-sagt-det/6705508" rel="noopener ugc nofollow" target="_blank"><em class="jp"/></a></li><li id="eae8" class="ml mm hu it b iu mu iy mv jc mw jg mx jk my jo ni mr ms mt dt translated"><a class="ae kg" href="http://ekstrabladet.dk/flash/dkkendte/aerlig-mascha-vang-saadan-paavirker-terroren-mig/6705231" rel="noopener ugc nofollow" target="_blank"><em class="jp">rlig Mascha Vang:s Dan p virker terror en MIG</em></a></li></ol><h2 id="52f6" class="lx kp hu bd kq ly lz ma ku mb mc md ky jc me mf lc jg mg mh lg jk mi mj lk mk dt translated">🕗记住一般的网页测试技巧</h2><p id="0b17" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">当您在包含第三方内容/技术的网站上使用WebPageTest时，将所有内容纳入测试负载中是非常重要的。<strong class="it hv">一些技术提供商会隐藏广告，例如，如果他们可以看到这是一个测试浏览器</strong>，以便浪费宝贵的广告显示在机器上。因此，检查“高级设置”中的“高级”中的“保留原始用户代理字符串”设置非常重要:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nj"><img src="../Images/02ef85112344ee2d9e2721e3668e087e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XitVzBWd_DGzCIjccWOjHw.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">‘PTST’ is the WebPageTest test browser’s way of identifying itself as a test browser. This can cause some issues so I always check this box ↑</figcaption></figure><p id="256d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你还应该在YouTube上观看<a class="ae kg" href="https://www.youtube.com/watch?v=6UeRMMI_IzI" rel="noopener ugc nofollow" target="_blank"><strong class="it hv"><em class="jp">【Velocity 2014—web page test Power Users—Part 1】</em></strong></a><strong class="it hv"><em class="jp"/></strong>。这是谷歌Chrome团队的Patrick Meenan在2014年性能会议“Velocity”上所做报告的第一部分。</p><p id="3ab9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除此之外，他建议你<strong class="it hv">运行奇数次</strong>，因为网页测试通过选择中间的一次来挑选最好的一次。他还强调你已经运行了不止一次，因为第一次运行会预热DNS缓存、服务器、数据库等。</p><p id="2288" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我选择在测试中运行五次。除此之外，我将每个测试运行10次(意味着总共运行50次),然后收集到一个电子表格中，求出平均值。</p><h1 id="59cc" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕘结果呢</h1><p id="b5b9" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">如果我们没有相同的数据来看，一切都会变得有点抽象。因此，我把我的电子表格上传到了谷歌文档，这样你就可以看看了。在那里你还可以找到我用过的所有网页测试的链接。</p><p id="ce6e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些测试/测量没有秘密可言。大家可以用WebPageTest来衡量ekstrabladet.dk文章的表现。我只是复制了结果(并转换了数字格式)，计算了平均值，并在有和没有五个URL的测试中进行了比较。就是这样。</p><p id="70c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">→ <a class="ae kg" href="https://docs.google.com/spreadsheets/d/13TLpPhZCEbvJQOQkgyry26b92C3aGic3QjtPMo2e2z0/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">你可以在这里看到电子表格</a></p><p id="26b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，最有趣的是比较，所以它们在这里。原谅我只是从Excel中粘贴截图——我只是不想花半天时间将数据粘贴到HTML表格中(注意:“Ny”在丹麦语中是“New”的意思):</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/837a0b3ecee49b777d975a155d027f71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvJDlamwTlijOEEFYNdSeA.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/a4731ccbf837cb8130e824ce0558c71c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bdzmk0oIZxbm-Zj1fODH5Q.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/45834ffdf061eb5648ffabd5b7398da5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdlXUAz8EowF1-BpAOZCkA.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/cc8142f0fa0c0d34eb64829302a2dac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-5fOy_rWzlYLwADiBfXY4g.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/dbb44fbecbb8570d6a38293fb90ffb87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AN_UISyes-PcReYfFBRmog.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/e9fd7ad6dad7e3f886d19ea37d0d66a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATrCu00g-8-l0fSMxjSL7g.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/8e19386fbbc57c8c429603007ff70bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U6W6VHzZm5zI5_lxcaOXvQ.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/ff3ac061ac0e5162db3cb646447e69b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yso6wEh-XIsewRG89PG9xw.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/76da27d38d19713eae7ae4f5fd87bc94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlXGMN5mEGQgtHAg11UGWg.png"/></div></div></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/4714724a51f0153347db0a25e7f5b436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_eqfr08JCt4Mg2rtETX3Q.png"/></div></div></figure><p id="1d69" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">快速浏览一下数字<strong class="it hv">速度指数值就是动作所在的位置</strong>。速度指数是(除了<a class="ae kg" href="https://sites.google.com/a/webpagetest.org/docs/using-webpagetest/metrics/speed-index'" rel="noopener ugc nofollow" target="_blank">被记录</a> ) <strong class="it hv">第一个视口准备好</strong>有多快的一个表达。换句话说，这是一种试图衡量<strong class="it hv">感知表现</strong>——或者至少是大部分感知表现的尝试。</p><p id="9f67" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了对结果有一个更全面的印象，我们可以看看平均增长百分比。请注意，这实际上是不可行的，因为文章之间可能会有很大的差异(毕竟只有10篇文章)，但它可以提供一个更广阔的视角，也许有助于确定某些趋势:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nk"><img src="../Images/aef0b5bc8da0b5cf91616b04c38892cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6KFMwPJhIwPayQxPciouA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">This clearly shows that especially Speed Index is improved by including the five URLs.</figcaption></figure><p id="9664" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里我们可以看到速度指数增加了30 %,这是非常显著的。</p><p id="c549" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这张图(可能获得“世界最丑图”提名)说明了速度指数的下降；这些物品按颜色配对:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nl"><img src="../Images/3f9ee5ca6b9ff0834d892d6e01ae5d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yzjnuNv8mgQSXOhQGD1dOQ.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Speed Index for the 10 different articles, with and without the new URLs in the test tool.</figcaption></figure><h1 id="361b" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕙结论</h1><p id="a6dc" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">尽管其他值实际上没有受到影响<strong class="it hv">，但是当测试工具(WebPageTest)在访问ekstrabladet.dk文章之前已经访问了五个URL并构建了一个cookie配置文件(诚然相当糟糕)时，第一个视图/视口看起来确实要快得多。</strong></p><p id="4536" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，这对于ekstrabladet.dk的用户体验来说并不意味着什么，就像我们不需要在这个发现之后改变我们网站上的任何东西一样。</p><p id="8e81" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而它仍然很重要。<strong class="it hv">这表明我们的网站可能比我们的工具显示的</strong>对我们的用户表现得更好(至少在速度指数方面)<strong class="it hv">；因为带有cookies配置文件的测试浏览器更类似于真实用户。</strong></p><p id="2106" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，我们需要考虑改变性能测试和测量的设置；我一会儿会回到这个话题。</p><p id="0551" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同时，有趣的是，文章的加载时间只有很小的变化。<strong class="it hv">对于用户来说，文章本身并没有加载得更快</strong>(或者，老实说，测试浏览器)，但是第一个视窗准备得要快得多。这可能表明一些元素/请求正在以另一种顺序获取，因此页面上的顶部元素首先被加载——从性能角度来看，这很有意义。</p><p id="bbd8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我也发现有趣的是，我们看到的<strong class="it hv">与我所期待的</strong>完全相反。我以为我们会和我再也找不到的文章中的人有同样的发现；对于真实用户来说，我们的网站实际上比测试工具慢。</p><p id="d869" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">相反，我们看到，当我们开始模仿真实的浏览器行为时，至少速度指标得到了提高。这是个好消息(尽管对于其他或者更多的URL来说可能是相反的情况)——但是我怎么会这样呢？</p><h1 id="462d" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕚为什么(也许)——以及未来</h1><p id="ce0f" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">这些测试(即使有大量的运行)没有揭示为什么测试中的文章在测试浏览器配备了cookies的情况下具有更好的感知性能。</p><p id="2052" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我与我们BackOffice/AdOps团队的一位同事分享了一个理论，即<strong class="it hv">对于各种技术来说，配置文件正变得越来越“有吸引力”</strong>。毕竟，许多广告都试图通过使用像cookies这样的东西来获得正确的用户，所以结论就在我们面前。</p><p id="950c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们需要挖掘它，并找出这是一个二元状态(其中最大的区别在于“cookie”/“无cookie”)还是一个渐进的事情，如果我们有25个URL而不是5个，我们可能会看到更好的性能。</p><p id="b570" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，这可能是WebPageTest中的一个小故障。由于某种原因，当测试浏览器在本文之前访问过其他站点时，它在加载第一个视窗时会变得更快。我不这么认为——但在这种情况下，它不会改变事实，即我们用来衡量和测试性能的工具存在某些不确定性。</p><p id="6c4b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通过这10篇文章，我们看到了速度指数的下降。<strong class="it hv">下一次可能会有所不同</strong> —例如，我刚刚做了一个控制测试，来自同一部分的另一篇文章；这里速度指数下降了大约20 %,而加载时间下降了超过10%。</p></div><div class="ab cl kh ki hc kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hn ho hp hq hr"><p id="3623" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">那么，现在会发生什么？首先，我们需要做更多的测试。</strong></p><p id="0908" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如我上面提到的，我们需要在性能测试之前找出被访问的URL数量是否有差异。这不是我们可以在网站上使用的东西——但是我们可以用它来构建更好的性能测试和测量。</p><p id="1013" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当用户体验像现在这样动态的时候，我们的性能测试尽可能地接近真实的浏览器访问是非常重要的。</p><p id="dcb0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我也想做测试，广告(和类似的第三方技术)被排除在外。我的论点是，速度指数的差异将会消失——但这需要通过测试来证实/排除。</p><p id="e791" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">当我们找到可能的最佳设置时，我们需要更改SpeedCurve </strong>中的设置，我们用它来进行持续的性能测试。在这里，我们将面临一个有趣的讨论:<strong class="it hv">我们是否也应该改变我们测试其他用于基准测试的网站的方式</strong>？如果是，会是相同的X个网址吗？还是其他网址更适合其他网站？</p><p id="d127" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这里，我们还需要决定这个设置是否需要<strong class="it hv">维护</strong>，从而我们不时地添加/编辑列表中的URL。</p><p id="a444" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">如果你从事一个有广告或其他个性化技术的网站</strong>的工作，我会推荐你做类似的事情。与你的组织中的其他人讨论在你的测试中使用哪些URL是有意思的。</p><p id="8d12" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很可能你会发现，没有什么不同——但那时你就会知道。记住要保持测试的活力，重复测试，这样你就能在正确的基础上做出决定。</p><h1 id="e998" class="ko kp hu bd kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh lv lj lk ll dt translated">🕛什么是真实的？</h1><p id="22db" class="pw-post-body-paragraph ir is hu it b iu lm iw ix iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo hn dt translated">毫无疑问，性能测试是一个非常…活跃的领域，在这里你永远不能确定你实际上是在测量用户正在体验什么。</p><p id="fc65" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如墨菲斯在《黑客帝国》中告诉尼奥的:</p><blockquote class="nm"><p id="2f31" class="nn no hu bd np nq nr ns nt nu nv jo ek translated">什么是真实的？你如何定义真实？</p></blockquote><p id="a263" class="pw-post-body-paragraph ir is hu it b iu nw iw ix iy nx ja jb jc ny je jf jg nz ji jj jk oa jm jn jo hn dt translated">这些测试强调了其他人已经多次提出的一个观点；个性化使我们每个人都体验到了自己的万维网。</p><p id="cfa0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这使得我们无法定义什么是“真正的”用户体验——这意味着像我们这样的网站的性能将永远是尽可能多的用户对网站体验的一般表达。</p></div><div class="ab cl kh ki hc kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hn ho hp hq hr"><p id="8acd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae kg" href="http://ebudvikling.dk/blog/2017/06/15/performance-cookies-giver-dig-mere-trovaerdige-maalinger/" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">这篇文章最初发布在我们的Ekstra Bladet开发博客上→ </strong> </a></p><div class="jr js jt ju fq ab cb"><figure class="ob jv oc od oe of og paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ob jv oc od oe of og paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ob jv oc od oe of og paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="oh oi oj"><p id="f922" class="ir is jp it b iu iv iw ix iy iz ja jb ok jd je jf ol jh ji jj om jl jm jn jo hn dt translated"><a class="ae kg" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kg" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kg" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kg" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb ok jd je jf ol jh ji jj om jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kg" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kg" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff on"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="oo op l"/></div></figure></div></div>    
</body>
</html>