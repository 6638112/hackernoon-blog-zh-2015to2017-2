<html>
<head>
<title>Configure Role Based Access Control In Django</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Django中配置基于角色的访问控制</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/configure-role-based-access-control-in-django-74fa94a54aff?source=collection_archive---------15-----------------------#2017-05-30">https://medium.com/hackernoon/configure-role-based-access-control-in-django-74fa94a54aff?source=collection_archive---------15-----------------------#2017-05-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/0710e248b7bb449250c94088f0c2a8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hquCwUM3AUh103wp.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Role Based Access Control in Django</figcaption></figure><p id="afa6" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这个模型存储系统中的实际用户。它有基本字段，如用户名、密码和电子邮件。您可以扩展该类以添加应用程序需要的更多属性。Django用户认证通过会话和中间件处理认证。</p><p id="f579" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">对于每个请求，Django都会挂钩一个请求对象。使用它，您可以通过request.user获得登录用户的详细信息。</p><h1 id="aa7a" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">组:对用户进行分类的方式</h1><p id="3a8d" class="pw-post-body-paragraph jg jh hu ji b jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz lg kb kc kd hn dt translated">这些是系统所需的逻辑用户组。您可以向这些组分配权限和用户。Django在admin中提供了一个基本视图来创建这些组和管理权限。</p><p id="67ec" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">组表示用户在系统中的“角色”。作为一名“管理员”，你可能属于一个名为“admin”的组。作为一名“支持人员”，你属于一个叫做“支持”的团体。</p><h1 id="f255" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">权限:粒度访问控制</h1><p id="b3e2" class="pw-post-body-paragraph jg jh hu ji b jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz lg kb kc kd hn dt translated">定义的组根据分配给每个组的权限控制访问。默认情况下，Django允许您添加、编辑和更改每个模型的权限。</p><p id="11d6" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">您可以在管理视图或您的应用程序中使用这些权限。比如你有一个类似‘博客’的模式。</p><p id="e35b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">班级博客(模特。模型):pub_date =模型。DateField() headline = models。CharField(max_length=200)内容=模型。TextField()作者=模型。外键(用户)</p><p id="e256" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">班级博客(模特。型号):</p><p id="97f2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">pub_date =模型。日期字段()</p><p id="1484" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">头条=模特。CharField(max_length=200)</p><p id="f421" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">内容=模型。文本字段()</p><p id="7760" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">作者=模特。外键(用户)</p><p id="7081" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这些模型都在Django中注册为ContentType。Django创建的所有下层权限都会引用这个特定的ContentType。在这种情况下，默认情况下将创建以下权限:</p><p id="260f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">add_blog:拥有此权限的任何用户或组都可以添加新的博客。change_blog:任何拥有此权限的用户或组都可以编辑博客。delete_blog:任何拥有此权限的用户或组都可以删除博客。</p><h1 id="8ed5" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">添加自定义权限</h1><p id="37b1" class="pw-post-body-paragraph jg jh hu ji b jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz lg kb kc kd hn dt translated">Django的默认权限非常简单。它可能不总是满足您的应用程序的要求。Django允许您添加自定义权限，并根据需要使用它们。使用模型元属性，您可以添加新的权限:</p><p id="513f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">班级博客(模特。Model): … Class Meta: permissions =((“查看_博客”，“可以查看博客”)，(“可以发布_博客”，“可以发布博客”)，)</p><p id="6b30" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">班级博客(模特。型号):</p><p id="3440" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">(“查看_博客”，“可以查看博客”)，</p><p id="0018" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">(“能_发布_博客”，“能发布博客”)，</p><p id="c890" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这些额外权限是在运行manage.py，migrate时与默认权限一起创建的。</p><h1 id="7e83" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">如何使用这些权限</h1><p id="0cf1" class="pw-post-body-paragraph jg jh hu ji b jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz lg kb kc kd hn dt translated">您可以将权限分配给用户或组。例如，您可以将所有权限授予组“管理员”。您可以确保“支持”组仅获得“change_blog”权限。这样，只有管理员用户才能添加或删除博客。在视图、模板或API中，您需要<a class="ae lh" href="https://www.techopedia.com/definition/23933/role-based-access-control-rbac" rel="noopener ugc nofollow" target="_blank">基于角色的访问控制</a>来获得这种权限。</p><h1 id="c4c2" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">视图:</h1><p id="625b" class="pw-post-body-paragraph jg jh hu ji b jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz lg kb kc kd hn dt translated">要检查视图中的权限，请使用has _ perm方法或装饰器。用户对象提供的方法是has_perm(perm，obj =无)，其中perm是“.”如果用户有权限，则返回True。</p><blockquote class="li lj lk"><p id="ebd9" class="jg jh ll ji b jj jk jl jm jn jo jp jq lm js jt ju ln jw jx jy lo ka kb kc kd hn dt translated"><em class="hu">user . has _ perm(【blog . can _ publish _ blog】)</em></p></blockquote><p id="5c62" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">您也可以使用修饰器“permission_required(perm，login _ url =无，raise_exception=False)”。这个装饰者也以“形式”获得许可。。此外，它还带有一个login_url，可用于将该url传递到您的登录/错误页面。如果用户没有所需的权限，那么他将被重定向到此URL。</p><blockquote class="li lj lk"><p id="b326" class="jg jh ll ji b jj jk jl jm jn jo jp jq lm js jt ju ln jw jx jy lo ka kb kc kd hn dt translated"><em class="hu">来自django . contrib . auth . decorators import permission _ required</em></p></blockquote><p id="3daa" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">@ permission _ required(' blog . can _ publish _ blog '，log in _ URL = '/sign in/')def publish _ blog(请求):…</p><p id="3715" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果您有一个基于类的视图，那么您可以使用“PermissionRequiredMixin”。您可以将一个或多个权限传递给permission_required参数。</p><blockquote class="li lj lk"><p id="cf0b" class="jg jh ll ji b jj jk jl jm jn jo jp jq lm js jt ju ln jw jx jy lo ka kb kc kd hn dt translated"><em class="hu">来自django . contribut . auth . mixins import permissionrequired dmin</em></p></blockquote><p id="bd4f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">类PublishBlog(permissionrequired adminxin，View):permissionrequired = blog . can _ publish _ blog '</p></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="e825" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="ll">原为2018年7月17日在</em><a class="ae lh" href="https://hashedin.com/blog/configure-role-based-access-control-in-django/" rel="noopener ugc nofollow" target="_blank"><em class="ll">hashedin.com</em></a><em class="ll">发布。</em></p></div></div>    
</body>
</html>