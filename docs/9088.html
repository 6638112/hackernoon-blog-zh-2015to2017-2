<html>
<head>
<title>An Introduction to Microservice Based Architecture Through Story — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过故事介绍基于微服务的架构—第二部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/an-introduction-to-microservice-based-architecture-through-story-part-2-dacceaff9a13?source=collection_archive---------6-----------------------#2017-12-26">https://medium.com/hackernoon/an-introduction-to-microservice-based-architecture-through-story-part-2-dacceaff9a13?source=collection_archive---------6-----------------------#2017-12-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d86b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几周前，我写了这篇文章:</p><div class="jp jq fm fo jr js"><a href="https://hackernoon.com/an-introduction-to-microservice-based-architecture-through-story-part-1-55c553ac4bd9" rel="noopener  ugc nofollow" target="_blank"><div class="jt ab ej"><div class="ju ab jv cl cj jw"><h2 class="bd hv fv z el jx eo ep jy er et ht dt translated">通过故事介绍基于微服务的架构—第1部分</h2><div class="jz l"><h3 class="bd b fv z el jx eo ep jy er et ek translated">如今，对基于微服务的架构的推动似乎对许多大型、分布式……</h3></div><div class="ka l"><p class="bd b gc z el jx eo ep jy er et ek translated">hackernoon.com</p></div></div><div class="kb l"><div class="kc l kd ke kf kb kg kh js"/></div></div></a></div><p id="a2a1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这对我来说是一种新的写作风格，我只是想尝试一下。从那时起，它就成为了我最受欢迎的帖子之一，它最近的活动促使我写下了故事的第二部分。</p><p id="3869" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">故事发生在高级开发人员Gemma身上，她领导着公司的一个团队向基于微服务的架构发展。这个故事发生在她的团队过渡到基于微服务的架构3个月后。</p></div><div class="ab cl kj kk hc kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hn ho hp hq hr"><h1 id="9a83" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">道路上的隆起</h1><p id="6a37" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">总体而言，向微服务架构的过渡已证明对公司有利。Gemma成功地设计了一个解决方案，将网站分成3个不同的问题域；账户服务、商店服务和漫画浏览器服务。</p><h2 id="297a" class="lt kr hu bd ks lu lv lw kw lx ly lz la jc ma mb le jg mc md li jk me mf lm mg dt translated">停机时间的减少</h2><p id="909e" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">在制作3个月后，这家漫画公司看到了任何停机时间的结束，这在一定程度上要归功于他们的绿蓝部署策略。再也没有“大爆炸”式部署上线并随后停止、导致整个站点瘫痪的情况了。</p><p id="d25b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通过绿蓝部署，Gemma和她的团队能够将新版本的系统与现有的稳定版本一起部署，并执行大量不同的测试，如canary测试，以确保当他们进行最终切换时，一切正常工作。</p><h2 id="4687" class="lt kr hu bd ks lu lv lw kw lx ly lz la jc ma mb le jg mc md li jk me mf lm mg dt translated">部署的困难</h2><p id="f8f9" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">然而，随着Gemma和她的团队转向基于微服务的方法，他们发现他们花费在部署上的时间增加了。</p><p id="d826" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他们不再执行单一应用程序的“一个”发布，而是在每次发布时部署2到6个不同的服务。这包括他们3个服务中的每一个的新的绿-蓝实例。</p><p id="8e6a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这显然并不理想，他们获得了更少的停机时间和更具弹性的架构，却损失了开发人员的生产力。作为一个小团队，如果一个开发人员每3天就被拖进4个小时的部署中，那么它真的开始损害团队的生产力。</p><h2 id="4bb3" class="lt kr hu bd ks lu lv lw kw lx ly lz la jc ma mb le jg mc md li jk me mf lm mg dt translated">库伯内特人的崛起</h2><p id="0cc7" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">在遇到这个绊脚石后，Gemma被迫进一步研究，并找到一种方法来自动化发布，这样他们就可以收回失去的时间，并将更多的精力放在交付关键业务价值上。</p><figure class="mi mj mk ml fq mm fe ff paragraph-image"><div class="fe ff mh"><img src="../Images/c22b1b106b9964787eedaca56f532a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*DmYECnWjPhFm0iTeB9aAsg.png"/></div></figure><p id="9169" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是她发现Kubernetes的时候。她看了一下<a class="ae ki" href="http://amzn.to/2Dglbpt" rel="noopener ugc nofollow" target="_blank"> Kubernetes:启动并运行</a>，并开始精通使用Kubernetes的艺术。</p><p id="8bda" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Kubernetes本质上允许她和她的团队将他们的整个系统定义为代码。在AWS新的托管Kubernetes服务的基础上运行这项服务，可以让他们在管理整体资产方面节省大量时间。</p><p id="1dbe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这引发的唯一问题是，团队需要一些时间来了解托管Kubernetes服务的来龙去脉以及底层的Kubernetes <a class="ae ki" href="https://hackernoon.com/tagged/technology" rel="noopener ugc nofollow" target="_blank">技术</a>。随着时间的推移，这将节省更多的时间，Gemma认为这没有问题。</p><figure class="mi mj mk ml fq mm fe ff paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="fe ff mo"><img src="../Images/7c0960db1c8866ed230eec5e8f803b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHBI-3wbqxm49mN2P0cNUA.png"/></div></div><figcaption class="mt mu fg fe ff mv mw bd b be z ek">AWS’s EKS — Managed Kubernetes Service</figcaption></figure><h2 id="ab5f" class="lt kr hu bd ks lu lv lw kw lx ly lz la jc ma mb le jg mc md li jk me mf lm mg dt translated">可追溯性的丧失</h2><p id="48c1" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">迁移到基于微服务的架构时出现的另一个有点麻烦的问题是，失去了对出错原因的可追溯性。</p><p id="62ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">随着任何应用程序中服务数量的增长，能够跨构建该应用程序的各种微服务跟踪请求变得很麻烦。</p><p id="bdfe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果某个服务出了问题，他们如何通过它调用的所有后续系统轻松地跟踪它？</p><p id="fc09" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最初，使用低效的调试机制浪费了大量时间。每当一个工程师因为一个问题在周末被叫去的时候，他们都不愿意上线并试图调试已经发生的事情。面临的任何问题都需要至少一个小时来调试，即使在没有问题的情况下也是如此。</p><h2 id="3a4c" class="lt kr hu bd ks lu lv lw kw lx ly lz la jc ma mb le jg mc md li jk me mf lm mg dt translated">可追溯性的答案:Zipkin</h2><p id="521e" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">杰玛求助于一个名为Zipkin的系统，该系统基于谷歌自己的追踪系统Dapper的想法。Zipkin本质上为您提供了所有服务间调用的非常详细的跟踪，并且本质上允许Gemma和她的团队跟踪他们的服务中面临的任何和所有问题。</p><p id="2c2f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，必须投入更多的时间来学习这个新工具，并确保她团队中的所有开发人员都能够轻松有效地使用该工具进行调试。</p><p id="3372" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，一旦他们熟悉了Zipkin，他们就能够利用这些看起来非常棒的调用跟踪。</p><figure class="mi mj mk ml fq mm fe ff paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="fe ff mx"><img src="../Images/1db1f103b6bda3dc016bb63f42cc10fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DYgaRRXZmw9AmHZCRhjCw.png"/></div></div><figcaption class="mt mu fg fe ff mv mw bd b be z ek">Zipkin traces typically look like this</figcaption></figure><h2 id="66fd" class="lt kr hu bd ks lu lv lw kw lx ly lz la jc ma mb le jg mc md li jk me mf lm mg dt translated">3个月后——结论</h2><p id="ffad" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">在转向基于微服务的架构6个月后，该团队在进行更改的速度方面取得了巨大进步。</p><p id="188c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他们在弹性方面取得了巨大进步，客户体验也得到了极大改善。他们能够快速部署用户喜爱的变化和改进，总体而言，该公司能够主导在线漫画市场。</p><p id="2112" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">团队花了很多时间学习更新的技术，但是最初投入的时间最终得到了回报。</p></div><div class="ab cl kj kk hc kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hn ho hp hq hr"><h1 id="06b4" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">结论</h1><p id="c55f" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">希望你发现这篇后续文章和上一篇文章一样有趣和有启发性。一如既往，如果你对我的写作风格有任何反馈，请告诉我！我总是渴望改进我表达观点的方式！</p><p id="2328" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想这个故事的寓意是，虽然基于分布式微服务的架构可能适用于大多数不同的系统和团队结构，但你必须考虑部署和可追溯性等方面的复杂性增加。这与过去的方式相比是一个巨大的变化，开发者的思维方式必须改变。</p><p id="6053" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">想和我联系吗？请随意发微博给我@ <a class="my mz gr" href="https://medium.com/u/eb71d34fbe09?source=post_page-----dacceaff9a13--------------------------------" rel="noopener" target="_blank">埃利奥特·福布斯</a>。</p><figure class="mi mj mk ml fq mm"><div class="bz el l di"><div class="na nb l"/></div></figure></div></div>    
</body>
</html>