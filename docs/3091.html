<html>
<head>
<title>A blooming good Java toString for the rest of us</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">给我们其余的人一个极好的爪哇串</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-blooming-good-java-tostring-for-the-rest-of-us-50dca980a462?source=collection_archive---------6-----------------------#2017-03-12">https://medium.com/hackernoon/a-blooming-good-java-tostring-for-the-rest-of-us-50dca980a462?source=collection_archive---------6-----------------------#2017-03-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/7d5410f7fe37d4e6afff28bee131f342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*k9DtwkFr0Rwn07CEFFCxCA.png"/></div></figure><p id="a6de" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">你有没有</strong> <em class="jw"> System-d点出</em>一个对象，并得到它的类名@它的十六进制hashcode？</p><p id="f30c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">很有可能:这不是你所希望的，也没有给你带来什么帮助。</p><p id="8eb5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">问题是，在Java中，我们缺少一个为任何Java对象生成良好且一致的文本表示的函数。</p><p id="5bef" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果我们有，我们会写:</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="a1c8" class="kg kh hu kc b fv ki kj l kk kl">System.out.println( <strong class="kc hv">toString</strong>.apply(myObject) ); </span></pre><p id="212f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">代替</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="f2ea" class="kg kh hu kc b fv ki kj l kk kl">System.out.println( myObject<strong class="kc hv">.toString()</strong> ); <em class="jw">// finger crossed, we <br/>                                           // have a good toString.</em></span></pre><p id="9d50" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后我们将停止诅咒开发者没有实现一个好的<em class="jw"> toString </em>。</p></div><div class="ab cl km kn hc ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hn ho hp hq hr"><p id="ec25" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你决定忽略一些边缘情况，破解一个通用的toString很容易。</p><p id="a000" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它只需要您使用反射API迭代对象的所有字段来打印它们。</p><p id="babb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><a class="ae kt" href="https://gist.github.com/lorenzoongithub/d1a7e047b29aef79d363b3b56c2e666a" rel="noopener ugc nofollow" target="_blank">我写了一个</a>，你可以用<a class="ae kt" href="https://docs.oracle.com/javase/8/docs/technotes/guides/scripting/nashorn/shell.html" rel="noopener ugc nofollow" target="_blank"> Nashorn jjs </a>，用<a class="ae kt" href="https://lorenzoongithub.github.io/nudge4j/" rel="noopener ugc nofollow" target="_blank"> nudge4j </a>和任何Java 8程序使用。</p><p id="888b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它是作为Nashorn JavaScript函数编写的。该函数几乎将所有工作委托给了名不副实的<em class="jw">ReflectionToStringBuilder</em>(Apache Commons Lang的一部分)。</p><p id="7bbd" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">您的类路径中不需要Apache Commons Lang(我也没有)。我讨厌依赖，我不会要求你仅仅为了这个而添加它。代码附带了<a class="ae kt" href="http://stackoverflow.com/questions/60764/how-should-i-load-jars-dynamically-at-runtime" rel="noopener ugc nofollow" target="_blank">一个很好的技巧</a>从maven repo按需加载它。</p></div><div class="ab cl km kn hc ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hn ho hp hq hr"><p id="da08" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们如何使用toString函数？</p><p id="94c3" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在Nashorn jjs和nudge4j中，您加载它并准备好开始:</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="7b18" class="kg kh hu kc b fv ki kj l kk kl">load("<a class="ae kt" href="https://gist.githubusercontent.com/lorenzoongithub/d1a7e047b29aef79d363b3b56c2e666a/raw/c486452e25d0f419101ae7bddd259240b17f1762/toString.js" rel="noopener ugc nofollow" target="_blank">https://gist.githubusercontent.com/lorenzoongithub/d1a7e047b29aef79d363b3b56c2e666a/raw/c486452e25d0f419101ae7bddd259240b17f1762/toString.js</a>")<br/>toString(java.lang.Thread.currentThread());</span></pre><p id="89c0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在Java中，你需要写一些模板来把它包装成一个Java函数:</p><pre class="jx jy jz ka fq kb kc kd ke aw kf dt"><span id="42b0" class="kg kh hu kc b fv ki kj l kk kl">Function&lt;Object, String&gt; toString = new Function&lt;Object,String&gt;() {<br/>  private ScriptEngine engine;<br/>   <br/>  {<br/>    try {<br/>      engine = new ScriptEngineManager().<br/>                      getEngineByName("JavaScript");<br/>      try (InputStream is = new URL("<a class="ae kt" href="https://gist.githubusercontent.com/lorenzoongithub/d1a7e047b29aef79d363b3b56c2e666a/raw/c486452e25d0f419101ae7bddd259240b17f1762/toString.js" rel="noopener ugc nofollow" target="_blank">https://gist.githubusercontent.com/lorenzoongithub/d1a7e047b29aef79d363b3b56c2e666a/raw/c486452e25d0f419101ae7bddd259240b17f1762/toString.js</a>").openStream()) {</span><span id="550d" class="kg kh hu kc b fv ku kj l kk kl">        engine.eval(new InputStreamReader(<br/>          is, StandardCharsets.UTF_8));<br/>      }<br/>    } catch (ScriptException | IOException e) {<br/>      throw new RuntimeException(e);<br/>    }<br/>  }</span><span id="add3" class="kg kh hu kc b fv ku kj l kk kl">  public String apply(Object oj) {<br/>    try {<br/>      return ""+<br/>        ((Invocable)engine).invokeFunction("toString", oj);<br/>    } catch (NoSuchMethodException | ScriptException e) {<br/>      throw new RuntimeException(e);<br/>    }<br/>  }<br/>};</span><span id="6bca" class="kg kh hu kc b fv ku kj l kk kl">System.out.println(toString.apply(Thread.currentThread()));</span></pre></div><div class="ab cl km kn hc ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hn ho hp hq hr"><p id="f5c4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">就是这样</strong>:字符串化任何Java对象的通用函数。</p><p id="5c56" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这不会对你的日常工作产生影响，但在调试的某一天，它可能会派上用场。</p><p id="2c3d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">少调试。</p><figure class="jx jy jz ka fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff kv"><img src="../Images/96cf97d9fcb036d41137c9a15c1b5209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TGPia95dg7f3F3gwRjTdgA.png"/></div></div><figcaption class="la lb fg fe ff lc ld bd b be z ek">loading toString.js in <a class="ae kt" href="https://lorenzoongithub.github.io/nudge4j/" rel="noopener ugc nofollow" target="_blank">nudge4j</a></figcaption></figure><div class="jx jy jz ka fq ab cb"><figure class="le iv lf lg lh li lj paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="le iv lf lg lh li lj paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="le iv lf lg lh li lj paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lk ll lm"><p id="f922" class="iy iz jw ja b jb jc jd je jf jg jh ji ln jk jl jm lo jo jp jq lp js jt ju jv hn dt translated"><a class="ae kt" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kt" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kt" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae kt" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="iy iz jw ja b jb jc jd je jf jg jh ji ln jk jl jm lo jo jp jq lp js jt ju jv hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kt" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kt" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jx jy jz ka fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff lq"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>