<html>
<head>
<title>Tutorial: How to make HTTP Requests in React, Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:如何在React中发出HTTP请求，第3部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/tutorial-how-to-make-http-requests-in-react-part-3-daa6b31b66be?source=collection_archive---------0-----------------------#2017-12-09">https://medium.com/hackernoon/tutorial-how-to-make-http-requests-in-react-part-3-daa6b31b66be?source=collection_archive---------0-----------------------#2017-12-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/99e2b11bf3fb7e015172bc4706d89505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Or6XtSXzdl2IdJ7aM6dfdQ.png"/></div></div></figure><p id="a6fa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ka">如果您还没有完成本教程的</em> <a class="ae kb" rel="noopener" href="/@MCapoz/tutorial-how-to-make-http-requests-in-react-part-1-f7afa3cd0cc8"> <em class="ka">第一部分</em> </a> <em class="ka">和</em> <a class="ae kb" rel="noopener" href="/@MCapoz/tutorial-how-to-make-http-requests-in-react-part-2-4cfdba3ec65"> <em class="ka">第二部分</em> </a> <em class="ka">，请在开始第三部分之前完成。</em></p><p id="2952" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们开始精彩的部分了！到目前为止，我们已经使用create-react-app建立了一个新的React应用程序，并且连接了我们的组件来记录“成功！”当我们点击按钮时。现在，我们需要发出实际的<a class="ae kb" href="https://hackernoon.com/tagged/http" rel="noopener ugc nofollow" target="_blank"> HTTP </a>请求。</p><p id="5e17" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当我第一次学习React时，我不确定是否有一种内置的方式来发出HTTP请求。没有。我们将不得不依靠第三方服务来提出我们的请求。我更喜欢axios，但也有其他选择，如Superagent或fetch。在本教程中，我们将使用axios。</p><h1 id="bb04" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">步骤1:安装axios</h1><p id="f6e5" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">我们将使用<code class="eh lf lg lh li b">npm</code>安装axios:</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="68e7" class="lr kd hu li b fv ls lt l lu lv">npm install axios -S</span></pre><p id="4cce" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦我们安装了它，我们就可以看一看<a class="ae kb" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank">文档</a>并开始编写我们的第一个HTTP请求。<strong class="je hv">旁注:</strong> Axios用承诺。如果你不熟悉承诺，你可能想多读一些关于承诺的内容，然后再回来。</p><p id="93cd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">快速提醒一下，我们的目标是从<code class="eh lf lg lh li b">/users/:username</code>端点获取用户名。</p><h1 id="9d9e" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated"><strong class="ak">第二步:编写一个获取请求</strong></h1><p id="e5d5" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">首先，让我们向组件添加状态。我们将向它添加一个用户名属性，并将其设置为一个空字符串。一旦我们添加了状态，我们的构造函数将如下所示:</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="4ae0" class="lr kd hu li b fv ls lt l lu lv"><em class="ka">constructor</em> () {<br/>  <em class="ka">super</em>(<em class="ka">)<br/>  this</em>.state = {<br/>    username: ''<br/>  }</span><span id="8eba" class="lr kd hu li b fv lw lt l lu lv">  <em class="ka">this</em>.handleClick = <em class="ka">this</em>.handleClick.bind(<em class="ka">this</em>)<br/>}</span></pre><p id="77e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，在我们的<code class="eh lf lg lh li b">handleClick</code>函数中，我们将调用Github来取回用户。</p><p id="4268" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，我们需要将axios导入到文件中，以便我们可以使用它。将这一行放在文件的顶部，在您导入<code class="eh lf lg lh li b">./App.css</code>的位置的下面。</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="6c19" class="lr kd hu li b fv ls lt l lu lv"><em class="ka">import</em> axios <em class="ka">from</em> 'axios'</span></pre><p id="6cd8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，我们可以开始在<code class="eh lf lg lh li b">handleClick</code>函数中构造我们的请求。</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="5285" class="lr kd hu li b fv ls lt l lu lv">handleClick () {<br/>  axios.get('https://api.github.com/users/maecapozzi')<br/>    .then(response <em class="ka">=&gt;</em> console.log(response))<br/>}</span></pre><p id="3872" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们稍微剖析一下我上面写的东西。我遵循axios设定的语法，向Github的<code class="eh lf lg lh li b">/users</code>端点发出get请求。该端点看起来像这样:</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="0908" class="lr kd hu li b fv ls lt l lu lv">/users/:username</span></pre><p id="f5d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">上面的<code class="eh lf lg lh li b">:username</code>，代表你喜欢的任何用户名。我把<code class="eh lf lg lh li b">:username</code>换成了<code class="eh lf lg lh li b">maecapozzi</code>，这是我的用户名。你可以用你自己的来替换它，并取回你自己的数据。</p><p id="587a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我使用<code class="eh lf lg lh li b">.then</code>告诉我的程序等待从Github返回数据，然后，我记录响应。</p><p id="411a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您复制上面的<a class="ae kb" href="https://hackernoon.com/tagged/code" rel="noopener ugc nofollow" target="_blank">代码</a>，您将看到您已经获得了一个表示控制台中所有用户数据的对象。它看起来会像这样:</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lx"><img src="../Images/ea3e447efb55f56499448a5934f95ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e2fttmE03zeBOmllDoCiEQ.png"/></div></div></figure><p id="41e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我需要以对用户有意义的方式显示这些数据。我想从请求中获取用户名。为此，我需要解析该数据，在我的状态上设置username属性，然后显示它。</p><p id="d1d0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我的<code class="eh lf lg lh li b">handleClick</code>函数将如下所示:</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="a553" class="lr kd hu li b fv ls lt l lu lv">handleClick () {<br/>  axios.get('https://api.github.com/users/maecapozzi')<br/>    .then(response <em class="ka">=&gt;</em> <em class="ka">this</em>.setState({username: response.data.name}))<br/>  }</span></pre><p id="abc4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我的<code class="eh lf lg lh li b">render</code>函数将如下所示:</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="1ee7" class="lr kd hu li b fv ls lt l lu lv">render () {<br/>  <em class="ka">return</em> (<br/>    &lt;div className='button__container'&gt;<br/>      &lt;button className='button' onClick={<em class="ka">this</em>.handleClick}&gt;<br/>        Click Me<br/>      &lt;/button&gt;<br/>      &lt;p&gt;{<em class="ka">this</em>.state.username}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="bfa4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我来介绍一下这个应用程序是如何工作的。</p><ol class=""><li id="a04d" class="ly lz hu je b jf jg jj jk jn ma jr mb jv mc jz md me mf mg dt translated">用户点击一个按钮。按钮上有一个onClick事件。</li><li id="2025" class="ly lz hu je b jf mh jj mi jn mj jr mk jv ml jz md me mf mg dt translated">onClick事件触发handleClick函数。</li><li id="e4ee" class="ly lz hu je b jf mh jj mi jn mj jr mk jv ml jz md me mf mg dt translated">handleClick函数向Github API发出请求，请求发送给它的用户名的用户数据。在本例中，它返回用户名“maecapozzi”的数据</li><li id="d8f7" class="ly lz hu je b jf mh jj mi jn mj jr mk jv ml jz md me mf mg dt translated">handleClick使用承诺等待从Github返回数据。</li><li id="c479" class="ly lz hu je b jf mh jj mi jn mj jr mk jv ml jz md me mf mg dt translated">handleClick用从Github API返回的名称更新state上的username属性。</li><li id="271f" class="ly lz hu je b jf mh jj mi jn mj jr mk jv ml jz md me mf mg dt translated"><code class="eh lf lg lh li b">&lt;p&gt; </code>标签显示<code class="eh lf lg lh li b">this.state.username</code>是什么。当按钮没有被点击时，它将返回一个空字符串，但是一旦按钮被点击并且请求被完成，它将显示用户名。</li></ol><p id="8e08" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，在你的屏幕上，一旦你点击了你的按钮，你应该有看起来像这样的东西:</p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="1dce" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在你知道了！您已经在React中发出了第一个HTTP请求！我在下面列出了整个组件的要点。你也可以在这里找到这个代码<a class="ae kb" href="https://github.com/maecapozzi/tutorial-http-requests-in-react" rel="noopener ugc nofollow" target="_blank"/>，如果你想克隆它的话。</p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="mo mn l"/></div></figure><p id="b335" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ka">如果您有任何问题或评论，请告诉我，如果本教程对您有所帮助，请鼓掌！</em></p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="mp mn l"/></div></figure></div></div>    
</body>
</html>