<html>
<head>
<title>How to make universal JavaScript applications — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何制作通用JavaScript应用程序—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-make-universal-javascript-applications-part-1-90e9032bc471?source=collection_archive---------4-----------------------#2017-06-26">https://medium.com/hackernoon/how-to-make-universal-javascript-applications-part-1-90e9032bc471?source=collection_archive---------4-----------------------#2017-06-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="4504" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">体验什么是可能的。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/e2fc012e3a019bff1111be43f538fc39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLxdGdx1Ic6oAYVGviP_EQ.jpeg"/></div></div></figure><p id="cf4f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你可能听说过“服务器端渲染”或“渐进增强”这样的术语，甚至可能对它们感到兴奋。如果你在<a class="ae kr" href="https://facebook.github.io/react/" rel="noopener ugc nofollow" target="_blank">反应</a>场景中，尤其如此。否则，我强烈推荐<a class="ae kr" href="https://strongloop.com/strongblog/node-js-react-isomorphic-javascript-why-it-matters/" rel="noopener ugc nofollow" target="_blank">看看StrongLoop </a>的这篇好文章，让你跟上进度。</p><p id="6071" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然而，如果你和我一样，在走上服务器端渲染的光辉道路后不久，你就碰了壁。事实证明，虽然<a class="ae kr" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>可以<a class="ae kr" rel="noopener" href="/@mjackson/universal-javascript-4761051b7ae9#.iddd7qgij">通用</a>，但许多JavaScript api肯定不能。</p><p id="3e7f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">让我向您展示我的意思——让我们比较一下node中的http请求和浏览器中的请求。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ks kt l"/></div><figcaption class="ku kv fg fe ff kw kx bd b be z ek">An example http request using node’s <a class="ae kr" href="https://nodejs.org/api/http.html" rel="noopener ugc nofollow" target="_blank">http module</a>.</figcaption></figure><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ks kt l"/></div><figcaption class="ku kv fg fe ff kw kx bd b be z ek">An example http request using <a class="ae kr" href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Analyzing_and_manipulating_a_responseText_property_containing_an_HTML_document" rel="noopener ugc nofollow" target="_blank">XMLHttpRequest</a>.</figcaption></figure><p id="4ff0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">诸如此类的东西很快就会在通用应用程序中堆积起来，最终会让你陷入无论如何都要重复编写代码的境地。你甚至可能想回到PHP或LanguageX+ Jquery。这在几年前可能是一个巨大的问题，但是由于社区的一些努力工作，这些api中的大部分已经被消除了。快进到今天，编写通用JavaScript变得比以往任何时候都容易。</p><p id="928c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">让我们来看看一个现代的、通用的http库— <a class="ae kr" href="https://github.com/matthew-andrews/isomorphic-fetch" rel="noopener ugc nofollow" target="_blank">同构获取</a></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ks kt l"/></div><figcaption class="ku kv fg fe ff kw kx bd b be z ek">An example http request using <a class="ae kr" href="https://github.com/matthew-andrews/isomorphic-fetch" rel="noopener ugc nofollow" target="_blank">Isomorphic Fetch</a>.</figcaption></figure><p id="ca68" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在这很美好，一旦<a class="ae kr" href="https://pouchdb.com/2015/03/05/taming-the-async-beast-with-es7.html" rel="noopener ugc nofollow" target="_blank">异步函数</a>获得更多的市场份额，它会变得更好。将其与<a class="ae kr" href="https://github.com/form-data/isomorphic-form-data" rel="noopener ugc nofollow" target="_blank">同构表单数据</a>配对，您就成功了。不过最好的部分是，由于package.json 中的<a class="ae kr" href="https://github.com/defunctzombie/package-browser-field-spec" rel="noopener ugc nofollow" target="_blank">“browser”字段和现代JavaScript捆绑器，如</a><a class="ae kr" href="http://browserify.org/" rel="noopener ugc nofollow" target="_blank"> Browserify </a>、<a class="ae kr" href="https://webpack.github.io/" rel="noopener ugc nofollow" target="_blank"> Webpack </a>和<a class="ae kr" href="https://rollupjs.org" rel="noopener ugc nofollow" target="_blank"> Rollup </a>，这两种API可以在服务器或浏览器中无缝工作。甚至那些实现大相径庭的库，比如HTTP和XHR，现在也可以通用了！</p><p id="d928" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这种技术允许库作者为不同的环境(服务器/浏览器)构建完全不同的库实现，同时保持api基本不变。在这种情况下，它允许您在服务器中再次使用您在浏览器中了解到的关于<a class="ae kr" href="https://developer.mozilla.org/en/docs/Web/API/Fetch_API" rel="noopener ugc nofollow" target="_blank"> fetch api </a>的所有内容。如今几乎任何东西都可以通用，<a class="ae kr" href="https://pouchdb.com/" rel="noopener ugc nofollow" target="_blank">甚至数据库</a>！这些库让我们更接近真正的通用JavaScript，它不再局限于共享工具，如<a class="ae kr" href="https://lodash.com" rel="noopener ugc nofollow" target="_blank"> Lodash </a>。你可以分享任何东西。</p><h1 id="e42c" class="ky kz hu bd la lb lc ld le lf lg lh li ja lj jb lk jd ll je lm jg ln jh lo lp dt translated">好吧，外面还有什么？</h1><p id="6a79" class="pw-post-body-paragraph jv jw hu jx b jy lq iv ka kb lr iy kd ke ls kg kh ki lt kk kl km lu ko kp kq hn dt translated">有很多很好的框架可以帮助你更进一步，但是<a class="ae kr" href="https://facebook.github.io/react/" rel="noopener ugc nofollow" target="_blank"> React </a>是第一个，可能你已经看过了。React的美妙之处在于，它将HTML抽象成JSX，允许你根据环境以不同的方式渲染JSX。在浏览器中，您希望更新现有的dom，而在服务器中，您只想发送一个html字符串。幸运的是，有了react，您可以用同一个api完成这两项任务。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ks kt l"/></div></figure><p id="4ac4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">看看上面的JSX。请注意，不管是在服务器上还是在浏览器中呈现，第1-10行都是一样的；这太棒了！无论您多快注意到第10行之后的混乱——构建DOM的API是共享的，但渲染肯定不是。但是情况变得更糟了…在一起破解了上面的方法之后，你会意识到下一步通常也很糟糕——路由！</p><p id="d3ca" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><a class="ae kr" href="https://hackernoon.com/tagged/isomorphic" rel="noopener ugc nofollow" target="_blank">同构</a>自React问世以来，路由实际上已经走过了漫长的道路。事实上，你只要看看<a class="ae kr" href="http://(And it doesn’t have to be difficult)" rel="noopener ugc nofollow" target="_blank">反应路由器</a>本身就够了。如果你从未看过与<a class="ae kr" href="http://(And it doesn’t have to be difficult)" rel="noopener ugc nofollow" target="_blank"> react-router </a>的同构路由，我推荐看看Claudio Savino 的这篇优秀的<a class="ae kr" rel="noopener" href="/@foxhound87/server-side-rendering-with-react-router-we-must-react-ep-04-ad03b6b9e05d">文章</a>。老实说，api相当不错。但我知道我们可以更进一步。这篇多部分文章的计划是看一看一个框架，它去掉了所有神奇的非通用API，如<code class="eh lx ly lz ma b">match</code>和<code class="eh lx ly lz ma b">RouterContext</code>，并且看一看在这个空间中有什么可能。</p><h1 id="822c" class="ky kz hu bd la lb lc ld le lf lg lh li ja lj jb lk jd ll je lm jg ln jh lo lp dt translated">就这样开始了。</h1><p id="45f8" class="pw-post-body-paragraph jv jw hu jx b jy lq iv ka kb lr iy kd ke ls kg kh ki lt kk kl km lu ko kp kq hn dt translated">这一系列文章将向您展示当今通用JavaScript的确切潜力。我们将首先深入探讨路由，我将主要关注<a class="ae kr" href="https://github.com/rill-js/rill" rel="noopener ugc nofollow" target="_blank"> Rill </a>和它的一些竞争对手。稍后我们会谈到今天正在做的更广泛的事情，包括数据库(离线应用非常酷！)，文件操作和大量的渐进增强。</p><p id="14ef" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">最终，我相信通用JavaScript就是现在，我的目标是向你们展示我们已经走了多远。为了快速了解<a class="ae kr" href="https://github.com/rill-js/rill" rel="noopener ugc nofollow" target="_blank"> Rill </a>，你可以看看<a class="ae kr" rel="noopener" href="/@pierceydylan/isomorphic-javascript-it-just-has-to-work-b9da5b0c8035">我的第一篇关于同构JavaScript的文章</a>——还有更多！</p></div><div class="ab cl mb mc hc md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hn ho hp hq hr"><p id="0191" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="mi">如果您对Rill、同构/通用JavaScript或如何以这种方式构建真正的应用程序有任何疑问，请访问</em><a class="ae kr" href="https://gitter.im/rill-js/rill" rel="noopener ugc nofollow" target="_blank"><em class="mi">gitter page</em></a><em class="mi">。</em></p><div class="jk jl jm jn fq ab cb"><figure class="mj jo mk ml mm mn mo paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mj jo mk ml mm mn mo paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mj jo mk ml mm mn mo paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mp mq mr"><p id="f922" class="jv jw mi jx b jy jz iv ka kb kc iy kd ms kf kg kh mt kj kk kl mu kn ko kp kq hn dt translated"><a class="ae kr" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kr" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kr" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae kr" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jv jw mi jx b jy jz iv ka kb kc iy kd ms kf kg kh mt kj kk kl mu kn ko kp kq hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kr" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kr" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mv"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mw kt l"/></div></figure></div></div>    
</body>
</html>