<html>
<head>
<title>A small dive into, and rejection of, Elm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个小小的潜入，和对榆树的排斥</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-small-dive-into-and-rejection-of-elm-8217fd5da235?source=collection_archive---------0-----------------------#2016-11-07">https://medium.com/hackernoon/a-small-dive-into-and-rejection-of-elm-8217fd5da235?source=collection_archive---------0-----------------------#2016-11-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="ee51" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">**我已不再使用介质。新地址是kodare.net</p><p id="c60e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我总是对前端开发的状态不满意。我对ClojureScript做了相当深入的研究，发现它最初很好，但最终在一些关键领域有所欠缺。我也在JQuery和Angular land中完成了我的工作(并尝试了几个小时试图让Ember工作，但认为这已经足够了，因为它在开始时非常讨厌)。那些显然比ClojureScript + reagent差多了。</p><p id="65fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以这让我自然而然地想到了榆树。我听说过一些很棒的东西:很棒的错误消息、不会导致运行时错误的很好的类型安全、函数式编程的优点、超快的渲染等等。我一心一意要为埃尔姆做一个强有力的例子，以取代安格尔的工作。我带着(毫无根据的)坚定信念来到这里，认为这最终是可以接受的，甚至是好的。</p><p id="4fa7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我把工作中最简单的角背页作为起点。我的想法是，我可以制作一个Elm版本，然后在代码量、可读性等方面与现有代码进行比较。该页面是一个超级简单的日志查看器，其GUI基本如下:</p><blockquote class="jq jr js"><p id="b8c1" class="ir is jt it b iu iv iw ix iy iz ja jb ju jd je jf jv jh ji jj jw jl jm jn jo hn dt translated">[搜索字段]时间范围:[3选框]页面大小:[3选框][复选框]详细程度</p><p id="fb7e" class="ir is jt it b iu iv iw ix iy iz ja jb ju jd je jf jv jh ji jj jw jl jm jn jo hn dt translated">[带标签和其他东西的结果列表]</p></blockquote><p id="b09b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">似乎很容易？事实证明，这是非常讨厌的，足以让我拒绝榆树。我就开门见山了。我喜欢Elm的地方:</p><ul class=""><li id="7360" class="jx jy hu it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf dt translated">错误信息大多非常好</li><li id="3e7f" class="jx jy hu it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf dt translated">编译器够快(这是高赞！)</li><li id="af30" class="jx jy hu it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf dt translated">榆树建筑很棒</li></ul><p id="2845" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在是交易破坏者:</p><p id="3f10" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">没有合理的或公认的方法来做选择框。你可能会问“什么？！这难道不是很基本的东西吗？”我认为你是对的。我越深入这个问题，我的结论就越坚定:榆树是:</p><ul class=""><li id="7932" class="jx jy hu it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf dt translated">不适合严肃使用</li><li id="c5ee" class="jx jy hu it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf dt translated">这种语言似乎不仅从Haskell继承了好的类型和很大程度上ok甚至好的语法，而且还继承了一种顽固的方法，即更喜欢(想象的)纯粹性而不是实用性，这导致了可能有用但实际上无法使用的核心语言特性</li></ul><p id="1c33" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们检查一下这个问题。选择框包含选项列表，这些选项</p><ul class=""><li id="32a9" class="jx jy hu it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf dt translated">是独一无二的(无论如何对于大多数用途来说)</li><li id="2d88" class="jx jy hu it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf dt translated">有一个面向用户的字符串</li><li id="fc5d" class="jx jy hu it b iu kg iy kh jc ki jg kj jk kk jo kc kd ke kf dt translated">有一些内部ID</li></ul><p id="9d46" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Elm有所谓的联合类型，它非常好地模拟了第一点:</p><pre class="kl km kn ko fq kp kq kr ks aw kt dt"><span id="33ca" class="ku kv hu kq b fv kw kx l ky kz">type TimeRange = AllTime | OneWeek | OneDay</span></pre><p id="9d8a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从中创建一个面向用户的字符串也很不错:</p><pre class="kl km kn ko fq kp kq kr ks aw kt dt"><span id="596e" class="ku kv hu kq b fv kw kx l ky kz">timeRangeDisplayName : TimeRange -&gt; String</span><span id="9952" class="ku kv hu kq b fv la kx l ky kz">timeRangeDisplayName timeRange =<br/>  case timeRange of<br/>    AllTime -&gt; “All time”<br/>    OneWeek -&gt; “One week”<br/>    OneDay -&gt; “24h”</span></pre><p id="686c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里的好处是，如果我向TimeRange定义添加一个替代项，我会得到一个编译错误，因为timeRangeDisplayName并不详尽，而且我没有默认情况。太好了！它非常冗长，并且重复了很多名称，显示名称的定义与类型定义相差甚远，但是对于100%确定已经涵盖了所有情况来说，这是一个不错的折衷。</p><p id="ffdb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在是内部id。所以我得再做一个如上的函数。是的，我甚至不能得到不同选项的数字。我不能在编译或运行时遍历它们，没有检查，什么都没有。好吧，我认为，这很糟糕，但我会使用相同的面向用户的字符串，这很好。</p><p id="180d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我必须从这里创建DOM。同样:没有办法在编译或运行时枚举选项，所以复制粘贴是:</p><pre class="kl km kn ko fq kp kq kr ks aw kt dt"><span id="9550" class="ku kv hu kq b fv kw kx l ky kz">  , select [id "id_time_range", onSelect ChangeTimeRange]<br/>    [ option [] [text "24h”] — or should I use timeRangeDisplayName here? It’s even worse!<br/>    , option [] [text "1 week"]<br/>    , option [] [text "All time"]<br/>    ]</span></pre><p id="59b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">呃。好吧，随便。很可能没事。然后当用户改变选择时，我需要更新我的模型。经过大量的谷歌搜索，我找到了这个:</p><pre class="kl km kn ko fq kp kq kr ks aw kt dt"><span id="68e3" class="ku kv hu kq b fv kw kx l ky kz">onSelect : (String -&gt; msg) -&gt; Attribute msg</span><span id="2b64" class="ku kv hu kq b fv la kx l ky kz">onSelect msg =<br/>    on “change” (Json.map msg targetValue)</span></pre><p id="d6e4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，json在这里做什么？好吧，好吧。类型签名？我不知道为什么会是这样，对我来说没有意义。然后，我得到一条带有目标值的消息。好了，酷，有进展了…现在把字符串转换回联合类型。</p><p id="59b2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以我基本上声明了上面的反函数:</p><pre class="kl km kn ko fq kp kq kr ks aw kt dt"><span id="adfc" class="ku kv hu kq b fv kw kx l ky kz">timeRangeFromString : String -&gt; TimeRange<br/>timeRangeFromString s =<br/>  case s of<br/>    “All time” -&gt; AllTime<br/>    “One week” -&gt; OneWeek<br/>    “24h” -&gt; OneDay</span></pre><p id="b9b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">显然这是一个编译错误，因为它并不详尽。所以我添加了一个永远不会使用的默认值。整个功能基本就是复制粘贴。好吧。但问题是:如果我给TimeRange添加一个选项，这个函数就会变成默认值。没有办法让一个case必须产生所有有效的_outputs_但是有一个方法可以检查你是否已经处理了所有_inputs_。所以现在除了大量的复制粘贴之外，我还有脆弱的代码。</p><p id="685a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好吧，我就写个测试吧！但是我不能列举时间范围。:(</p><p id="d61b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我询问了Elm slack，人们的“解决方案”似乎是在列表中复制union类型:</p><pre class="kl km kn ko fq kp kq kr ks aw kt dt"><span id="78b0" class="ku kv hu kq b fv kw kx l ky kz">type TimeRange = AllTime | OneWeek | OneDay<br/>ranges = [AllTime, OneWeek, OneDay]</span></pre><p id="9b28" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是我不能确保这个列表是同步的，因为我不能枚举TimeRange。</p><p id="b81a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在谷歌上搜索人们是如何处理这类事情的，发现了一个关于引入宏的激烈争论，因为人们正在编写代码生成器。在这一点上，我停下来，决定这种语言没有实用主义。</p><p id="8d5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">也许是时候再次在网上研究python了？</p></div><div class="ab cl lb lc hc ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hn ho hp hq hr"><p id="3227" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">写完上面的文字后，我看到了这篇文章:<a class="ae jp" href="http://reasonablypolymorphic.com/blog/elm-is-wrong" rel="noopener ugc nofollow" target="_blank">http://reasonablypolymorphic.com/blog/elm-is-wrong</a></p><blockquote class="jq jr js"><p id="4c26" class="ir is jt it b iu iv iw ix iy iz ja jb ju jd je jf jv jh ji jj jw jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is jt it b iu iv iw ix iy iz ja jb ju jd je jf jv jh ji jj jw jl jm jn jo hn dt translated">要了解更多信息，<a class="ae jp" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">请阅读我们的“关于”页面</a> , <a class="ae jp" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">喜欢/在脸书给我们发消息</a>，或者简单地，<a class="ae jp" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank">发推文/DM @HackerNoon。</a></p><p id="708a" class="ir is jt it b iu iv iw ix iy iz ja jb ju jd je jf jv jh ji jj jw jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>