<html>
<head>
<title>Deploying Kubernetes On-Premise with RKE and deploying OpenFaaS on it — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RKE在本地部署Kubernetes并在其上部署OpenFaaS第1部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/deploying-kubernetes-on-premise-with-rke-and-deploying-openfaas-on-it-part-1-69a35ddfa507?source=collection_archive---------4-----------------------#2017-12-10">https://medium.com/hackernoon/deploying-kubernetes-on-premise-with-rke-and-deploying-openfaas-on-it-part-1-69a35ddfa507?source=collection_archive---------4-----------------------#2017-12-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="5b89" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我是Rancher的忠实粉丝，对他们的RKE (Rancher Kubernetes引擎)将如何发展并简化我部署Kubernetes的方式感到非常兴奋。由于我在OpenFaaS(一个开源的无服务器平台)上投入了大量的时间，我希望能够轻松地将它部署在RKE的kubernetes集群之上。在这篇文章中，我想展示:</p><ul class=""><li id="d208" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">如何使用RKE部署具有2个节点(1个主节点和1个工作节点)的kubernetes集群</li><li id="32c3" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">如何在通过Helm部署的kubernetes集群上部署OpenFaaS</li></ul><p id="e0fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下图显示了组件的简单关系:</p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ke"><img src="../Images/5e1fa54efb9af90f1e7e32bf133dd328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kX4NlgPeovpOXwxd5SmcJw.png"/></div></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">rke</figcaption></figure><h1 id="3ca9" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">先决条件</h1><ul class=""><li id="ca52" class="jq jr hu it b iu ls iy lt jc lu jg lv jk lw jo jv jw jx jy dt translated">2台可以运行docker(版本。1.12到17.03) <br/>(我将使用2台docker 17.03-ce的Ubuntu 16.04主机)</li><li id="ab53" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">我的每台主机都有1个CPU内核和1GB RAM</li></ul><h1 id="a1ca" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">使用RKE部署Kubernetes集群</h1><p id="93f4" class="pw-post-body-paragraph ir is hu it b iu ls iw ix iy lt ja jb jc lx je jf jg ly ji jj jk lz jm jn jo hn dt translated">如果你还没有读过“<a class="ae jp" href="http://rancher.com/announcing-rke-lightweight-kubernetes-installer/" rel="noopener ugc nofollow" target="_blank">宣布RKE，一个轻量级的Kubernetes安装程序</a>”这本书，那就来看看吧。此外，如果您有时间，您应该观看“<a class="ae jp" href="https://www.youtube.com/watch?v=yanBgR7sOlI&amp;t=332s" rel="noopener ugc nofollow" target="_blank">使用Rancher 2.0管理Kubernetes集群—2017年11月在线会议</a>”，因为它解释了Rancher 2.0的最新功能以及关于RKE的信息。</p><figure class="kf kg kh ki fq kj"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="4830" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">下载RKE </strong></p><p id="c3af" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以从<a class="ae jp" href="https://github.com/rancher/rke/releases" rel="noopener ugc nofollow" target="_blank">这里</a>下载RKE。这是一个简单的CLI工具来部署Kubernetes。如果你用的是OSX，你会下载<code class="eh mc md me mf b">rke_darwin-amd64</code>。将其重命名为<code class="eh mc md me mf b">rke</code>，不要忘记通过<code class="eh mc md me mf b">chmod +x rke</code>给它执行权限。从这里开始，我假设您将<code class="eh mc md me mf b">rke</code>添加到了<code class="eh mc md me mf b">PATH</code>中。确认可以执行<code class="eh mc md me mf b">rke</code>。您应该会看到类似这样的内容:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="02bf" class="mk kv hu mf b fv ml mm l mn mo">NAME:<br/>   rke - Rancher Kubernetes Engine, Running kubernetes cluster in the cloud</span><span id="47a1" class="mk kv hu mf b fv mp mm l mn mo">USAGE:<br/>   rke [global options] command [command options] [arguments...]</span><span id="b27b" class="mk kv hu mf b fv mp mm l mn mo">VERSION:<br/>   v0.0.8-dev</span><span id="969d" class="mk kv hu mf b fv mp mm l mn mo">AUTHOR(S):<br/>   Rancher Labs, Inc.</span><span id="bde4" class="mk kv hu mf b fv mp mm l mn mo">COMMANDS:<br/>     up              Bring the cluster up<br/>     remove          Teardown the cluster and clean cluster nodes<br/>     version         Show cluster Kubernetes version<br/>     config, config  Setup cluster configuration<br/>     help, h         Shows a list of commands or help for one command</span><span id="c120" class="mk kv hu mf b fv mp mm l mn mo">GLOBAL OPTIONS:<br/>   --debug, -d    Debug logging<br/>   --help, -h     show help<br/>   --version, -v  print the version</span></pre><p id="fe70" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">创建RKE配置</strong></p><p id="1097" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们可以使用<code class="eh mc md me mf b">rke</code>，让我们创建一个配置，以便将Kubernetes部署到我们的主机上。执行<code class="eh mc md me mf b">rke config</code>，应该会提示你回答一些问题。下图描述了我的主机以及它们在Kubernetes中的角色。基本上，主机1将是主节点，主机2将是工作节点。</p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/806609279aca87def89aeb8793000f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*7yL9DBBJ_TVLwA65ToXK-Q.png"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Host Description</figcaption></figure><p id="081d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">考虑到这一点，我的<code class="eh mc md me mf b">rke config</code>答案如下:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="6819" class="mk kv hu mf b fv ml mm l mn mo">Cluster Level SSH Private Key Path [~/.ssh/id_rsa]:<br/>Number of Hosts [3]: 2<br/>SSH Address of host (1) [none]: 203.104.214.176<br/>SSH Private Key Path of host (203.104.214.176) [none]:<br/>SSH Private Key of host (203.104.214.176) [none]:<br/>SSH User of host (203.104.214.176) [ubuntu]: root<br/>Is host (203.104.214.176) a control host (y/n)? [y]: y<br/>Is host (203.104.214.176) a worker host (y/n)? [n]: n<br/>Is host (203.104.214.176) an Etcd host (y/n)? [n]: y<br/>Override Hostname of host (203.104.214.176) [none]:<br/>Internal IP of host (203.104.214.176) [none]:<br/>Docker socket path on host (203.104.214.176) [/var/run/docker.sock]:<br/>SSH Address of host (2) [none]: 203.104.227.60<br/>SSH Private Key Path of host (203.104.227.60) [none]:<br/>SSH Private Key of host (203.104.227.60) [none]:<br/>SSH User of host (203.104.227.60) [ubuntu]: root<br/>Is host (203.104.227.60) a control host (y/n)? [y]: n<br/>Is host (203.104.227.60) a worker host (y/n)? [n]: y<br/>Is host (203.104.227.60) an Etcd host (y/n)? [n]: n<br/>Override Hostname of host (203.104.227.60) [none]:<br/>Internal IP of host (203.104.227.60) [none]:<br/>Docker socket path on host (203.104.227.60) [/var/run/docker.sock]:<br/>Network Plugin Type [flannel]: calico<br/>Authentication Strategy [x509]:<br/>Etcd Docker Image [quay.io/coreos/etcd:latest]:<br/>Kubernetes Docker image [rancher/k8s:v1.8.3-rancher2]:<br/>Cluster domain [cluster.local]:<br/>Service Cluster IP Range [10.233.0.0/18]:<br/>Cluster Network CIDR [10.233.64.0/18]:<br/>Cluster DNS Service IP [10.233.0.3]:<br/>Infra Container image [gcr.io/google_containers/pause-amd64:3.0]:</span></pre><p id="8df2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">快速提示:我的主机只有根用户，所以我使用<code class="eh mc md me mf b">root</code>但是任何可以使用<code class="eh mc md me mf b">docker</code>的用户都可以设置。此外，我正在使用<code class="eh mc md me mf b">calico</code>进行网络连接，但是<code class="eh mc md me mf b">flannel</code>和<code class="eh mc md me mf b">canal</code>也受到支持(基于我同事的这个PR<a class="ae jp" href="https://github.com/rancher/rke/pull/81" rel="noopener ugc nofollow" target="_blank"><code class="eh mc md me mf b">weave</code>可能会在下一个版本中发布)。</a></p><p id="7273" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这会生成一个<code class="eh mc md me mf b">cluster.yml</code>文件，内容应该是这样的:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="ac94" class="mk kv hu mf b fv ml mm l mn mo">nodes:<br/>- address: 203.104.214.176<br/>  internal_address: ""<br/>  role:<br/>  - controlplane<br/>  - etcd<br/>  hostname_override: ""<br/>  user: root<br/>  docker_socket: /var/run/docker.sock<br/>  ssh_key: ""<br/>  ssh_key_path: ""<br/>- address: 203.104.227.60<br/>  internal_address: ""<br/>  role:<br/>  - worker<br/>  hostname_override: ""<br/>  user: root<br/>  docker_socket: /var/run/docker.sock<br/>  ssh_key: ""<br/>  ssh_key_path: ""<br/>services:<br/>  etcd:<br/>    image: quay.io/coreos/etcd:latest<br/>    extra_args: {}<br/>  kube-api:<br/>    image: rancher/k8s:v1.8.3-rancher2<br/>    extra_args: {}<br/>    service_cluster_ip_range: 10.233.0.0/18<br/>  kube-controller:<br/>    image: rancher/k8s:v1.8.3-rancher2<br/>    extra_args: {}<br/>    cluster_cidr: 10.233.64.0/18<br/>    service_cluster_ip_range: 10.233.0.0/18<br/>  scheduler:<br/>    image: rancher/k8s:v1.8.3-rancher2<br/>    extra_args: {}<br/>  kubelet:<br/>    image: rancher/k8s:v1.8.3-rancher2<br/>    extra_args: {}<br/>    cluster_domain: cluster.local<br/>    infra_container_image: gcr.io/google_containers/pause-amd64:3.0<br/>    cluster_dns_server: 10.233.0.3<br/>  kubeproxy:<br/>    image: rancher/k8s:v1.8.3-rancher2<br/>    extra_args: {}<br/>network:<br/>  plugin: calico<br/>  options: {}<br/>auth:<br/>  strategy: x509<br/>  options: {}<br/>addons: ""<br/>system_images: {}<br/>ssh_key_path: ~/.ssh/id_rsa</span></pre><p id="dd1e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">将码头工人安装到主机上</strong></p><p id="c292" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我将使用Docker 17.03-ce发布此帖子。Kubernetes支持的任何版本都应该可以工作(本文将部署Kubernetes 1.8.3)。安装Docker的简单方法之一是通过以下链接从Rancher Labs提供的外壳中安装:</p><div class="mr ms fm fo mt mu"><a href="http://rancher.com/docs/rancher/latest/en/hosts/" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab ej"><div class="mw ab mx cl cj my"><h2 class="bd hv fv z el mz eo ep na er et ht dt translated">牧场主</h2><div class="nb l"><h3 class="bd b fv z el mz eo ep na er et ek translated">牧场主文件</h3></div><div class="nc l"><p class="bd b gc z el mz eo ep na er et ek translated">rancher.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni ko mu"/></div></div></a></div><p id="7ec6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下命令应适用于码头工人17.03-ce:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="e17d" class="mk kv hu mf b fv ml mm l mn mo">curl <a class="ae jp" href="https://releases.rancher.com/install-docker/17.03.sh" rel="noopener ugc nofollow" target="_blank">https://releases.rancher.com/install-docker/17.03.sh</a> | sh</span></pre><p id="6302" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">确认您的码头工人版本正确:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="cde2" class="mk kv hu mf b fv ml mm l mn mo">Client:<br/> Version:      17.03.2-ce<br/> API version:  1.27<br/> Go version:   go1.7.5<br/> Git commit:   f5ec1e2<br/> Built:        Tue Jun 27 03:35:14 2017<br/> OS/Arch:      linux/amd64</span><span id="d8e8" class="mk kv hu mf b fv mp mm l mn mo">Server:<br/> Version:      17.03.2-ce<br/> API version:  1.27 (minimum version 1.12)<br/> Go version:   go1.7.5<br/> Git commit:   f5ec1e2<br/> Built:        Tue Jun 27 03:35:14 2017<br/> OS/Arch:      linux/amd64<br/> Experimental: false</span></pre><p id="1c64" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">注册授权_密钥</strong></p><p id="7c31" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请确保您可以通过<code class="eh mc md me mf b">ssh key</code>访问您的主机。假设您将使用私钥<code class="eh mc md me mf b">~/.ssh/id_rsa</code>访问主机。您可能会在<code class="eh mc md me mf b">~/.ssh/id_rsa.pub</code>拥有您的公钥，因此<code class="eh mc md me mf b">cat</code>会复制内容。在每台主机中，将内容粘贴到<code class="eh mc md me mf b">~/.ssh/authorized_keys</code>中。确认您可以通过<code class="eh mc md me mf b">ssh</code>访问您的主机。</p><p id="a994" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">关闭主机中的交换</strong></p><p id="6ec2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您正在使用自己的内部机器，很可能您的交换已经开启。Kubelet将无法激活，比如说:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="4c5e" class="mk kv hu mf b fv ml mm l mn mo">error: failed to run Kubelet: Running with swap on is not supported, please disable swap! or set --fail-swap-on flag to false. /proc/swaps contained:</span></pre><p id="0db6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">禁用交换:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="3d00" class="mk kv hu mf b fv ml mm l mn mo">sudo swapoff -a</span></pre><p id="1039" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">或者像这样用<code class="eh mc md me mf b">fail-swap-on: false</code>设定您的<code class="eh mc md me mf b">cluster.yml</code>:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="a420" class="mk kv hu mf b fv ml mm l mn mo">kubelet:<br/>  image: rancher/k8s:v1.8.3-rancher2<br/>  extra_args:<br/>    fail-swap-on: false</span></pre><p id="8a3a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">部署库本内特斯！</strong></p><p id="5962" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你们都准备好了！确认您在<code class="eh mc md me mf b">cluster.yml</code>目录下，执行<code class="eh mc md me mf b">rke up</code>。是的，就是这样！您应该看到<code class="eh mc md me mf b">rke</code>为Kubernetes部署组件以在指定的主机上工作。</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="dee3" class="mk kv hu mf b fv ml mm l mn mo">INFO[0000] Building Kubernetes cluster<br/>INFO[0000] [ssh] Setup tunnel for host [203.104.214.176]<br/>INFO[0000] [ssh] Setup tunnel for host [203.104.214.176]<br/>INFO[0001] [ssh] Setup tunnel for host [203.104.227.60]<br/>INFO[0002] [certificates] Generating kubernetes certificates<br/>INFO[0002] [certificates] Generating CA kubernetes certificates<br/>INFO[0002] [certificates] Generating Kubernetes API server certificates<br/>INFO[0002] [certificates] Generating Kube Controller certificates<br/>INFO[0002] [certificates] Generating Kube Scheduler certificates<br/>INFO[0003] [certificates] Generating Kube Proxy certificates<br/>INFO[0003] [certificates] Generating Node certificate<br/>INFO[0004] [certificates] Generating admin certificates and kubeconfig<br/>INFO[0004] [reconcile] Reconciling cluster state<br/>INFO[0004] [reconcile] This is newly generated cluster<br/>INFO[0004] [certificates] Deploying kubernetes certificates to Cluster nodes<br/>INFO[0023] Successfully Deployed local admin kubeconfig at [./.kube_config_cluster.yml]<br/>INFO[0023] [certificates] Successfully deployed kubernetes certificates to Cluster nodes<br/>INFO[0023] [etcd] Building up Etcd Plane..<br/>INFO[0023] [etcd] Pulling Image on host [203.104.214.176]<br/>INFO[0028] [etcd] Successfully pulled [etcd] image on host [203.104.214.176]<br/>INFO[0028] [etcd] Successfully started [etcd] container on host [203.104.214.176]<br/>INFO[0028] [etcd] Successfully started Etcd Plane..<br/>INFO[0028] [controlplane] Building up Controller Plane..<br/>INFO[0028] [controlplane] Pulling Image on host [203.104.214.176]<br/>INFO[0086] [controlplane] Successfully pulled [kube-api] image on host [203.104.214.176]<br/>INFO[0087] [controlplane] Successfully started [kube-api] container on host [203.104.214.176]<br/>INFO[0087] [controlplane] Pulling Image on host [203.104.214.176]<br/>INFO[0089] [controlplane] Successfully pulled [kube-controller] image on host [203.104.214.176]<br/>INFO[0089] [controlplane] Successfully started [kube-controller] container on host [203.104.214.176]<br/>INFO[0090] [controlplane] Pulling Image on host [203.104.214.176]<br/>INFO[0092] [controlplane] Successfully pulled [scheduler] image on host [203.104.214.176]<br/>INFO[0092] [controlplane] Successfully started [scheduler] container on host [203.104.214.176]<br/>INFO[0092] [controlplane] Successfully started Controller Plane..<br/>INFO[0092] [worker] Building up Worker Plane..<br/>INFO[0092] [worker] Pulling Image on host [203.104.214.176]<br/>INFO[0095] [worker] Successfully pulled [kubelet] image on host [203.104.214.176]<br/>INFO[0095] [worker] Successfully started [kubelet] container on host [203.104.214.176]<br/>INFO[0095] [worker] Pulling Image on host [203.104.214.176]<br/>INFO[0097] [worker] Successfully pulled [kube-proxy] image on host [203.104.214.176]<br/>INFO[0098] [worker] Successfully started [kube-proxy] container on host [203.104.214.176]<br/>INFO[0098] [worker] Pulling Image on host [203.104.227.60]<br/>INFO[0103] [worker] Successfully pulled [nginx-proxy] image on host [203.104.227.60]<br/>INFO[0103] [worker] Successfully started [nginx-proxy] container on host [203.104.227.60]<br/>INFO[0103] [worker] Pulling Image on host [203.104.227.60]<br/>INFO[0156] [worker] Successfully pulled [kubelet] image on host [203.104.227.60]<br/>INFO[0156] [worker] Successfully started [kubelet] container on host [203.104.227.60]<br/>INFO[0156] [worker] Pulling Image on host [203.104.227.60]<br/>INFO[0159] [worker] Successfully pulled [kube-proxy] image on host [203.104.227.60]<br/>INFO[0159] [worker] Successfully started [kube-proxy] container on host [203.104.227.60]<br/>INFO[0159] [worker] Successfully started Worker Plane..<br/>INFO[0159] [certificates] Save kubernetes certificates as secrets<br/>INFO[0177] [certificates] Successfuly saved certificates as kubernetes secret [k8s-certs]<br/>INFO[0177] [state] Saving cluster state to Kubernetes<br/>INFO[0177] [state] Successfully Saved cluster state to Kubernetes ConfigMap: cluster-state<br/>INFO[0177] [network] Setting up network plugin: calico<br/>INFO[0177] [addons] Saving addon ConfigMap to Kubernetes<br/>INFO[0177] [addons] Successfully Saved addon to Kubernetes ConfigMap: rke-network-plugin<br/>INFO[0177] [addons] Executing deploy job..<br/>INFO[0183] [addons] Setting up KubeDNS<br/>INFO[0183] [addons] Saving addon ConfigMap to Kubernetes<br/>INFO[0183] [addons] Successfully Saved addon to Kubernetes ConfigMap: rke-kubedns-addon<br/>INFO[0183] [addons] Executing deploy job..<br/>INFO[0188] [addons] KubeDNS deployed successfully..<br/>INFO[0188] [addons] Setting up user addons..<br/>INFO[0188] [addons] No user addons configured..<br/>INFO[0188] Finished building Kubernetes cluster successfully</span></pre><p id="52bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">初始部署需要多长时间将取决于您的网络连接，因为<code class="eh mc md me mf b">rke</code>需要获取docker映像，但如果没有，它将在几分钟内结束。在你看到<code class="eh mc md me mf b">Finished building Kubernetes cluster successfully</code>之后，你应该会看到一个叫做<code class="eh mc md me mf b">.kube_config_cluster.yml</code>的文件。您可以在这个配置中使用<code class="eh mc md me mf b">kubectl</code>。使用以下命令确认您的节点正在工作:</p><pre class="kf kg kh ki fq mg mf mh mi aw mj dt"><span id="4e54" class="mk kv hu mf b fv ml mm l mn mo">kubectl --kubeconfig .kube_config_cluster.yml get all --all-namespaces</span></pre><p id="e71f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您应该可以获得关于您的kubernetes集群的所有信息。</p><h1 id="dd7b" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">包裹</h1><p id="1f35" class="pw-post-body-paragraph ir is hu it b iu ls iw ix iy lt ja jb jc lx je jf jg ly ji jj jk lz jm jn jo hn dt translated">很简单，不是吗？你可以很容易地创建一个kubernetes集群，即使是在你家的环境中(我就是这么做的)。第1部分着重于创建一个kubernetes集群。在<a class="ae jp" rel="noopener" href="/@kenfdev/deploying-kubernetes-with-rke-and-deploying-openfaas-on-it-part-2-cc14004e7007">第二部分</a>中，我想在它上面部署OpenFaaS。</p></div></div>    
</body>
</html>