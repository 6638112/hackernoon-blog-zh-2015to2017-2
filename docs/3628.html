<html>
<head>
<title>YAC-Why I chose Kotlin and API 21+ a year ago</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">YAC-为什么一年前我选择了Kotlin和API 21+</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/yac-why-i-chose-kotlin-and-api-21-a-year-ago-38742dca9a9a?source=collection_archive---------13-----------------------#2017-04-12">https://medium.com/hackernoon/yac-why-i-chose-kotlin-and-api-21-a-year-ago-38742dca9a9a?source=collection_archive---------13-----------------------#2017-04-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="152c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@prashhtrivedi/yac-why-the-app-50b2daeb5400">第一部分</a></p><p id="550d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你有一个Kitkat设备并试图安装<a class="ae jp" href="https://play.google.com/store/apps/details?id=com.celites.yac" rel="noopener ugc nofollow" target="_blank"> YAC </a>。您可以看到该应用程序与设备不兼容。这是因为我已经为该应用程序设置了最低SDK为21，这意味着你只能在运行lolipop或更新版本的设备上使用该应用程序。</p><p id="8062" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这篇文章的前半部分，我将分享一些关于我为什么决定在我的应用中使用<code class="eh jq jr js jt b">MinSdk=21</code>的观点。这个应用是一个文件/目录处理应用。为了清理你的文件，YAC需要知道你的文件，以及它们在哪里。你知道吗？YAC做得很好，它甚至不需要许可，事实上，这个应用程序需要的唯一许可是互联网和引导接收，这是无害的，在安装时自动授予。扫描文件，并保持扫描，YAC无缝地工作，无需请求许可。棒棒糖或以上真的帮助了我。</p><p id="6c5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Lollipop有一个API处理文件甚至不需要请求权限<a class="ae jp" href="#b151" rel="noopener ugc nofollow"> </a> <a class="ae jp" href="#831b" rel="noopener ugc nofollow"> </a>。你可以向<code class="eh jq jr js jt b">Storage Access Framework</code>发送一个意图来读取<strong class="it hv">任何</strong>文件树，它可以在任何地方读取你的文件(甚至在SD卡中)。旧的API则不是这样。对于Kitkat，你所能拥有的只是一个文件，而不是一整棵树。对于较老的API，我们所拥有的都是hacks，它可能有效，也可能无效。至于扫描，我使用的是<code class="eh jq jr js jt b">JobScheduer</code>API。作业调度器是非常强大的API，我们可以根据网络类型、设备充电与否等运行周期性任务，甚至不会影响我们的电池。这就是为什么YAC不会出现在你的顶级电池使用中。</p><p id="6f92" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是等等…反向端口的存在是有原因的，对吗？我只需要支持我的存储和旧文件API并使用<code class="eh jq jr js jt b">GCMNetworkManager</code>或<code class="eh jq jr js jt b">FirebaseJobDispatcher</code>API？为什么要疏远20%的用户？这是我的回答，当我开始的时候，21+已经在大约50%的设备上运行了(如果我没记错的话)。这个数字——出于各种原因<a class="ae jp" href="https://www.reddit.com/r/androiddev/comments/3fv0at/beginner_dev_here_start_with_backwards/cts750w/" rel="noopener ugc nofollow" target="_blank">，我在reddit </a>上说——不会再下降了。作为一名独立开发者，在有限的资源和时间下，我必须向前看。这种API的用户水平不会降低。对于那些仍然使用Kitkat设备的用户来说，如果我努力，他们可以使用我的应用程序，但他们能够购买这个应用程序吗？如果他们有这样的购买力，为什么他们不能或者不买一部6000-8000印度卢比(90-100美元)的手机，而现在这款手机的价格是5.1或6.0。想到这一点，我决定坚持用棒棒糖作为我的最低支持水平。即使对于一些简单且经过验证的反向移植，我也不希望我的代码一团糟。</p><p id="e0a9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是为什么要乱呢？只有几个<code class="eh jq jr js jt b">if else</code>街区，对吗？为什么像我这样的开发者不应该写它？这个决定是和其他决定一起做出的，其中最大的决定是如何处理我的代码库？当我想开始的时候，对Java 6的厌恶更强烈了，我已经看到了当你想使用RxJava时代码所造成的混乱。人们已经在使用RetroLambda来摆脱它，使用lambdas，<a class="ae jp" href="https://hackernoon.com/tagged/kotlin" rel="noopener ugc nofollow" target="_blank"> kotlin </a>已经在拐角处(比lambdas更有前途)，正在加速，甚至没有进入稳定阶段。我想用一种新的语言开发一个应用程序，并想看看我能走多远。</p><p id="5e4c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">经过一年的编码，以及将近10-11个版本的发布，我只能说我对kotlin印象深刻。它已经有了从一开始就困扰我们——Android<a class="ae jp" href="https://hackernoon.com/tagged/android" rel="noopener ugc nofollow" target="_blank">开发者——的问题的答案。它的空处理、数据类、开箱即用的功能API(如map、filter……)和lambdas等都是我们所需要的。回答这些问题不仅使我们变得强大，而且高阶函数、扩展函数、惰性初始化等特性也使语言变得更加强大。</a></p><p id="2ab3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有多少次我们忘记了<code class="eh jq jr js jt b">show()</code>调用一个警告对话框并调试为什么我们的对话框不显示？有多少次我们忘记了调用<code class="eh jq jr js jt b">notify___Changed()</code>方法，并且想知道为什么屏幕上的数据没有更新？或者有多少次是我们忘记调用<code class="eh jq jr js jt b">commit</code>或<code class="eh jq jr js jt b">close</code>导致我们出现异常？正如杰克·沃顿在他的一次演讲中所说。当我们在Android中工作时，我们不得不处理这么多“仪式”的事情。从上下文开始，做x，做y，做z，如果你在做z，不要做4…一旦你完成了，调用一个finishing方法告诉SDK<em class="ju">我完成了你所要求的，现在只要用我提供的数据做你的工作</em>。这个IMO要做的事情太多，要记的东西太多，还有很多容易出错的样板文件。科特林只是帮助我们减少这种<code class="eh jq jr js jt b">ceremonial boilerplate</code>。</p><p id="37d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如何创建通知？用上下文创建一个<code class="eh jq jr js jt b">NotificationManagerCompat.Builder</code>对象。传递标题，内容文本，风格，小图标，大图标等…然后只通知一个唯一的Id。在所有这些事情中，什么更重要？是专注于创建对象并调用notify，还是专注于让通知对我们的用户更有用、更独特、更少打扰？正因为这些<code class="eh jq jr js jt b">ceremonial boilerplate</code>,我们更关注创建通知，而不是正确地创建通知。kotlin使我们能够创建正确的通知，而不仅仅是创建通知。在我的例子中，我有一个<code class="eh jq jr js jt b">notify</code>方法，它接受一个<code class="eh jq jr js jt b">context</code>和一个<code class="eh jq jr js jt b">Int</code>以及一些<code class="eh jq jr js jt b">NotificationCompat.Builder</code>方法(是的，像<code class="eh jq jr js jt b">setTitle()</code> <code class="eh jq jr js jt b">setStyle()</code>等方法)，它将基于这些方法创建一个适当的通知，并自动发送一个通知。只要我通过了<code class="eh jq jr js jt b">context</code>，一个合适的<code class="eh jq jr js jt b">Int</code>和合适的方法(这真的很重要)，我就不用担心通知是否被触发..</p><p id="8cc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你如何处理一些回调？从你的活动中，你如何倾听——并对——你的视图模型中发生的一些变化做出反应？在java中，您可能有一个接口，使您活动实现该接口，在您的viewmodel中，您有该接口的实例，并在有事发生时调用它的方法。如果您想使它成为可选的，您可能希望您的viewmodel的接口可为空，并添加一个空检查。</p><p id="c81d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">听起来太多了吧？但在科特林却不是。我不知道Java 8，但是在kotlin中，你所要做的就是将lambda作为参数，并在需要时传递它。Kotlin让我们有默认的参数，所以如果我不想传递参数，我就不必传递参数，在Kotlin中，我所做的就是定义一个默认的无操作方法<a class="ae jp" href="#033d" rel="noopener ugc nofollow"> </a>作为lambda的默认参数，无论何时我想听到变化，我都可以传递我自己的lambda，而不用太担心。</p><p id="471c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">到目前为止，我已经陈述了kotlin对我们帮助很大的好的使用案例。但是我理解<strong class="it hv">没有代码，闲聊</strong>毫无意义。但是这篇文章太长了，无法包含那么多代码。在下一篇文章<a class="ae jp" rel="noopener" href="/@prashhtrivedi/kotlin-and-ceremonial-boilerplate-some-real-examples-from-my-app-4199b5c58869">，</a>中，我会讲更多关于科特林的例子。</p><p id="da8a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">原刊<a class="ae jp" href="http://www.prashamhtrivedi.in/yac_why_kotlin" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><div class="jv jw fm fo jx jy"><a href="https://play.google.com/store/apps/details?id=com.celites.yac" rel="noopener  ugc nofollow" target="_blank"><div class="jz ab ej"><div class="ka ab kb cl cj kc"><h2 class="bd hv fv z el kd eo ep ke er et ht dt translated">YAC-Google Play上的Android应用</h2><div class="kf l"><h3 class="bd b fv z el kd eo ep ke er et ek translated">另一种(智能)清洁器</h3></div><div class="kg l"><p class="bd b gc z el kd eo ep ke er et ek translated">play.google.com</p></div></div><div class="kh l"><div class="ki l kj kk kl kh km kn jy"/></div></div></a></div><h1 id="a6ac" class="ko kp hu bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">脚注</h1><ol class=""><li id="b151" class="lm ln hu it b iu lo iy lp jc lq jg lr jk ls jo lt lu lv lw dt translated">事实上，当用户界面呈现给用户时，权限会被虚拟地询问，如果用户继续使用用户界面，应用程序得到肯定的响应，权限会被授予，我们只需要添加一些代码来保持这一点。如果用户取消它，我们没有得到许可。</li><li id="831b" class="lm ln hu it b iu lx iy ly jc lz jg ma jk mb jo lt lu lv lw dt translated">Ian Lake在2015年的大型Android BBQ上发布的这个视频确实在文件和权限方面表现得很好，请看这个视频。依我看，你不需要一个文件权限，如果你有10个文件，用上下文的文件方法，用存储访问框架。</li></ol><figure class="mc md me mf fq mg"><div class="bz el l di"><div class="mh mi l"/></div></figure><p id="033d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">3.无操作:什么都不做，空方法</p><blockquote class="mj mk ml"><p id="17df" class="ir is ju it b iu iv iw ix iy iz ja jb mm jd je jf mn jh ji jj mo jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is ju it b iu iv iw ix iy iz ja jb mm jd je jf mn jh ji jj mo jl jm jn jo hn dt translated">要了解更多信息，请阅读我们的“关于”页面、<a class="ae jp" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书</a>上给我们点赞/发消息，或者简单地发送<a class="ae jp" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is ju it b iu iv iw ix iy iz ja jb mm jd je jf mn jh ji jj mo jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mc md me mf fq mg"><div class="bz el l di"><div class="mp mi l"/></div></figure></div></div>    
</body>
</html>