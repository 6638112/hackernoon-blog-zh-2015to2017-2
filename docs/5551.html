<html>
<head>
<title>Redux unit testing with Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Jest进行冗余单元测试</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/redux-unit-testing-with-jest-f3a18f387f75?source=collection_archive---------2-----------------------#2017-08-02">https://medium.com/hackernoon/redux-unit-testing-with-jest-f3a18f387f75?source=collection_archive---------2-----------------------#2017-08-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/20974816fe30af3963436a014cebd707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EnygRiLRviLqAJuT2Qpc8A.jpeg"/></div></div></figure><p id="86f8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你正在用<a class="ae ka" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>引导你的react应用，你可能会意识到Jest现在已经被嵌入了。Jest是另一个<a class="ae ka" href="http://facebook.com" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> FB </strong> </a> <strong class="je hv"> </strong>创造，旨在简化javascript单元测试的编写。它目前正在获得牵引力，你可以在这里找到非常好的Jest教程<a class="ae ka" href="https://hackernoon.com/api-testing-with-jest-d1ab74005c0a" rel="noopener ugc nofollow" target="_blank"/>、这里的<a class="ae ka" href="https://egghead.io/lessons/javascript-test-javascript-with-jest" rel="noopener ugc nofollow" target="_blank"/>和这里的<a class="ae ka" rel="noopener" href="/react-native-training/learning-to-test-react-native-with-jest-part-1-f782c4e30101"/>。</p><p id="094f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇介绍性的教程着重于为支持Redux的React应用程序编写测试，更具体地说，是为您的<a class="ae ka" href="http://redux.js.org/docs/basics/Actions.html" rel="noopener ugc nofollow" target="_blank">动作</a>和<a class="ae ka" href="http://redux.js.org/docs/basics/Reducers.html" rel="noopener ugc nofollow" target="_blank">减少器</a>编写测试。</p></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="d8d6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">入门:</strong></p><ul class=""><li id="a517" class="ki kj hu je b jf jg jj jk jn kk jr kl jv km jz kn ko kp kq dt translated">如果你从create-react-app引导，你的项目中可能已经有Jest，如果没有，你需要添加它。在这篇文章中，我将多次引用<a class="ae ka" href="https://yarnpkg.com/lang/en/" rel="noopener ugc nofollow" target="_blank">纱线</a>，如果你用<a class="ae ka" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>来进行包管理的话，我将把它替换掉。</li></ul><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kr"><img src="../Images/e4a4a9ceae0c6a994cec32f12056d6a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zwJjMuTaBra-g8kPtiCOw.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">yarn add jest</figcaption></figure><ul class=""><li id="607e" class="ki kj hu je b jf jg jj jk jn kk jr kl jv km jz kn ko kp kq dt translated">您还没有进行任何测试，但是从这里您可以运行<em class="la">纱线测试</em>来启动手表终端，您将看到几个选项:</li></ul><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lb"><img src="../Images/aab7d8d0aa3522d03f55570a44a93169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwQuvxnaqsgmd4kWCZlJvg.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">yarn test watch options</figcaption></figure><p id="583a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Yarn有一个内置的正则表达式，它会搜索src文件夹的所有级别，它会搜索符合以下三个标准之一的文件:</p><p id="9cf9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">*文件夹中带有“. js”后缀的文件。</p><p id="e106" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">*后缀为`. test.js '的文件。</p><p id="fdfa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">*后缀为` . spec.js '的文件。</p></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="d96f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">好，让我们写一个简单的第一个测试。我们将从测试一个非常简单的动作创建器开始。如果你不熟悉动作和动作创建者的区别，读读<a class="ae ka" href="https://decembersoft.com/posts/whats-the-difference-between-action-and-action-creator-in-redux-js/" rel="noopener ugc nofollow" target="_blank">这个</a>。</p><h1 id="1a54" class="lc ld hu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">actions.js</h1><p id="6db7" class="pw-post-body-paragraph jc jd hu je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hn dt translated">下面是一个actionsJS文件，带有一个常量<em class="la"> SET_SELECTED_ACCT </em>和动作创建者:<em class="la"> setSelectedAccount()。这是我们将要测试的动作创建器。</em></p><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mf"><img src="../Images/73a78692e8d465da9322e37b03d2385a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0Z7IensRZG5lIXDaB8oAw.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">actions.js</figcaption></figure><h1 id="ea1e" class="lc ld hu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">测试. js</h1><p id="d2bd" class="pw-post-body-paragraph jc jd hu je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hn dt translated">这是我们的测试文件。我们从我们的<em class="la"> actions.js </em>文件导入所有内容，设置一个假的<em class="la">账号</em>进行测试，然后开始我们的测试。第5行和第6行描述了我们的测试(您可以在describe中放置多个<em class="la"> it </em>测试)，第8行开始我们模拟的预期响应，第12行执行我们的操作，并使用一个<em class="la"> toEqual </em> <a class="ae ka" href="https://facebook.github.io/jest/docs/en/using-matchers.html#content" rel="noopener ugc nofollow" target="_blank"> matcher </a>来比较接收到的响应和预期的响应。</p><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mg"><img src="../Images/f30747c61f23ad7847dfa6f0c7bd47c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CFs2IQJvUa5SGfbpmzyCQ.png"/></div></div></figure><p id="8224" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果成功，您的终端将输出如下内容，如果出错，终端中将显示失败的上下文。</p><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mh"><img src="../Images/25f11ce62d24b1c7a22d58e203563465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KpWfqm-qI26Ed2O5ZNP7rw.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">watch options results</figcaption></figure></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="de50" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在让我们测试一个减速器。Reducers可能很复杂，但是为它们编写测试相当简单，因为它们只是JS函数。</p><h1 id="55b8" class="lc ld hu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">reducers.js</h1><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mi"><img src="../Images/804f05bd30b92fa4768b3e3990ecdd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsdtthsuU8O5_7GQgcQcKA.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">reducers.js</figcaption></figure><p id="6e4f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个简单的reducer文件，只有一个reducer:<em class="la">selected account</em>。注意，我们从out <em class="la"> actions.js </em>文件中引用了相同的const<em class="la">SET _ SELECTED _ ACCOUNT</em>。</p><h1 id="027a" class="lc ld hu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">测试. js</h1><p id="2263" class="pw-post-body-paragraph jc jd hu je b jf ma jh ji jj mb jl jm jn mc jp jq jr md jt ju jv me jx jy jz hn dt translated">这个描述函数包含两个测试，第6行和第9行。第6行测试<em class="la"> selectedAccount: null的初始状态。</em>第9行执行一个<em class="la">未定义</em>状态(第12行)的减速器和一个具有两个属性的动作:<em class="la">选择账户</em>和<em class="la">类型。这与我们之前测试的动作相同。第18行确保reducer返回accountNumber。</em></p><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mj"><img src="../Images/b5540f8118a97f6625d1477bc7279757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvUxbvLuT0ObrcwC-9KLSg.png"/></div></div></figure></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><p id="ff2d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这就是关于使用Jest测试Redux动作和Reducers的介绍。我们将Jest添加到我们的项目中，在我们的<em class="la"> test.js </em>文件中为Action creator和Reducer创建了测试，并查看了一些用于导航Jest测试的终端输入和输出。</p></div><div class="ab cl kb kc hc kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hn ho hp hq hr"><h1 id="e2b1" class="lc ld hu bd le lf mk lh li lj ml ll lm ln mm lp lq lr mn lt lu lv mo lx ly lz dt translated">当前正在收听:</h1><figure class="ks kt ku kv fq iv"><div class="bz el l di"><div class="mp mq l"/></div></figure><h1 id="14d2" class="lc ld hu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">其他资源:</h1><ul class=""><li id="6188" class="ki kj hu je b jf ma jj mb jn mr jr ms jv mt jz kn ko kp kq dt translated"><a class="ae ka" href="https://facebook.github.io/jest/" rel="noopener ugc nofollow" target="_blank"> Jest文档</a></li><li id="bb9e" class="ki kj hu je b jf mu jj mv jn mw jr mx jv my jz kn ko kp kq dt translated"><a class="ae ka" href="http://redux.js.org/docs/recipes/WritingTests.html" rel="noopener ugc nofollow" target="_blank">使用Redux和Jest进行测试</a></li></ul><p id="7519" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在推特上让我知道你的想法。坚持下去。</p><figure class="ks kt ku kv fq iv"><div class="bz el l di"><div class="mz mq l"/></div></figure><h1 id="48bc" class="lc ld hu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated"><strong class="ak">如果你喜欢这篇文章，请推荐，帮助别人找到！</strong></h1><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div class="fe ff na"><img src="../Images/6ca8d8237c62634322efbca85a00bee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*dfdhH31znY8Jb8xdNgTAYg.gif"/></div></figure></div></div>    
</body>
</html>