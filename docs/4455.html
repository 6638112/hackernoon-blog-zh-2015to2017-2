<html>
<head>
<title>Build a Location-based Chatroom with Firebase and Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Firebase和Vue.js建立一个基于位置的聊天室</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-a-location-based-chatroom-with-firebase-and-vue-js-part-1-27e7f777d1ac?source=collection_archive---------1-----------------------#2017-06-03">https://medium.com/hackernoon/build-a-location-based-chatroom-with-firebase-and-vue-js-part-1-27e7f777d1ac?source=collection_archive---------1-----------------------#2017-06-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/ec74bc328ece04189a797c9a88f9ab11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQHbncfOx5oKvpHtlEqe7g.jpeg"/></div></div></figure><h1 id="a8af" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated"><strong class="ak">简介</strong></h1><p id="eec4" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">最近，我和我的朋友在<strong class="kc hv">(</strong><a class="ae ky" href="https://near.idgo.me." rel="noopener ugc nofollow" target="_blank"><strong class="kc hv">https://Near . idgo . me)</strong>附近建立了一个基于位置的聊天室，名为— </a><a class="ae ky" href="https://near.idgo.me" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hv">。</strong></a>人们可以通过网络应用在附近相互交谈。我们愿意分享我们做了什么，以及如何做到这一点。请随时回复这篇文章给我们反馈。</p><h1 id="ef25" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">先决条件</h1><ol class=""><li id="2ed4" class="kz la hu kc b kd ke kh ki kl lb kp lc kt ld kx le lf lg lh dt translated">Geohash的基础知识</li><li id="408b" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">火碱的基本知识</li><li id="eca8" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">Vue.js组件的基础知识</li></ol><h1 id="cc28" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">我们想要实现什么？</h1><p id="60b7" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">在本教程中，我们会尽量使<strong class="kc hv">简单</strong>，这样你可以很快看到效果。所以，今天我们将介绍以下步骤。</p><ol class=""><li id="c559" class="kz la hu kc b kd ln kh lo kl lp kp lq kt lr kx le lf lg lh dt translated">通过地理定位API获取用户的位置，并将纬度和经度转换为geohash</li><li id="2c2b" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">向房间发送消息</li><li id="5322" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">显示消息</li></ol><h1 id="0487" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">什么是Geohash？</h1><p id="0c10" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">在谈论如何做到这一点之前，我们想简单介绍一下什么是geohash。Geohash 是一个地理编码系统，它将在本教程中用来定义一个聊天室。</p><p id="3810" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">比如<strong class="kc hv"> wecnvgm2re3u </strong>代表香港尖沙咀(经纬度= 22.29818732，114.16646970)。每个geohash字符代表世界上的一个区域，更多的字符意味着对一个地方更具体。你可以使用这个<a class="ae ky" href="http://geohash.co/" rel="noopener ugc nofollow" target="_blank">工具</a>来了解它是如何工作的。</p><p id="684c" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">在该应用中，geohash是基于用户位置定义房间ID并使用geohash精度(geohash的长度)定义区域覆盖的理想机制。</p></div><div class="ab cl lv lw hc lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hn ho hp hq hr"><h1 id="4dcb" class="jc jd hu bd je jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz dt translated">创建一个Vue项目</h1><p id="fb6f" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">在本文中，我们使用<a class="ae ky" href="https://github.com/vuejs/vue-cli" rel="noopener ugc nofollow" target="_blank"> vue-cli </a>来生成一个Vue seed项目。</p><p id="8217" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">安装<strong class="kc hv"> vue-cli </strong></p><p id="01f7" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">可能需要Root权限</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="7199" class="mq jd hu mm b fv mr ms l mt mu">npm install -g vue-cli</span></pre><p id="d1f7" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">通过<strong class="kc hv"> vue-cli </strong>初始化一个vue项目</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="b9ee" class="mq jd hu mm b fv mr ms l mt mu">vue init webpack-simple my-project</span></pre><p id="0007" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">在本教程中，我们使用<strong class="kc hv"> webpack-simple </strong>模板作为演示。有关vue-cli的更多详细信息，请参见此处的<a class="ae ky" href="https://github.com/vuejs/vue-cli" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="6396" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">通过以下命令安装依赖项并运行项目</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="e2cb" class="mq jd hu mm b fv mr ms l mt mu">cd my-project<br/>npm install<br/>npm run dev</span></pre><p id="4b87" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">现在，您可以在<strong class="kc hv"> localhost:8080 </strong>上访问您的项目</p><p id="a0cb" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">在我们创建了一个Vue项目并安装了依赖项之后，我们就可以开始处理Vue组件了(<strong class="kc hv"><em class="mv">my-project/src/app . Vue</em></strong>)。如果不熟悉Vue单文件组件，可以看一下<a class="ae ky" href="https://vuejs.org/v2/guide/single-file-components.html" rel="noopener ugc nofollow" target="_blank">官网</a>。</p><p id="7ca3" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">接下来，尝试修改您的脚本，使其成为以下结构。在组件内部，添加一些数据变量来存储聊天室信息。</p><p id="1342" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated"><strong class="kc hv">房间</strong> —代表房间的Firebase参考对象</p><p id="e080" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated"><strong class="kc hv">精度</strong>-geo hash的精度(在本教程中默认为6)</p><p id="a03a" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated"><strong class="kc hv"> db </strong> —用于与Firebase通信的Firebase SDK</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><p id="6f7f" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated"><strong class="kc hv">安装Firebase和Geohash编码器</strong></p><p id="0e59" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">除了Vue.js，我们还需要<a class="ae ky" href="https://www.npmjs.com/package/firebase" rel="noopener ugc nofollow" target="_blank"> Firebase SDK </a>与Firebase通信，并使用<a class="ae ky" href="https://github.com/chrisveness/latlon-geohash" rel="noopener ugc nofollow" target="_blank"> geohash converter </a>包将经纬度编码为geohash(房间ID)。您可以通过以下命令安装这两个包。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="55f4" class="mq jd hu mm b fv mr ms l mt mu">npm install --save firebase <!-- -->latlon-geohash</span></pre><p id="0585" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">安装完这两个包后，可以在<strong class="kc hv"> App.vue </strong>中的script标签内导入。对于<strong class="kc hv"> Geohash </strong>包，我们稍后会解释。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="6b4d" class="mq jd hu mm b fv mr ms l mt mu">import * as Firebase from 'firebase'<br/>import Geohash from 'latlon-geohash'</span><span id="f7f8" class="mq jd hu mm b fv my ms l mt mu">export default{</span><span id="96f0" class="mq jd hu mm b fv my ms l mt mu">// ....<br/>}</span></pre><p id="66d6" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated"><strong class="kc hv">当组件准备好时初始化Firebase</strong></p><p id="7f03" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">当Vue组件准备就绪时，<a class="ae ky" href="https://vuejs.org/v2/api/#mounted" rel="noopener ugc nofollow" target="_blank">安装钩</a>将被调用。因此，我们可以初始化一个Firebase客户端对象，并将其分配给一个名为— <strong class="kc hv"> db的变量。</strong>记得把你的Firebase凭证比如<strong class="kc hv"> apiKey、</strong> <strong class="kc hv"> authDomain </strong>、<strong class="kc hv"> databaseURL </strong>和<strong class="kc hv"> projectId </strong>作为参数。我们假设您知道如何设置Firebase项目并获得证书。如果你不知道如何设置，请访问<a class="ae ky" href="https://firebase.google.com/docs/web/setup" rel="noopener ugc nofollow" target="_blank"> Firebase入门指南</a>。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><h1 id="0658" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">依赖关系准备好了。是时候建设了。</h1><h2 id="2e2e" class="mq jd hu bd je mz na nb ji nc nd ne jm kl nf ng jq kp nh ni ju kt nj nk jy nl dt translated">1.获取用户的位置，并将纬度和经度转换为geohash</h2><p id="d6cb" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">在这一步，我们将创建一个名为— <strong class="kc hv"> init() </strong>的方法，通过<a class="ae ky" href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation" rel="noopener ugc nofollow" target="_blank">地理定位API </a>访问用户的位置，并将其转换为geohash，以便我们可以定义他们应该去哪个房间。</p><p id="4662" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">获得地理位置后，我们使用之前导入的Geohash编码器将位置转换为geohash。</p><p id="bce1" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">例如:</p><p id="850b" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">地点:<strong class="kc hv"> 22.29818732，114.16646970</strong>=&gt;<strong class="kc hv">wecnvg(geo hash)</strong></p><p id="576d" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">由于我们设置默认精度为6，编码器只返回6个字符。当我们获得geohash时，我们用房间ID (geohash)初始化一个Firebase引用，并将该引用分配给<strong class="kc hv">房间</strong>变量，该变量可以在以后重用。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><p id="ddd8" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">好的。<strong class="kc hv"> init </strong>方法已经完成，但是我们仍然需要在组件准备好的时候调用它。所以，调用<strong class="kc hv">挂载钩子</strong>内部的<strong class="kc hv"> init </strong>方法。比如下面的代码。然后，当组件准备好时，组件将尝试访问用户的位置。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><h2 id="b4b3" class="mq jd hu bd je mz na nb ji nc nd ne jm kl nf ng jq kp nh ni ju kt nj nk jy nl dt translated">2.创建一个输入元素来发送消息</h2><p id="8b5f" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">在组件(App.vue)的<em class="mv">模板</em>标签内创建一个input元素。我们使用v-model <strong class="kc hv"> messageInput </strong>来存储消息，并使用<em class="mv"> trim </em>来删除输入的前导空格。当用户在输入元素中按回车键时。将调用方法<strong class="kc hv"> send(messageInput) </strong>。记得在数据部分创建一个<strong class="kc hv"> messageInput </strong>键。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><p id="237a" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">现在，我们将实现<strong class="kc hv"> send(messageInput) </strong>方法来处理来自Input元素的事件。在这个方法中，我们简单地创建一个临时对象，用一个名为— <strong class="kc hv"> message </strong>的键来存储消息体。之后，调用<strong class="kc hv"> push() </strong>来获得一个键，然后在那个键上设置值。</p><p id="f99d" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">发送消息时，记得清除<strong class="kc hv"> messageInput </strong>值。否则，你的输入总是在那里。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><p id="fe77" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">当你按下回车键时，你的浏览器控制台可能会出现一个错误。下图来自Chrome控制台。</p><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nm"><img src="../Images/669d2c3f3453e661bccf1b8c65ed8cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s9dAnSRkwm2autFT3hcq2g.png"/></div></div></figure><p id="8a49" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">别担心。因为Firebase默认情况下只允许授权用户访问，所以您需要为此启用权限。</p><p id="59ef" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">按照以下步骤启用权限:</p><ol class=""><li id="a800" class="kz la hu kc b kd ln kh lo kl lp kp lq kt lr kx le lf lg lh dt translated">转到Firebase控制台</li><li id="f261" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">选择您的项目</li><li id="dbe9" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">选择数据库部分</li></ol><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nn"><img src="../Images/bf68b78f3068540aca604603d0d8ccda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qMjAf_3qiOO46y91Pp31Qg.png"/></div></div></figure><p id="3675" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">你可以在<strong class="kc hv">规则</strong>部分看到JSON并看到默认设置。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="8922" class="mq jd hu mm b fv mr ms l mt mu">{<br/>  "rules": {<br/>    ".read": "auth != null",<br/>    ".write": "auth != null"<br/>  }<br/>}</span></pre><p id="f5f1" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">我们想快速看到效果。我们通过以下设置使任何人都可以访问Firebase。<strong class="kc hv"> <em class="mv">(此方法仅供演示。不要在生产中做)。</em> </strong></p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="3074" class="mq jd hu mm b fv mr ms l mt mu">{<br/>  "rules": {<br/>    ".read": true,<br/>    ".write": true<br/>  }<br/>}</span></pre><p id="145f" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">发布规则后，您可以尝试再次发送消息。再也没有错误了。如果您可以访问Firebase控制台，您可以看到输入的数据(如下图所示)。</p><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff no"><img src="../Images/4ce0ab2ae045b59bd167c2fd2774bba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BeUB_KQ9j271GcEofmA8wQ.png"/></div></div></figure><p id="bff4" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated"><strong class="kc hv"> <em class="mv">注意</em> : </strong>由于地理定位是一个异步过程(在步骤1中)，地理定位不能立即获得。因此，最好添加一个标志来指示地理定位就绪。否则，当您发送消息时，将会因为房间ID (Geohash)未准备好而引发错误。</p><h2 id="7b69" class="mq jd hu bd je mz na nb ji nc nd ne jm kl nf ng jq kp nh ni ju kt nj nk jy nl dt translated">3.显示消息</h2><p id="06fd" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">我们已经知道如何向Firebase发送消息。现在，我们将创建一个监听器来监听来自Firebase的事件，并在消息到来时显示消息。</p><p id="2eff" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">下面的代码显示了如何创建一个事件监听器，并在选择房间后激活事件监听器。当一个新消息添加到Firebase中时，一个事件<strong class="kc hv"> child_added </strong>将被触发，并使用快照数据运行回调方法。如果你不知道Firebase如何工作，很好地阅读教程<a class="ae ky" href="https://firebase.google.com/docs/reference/js/firebase.database.Reference#on" rel="noopener ugc nofollow" target="_blank">这里</a>。在回调方法内部，数据的快照将被推入<strong class="kc hv">消息</strong>变量。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><p id="728b" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">接下来，当<strong class="kc hv">消息</strong>变量改变时，我们需要以HTML级别呈现数据。将下面的代码添加到模板标记内。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="688e" class="mq jd hu mm b fv mr ms l mt mu">&lt;div v-for="msg in messages"&gt;{{msg.message}}&lt;/div&gt;</span></pre><p id="139e" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">因为步骤2中Firebase中消息的基本数据结构如下:</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="4894" class="mq jd hu mm b fv mr ms l mt mu">{<br/>  "message":"my message"<br/>}</span></pre><p id="68c0" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">因此，在HTML级别，我们可以访问<strong class="kc hv"> msg.message </strong>来显示数据。当您发送消息时，将会显示一条新消息。</p><h1 id="df9c" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated"><strong class="ak">结合在一起</strong></h1><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mw mx l"/></div></figure><h2 id="7a19" class="mq jd hu bd je mz na nb ji nc nd ne jm kl nf ng jq kp nh ni ju kt nj nk jy nl dt translated">最终视图</h2><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff np"><img src="../Images/f2ce9718e78d4e2b886340c96d8b4bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yp9v_TKrl2Jfk1YZdZItCw.png"/></div></div></figure><h1 id="3e7f" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">结论</h1><p id="1b45" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">最后，本教程中有一些要点:</p><ol class=""><li id="f9e9" class="kz la hu kc b kd ln kh lo kl lp kp lq kt lr kx le lf lg lh dt translated">请确保您有权限访问Firebase</li><li id="5240" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">由于获取地理位置是一个异步过程，所以在向Firebase发送消息之前，请确保您已经获取了地理位置。</li><li id="65c0" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">在每个部分创建适当的变量</li><li id="a6fe" class="kz la hu kc b kd li kh lj kl lk kp ll kt lm kx le lf lg lh dt translated">激活事件监听器以监听新消息</li></ol><p id="c13c" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">有一个已经完成的应用—<a class="ae ky" href="https://near.idgo.me" rel="noopener ugc nofollow" target="_blank"><strong class="kc hv">https://near . idgo . me</strong></a></p><p id="c933" class="pw-post-body-paragraph ka kb hu kc b kd ln kf kg kh lo kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx hn dt translated">请随时给我们反馈。不管是好是坏。此外，我们将准备第二部分，使聊天室更有趣。</p><div class="mh mi mj mk fq ab cb"><figure class="nq iv nr ns nt nu nv paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nq iv nr ns nt nu nv paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nq iv nr ns nt nu nv paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nw nx ny"><p id="f922" class="ka kb mv kc b kd ln kf kg kh lo kj kk nz ls kn ko oa lt kr ks ob lu kv kw kx hn dt translated">黑客中午是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae ky" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ky" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ka kb mv kc b kd ln kf kg kh lo kj kk nz ls kn ko oa lt kr ks ob lu kv kw kx hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ky" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ky" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff oc"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>