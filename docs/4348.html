<html>
<head>
<title>How to graft React on to legacy code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何移植遗留代码</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-graft-react-on-to-legacy-code-3ad86e55e2f1?source=collection_archive---------9-----------------------#2017-05-26">https://medium.com/hackernoon/how-to-graft-react-on-to-legacy-code-3ad86e55e2f1?source=collection_archive---------9-----------------------#2017-05-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/d75b3d932f8700b4c87f6861654bc81b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQ4Nt84vQXw4pXG5xq9Lug.jpeg"/></div></div></figure><div class=""/><p id="0b48" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有很多活的项目是使用旧的web技术栈构建的。从头开始通常是不可能的，升级代码库可能是一项艰巨的任务，尤其是在没有单元测试或合适的构建工具的情况下。本文讨论并演示了一个简单的工作演示，通过使用Redux和<a class="ae ka" rel="noopener" href="/@DjamelH/ducks-redux-reducer-bundles-44267f080d22"> Ducks++ </a>模式，将Backbone/jQuery应用程序与<a class="ae ka" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"> React </a>集成。如果你没有听说过Ducks，它基本上是一个简单的设计模式，用于模块化你的Redux代码。</p><h1 id="bdc8" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">该应用程序</h1><p id="1cf1" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在<a class="ae ka" href="https://codepen.io/dhassaine/pen/ybwqQZ?editors=1011" rel="noopener ugc nofollow" target="_blank"> CodePen </a>可以找到一个现场工作演示，整个项目也可以在<a class="ae ka" href="https://github.com/dhassaine/legacy2react" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。app演示了两个开关:一个是用Backbone/jQuery实现的，一个是用React实现的；然而，两者都是通过主干模型和Redux存储同步的。React代码被打包并放入到传统的应用程序中——实际上，它是一个可以立即调用的函数表达式，行为就像一个库。</p><h1 id="71ce" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">反应模块</h1><p id="1b41" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">遗留应用程序仍然处于主导地位，负责构建和安装React代码:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="3853" class="ln kc if lj b fv lo lp l lq lr">var reactToggleApp = window.reactModule.make(<br/>  { <br/>    el: document.getElementById('react-module') <br/>  }<br/>);</span><span id="d37f" class="ln kc if lj b fv ls lp l lq lr">reactToggleApp.render();</span></pre><p id="0ef6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">React代码可通过一个工厂函数获得，该函数是全局可用的。这允许我们传入必要的回调和选项，例如错误处理机制或翻译功能。React模块还需要一个DOM元素来挂载。运行工厂函数后，将返回一个具有以下接口的对象:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="6a51" class="ln kc if lj b fv lo lp l lq lr">{<br/>  render,<br/>  destroy,<br/>  store,<br/>  ducks<br/>}</span></pre><p id="5f86" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">渲染和销毁允许父应用程序启动和删除react应用程序。Redux存储和ducks模块是实现两个世界同步的关键。</p><h1 id="f65e" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这座桥</h1><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lt"><img src="../Images/08e0b3294d7bdcbe82edbd846c63a75e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMtNtLHsW9a9-VYCvM036A.jpeg"/></div></div></figure><p id="26fb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">工厂函数公开了Redux存储，这允许我们订阅存储中的任何更改，并将这些更改传播到主干模型。类似地，对主干模型的更改可以通过分派适当的动作传播到Redux存储。实现这一点的诀窍是遵循Ducks++模式，该模式将动作和选择器捆绑在一起。注意在下面的代码中，我们使用<code class="eh lu lv lw lj b">actionCreators</code>和<code class="eh lu lv lw lj b">selectors</code>将主干模型的属性<code class="eh lu lv lw lj b">on</code>同步到<code class="eh lu lv lw lj b">keyValues</code>鸭子的属性<code class="eh lu lv lw lj b">toggle </code>。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="33e7" class="ln kc if lj b fv lo lp l lq lr">model.on('change:on', function (model, value) {<br/>  window.reactModule.store.dispatch(<br/>    window.reactModule.ducks.keyValues.actionCreators.setValue(<br/>      'toggle', value<br/>  ));<br/>});</span><span id="a8f8" class="ln kc if lj b fv ls lp l lq lr">window.reactModule.store.subscribe(function() {<br/>  var state = window.reactModule.store.getState();<br/>  var value = window.reactModule.ducks.keyValues.selectors.getValue(<br/>    state, 'toggle');</span><span id="9200" class="ln kc if lj b fv ls lp l lq lr">  model.set('on', value);<br/>});</span></pre><p id="14b2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们现在有能力用react模块替换遗留组件，并最终替换所有遗留代码。</p><h1 id="dca7" class="kb kc if bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="26e3" class="pw-post-body-paragraph jc jd if je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">考虑到我们正在将一个全新的代码库合并到一个遗留系统中，这种方法出人意料地直接。我们甚至可以在一个单独的存储库中实现React代码，并像对待一个绿地项目一样对待它——面对现实吧，谁不想在绿地上工作呢！？</p></div><div class="ab cl lx ly hc lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hn ho hp hq hr"><p id="c7fc" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请记住，如果您想尝试本文中的代码，请随意克隆/派生我的<a class="ae ka" href="https://github.com/dhassaine/legacy2react" rel="noopener ugc nofollow" target="_blank"> repo </a>。</p></div><div class="ab cl lx ly hc lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hn ho hp hq hr"><p id="246b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="me">如果你觉得这篇文章有用/鼓舞人心</em> <strong class="je ig"> <em class="me">点击</em> </strong>💚这样其他人也可以享受。</p><p id="62fe" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">感谢您的宝贵时间！关注我的<a class="ae ka" href="https://twitter.com/DjamelH" rel="noopener ugc nofollow" target="_blank"><em class="me">Twitter</em></a><em class="me">和</em><a class="ae ka" href="https://www.linkedin.com/in/dhassaine/" rel="noopener ugc nofollow" target="_blank"><em class="me">LinkedIn</em></a><em class="me">。</em></p><div class="le lf lg lh fq ab cb"><figure class="mf hw mg mh mi mj mk paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mf hw mg mh mi mj mk paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mf hw mg mh mi mj mk paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ml mm mn"><p id="f922" class="jc jd me je b jf jg jh ji jj jk jl jm mo jo jp jq mp js jt ju mq jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿美族家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd me je b jf jg jh ji jj jk jl jm mo jo jp jq mp js jt ju mq jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="le lf lg lh fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mr"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="le lf lg lh fq hw"><div class="bz el l di"><div class="ms mt l"/></div></figure></div></div>    
</body>
</html>