# 文件系统的任务

> 原文：<https://medium.com/hackernoon/the-job-of-the-filesystem-a64ad1ecfcf6>

*它应该做得更多，这样你就可以做得更少*

[苹果](https://hackernoon.com/tagged/apple)刚刚发布了 iOS 10.3，首次将他们的生产平台之一 [APFS](https://en.wikipedia.org/wiki/Apple_File_System) 放在了他们的新文件系统上。我很高兴他们终于取代了如此老化、过时的核心技术，但我远没有约翰·西拉库萨(John Siracusa)那么兴奋。APFS 所做的似乎只是最终满足现代操作系统的基本需求，甚至不是所有的需求。这与我在文件系统中最关心的事情相去甚远，我最关心的事情是拥有元数据，这样应用程序就不会拥有元数据。

任何关注联邦监控讨论的人都知道，元数据对我们的生活已经变得至少和我们的数据一样重要。不仅仅是电话，而是你打给了谁，什么时候，打了多长时间。不仅仅是手机，还有哪些是你的最爱，以及它们之间的关系。这些元数据对我们个人和国家安全局一样重要，因为它为我们创造和依赖的大量信息带来了简单性、有用性和最重要的可访问性。

我对 APFS 感到失望的原因是，它错过了将元数据提升到与数据同样重要的地位的机会，结果，我基本上对计算机会尽可能有用和开放失去了希望。

几个月来，我一直试图从苹果的照片转换到 Adobe 的 Lightroom 进行照片管理，这样做的最大障碍是元数据。获取所有照片很容易，只需将 Masters 文件夹拖到 Lightroom 中。哦，你把你的照片整理成相册了？是啊，都过去了。你有成千上万张被归类为收藏的照片，所以你可以很容易地找到最好的？哎呀，我们忽略了这一点。

谷歌照片也有同样的问题。我无法想象任何关心照片的人会迁移到它上面，因为根本没有办法保存任何元数据。你可以保留照片，但不能保留你是如何组织它们的，你唯一的选择是依靠他们认为对你重要的东西。

你能想象更换电子邮件提供商却丢失了所有关于邮件发件人或发送时间的信息吗？这和这里发生的事情一样愚蠢。

另一方面，如果我的文件系统拥有这些元数据，就不需要转换。任何应用程序都可以直接读写，或者我可以使用任何我想使用的脚本语言。事实上，我可以很容易地在不同用途的应用程序之间来回切换，因为他们无法将我锁定在他们的专有数据库中。

这种转变很难理解，因为我们习惯于认为应用程序和它们的元数据以某种方式交织在一起。对于编程界的人来说，有一个简单的类比可以帮助解释现代文件系统的可怕之处:

在软件历史的大部分时间里，应用程序都是直接访问数据库的。他们需要理解表和行的结构，并且他们必须编写和管理自己的查询来与数据交互。由于复制这种能力的复杂性，应用程序倾向于完全拥有自己的数据，其他应用程序无法访问。

相反，我们最近看到一种趋势，即在数据库之上构建非常简单的数据服务，这样就没有应用程序可以直接访问它们。这个数据服务提供了一个 API，它理解所有数据是如何工作的，并且还提供了可以对数据执行的所有关键操作。这样，任何应用程序都可以读写数据，而不用担心它对数据的使用会与另一个用户不兼容。你得到的额外好处是，数据服务的任何优化都有助于每一个消费者，而不仅仅是你记得要更改的一两个应用程序。

正是这些数据服务使得现代应用程序能够扩展到目前的水平。应用程序开发人员可以专注于他们的数据目标，依靠数据服务来提供一致性、可移植操作和其他一切。

然而，在操作系统领域，我们就没有这样的运气了。每个与文件系统对话的人都会得到可以想象的最薄的界面:给我一个 blob 数据。是的，有基本的元数据(谁拥有它，什么时候创建的，等等。)，但是没有一个是或者可以是应用程序定制的，这使得它毫无用处。你能想象如果我们不得不把一封邮件的主题和一张照片的主题塞进同一个关键词里会有多不愉快吗？

结果，每个人都将文件系统信任的 blob 转换成数据库，在那里存放所有元数据。有些人甚至把数据放在那里，即使这意味着巨大的数据库文件和完全不可移植的系统。真正优秀的应用程序开发人员会努力在这个数据库之上构建一个完整的读写 API，让您可以管理和移植数据库中的所有内容。不过，这已经足够让大多数人跳过它了。

如果我没有使用 BeOS，我永远不会在文件系统中看到这个错过的机会。我去了里德学院，史蒂夫·乔布斯曾在那里短暂就读(我犯了一个不幸的错误，毕业了，不像他)。这意味着我在整个学校期间都是 Mac 用户，那是 Quadras 和 MacOS 8 和 9 的糟糕日子。*战栗*我转用 BeOS 是因为，嗯，我可以，这也是我真正成为 OS 迷的原因。它有许多令人惊叹的东西(其中许多现在在 OS X)，但我最喜欢的是操作系统对元数据承担了多少责任。应用程序变得更小、更简单，并且在许多情况下，你意识到你的整个应用程序概念是一种组织元数据的方式，这意味着你可以完全依赖于操作系统，并且不需要写任何代码。

最具讽刺意味的是，Be 令人敬畏的文件系统的作者 [Dominic Giampaolo](https://en.wikipedia.org/wiki/Dominic_Giampaolo) ，现在是 APFS 的首席工程师。通过他和 Be 团队其他成员的工作，我对我的元数据的价值有了清晰的认识，尤其是操作系统将它放在中心位置的好处。

因此，虽然我很高兴我的手机不再运行最古老、最垃圾的文件系统，我也期待着有一天我的电脑也不再运行这种系统，但我并不兴奋。在它发布之前，我总是可以梦想苹果看到和我一样的未来。

现在新的文件系统已经在这里了，这个希望也破灭了。

> [黑客中午](http://bit.ly/Hackernoon)是黑客如何开始他们的下午。我们是 [@AMI](http://bit.ly/atAMIatAMI) 家庭的一员。我们现在[接受投稿](http://bit.ly/hackernoonsubmission)并乐意[讨论广告&赞助](mailto:partners@amipublications.com)机会。
> 
> 要了解更多信息，请[阅读我们的“关于”页面](https://goo.gl/4ofytp)、[在脸书上点赞/给我们发消息](http://bit.ly/HackernoonFB)，或者简单地说， [tweet/DM @HackerNoon。](https://goo.gl/k7XYbx)
> 
> 如果你喜欢这个故事，我们推荐你阅读我们的[最新科技故事](http://bit.ly/hackernoonlatestt)和[趋势科技故事](https://hackernoon.com/trending)。直到下一次，不要把世界的现实想当然！