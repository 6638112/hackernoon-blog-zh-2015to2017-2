<html>
<head>
<title>How to build a dynamic Email template in under 10 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在10分钟内建立一个动态邮件模板</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-a-dynamic-email-template-in-under-10-minutes-1fe85ad40e35?source=collection_archive---------1-----------------------#2017-09-23">https://medium.com/hackernoon/how-to-build-a-dynamic-email-template-in-under-10-minutes-1fe85ad40e35?source=collection_archive---------1-----------------------#2017-09-23</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/d2b014320b0254ae912147267b668d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyLXnG1WUMPsEO4IEXTgUg.png"/></div></div></figure><div class=""/><div class=""><h2 id="de3b" class="pw-subtitle-paragraph jc ie if bd b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ek translated">在过去的几年里，自动化电子邮件取得了长足的进步。过去只有文本的电子邮件，现在包含各种形式、动态链接和图像，这取决于每个公司的设计。</h2></div><p id="66ba" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">如今，接收格式良好、设计时尚的HTML电子邮件已经成为大多数公司的标准，这就是为什么采用这一原则而不是普通的纯文本电子邮件成为必须的。</p><p id="1b0c" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">开发HTML模板并不需要很多编码技能，但是知道如何编码模板以在所有设备和旧的电子邮件客户端上正确显示才是真正的挑战。</p><p id="b60e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在这篇博文中，我将一步一步地介绍如何通过HTML、CSS和PHP构建跨平台兼容的动态电子邮件模板。</p><h1 id="2d2f" class="kq kr if bd ks kt ku kv kw kx ky kz la jl lb jm lc jo ld jp le jr lf js lg lh dt translated">基本准则</h1><p id="6788" class="pw-post-body-paragraph ju jv if jw b jx li jg jz ka lj jj kc kd lk kf kg kh ll kj kk kl lm kn ko kp hn dt translated">如上所述，开发HTML电子邮件模板的最大挑战是确保它的跨平台兼容性。有这么多的电子邮件客户端，如谷歌邮件，苹果邮件，Outlook，美国在线，雷鸟，雅虎！、Hotmail、Lotus Notes等。就CSS支持而言，其中一些客户端和其他客户端落后于八球，这意味着如果我们真的希望电子邮件模板为每个用户一致地显示，我们必须求助于使用HTML表格来控制设计布局。</p><p id="8e17" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">事实上，使用HTML表格是实现跨不同电子邮件客户端呈现一致的布局的最佳方式。可以把模板想象成由表中表中表构成的…</p><p id="46ae" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">其次，我们必须使用内联CSS来控制电子邮件中的元素，比如背景颜色和字体。CSS样式声明应该非常简单，不需要使用任何CSS文件。</p><p id="d72e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">为了强调上面的HTML表格规则，请看下面的例子，我修改了每个表格的border属性，使其可见。请注意,%s是一个占位符，动态文本和图像将被填充，我将很快看到描述(滚动到末尾以查看最终的电子邮件模板):</p><figure class="lo lp lq lr fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ln"><img src="../Images/e3eb1939ee1928e997854e629f6c287d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PxUSCWWlzG4R4My52L5sGg.png"/></div></div></figure><p id="2a15" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">正如你在上面看到的，整个布局是由HTML表格构建的。我们将使用PHP库解析%s占位符，并在电子邮件发送给用户之前用动态文本填充它。</p><h1 id="dee5" class="kq kr if bd ks kt ku kv kw kx ky kz la jl lb jm lc jo ld jp le jr lf js lg lh dt translated">开发静态模板</h1><p id="6251" class="pw-post-body-paragraph ju jv if jw b jx li jg jz ka lj jj kc kd lk kf kg kh ll kj kk kl lm kn ko kp hn dt translated">所以开始编程吧！</p><p id="614e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在我们开始模板本身之前，您需要以一个<a class="ae ls" href="http://www.w3schools.com/html/html_xhtml.asp" rel="noopener ugc nofollow" target="_blank"> XHTML文档</a>开始您的HTML文件:</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="d2ca" class="ly kr if lu b fv lz ma l mb mc">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br/>&lt;html &gt;<br/> &lt;head&gt;<br/>  &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br/>  &lt;title&gt;Demystifying Email Design&lt;/title&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"/&gt;<br/>&lt;/head&gt;<br/>&lt;/html&gt;</span></pre><p id="a3dc" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我建议用border="1 "定义所有的表格，如上所示，因为这样更容易发现错误，并且可以看到布局的框架。首先，让我们创建基本布局:</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="c814" class="ly kr if lu b fv lz ma l mb mc">&lt;body style="margin: 0; padding: 0;"&gt;<br/> &lt;table border="1" cellpadding="0" cellspacing="0" width="100%"&gt;<br/>  &lt;tr&gt;<br/>   &lt;td&gt;<br/>    My first email template!<br/>   &lt;/td&gt;<br/>  &lt;/tr&gt;<br/> &lt;/table&gt;<br/>&lt;/body&gt;</span></pre><p id="25e5" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">将单元格边距和单元格间距设置为零，以避免表格中出现任何意外的空间。同样将宽度设置为100%,因为这个表格是我们电子邮件的真正正文标签，因为正文标签的样式并不完全支持。</p><p id="f1c8" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">现在，我们将添加“我的第一个电子邮件模板！”另一个表格将显示实际的电子邮件模板显示:</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="d163" class="ly kr if lu b fv lz ma l mb mc">&lt;table align="center" border="1" cellpadding="0" cellspacing="0" width="600" style="border-collapse: collapse;"&gt;<br/> &lt;tr&gt;<br/>  &lt;td&gt;<br/>   This is the email template body<br/>  &lt;/td&gt;<br/> &lt;/tr&gt;<br/>&lt;/table&gt;</span></pre><p id="f607" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">如您所见，宽度设置为600像素。600像素是您的电子邮件在大多数电子邮件客户端上正确显示的最大安全宽度。此外，将border-collapse属性设置为collapse，以确保表格和边框之间没有多余的空格。</p><p id="4488" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在上面的示例中，您可以看到我们的电子邮件模板由五个部分(行)组成，这就是为什么我们将创建这些行，然后根据每个行添加表格，以完成模板。</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="11be" class="ly kr if lu b fv lz ma l mb mc">&lt;table align="center" border="1" cellpadding="0" cellspacing="0" width="600"&gt;<br/> &lt;tr&gt;<br/>    &lt;td&gt;<br/>       Row 1<br/>    &lt;/td&gt;<br/> &lt;/tr&gt;<br/>  ...<br/> &lt;tr&gt;<br/>    &lt;td&gt;<br/>       Row 5<br/>    &lt;/td&gt;<br/> &lt;/tr&gt;<br/>&lt;/table&gt;</span></pre><p id="ca2a" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在每一行，我们将创建一个新的表，其中的神话与上面的相似。我们还将相应地添加列和正确的填充来对齐所有对象，以达到所需的模板。</p><p id="d94b" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">下面是最终的HTML模板，命名为“template.html”，也可以在<a class="ae ls" href="https://github.com/CodingStartups/dynamic_email" rel="noopener ugc nofollow" target="_blank">项目Github页面</a>中找到:</p><figure class="lo lp lq lr fq hw"><div class="bz el l di"><div class="md me l"/></div></figure><p id="86dd" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">一些观察结果:</p><ol class=""><li id="0298" class="mf mg if jw b jx jy ka kb kd mh kh mi kl mj kp mk ml mm mn dt translated">在需要的地方添加alt属性，以便在电子邮件客户端无法正确加载它们的情况下显示文本而不是图像。</li><li id="6573" class="mf mg if jw b jx mo ka mp kd mq kh mr kl ms kp mk ml mm mn dt translated">根据电子邮件使用情况，在您希望数据动态显示的位置添加%s占位符。</li><li id="538d" class="mf mg if jw b jx mo ka mp kd mq kh mr kl ms kp mk ml mm mn dt translated">如果仔细观察，百分比值会多一个“%”。这就是为什么PHP库用来使这个动态，知道如何正确地解析文本。</li></ol><p id="a66e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">注意！出于安全和隐私考虑，我已经删除了这些网址。请随意用您自己的图片和个人链接替换它们。</p><p id="8829" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">就是这样！您已经成功开发了自己的电子邮件静态模板。现在让我们把手弄脏，让它充满活力！</p><h1 id="ac8d" class="kq kr if bd ks kt ku kv kw kx ky kz la jl lb jm lc jo ld jp le jr lf js lg lh dt translated">用PHP构建动态模板</h1><p id="463f" class="pw-post-body-paragraph ju jv if jw b jx li jg jz ka lj jj kc kd lk kf kg kh ll kj kk kl lm kn ko kp hn dt translated">在服务器端，创建下面的电子邮件发送方法:</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="30bf" class="ly kr if lu b fv lz ma l mb mc">function send_mail_template($to, $from, $subject, $message)<br/>{<br/>  $headers = "MIME-Version: 1.0" . "\r\n";<br/>  $headers .= "Content-type:text/html;charset=UTF-8" . "\r\n";<br/>  $headers .= "From: ContactNameGoesHere &lt;" . $from . "&gt;\r\n";<br/>  $response = mail($to, $subject, $message, $headers);<br/>}</span></pre><p id="90c2" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">现在，如果你仔细查看template.html文件，你会发现我在某些地方添加了%s个占位符。更具体地说，在图像横幅元素和正文中。</p><p id="870d" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">现在我们需要做的就是导入上面的template.html文件，像普通文本一样解析它，添加相关的文本来代替“%s”并使用上面的send_mail_template方法。</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="bfae" class="ly kr if lu b fv lz ma l mb mc">function build_email_template($email_subject_image, $message)<br/>{<br/>    // Get email template as string<br/>    $email_template_string = file_get_contents('template.html', true);<br/>    // Fill email template with message and relevant banner image<br/>    $email_template = sprintf($email_template_string,'URL_to_Banner_Images/banner_' . $email_subject_image. '.png', $message, $mobile_plugin_string);<br/>    return $email_template;<br/>}</span></pre><p id="16ca" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">解决了这个问题后，我们可以使用这两种方法来发送我们的第一封动态邮件！</p><p id="5f5a" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我们来举个例子。假设一个新用户刚刚验证了他的电子邮件。我们希望在服务器端自动执行该用例，并向用户发送一封“您的电子邮件已成功验证”的电子邮件。</p><p id="5efe" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">假设我们有用户验证的电子邮件“user@user.com”，公司的电子邮件是“company@company.com”。</p><p id="f7b4" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我们现在可以发送一封自动电子邮件:</p><pre class="lo lp lq lr fq lt lu lv lw aw lx dt"><span id="9f3c" class="ly kr if lu b fv lz ma l mb mc">$from = "company@company.com";<br/>$to = "user@user.com";<br/>$body_text = "Your email has been successfully verified...";<br/>$banner_image_subject = "account_verified";<br/>$final_message = build_email_template($banner_image_subject, $body_text);<br/>send_email($to, $from, "You email has been verified", $final_message);</span></pre><p id="3f52" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">终于！现在，您可以根据需要使用这种方法。发送此示例后，在应用GreenIQ的公司图像和文本时，这是发送给用户的最终电子邮件模板:</p><figure class="lo lp lq lr fq hw fe ff paragraph-image"><div class="fe ff mt"><img src="../Images/acd6e36c192d6c110e31d004641b15d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*gwMApo12f34h7iX0UVOZwQ.png"/></div></figure><p id="ef58" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">简单吧？</p><p id="4831" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">查看<a class="ae ls" href="http://codingstartups.com" rel="noopener ugc nofollow" target="_blank"> CodingStartups </a>为技术企业家和数据黑客提供的更多有见地的帖子。</p><p id="9542" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">如果你喜欢这首曲子，那就鼓掌吧👏🏻！你也可以在网上的某个地方分享，这样其他人也可以阅读。</p><figure class="lo lp lq lr fq hw"><div class="bz el l di"><div class="mv me l"/></div></figure></div></div>    
</body>
</html>