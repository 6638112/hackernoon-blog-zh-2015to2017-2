<html>
<head>
<title>How I made a simplest and useful library in Golang by learning Reflection’s work</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何通过学习Reflection的工作在Golang创建一个最简单有用的库的</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-i-made-a-simplest-and-useful-library-in-golang-by-learning-reflections-work-6192aa7ef8cf?source=collection_archive---------8-----------------------#2017-09-14">https://medium.com/hackernoon/how-i-made-a-simplest-and-useful-library-in-golang-by-learning-reflections-work-6192aa7ef8cf?source=collection_archive---------8-----------------------#2017-09-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="e991" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">从做中学:在戈朗的反思</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/7697e56411f4b04e9769fafe842eae77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcrCSLrSJ7vj4JgzWv7uig.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Random text , searched from google images</figcaption></figure><p id="5dc4" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">几个月前，我在golang中创建了一个简单的库，以帮助golang工程师测试他们的功能。这只是一个简单的库，会根据它们的结构产生虚假和随机的数据。这个想法来自于我在每个函数中创建单元测试，创建不同的结构，这是浪费时间。</p><p id="2c3f" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">这里可以看到图书馆</p><div class="kv kw fm fo kx ky"><a href="https://github.com/bxcodec/faker" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">bxcodec/faker</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">faker - Go (Golang)结构的假数据生成器</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">github.com</p></div></div><div class="lh l"><div class="li l lj lk ll lh lm jt ky"/></div></div></a></div><p id="b2ba" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">如何使用它:</p><pre class="jk jl jm jn fq ln lo lp lq aw lr dt"><span id="ab29" class="ls lt hu lo b fv lu lv l lw lx">$ go get github.com/bxcodec/faker</span></pre><p id="2406" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">然后导入到您的测试文件中。</p><p id="4023" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">这个简单的库是我利用golang中的反射特性制作的。这项工作很简单，你只需定义你的结构，我的库将根据你的结构为你生成一个虚拟数据。</p><p id="3dc6" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">示例:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ly lz l"/></div></figure><p id="4324" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">当你运行的时候，你的对象将会充满随机数据:</p><pre class="jk jl jm jn fq ln lo lp lq aw lr dt"><span id="a949" class="ls lt hu lo b fv lu lv l lw lx">$ go run main.go<br/>$ {Int:37 String:LOftACEPfclEWQDBqAaaqyVis Bool:false SString:[yWgdk<br/>  ZQtbTmi] Struct:{Number:36 Height:0.021622694665801242<br/>  AnotherStruct:{Image:wUvHuSlyJYknWbqUbWtYGrMrZ}}}</span></pre><p id="532e" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">即使你有一个嵌套的struct，只要它们不指向struct，它们就会安全地生成。</p><p id="262c" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">很好，你是怎么做到的？</p><h2 id="e74a" class="ls lt hu bd ma mb mc md me mf mg mh mi ki mj mk ml km mm mn mo kq mp mq mr ms dt translated"><strong class="ak">倒影</strong></h2><p id="5db6" class="pw-post-body-paragraph jz ka hu kb b kc mt iv ke kf mu iy kh ki mv kk kl km mw ko kp kq mx ks kt ku hn dt translated">在golang中，有一个内置的包可以用于反射数据类型，它叫做<code class="eh my mz na lo b">reflect</code>。你可以在官方文件中看到<code class="eh my mz na lo b">reflect</code>能做什么【https://golang.org/pkg/reflect/<a class="ae nb" href="https://golang.org/pkg/reflect/" rel="noopener ugc nofollow" target="_blank"/></p><p id="4400" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">基本上，我只是<strong class="kb hv">得到数据类型</strong>，然后<strong class="kb hv">根据它的类型</strong>得到随机数据。</p><pre class="jk jl jm jn fq ln lo lp lq aw lr dt"><span id="ab70" class="ls lt hu lo b fv lu lv l lw lx">var a int64 <br/> <br/>ref :=reflect.ValueOf(&amp;a) //<em class="nc">will return reflect.Value objects ; </em><br/>                          //<em class="nc">Pass with refferences for data  </em><br/>                          //<em class="nc">manipulation</em><br/> <br/>ref=reflect.Indirect(ref) //<em class="nc">accessing the value only that pointed by </em><br/>                          //<em class="nc">ref</em><br/> <br/>kind:= ref.Kind() // <em class="nc">will return the kind of the reflected value</em><br/> <br/>if kind == reflect.Int64{</span><span id="adfd" class="ls lt hu lo b fv nd lv l lw lx">  val:= int64(100)  //<em class="nc">Data will assigned. For fake data, this </em><br/>                   //<em class="nc">should randomized</em></span><span id="ef40" class="ls lt hu lo b fv nd lv l lw lx">  ref.Set(reflect.ValueOf(<strong class="lo hv">val</strong>)) //<em class="nc">Set the value</em><br/>}<br/> <br/>fmt.Println("Value of a ", a) //<em class="nc">Will print 100</em></span></pre><p id="b757" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">活生生的例子你可以在这里运行</p><div class="kv kw fm fo kx ky"><a href="https://play.golang.org/p/wY1kBUFEFu" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">围棋运动场</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">操场服务不仅仅被官方Go项目使用(Go by Example是另一个例子),我们…</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">play.golang.org</p></div></div></div></a></div><p id="9278" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">就这么简单。现在，我可以为我的结构生成一个虚拟数据，并在用随机数据进行自动化测试时帮助我。</p><p id="e400" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">但是，这个库仍然需要更多的改进，因为它仍然不能随机化结构数组的数据。我试过很多方法，还是不好，可能是做不到，也可能是还需要学习更多。</p><p id="e66b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">快乐编码…:)</p><p id="a7b6" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated"><em class="nc">如果你有问题，或者需要更多的解释，或者有什么东西，我在这里不好解释，你可以从我的</em><a class="ae nb" href="https://www.linkedin.com/in/imantumorang/" rel="noopener ugc nofollow" target="_blank"><em class="nc">LinkedIn</em></a><em class="nc">或者</em><a class="ae nb" href="mailto:iman.tumorang@gmail.com" rel="noopener ugc nofollow" target="_blank"><em class="nc">email</em></a><em class="nc">问我。谢谢</em></p><div class="kv kw fm fo kx ky"><a href="https://hackernoon.com/golang-clean-archithecture-efd6d7c43047" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">在Golang尝试干净的建筑</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">独立的、可测试的和干净的</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">hackernoon.com</p></div></div><div class="lh l"><div class="ne l lj lk ll lh lm jt ky"/></div></div></a></div><div class="kv kw fm fo kx ky"><a href="https://toolbox.kurio.co.id/implementing-grpc-service-in-golang-afb9e05c0064" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">在戈兰实施gRPC服务</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">指南，使gRPC服务使用清洁的建筑在果兰。</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">toolbox.kurio.co.id</p></div></div><div class="lh l"><div class="nf l lj lk ll lh lm jt ky"/></div></div></a></div><div class="kv kw fm fo kx ky"><a href="https://toolbox.kurio.co.id/im-learning-to-use-flatbuffer-in-go-golang-here-what-i-learn-f7f8bf42f015" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">我正在学习使用Go (Golang)中的Flatbuffer，下面是我所学到的</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">用于序列化数据的Flatbuffer。</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">toolbox.kurio.co.id</p></div></div><div class="lh l"><div class="ng l lj lk ll lh lm jt ky"/></div></div></a></div></div></div>    
</body>
</html>