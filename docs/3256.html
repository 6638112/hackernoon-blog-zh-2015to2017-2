<html>
<head>
<title>AWS Policy to Terminate Instances Based on Profile</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于概要文件终止实例的AWS策略</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/aws-policy-to-terminate-instances-based-on-profile-6253ef8614f6?source=collection_archive---------18-----------------------#2017-03-22">https://medium.com/hackernoon/aws-policy-to-terminate-instances-based-on-profile-6253ef8614f6?source=collection_archive---------18-----------------------#2017-03-22</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="2cd8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">终止EC2实例是一个关键的操作，默认情况下应该拒绝，只有特定的角色才明确允许。</p><p id="76f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有些情况下，我们希望一个实例能够终止其他实例，例如一个<em class="jp">工作人员</em>角色能够检查<em class="jp"> Web </em>实例的健康状态，并终止坏的实例。</p><p id="d438" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我发现的大多数通过IAM策略允许ec2:TerminateInstances的<a class="ae jq" href="https://aws.amazon.com/blogs/security/resource-level-permissions-for-ec2-controlling-management-access-on-specific-instances/" rel="noopener ugc nofollow" target="_blank">示例</a>都指定了基于源ip、用户认证方法或目标实例标签的条件。</p><p id="fbdf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下代码片段显示了如何基于目标实例概要文件允许ec2:TerminateInstances:</p><pre class="jr js jt ju fq jv jw jx jy aw jz dt"><span id="e835" class="ka kb hu jw b fv kc kd l ke kf">{<br/>  "Sid": "TerminateWebInstances",<br/>  "Action": [<br/>    "ec2:TerminateInstances"<br/>  ],<br/>  "Condition": {<br/><strong class="jw hv">    "StringEquals":<br/>      { "ec2:InstanceProfile":<br/>        "arn:aws:iam::&lt;accountId&gt;:instance-profile/&lt;Web&gt;" }<br/></strong>    },<br/>  "Resource": [<br/>    "arn:aws:ec2:us-west-1:&lt;accountId&gt;:instance/*"<br/>  ],<br/>  "Effect": "Allow"<br/>}</span></pre><p id="8ad6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在上面的例子中，这个代码片段将被添加到角色<em class="jp"> Worker </em>的策略中，并将允许<em class="jp"> Worker </em>终止任何具有实例概要文件<em class="jp"> Web </em>的目标。</p><p id="1db0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">确保使用您想要终止的目标实例概要文件更改您的帐户区域、帐户id和<web>。</web></p><p id="6985" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您是否让实例终止其他实例，如果是，如何终止？我很想知道。请在下面评论或<a class="ae jq" href="https://twitter.com/0x0ece" rel="noopener ugc nofollow" target="_blank">在Twitter上找到我</a>。</p><blockquote class="kg kh ki"><p id="f4eb" class="ir is jp it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated"><a class="ae jq" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae jq" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jq" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is jp it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">要了解更多信息，<a class="ae jq" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">请阅读我们的“关于”页面</a>、<a class="ae jq" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">喜欢/在脸书上给我们发消息</a>，或者简单地说，<a class="ae jq" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jq" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jq" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>