<html>
<head>
<title>How to Create a Buck-based C/C++ Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建一个基于Buck的C/C++项目</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-create-a-buck-based-c-c-project-38b85273d6a6?source=collection_archive---------4-----------------------#2017-05-15">https://medium.com/hackernoon/how-to-create-a-buck-based-c-c-project-38b85273d6a6?source=collection_archive---------4-----------------------#2017-05-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/f68ffd96179039a719531838fabb705b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9SQlakE0AhH_uX4Kha0IdQ.jpeg"/></div></div></figure><div class=""/><p id="c645" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Buck是由脸书开发的快速构建工具。选择Buck 的理由有<a class="ae ka" href="https://hackernoon.com/7-reasons-to-use-buck-build-5b44d7413585" rel="noopener ugc nofollow" target="_blank">很多，但是应该如何入门呢？</a></p><p id="44d3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该演练将涵盖:</p><ul class=""><li id="8f77" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">如何组织你的项目</li><li id="c963" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">Google测试的集成</li><li id="ff08" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">基本降压命令的解释</li></ul><h2 id="511b" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">TL；速度三角形定位法(dead reckoning)</h2><p id="6831" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">在GitHub 上浏览<a class="ae ka" href="https://github.com/njlr/buck-cpp-example" rel="noopener ugc nofollow" target="_blank">项目文件，或者将它们克隆到您的系统上:</a></p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="1db7" class="kp kq if lu b fv ly lz l ma mb">git clone <a class="ae ka" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:njlr/buck-cpp-example.git</span></pre><p id="d46a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从<a class="ae ka" href="https://www.buckaroo.pm" rel="noopener ugc nofollow" target="_blank"> Buckaroo.pm </a>安装现有的降压口。</p><h1 id="3d41" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">巴克是如何工作的</h1><p id="26bb" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">在我们开始之前，了解一下Buck的工作原理可能会有所帮助。与其旧事重提，不如看看巴克开发者的这篇演讲。</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="mt mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">Ludicrously Fast Builds with Buck</figcaption></figure><h1 id="445c" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">安装降压器</h1><p id="49c5" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">安装Buck的官方指南<a class="ae ka" href="https://buckbuild.com/setup/getting_started.html" rel="noopener ugc nofollow" target="_blank">可在他们的网站</a>上获得。然而，最快的方法可能是使用Homebrew或Linuxbrew。</p><ul class=""><li id="81d3" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">如果你使用的是Linux，你可以在他们的网站上使用<a class="ae ka" href="http://linuxbrew.sh/" rel="noopener ugc nofollow" target="_blank">一行程序安装Linuxbrew。</a></li><li id="6710" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">macOS上的<a class="ae ka" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制</a>同上。</li></ul><p id="9f40" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦你有一个“酿造”安装，添加脸书水龙头，并安装降压:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="90e2" class="kp kq if lu b fv ly lz l ma mb">brew tap facebook/fb<br/>brew install --HEAD facebook/fb/buck</span></pre><p id="e5ac" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用以下内容验证您的安装:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="f7b6" class="kp kq if lu b fv ly lz l ma mb">buck --version</span></pre><h1 id="ec08" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">整理您的文件</h1><p id="182d" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">一旦安装了Buck，就该创建项目文件夹了。Buck使得支持你喜欢的任何文件夹结构变得容易，但是对于这个演示，我们将遵循C/C++的惯例，使用<code class="eh mz na nb lu b">src</code>和<code class="eh mz na nb lu b">include</code>文件夹。</p><p id="9f80" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该项目将由两部分组成:</p><ul class=""><li id="44d5" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">demo</code> —计算<code class="eh mz na nb lu b">3 + 4</code>并打印结果的可执行文件</li><li id="f9aa" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">mathutils</code> —一个提供简单添加功能的库</li></ul><p id="f775" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="nc">注意:这是一个用于演示目的的简单示例；buck capable to build</em><a class="ae ka" href="http://buckaroo.pm/search?q=*" rel="noopener ugc nofollow" target="_blank"><em class="nc">复杂的C/C++项目</em> </a> <em class="nc">！</em></p><p id="7d1b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，在您的驱动器上创建以下结构:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="65c3" class="kp kq if lu b fv ly lz l ma mb">.<br/>├── .buckconfig<br/>├── BUCK<br/>└── demo<br/>    ├── include<br/>    └── src<br/>        └── main.cpp</span></pre><p id="602c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用命令行:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="cefb" class="kp kq if lu b fv ly lz l ma mb">touch .buckconfig<br/>touch BUCK</span><span id="aa69" class="kp kq if lu b fv nd lz l ma mb">mkdir demo<br/>mkdir demo/include<br/>mkdir demo/src<br/>touch demo/src/main.cpp</span></pre><p id="e196" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是相当多的文件，让我们浏览一下:</p><ul class=""><li id="005c" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">在运行任何降压命令之前，需要一个<code class="eh mz na nb lu b">.buckconfig</code>。它告诉Buck项目的根在哪里，也可以用来配置项目的全局设置。现在我们可以让它空着。</li><li id="4d3f" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">BUCK</code>文件是我们为二进制文件定义目标的地方。在一个Buck项目中可以有多个<code class="eh mz na nb lu b">BUCK</code>文件，这在您想要为项目的不同方面(比如库和测试)分离构建逻辑时非常有用。</li><li id="9b8e" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">demo/include</code>是我们放置二进制文件使用的头的地方。</li><li id="bfa0" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">demo/src</code>是我们放置二进制文件翻译单元(这里是<code class="eh mz na nb lu b">.cpp</code>文件)的地方。</li><li id="1ba2" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">demo/src/main.cpp</code>将是我们应用的切入点。</li></ul><h2 id="1148" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">主页面</h2><p id="001d" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">首先，我们将编写一个简单的hello-world程序。将以下内容粘贴到<code class="eh mz na nb lu b">main.cpp</code>:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">demo/src/main.cpp</figcaption></figure><h2 id="cab0" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">钱</h2><p id="d905" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">为了构建<code class="eh mz na nb lu b">main.cpp</code>文件，我们需要为它编写一个Buck目标。将以下内容粘贴到<code class="eh mz na nb lu b">BUCK</code>文件中:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">BUCK</figcaption></figure><p id="73e6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">文件是用Python 2的一种方言写的，有一些扩展名。当您调用<code class="eh mz na nb lu b">buck build</code>时，Buck将执行Python并记录定义的任何目标。一旦目标列表被解析，每个目标就根据其类型被构建。</p><p id="bdaa" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以在<a class="ae ka" href="https://buckbuild.com/rule/cxx_binary.html" rel="noopener ugc nofollow" target="_blank">降压文档</a>中看到完整的目标类型列表，但是对于C/C++来说重要的是<code class="eh mz na nb lu b">cxx_binary</code>、<code class="eh mz na nb lu b">cxx_library</code>和<code class="eh mz na nb lu b">prebuilt_cxx_library</code>。</p><ul class=""><li id="3a7f" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">cxx_binary</code> —包含入口点的一组C/C++翻译单元和头(例如<code class="eh mz na nb lu b">int main()</code>)。一个<code class="eh mz na nb lu b">cxx_binary</code>一旦编译就可以执行。不应该是依赖。</li><li id="73d5" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">cxx_library</code> —可以被其他目标使用的一组C/C++翻译单元。与<code class="eh mz na nb lu b">cxx_binary</code>不同，一个库还定义了一个<code class="eh mz na nb lu b">exported_headers</code>列表，它是对其依赖者可用的头文件。</li><li id="4988" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">prebuilt_cxx_library</code> —像一个<code class="eh mz na nb lu b">cxx_library</code>，但是在翻译单元的位置有一个可选的目标文件。只有头文件的库被实现为没有目标文件的<code class="eh mz na nb lu b">prebuilt_cxx_library</code>。</li></ul><h1 id="a6c8" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">降压命令</h1><p id="86c7" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">现在<code class="eh mz na nb lu b">BUCK</code>文件已经就绪，Buck可以构建目标了。运行以下命令:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="a86c" class="kp kq if lu b fv ly lz l ma mb">buck build //:demo</span></pre><p id="a5b6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该命令告诉Buck构建在与<code class="eh mz na nb lu b">.buckconfig</code>相邻的<code class="eh mz na nb lu b">BUCK</code>文件中找到的目标<code class="eh mz na nb lu b">:demo</code>。</p><p id="b96d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Buck基于项目的实际文件夹结构，对目标使用简单的寻址系统。例如，<code class="eh mz na nb lu b">//examples/basic/:demo</code>是指<code class="eh mz na nb lu b">examples/basic/BUCK</code>中定义的目标<code class="eh mz na nb lu b">demo</code>。</p><p id="ee2b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">构建完成后，您应该在<code class="eh mz na nb lu b">buck-out/gen/demo</code>找到一个可执行文件。您可以使用以下代码构建并运行它:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="f122" class="kp kq if lu b fv ly lz l ma mb">buck build //:demo &amp;&amp; ./buck-out/gen/demo</span></pre><p id="4e37" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者，巴克可以帮你做:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="17eb" class="kp kq if lu b fv ly lz l ma mb">buck run //:buck-cpp-example</span></pre><p id="fbd7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您会注意到，第二次运行构建的速度非常快。这是因为Buck缓存了所有东西，包括Python脚本的输出！</p><h1 id="2579" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">添加依赖关系</h1><p id="5d10" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">让我们实现<code class="eh mz na nb lu b">mathutils</code>以便在演示应用程序中使用它。</p><p id="38fd" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在项目中创建以下文件夹结构:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="31e5" class="kp kq if lu b fv ly lz l ma mb">.<br/>└── mathutils<br/>    ├── BUCK<br/>    ├── include<br/>    │   └── add.hpp<br/>    └── src<br/>        └── add.cpp</span></pre><p id="21a6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用命令行:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="920b" class="kp kq if lu b fv ly lz l ma mb">mkdir mathutils<br/>mkdir mathutils/include<br/>mkdir mathutils/src</span><span id="0023" class="kp kq if lu b fv nd lz l ma mb">touch mathutils/BUCK<br/>touch mathutils/include/add.hpp<br/>touch mathutils/src/add.cpp</span></pre><p id="62a9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和文件本身:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">mathutils/add.hpp</figcaption></figure><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">mathutils/add.cpp</figcaption></figure><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">mathutils/BUCK</figcaption></figure><p id="28a7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">关于这个<code class="eh mz na nb lu b">BUCK</code>文件有几个要点:</p><ul class=""><li id="fc36" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">将<code class="eh mz na nb lu b">header_namespace</code>设置为<code class="eh mz na nb lu b">'mathutils'</code>。这会将该库导出的每个头文件放入一个同名文件夹中，从而减少与其他库发生文件名冲突的可能性。</li><li id="8f3e" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><code class="eh mz na nb lu b">glob</code>规则的根在<code class="eh mz na nb lu b">BUCK</code>文件，所以<code class="eh mz na nb lu b">src/**/*.cpp</code>实际上是从项目根对应<code class="eh mz na nb lu b">mathutils/src/**/*.cpp</code>。</li><li id="b08a" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">可见性被设置为<code class="eh mz na nb lu b">//...</code>,以便该目标可以被项目中的所有其他目标作为依赖项。在英语中，它的意思是“这个库对根目录下的所有其他目标都是可见的”。</li></ul><h2 id="f832" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">使用添加功能</h2><p id="8bb4" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">现在我们可以在<code class="eh mz na nb lu b">demo</code>可执行文件中使用<code class="eh mz na nb lu b">mathutils</code>库。</p><p id="ed29" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，声明<code class="eh mz na nb lu b">demo</code>对<code class="eh mz na nb lu b">mathutils</code>的依赖。将项目根目录下的<code class="eh mz na nb lu b">BUCK</code>文件改为:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">BUCK</figcaption></figure><p id="be35" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在更新<code class="eh mz na nb lu b">main.cpp</code>到:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">demo/src/main.cpp</figcaption></figure><p id="014b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用Buck运行<code class="eh mz na nb lu b">demo</code>查看结果。你会注意到巴克知道如何为你连接<code class="eh mz na nb lu b">mathutils</code>。</p><h1 id="fc6a" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">谷歌测试</h1><p id="9aeb" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">我们的应用程序正在工作，但是为了勤奋，我们应该添加一些单元测试！</p><p id="29ce" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Buck通过<code class="eh mz na nb lu b">buck run</code>支持所有的C/C++测试框架，但是它提供了与Google Test的额外集成。</p><h2 id="6f36" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">获取Google测试源代码</h2><p id="79fd" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">Git提供了一种使用子模块获取Google测试源代码的简单方法。我们将使用包含一个<code class="eh mz na nb lu b">BUCK</code>文件的<a class="ae ka" href="https://github.com/njlr/googletest" rel="noopener ugc nofollow" target="_blank">fork</a>，但是如果需要的话，您可以使用主文件并编写自己的文件。</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="3c23" class="kp kq if lu b fv ly lz l ma mb">git submodule add git@github.com:njlr/googletest.git<br/>cd googletest/<br/>git checkout 48072820e47a607d000b101c05d796ebf9c4aad2<br/>cd ../</span></pre><p id="06d2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们需要告诉Buck在哪里可以找到Google测试源。打开<code class="eh mz na nb lu b">.buckconfig</code>并添加以下内容:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">.buckconfig</figcaption></figure><p id="5742" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这告诉Buck在哪里可以找到可以用于测试的Google测试目标。还可以设置其他配置属性；浏览<a class="ae ka" href="https://buckbuild.com/concept/buckconfig.html" rel="noopener ugc nofollow" target="_blank"> Buck文档</a>。</p><h2 id="ab4b" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">编写测试</h2><p id="9706" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">我们将把测试放在<code class="eh mz na nb lu b">mathutils/test</code>中，旁边是<code class="eh mz na nb lu b">mathutils/src</code>和<code class="eh mz na nb lu b">mathutils/include</code>:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="fca8" class="kp kq if lu b fv ly lz l ma mb">.<br/>└── mathutils<br/>    ├── BUCK<br/>    ├── include<br/>    │   └── add.hpp<br/>    ├── src<br/>    │   └── add.cpp<br/>    └── test<br/>        ├── BUCK<br/>        └── add.cpp</span></pre><p id="ff33" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用命令行:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="824a" class="kp kq if lu b fv ly lz l ma mb">mkdir mathutils/test<br/>touch mathutils/test/add.cpp</span></pre><p id="95a4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">测试本身:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">mathutils/test/add.cpp</figcaption></figure><p id="8012" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，我们需要在<code class="eh mz na nb lu b">BUCK</code>文件中声明测试:</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ne mu l"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">mathutils/test/BUCK</figcaption></figure><p id="e016" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在测试可以由巴克进行了:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="6d1a" class="kp kq if lu b fv ly lz l ma mb">buck test //mathutils/test:add</span></pre><p id="2919" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者，运行所有测试:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="0d84" class="kp kq if lu b fv ly lz l ma mb">buck test</span></pre><h1 id="9ecb" class="mc kq if bd kr md me mf kv mg mh mi kz mj mk ml lc mm mn mo lf mp mq mr li ms dt translated">结论</h1><p id="b947" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">就是这样！Buck是一个强大的工具，它将为你节省项目开发周期中的等待时间。要了解更多信息，请阅读<a class="ae ka" href="https://buckbuild.com/setup/getting_started.html" rel="noopener ugc nofollow" target="_blank">文档</a>或观看一些<a class="ae ka" href="https://buckbuild.com/presentations/index.html" rel="noopener ugc nofollow" target="_blank"> Buck演示</a>。</p><p id="f296" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果有你需要移植到Buck的库，看看<a class="ae ka" href="https://www.buckaroo.pm/" rel="noopener ugc nofollow" target="_blank"> Buckaroo.pm </a>。我们已经移植了300个项目，并且正在进行更多的工作！</p><div class="lp lq lr ls fq ab cb"><figure class="nf hw ng nh ni nj nk paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nf hw ng nh ni nj nk paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nf hw ng nh ni nj nk paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nl nm nn"><p id="f922" class="jc jd nc je b jf jg jh ji jj jk jl jm no jo jp jq np js jt ju nq jw jx jy jz hn dt translated">黑客中午是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd nc je b jf jg jh ji jj jk jl jm no jo jp jq np js jt ju nq jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nr"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>