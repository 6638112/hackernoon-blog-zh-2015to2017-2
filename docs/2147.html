<html>
<head>
<title>Thinking in Redux (when all you’ve known is MVC)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Redux思考(当你只知道MVC的时候)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/thinking-in-redux-when-all-youve-known-is-mvc-c78a74d35133?source=collection_archive---------0-----------------------#2017-01-09">https://medium.com/hackernoon/thinking-in-redux-when-all-youve-known-is-mvc-c78a74d35133?source=collection_archive---------0-----------------------#2017-01-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="597d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我们在<a class="ae jp" href="https://spoil.co" rel="noopener ugc nofollow" target="_blank">宠</a>决定推出我们的移动应用时，我们必须做出的第一个决定是:我们使用什么语言？经过一番深思熟虑后，我们做出了一个决定:这将是一个非常自然的决定。<a class="ae jp" href="https://hackernoon.com/tagged/learning" rel="noopener ugc nofollow" target="_blank">学习</a>一种新的“语言”或<a class="ae jp" href="https://hackernoon.com/tagged/framework" rel="noopener ugc nofollow" target="_blank">框架</a>不是一个大问题，但是伙计哦伙计，确实有反应——native和redux让我不好过。本文没有解释React-Native是如何工作的(因为这不是最难的部分)。接下来几段的目的是帮助任何人阅读从“用MVC思考”到“用Redux思考”的转变。希望有帮助。</p><h1 id="6667" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">React-Native和Redux？</h1><p id="5b50" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">一旦你开始学习react-native(或react ),在有人提到redux之前，你大概有3个栈溢出问题或中等帖子。</p><p id="dbfc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你很开心。你开始了解状态和道具，你知道componentDidMount是做什么的，你甚至知道如何正确地创建你的组件，使它们可重用。现在你突然发现自己在egghead.io上，某个家伙正在谈论商店、reducer合成、动作和将状态映射到道具。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/631ce1cc0678ff08052254a47e16e008.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/1*ZkpuItpBQjkDu1mXDbR35A.gif"/></div></figure><p id="8657" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还意识到，虽然之前您能够做到:</p><pre class="ku kv kw kx fq lb lc ld le aw lf dt"><span id="bf17" class="lg jr hu lc b fv lh li l lj lk">$(“.my-button”).click(); </span></pre><p id="6713" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">得到做某事的按钮；现在已经过了大约3个小时，你的一个按钮没有任何作用。</p><h1 id="c01f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">一些类比</h1><p id="efe2" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">如果你来自MVC(或MVVC)世界，你会习惯模型、视图和控制器(咄)。然而，在<a class="ae jp" href="http://redux.js.org/docs/introduction/" rel="noopener ugc nofollow" target="_blank"> Redux </a>中，我们处理的是动作、减少器、存储和组件。试图将MVC“翻译”成Redux是一件棘手的事情，但我会这样做:</p><p id="0433" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">动作=控制器。把你的行动想象成控制者。每当你想在你的应用程序中发生一些事情(例如，加载一些数据，改变一个isLoading标志从真到假…)你将不得不分派一个动作。就像在MVC中，你必须调用一个控制器端点。</strong></p><p id="f945" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">减速器=型号。</strong>有点。您的reducers将负责保存您的应用程序的当前状态(即用户信息、从api加载的信息、您想要显示的项目……)。它也是决定当一个动作被调用时做什么的部分。在MVC中，你可能有一个带有方法setName()的模型，而在Redux中，你将让一个reducer处理一个动作来设置状态中的名称。</p><p id="e6ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="ll">编辑感谢</em> </strong> <a class="lm ln gr" href="https://medium.com/u/1dc22d249ed1?source=post_page-----c78a74d35133--------------------------------" rel="noopener" target="_blank"> <strong class="it hv"> <em class="ll">普拉宾瓦尔马</em> </strong> </a> <strong class="it hv"> <em class="ll">。这更好地解释了商店。</em>T13】</strong></p><p id="2ceb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">门店=？？？。</strong>商店是Redux特有的，在MVC中并没有真正的对等物。不过不用担心。这部分是幕后处理的。存储就像一个状态容器，它聚集了所有的reducers。它有一个获取当前状态的方法，并公开了订阅状态更改的方法(使用“connect()”方法)。这将允许你调用动作并把它们作为道具传递给你的组件。</p><p id="bbc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">组件=视图。</strong>组件有点像您的智能视图。他们展示从州政府获得的信息。我建议把你的组件分成两部分。一个仅用于表示部分(哑组件)，一个用于处理所有的动作和状态变化(智能组件)。</p><h1 id="22cc" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">从MVC思维到Redux思维</h1><p id="7b40" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">MVC和Redux之间的一个主要区别是，在MVC中数据可以双向流动，而在Redux中数据只能单向流动。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff lo"><img src="../Images/ad951d7019f1ea9f980943077632c8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*xORdWwOFLR-6D4ghvUa6AA.png"/></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Typical MVC. When life was easy.</figcaption></figure><p id="6288" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如您在上面的图表中所看到的(并且从经验中知道),数据可以以两种方式流动。您在视图中按下一个按钮，它会向控制器发送一条消息并更新模型。模型更改一些值，将该值返回给控制器，控制器刷新视图。放松点，皮兹！</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff lt"><img src="../Images/c2b3d7394ceab5dd71c35ea6b656dc8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*ZX00M-DmsrigKap7wzGoQQ.png"/></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Redux flow. Life sucks now</figcaption></figure><p id="bc8c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有了Redux，事情会有所不同。假设你有一个组件，当一个按钮被按下时，你想做一些事情。你从哪里开始？我是这样做的。</p><ol class=""><li id="db00" class="lu lv hu it b iu iv iy iz jc lw jg lx jk ly jo lz ma mb mc dt translated">定义您的行动</li><li id="d25e" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">定义您的减速器</li><li id="e236" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">将动作定义为组件中的道具</li><li id="d3e4" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">在你的视野中连线</li></ol><p id="eb2c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里有一个简单的代码示例来解释这些概念。在这个例子中，我将展示如何编辑文本输入，当用户按下按钮时，它将调用一个动作来保存它。</p><p id="b7e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先让我们从<strong class="it hv">动作</strong>文件开始。</p><pre class="ku kv kw kx fq lb lc ld le aw lf dt"><span id="e0ac" class="lg jr hu lc b fv lh li l lj lk">export const MODIFY_NAME = "MODIFY_NAME";<br/>export const SAVE_NAME = "SAVE_NAME";</span><span id="6216" class="lg jr hu lc b fv mi li l lj lk">/**<br/>* This is the action we will call from our component whenever the user presses a button. Literally every letter that they will type, this action will be called with the new value in the text input field. Pay attention to the type and payload in this function. This is what we will use in the reducer to "modify" our model with the new values.<br/>**/<br/>export function modifyName(name){<br/>    return {<br/>        type: MODIFY_NAME,<br/>        payload:{<br/>            name<br/>        }<br/>    }<br/>}</span><span id="0474" class="lg jr hu lc b fv mi li l lj lk">/**<br/>This is the action we will call when the user presses the save name button. Notice how we don't pass any value in. That is because the reducer already holds that value. Also there is no payload. The reason for that is the reducer doesn't need one. There is no extra information needed for the reducer step.<br/>Also, normally this would call an api endpoint and all that jazz, but for brevity's sake I won't include that.<br/>**/<br/>export function saveName(){<br/> return {<br/>   type: SAVE_NAME<br/> }<br/>}</span></pre><p id="4c06" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在轮到我们的主持人T21了。基本上，减速器必须处理进来的动作。</p><pre class="ku kv kw kx fq lb lc ld le aw lf dt"><span id="a973" class="lg jr hu lc b fv lh li l lj lk">//import the actions file we defined earlier<br/>import * as constants from '../actions.js';</span><span id="76e3" class="lg jr hu lc b fv mi li l lj lk">/** <br/>The initial state is used to define your reducer. Usually you would just set this to default values and empty strings. The reason this is needed is so that when using these values you are guaranteed to at least have some default value. Think of it as the default constructor.<br/>**/<br/>const initialState = {<br/>     name:'',<br/>     isSaved: false<br/>}</span><span id="d1e1" class="lg jr hu lc b fv mi li l lj lk">/**<br/>This action part is the part that will "listen" for emitted actions. So the saveName and modifyName functions that we defined earlier will be handled in here. The action parameter is what is being returned (the type and payload) in the functions above.<br/>**/<br/>function name(state=initialState,action){<br/>  switch (action.type){<br/>/**<br/>in REDUX the state is immutable. You must always return a new one, which is why use the ES6 spread operator to copy the values from the states that's passed in.<br/>**/<br/>    case constants.MODIFY_NAME:<br/>       return {<br/>         ...state, <br/>         name:action.payload.name<br/>      }<br/>     case constants.SAVE_NAME:<br/>       return {<br/>           ...state, <br/>           isSaved:!state.isSaved<br/>       }<br/>   }<br/>}<br/>export default name;</span></pre><p id="21b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意<strong class="it hv">常量。修改名称</strong>和<strong class="it hv">常量。SAVE_NAME </strong>正是我们在type字段中的操作所返回的内容。这就是你让减速器知道正在发生什么动作的方式。</p><p id="d04f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在来定义我们的【智能】组件<strong class="it hv">。实际上，这意味着这是定义动作调用的组件。</strong></p><pre class="ku kv kw kx fq lb lc ld le aw lf dt"><span id="f5a1" class="lg jr hu lc b fv lh li l lj lk">/**<br/> * The home page for the app<br/> */<br/>‘use strict’;<br/>import React, { Component } from ‘react’;</span><span id="8c8c" class="lg jr hu lc b fv mi li l lj lk">import { connect } from ‘react-redux’;</span><span id="c229" class="lg jr hu lc b fv mi li l lj lk">import Name from ‘./presentational/Name’;</span><span id="b949" class="lg jr hu lc b fv mi li l lj lk">import * as actions from ‘./actions/name’;</span><span id="0fd1" class="lg jr hu lc b fv mi li l lj lk">/**<br/>Both the actual values (name and isSaved) as well as the function to call those actions are passed in as props.**/<br/>class NameContainer extends Component {<br/> render() {<br/>   return (<br/>    &lt;Name <br/>      name = {this.props.name}<br/>      isSaved = {this.props.isSaved}<br/>      modifyName = {this.props.modifyName}<br/>      saveName = {this.props.saveName}<br/>     /&gt;<br/>   );<br/> }<br/>}</span><span id="a5c3" class="lg jr hu lc b fv mi li l lj lk">/**<br/>All this does is get the values that are saved in the reducer, and return it to the component so that we can call them using this.props<br/>**/<br/>const mapStateToProps = (state,ownProps) =&gt;{<br/>/**<br/>using REDUX stores, it allows us to just access the reducer values       by going state.name. Notice how name is what is being exported in    the reducer above<br/>**/<br/>const { name, isSaved } = state.name;<br/> return {name,isSaved };<br/>}</span><span id="7b9a" class="lg jr hu lc b fv mi li l lj lk">/**<br/>In mapStateToProps we were mapping the state variables as properties to pass into our presentational component. In mapDispatchToProps we are mapping the action functions to our container to be able to pass it into our presentational component.<br/>**/<br/>const mapDispatchToProps = (dispatch) =&gt; {<br/> return {<br/> modifyName:(name)=&gt;{<br/>  dispatch(actions.modifyName(name))<br/> },<br/> saveName:()=&gt;{<br/> dispatch(actions.saveName())<br/> },<br/>}</span><span id="1803" class="lg jr hu lc b fv mi li l lj lk">/**<br/>This is the reason we are able to pass in the functions and variables as props to our container. It's the connect function from the react-redux library that does all the magic.<br/>**/<br/>export default connect(mapStateToProps,mapDispatchToProps)(NameContainer);</span></pre><p id="8a23" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在是最简单的部分。您创建了用户将与之交互的表示组件(MVC中的V)。</p><pre class="ku kv kw kx fq lb lc ld le aw lf dt"><span id="7f1c" class="lg jr hu lc b fv lh li l lj lk">/**<br/> * the dumb component which will use the props passed in from the smart component based on a user's actions<br/> */<br/>‘use strict’;<br/>import React, { Component } from ‘react’;<br/>import {Text,TextInput, TouchableOpacity} from ‘react-native’;<br/>import { Actions, ActionConst } from ‘react-native-router-flux’;</span><span id="09c3" class="lg jr hu lc b fv mi li l lj lk">class Name extends Component</span><span id="5301" class="lg jr hu lc b fv mi li l lj lk">render() {<br/> return (<br/> &lt;View&gt;<br/><br/> &lt;TextInput<br/> multiline={false}<br/> //from the component above<br/> value={this.props.name}<br/> placeholder=”Full Name”<br/> //from the component above<br/> onChangeText={(name)=&gt;this.props.modifyName(name)}<br/> /&gt;<br/> <br/>  &lt;TouchableOpacity onPress= {()=&gt;{this.props.saveName()}&gt;<br/>     &lt;Text&gt;Save&lt;/Text&gt;<br/>  &lt;/TouchableOpacity&gt;<br/> &lt;/View&gt;<br/> );<br/> }<br/>}</span><span id="f705" class="lg jr hu lc b fv mi li l lj lk">export default Name;</span></pre><p id="4c59" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！您仍然需要做一些基本的样板设置工作，但是我希望这能让您明白如何在redux中思考。</p><p id="95fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这让我困惑了一会儿(例如，什么信息在哪里以及如何传递…)，所以我希望能为你们节省一些时间和痛苦。</p><p id="a688" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想提高你的编码技能，我正在整理一本剧本，包括:</p><p id="93de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1.30多种常见的代码气味&amp;如何解决它们</p><p id="fd56" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1.15+设计模式实践&amp;如何应用它们</p><p id="aca3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1.20多个常见的JS错误&amp;如何防止它们</p><p id="9a3f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">提前获得我的<a class="ae jp" href="https://javascriptplaybook.com" rel="noopener ugc nofollow" target="_blank"> javascript剧本</a>。</p><div class="ku kv kw kx fq ab cb"><figure class="mj ky mk ml mm mn mo paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mj ky mk ml mm mn mo paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mj ky mk ml mm mn mo paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="fe ff mp"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="mu mv l"/></div></figure></div></div>    
</body>
</html>