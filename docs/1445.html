<html>
<head>
<title>How I accidentally deleted all my Python modules and got it back in 20 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何不小心删除了我所有的Python模块，并在20分钟内恢复了它</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-i-accidentally-deleted-all-my-python-modules-and-got-it-back-in-20-minutes-356f22349c5e?source=collection_archive---------0-----------------------#2016-10-30">https://medium.com/hackernoon/how-i-accidentally-deleted-all-my-python-modules-and-got-it-back-in-20-minutes-356f22349c5e?source=collection_archive---------0-----------------------#2016-10-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="7057" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今天我很粗心，这给我带来了一些麻烦。我正在开发一个Flask web应用程序，由于我的懒惰，没有使用virtualenv。我只是想尽快在Heroku上建立一个运行的原型。为了将你的应用程序部署到Heroku，你必须将requirements.txt放到应用程序的目录中。没有美德</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="938b" class="jy jz hu ju b fv ka kb l kc kd">pip freeze &gt; requirements.txt</span></pre><p id="a35a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因为它将所有全局安装的模块放入其中。在谷歌中搜索解决方案40秒后，我找到了声称能帮我解决问题的pip-tools。下载之后，我快速浏览了一下README的用法信息，但是那次我不仅仅是<em class="kf">粗心</em>，我也是<em class="kf">愚蠢</em>，因为它清楚地说明了这一点</p><blockquote class="kg kh ki"><p id="5f5a" class="ir is kf it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">“现在您有了requirements.txt，您可以使用pip-sync来更新您的虚拟env，以准确反映其中的内容。注意:这将安装/升级/卸载与requirements.txt内容匹配的所有必要内容。</p></blockquote><p id="edce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我注意力不够，跑了pip-sync。由于缺乏virtualenv，它将我的requirements.txt(只有3个包)与我全球安装的Python模块同步。是的，<em class="kf">它卸载了一切</em>。我的终端里只有这个日志:</p><figure class="jp jq jr js fq kn fe ff paragraph-image"><div class="fe ff km"><img src="../Images/4ba830813a5f1bc0e820c50026e0337e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*bPa63Ks2S01FeFb2dJE1xQ.png"/></div></figure><p id="944e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我对自己的错误感到愤怒，但我需要一个解决方案。在谷歌搜索了一堆之后，我发现没有人会傻到不小心删除他们所有的Python模块，所以我不得不自己想出一些东西，以下是我所做的:</p><ul class=""><li id="586e" class="kq kr hu it b iu iv iy iz jc ks jg kt jk ku jo kv kw kx ky dt translated">从我的终端复制日志，并将其作为多行字符串粘贴到python脚本中</li><li id="5b48" class="kq kr hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">使用vim搜索和替换从日志中删除所有冗余信息</li><li id="ba8c" class="kq kr hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">拆分新创建的字符串(仅包含模块名)</li><li id="6efb" class="kq kr hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">在列表上写了一个for循环，并运行了下面一行:</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="7282" class="jy jz hu ju b fv ka kb l kc kd">subprocess.call(‘sudo pip install %s’ % package_name, shell True)</span></pre><p id="a3a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几乎成功了！唯一的问题是pip需要预先安装一些包，比如<em class="kf"> appdirs </em>、<em class="kf">打包</em>和<em class="kf"> pyparsing </em>。在从我的发行版的仓库中安装了这些之后，我的脚本就像预期的那样工作了，并且安装了所有的东西。</p><h1 id="53ad" class="le jz hu bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma dt translated">这个故事的寓意是:</h1><ul class=""><li id="6539" class="kq kr hu it b iu mb iy mc jc md jg me jk mf jo kv kw kx ky dt translated"><strong class="it hv">别傻了(一直用virtualenv) </strong></li><li id="77f9" class="kq kr hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">如果你很笨，也许你可以用一个聪明的主意来弥补</li></ul><blockquote class="kg kh ki"><p id="fc4d" class="ir is kf it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">黑客中午是黑客如何开始他们的下午。我们是这个家庭的一员。我们现在<a class="ae ke" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ke" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is kf it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">要了解更多信息，<a class="ae ke" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">请阅读我们的“关于”页面</a> , <a class="ae ke" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">喜欢/在脸书给我们发消息</a>，或者简单地，<a class="ae ke" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank">发推文/DM @HackerNoon。</a></p><p id="708a" class="ir is kf it b iu iv iw ix iy iz ja jb kj jd je jf kk jh ji jj kl jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ke" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ke" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>