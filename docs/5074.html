<html>
<head>
<title>A guide to TDD a React/Redux TodoList App — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TDD a React/Redux TodoList应用程序指南—第3部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-guide-to-tdd-a-react-redux-todolist-app-part-3-f25c2289c54?source=collection_archive---------4-----------------------#2017-07-09">https://medium.com/hackernoon/a-guide-to-tdd-a-react-redux-todolist-app-part-3-f25c2289c54?source=collection_archive---------4-----------------------#2017-07-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="be6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@sanjsanj/a-guide-to-tdd-a-react-redux-todolist-app-part-1-b8a200bb7091">第1部分—链接</a>。</p><p id="8f4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@sanjsanj/a-guide-to-tdd-a-react-redux-todolist-app-part-2-8d4cb2dc154c">第二部分——链接</a>。</p><p id="0b8f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">第三部分——你现在在这里。</p><p id="5ad2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@sanjsanj/a-guide-to-tdd-a-react-redux-todolist-app-part-4-edb62e113c9b">第4部分—链接</a>。</p><h1 id="114d" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">Redux</h1><p id="aca0" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated"><em class="kt">我过于简化的解释是；UI元素调度动作，该动作是仅包含相关信息的对象，该动作被发送到缩减器，缩减器接收应用和动作的当前状态并返回新状态，UI订阅该状态，并在所述状态改变时有效地更新。</em></p><p id="f0d5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们正在谈论<a class="ae jp" href="https://hackernoon.com/tagged/redux" rel="noopener ugc nofollow" target="_blank"> Redux </a>，基于Flux架构，<a class="ae jp" href="https://code-cartoons.com/a-cartoon-intro-to-redux-3afb775501a6" rel="noopener ugc nofollow" target="_blank">这里有一个非常好的解释</a>，如果你还不熟悉的话可以读一下。</p><h1 id="04e9" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">submitTodo操作</h1><p id="bf8b" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我们将使用一个<code class="eh ku kv kw kx b">constants</code>文件来确保一致性，消除愚蠢的语法错误，并帮助记录我们的代码:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/constants/index.js</figcaption></figure><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/actions/test.js</figcaption></figure><p id="599d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 7</code>因为我们将不止一次地使用一个<code class="eh ku kv kw kx b">todoText</code>，我们也可以在<code class="eh ku kv kw kx b">describe</code>的范围内将它设置为一个常量。</p><p id="7dc3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 10 — 14</code>当我们以<code class="eh ku kv kw kx b">todoText</code>作为参数调用<code class="eh ku kv kw kx b">submitTodo</code>函数时，这是我们期望我们的应用程序调度的动作。这是我们的Redux <code class="eh ku kv kw kx b">reducer</code>为了存储这个todo所需的最低限度；一个<code class="eh ku kv kw kx b">type</code>让缩减器知道这是哪种动作，一个<code class="eh ku kv kw kx b">id</code>让它有一个惟一的标识符，还有todo本身的<code class="eh ku kv kw kx b">text</code>。</p><p id="b9b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 16</code>断言。</p><p id="32b2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">失败的测试告诉我们要构建什么，所以让我们创建动作:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/actions/index.js</figcaption></figure><p id="3490" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 3</code>创建一个可变变量来保存我们的<code class="eh ku kv kw kx b">id</code>。</p><p id="aadc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 5 — 8</code>一个<code class="eh ku kv kw kx b">nextId</code>帮助器方法，它递增<code class="eh ku kv kw kx b">id</code>然后返回它。</p><p id="69ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 11 — 17</code>我们的动作将<code class="eh ku kv kw kx b">text</code>作为参数，并返回一个将被分派给我们的reducer的对象。</p><p id="caef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">仅仅说<code class="eh ku kv kw kx b">text,</code>是<code class="eh ku kv kw kx b">text: text,</code>的简写。</p><p id="abcd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的测试应该通过了。</p><ul class=""><li id="928b" class="lj lk hu it b iu iv iy iz jc ll jg lm jk ln jo lo lp lq lr dt translated"><a class="ae jp" href="https://github.com/sanjsanj/my-react-todolist/commit/5ad7327180b966621f8e7c8bf2255e3ebd482ab2" rel="noopener ugc nofollow" target="_blank"> Git提交</a></li><li id="e5a1" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated"><a class="ae jp" href="https://github.com/sanjsanj/my-react-todolist/tree/5ad7327180b966621f8e7c8bf2255e3ebd482ab2" rel="noopener ugc nofollow" target="_blank">储存库的状态</a></li></ul><h1 id="8168" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">submitTodo缩减程序</h1><p id="b154" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">这是我们基于动作存储和返回新状态的地方。首先，我们可以测试它在实例化时返回一个<code class="eh ku kv kw kx b">initialState</code>:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/reducers/test.js</figcaption></figure><p id="5656" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 3</code>我们导入<code class="eh ku kv kw kx b">reducer</code>本身和它的<code class="eh ku kv kw kx b">initialState</code>变量。</p><p id="1559" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 7</code>断言当我们在没有状态和空动作的情况下调用<code class="eh ku kv kw kx b">reducer</code>时，它会正确地返回我们期望的<code class="eh ku kv kw kx b">initialState</code>。</p><p id="5a52" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们通过测试:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/reducers/index.js</figcaption></figure><p id="6dec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 1</code>从该文件中导出一个<code class="eh ku kv kw kx b">initialState</code>模块。</p><p id="d3e0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 3</code>导出<code class="eh ku kv kw kx b">reducer</code>，这是一个以<code class="eh ku kv kw kx b">state</code>(默认为<code class="eh ku kv kw kx b">initialState</code>)和<code class="eh ku kv kw kx b">action</code>为参数，简单返回<code class="eh ku kv kw kx b">state</code>的函数。当这个归约器返回新的状态时，Redux将跟踪它，并在将来的归约中使用所述新状态。</p><p id="4d0a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 5</code>导入该文件时，默认导出<code class="eh ku kv kw kx b">reducer</code>。</p><p id="b233" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在让我们测试它能否接收我们的<code class="eh ku kv kw kx b">submitTodo</code>动作并返回一个新的正确状态:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/reducers/test.js</figcaption></figure><p id="35aa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 3</code>导入我们的<code class="eh ku kv kw kx b">types</code>常量。</p><p id="8e90" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 7</code>设置一个<code class="eh ku kv kw kx b">todoText</code>变量来帮助断言一致性。</p><p id="c435" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 15 — 19</code>设置我们希望传递给减速器的动作。</p><p id="cbfc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 21 — 28</code>设置预期回报<code class="eh ku kv kw kx b">state</code>，包含一个数组<code class="eh ku kv kw kx b">todos</code>，其中链接了我们全新的todo。</p><figure class="ky kz la lb fq lc fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff lx"><img src="../Images/82aa7730d4ba01c1bdc4a208ddf6c429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_f0ZA-4cM-3JXG4Kyetwg.png"/></div></div></figure><p id="5317" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的测试向我们展示了什么是错误的，我们期望返回一个新的状态以及我们已经提交的todo，但是我们仍然只是得到一个空的<code class="eh ku kv kw kx b">initialState</code>对象。所以让我们来解决它:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/reducers/index.js</figcaption></figure><p id="1055" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 1</code>导入<code class="eh ku kv kw kx b">types</code>模块给我们我们的<code class="eh ku kv kw kx b">constants</code>。</p><p id="e2a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 3 — 5</code>更改我们的<code class="eh ku kv kw kx b">initialState</code>以包含一个<code class="eh ku kv kw kx b">todos</code>键，它在实例化时是一个空数组。这将以todo对象的数组结束。</p><p id="2cfd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 7</code>我们已经重构了我们的reducer，使之成为一个不仅仅返回<code class="eh ku kv kw kx b">initialState</code>的函数。</p><p id="b721" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 8</code>我们使用标准的<code class="eh ku kv kw kx b">switch</code>语句返回基于<code class="eh ku kv kw kx b">action.type</code>的新计算状态。</p><p id="92be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 10 — 11</code>在我们的动作类型是“<code class="eh ku kv kw kx b">SUBMIT_TODO</code>的情况下，我们返回这个状态的对象表示。</p><p id="1857" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 12 — 19</code>这种语法的要旨是；我们希望从返回任何存在的东西开始，然后重写我们想要添加、删除或更改的新东西。</p><p id="a278" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 12</code>返回解包状态，即状态的所有内容，包括空的<code class="eh ku kv kw kx b">todos</code>数组。</p><p id="43fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 13</code>用这个数组覆盖<code class="eh ku kv kw kx b">todos</code>键。</p><p id="ed67" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 14</code>这个数组包含我们当前状态的<code class="eh ku kv kw kx b">todos</code>数组碰巧包含的任何内容，无论是什么都不是还是几十个todo对象。</p><p id="98bb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 15 — 18</code>现在添加一个新的对象到这个数组，给它一个我们传入的<code class="eh ku kv kw kx b">action.id</code>的<code class="eh ku kv kw kx b">id</code>，给它一个我们传入的<code class="eh ku kv kw kx b">action.text</code>的<code class="eh ku kv kw kx b">text</code>。</p><p id="2a27" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，我们刚刚返回了一个新的状态表示，它包含现有的状态和我们刚刚提交的新todo。希望这有意义。</p><p id="946e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果没有我们可以处理的<code class="eh ku kv kw kx b">action.type</code>存在，我们的减速器的默认返回只是现有的状态。</p><figure class="ky kz la lb fq lc fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff lx"><img src="../Images/e62468740acc8c1115636da2d6b6701f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSCfCOD0TN1CGJkFk6Uxmw.png"/></div></div></figure><p id="416b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们的减速器单元测试现在通过了。所以从技术上来说，我们的代码现在知道如何向状态添加一个todo，现在我们只需要设置Redux，并通过我们的<code class="eh ku kv kw kx b">App</code>组件将事情连接起来。</p><ul class=""><li id="bf08" class="lj lk hu it b iu iv iy iz jc ll jg lm jk ln jo lo lp lq lr dt translated"><a class="ae jp" href="https://github.com/sanjsanj/my-react-todolist/commit/6deb88554b92a768331a3bc54a3f90450e9e676f" rel="noopener ugc nofollow" target="_blank"> Git提交</a></li><li id="96e7" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated"><a class="ae jp" href="https://github.com/sanjsanj/my-react-todolist/tree/6deb88554b92a768331a3bc54a3f90450e9e676f" rel="noopener ugc nofollow" target="_blank">储存库的状态</a></li></ul><h1 id="7742" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">布线冗余</h1><p id="6802" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">首先我们需要安装<code class="eh ku kv kw kx b">redux</code>和<code class="eh ku kv kw kx b">react-redux</code>作为依赖项。</p><p id="0815" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">npm install --save redux react-redux</code></p><p id="c851" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">redux</code>与<a class="ae jp" href="https://hackernoon.com/tagged/" rel="noopener ugc nofollow" target="_blank"> React </a>完全分离，只是一种管理状态的方式，是我们应用程序的唯一真实来源。</p><p id="2913" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">react-redux</code>为我们提供了<code class="eh ku kv kw kx b">redux</code>的React绑定。</p><p id="eb01" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们来创建我们的商店:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/store.js</figcaption></figure><p id="3844" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 1</code>从<code class="eh ku kv kw kx b">redux</code>导入<code class="eh ku kv kw kx b">combineReducers</code>和<code class="eh ku kv kw kx b">createStore</code>子模块。</p><p id="cf71" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 2</code>进口我司减速机，可还原商场新状态。</p><p id="6d34" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 4 — 6</code>在这一点上是多余的，因为我们只有一个减速器，但随着我们应用程序的扩展，我们将希望减速器具有可管理的责任，并将使用<code class="eh ku kv kw kx b">combineReducers</code>将其合并为一个供我们的商店使用。</p><p id="3e27" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 8</code>我们默认导出我们的商店。简单。</p><p id="b9f8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/index.js</figcaption></figure><p id="020e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 5</code>从<code class="eh ku kv kw kx b">react-redux</code>导入<code class="eh ku kv kw kx b">Provider</code>模块，它的一个目的是为所有包装的子组件提供存储，在本例中是我们的应用程序及其所有子组件。</p><p id="3c80" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="http://www.sohamkamani.com/blog/2017/03/31/react-redux-connect-explained/" rel="noopener ugc nofollow" target="_blank"> React-redux-connect解释。</a></p><p id="fbb8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 7</code>导入我们上面创建的<code class="eh ku kv kw kx b">store</code>。</p><p id="e0c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 10 — 15</code>我们在这里做了两件事；重构我们的代码，使其更加清晰，并将我们的<code class="eh ku kv kw kx b">App</code>包装在我们的<code class="eh ku kv kw kx b">Provider</code>中，在这里我们传递我们的reducer和redux-store作为<code class="eh ku kv kw kx b">store</code>。</p><p id="6879" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们的渲染方法中为<code class="eh ku kv kw kx b">document</code>元素添加一个eslint异常。</p><p id="4a3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/App.js</figcaption></figure><p id="b4ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">导入<code class="eh ku kv kw kx b">connect</code>，这样我们就可以将redux的必要部分暴露给我们的应用程序。</p><p id="1a01" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">导入我们之前创建的<code class="eh ku kv kw kx b">actions</code>,这样我们就可以在我们的组件中调度它们。</p><p id="1011" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 18</code>顾名思义，我们将在<code class="eh ku kv kw kx b">store.js</code>中创建的状态准备给组件使用的属性。</p><p id="4af8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，我们正在将应用程序中的可分派操作准备为可在组件中使用的属性。</p><p id="279c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 21 — 25</code>我们已经创建了接受<code class="eh ku kv kw kx b">text</code>参数的<code class="eh ku kv kw kx b">submitTodo</code>分派事件，如果不为falsey，它将分派我们的<code class="eh ku kv kw kx b">actions.submitTodo</code>函数。</p><p id="f4ee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 28</code><code class="eh ku kv kw kx b">connect</code>模块现在完成了任务，它给我们的应用程序提供了与状态交互的两种方式；调度操作和订阅状态。另一种解释是:告诉商店如何改变并读取其状态。这现在成为我们从该文件的默认导出。</p><p id="d4d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 3</code>导入<code class="eh ku kv kw kx b">PropTypes</code>进行我们的道具验证。</p><p id="fde4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 14 — 16</code>验证我们即将传入的<code class="eh ku kv kw kx b">submitTodo</code>函数。</p><p id="8bcc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 7</code>我们的<code class="eh ku kv kw kx b">connect</code>已经给了我们访问<code class="eh ku kv kw kx b">submitTodo</code>的权限，所以我们只需将它传递给我们的<code class="eh ku kv kw kx b">App</code>。<em class="kt">注意:我们已经将其更改为非默认导出，连接的应用程序是默认的，但我们仍然会在稍后的测试中公开它。</em></p><p id="b8a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 10</code>然后我们将它传递给需要它的<code class="eh ku kv kw kx b">AddTodo</code>组件。</p><p id="4da2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后更新测试:</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="ld le l"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">src/App.test.js</figcaption></figure><p id="5dec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 5</code>我们不得不从导入<code class="eh ku kv kw kx b">App</code>改为导入<code class="eh ku kv kw kx b">{ App }</code>，因为我们想在不使用整个连接组件的情况下单独测试这个组件，这需要我们传入一个<code class="eh ku kv kw kx b">Provider</code>和<code class="eh ku kv kw kx b">store</code>。</p><p id="85f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 6</code>引入<code class="eh ku kv kw kx b">initialState</code>作为我们应用的状态。</p><p id="a721" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 9</code>为<code class="eh ku kv kw kx b">submitTodo</code>创建一个模拟函数。</p><p id="7f2b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">Line 11 — 15</code>稍微重构一下，让代码可读性更强，更容易扩展，然后消耗<code class="eh ku kv kw kx b">state</code>和<code class="eh ku kv kw kx b">submitTodo</code>。</p><p id="ca4e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面对<a class="ae jp" href="http://www.sohamkamani.com/blog/2017/03/31/react-redux-connect-explained/" rel="noopener ugc nofollow" target="_blank"> redux和connect </a>做一个清晰简洁的解释。</p><p id="fc83" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可能还会发现<a class="ae jp" href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#api" rel="noopener ugc nofollow" target="_blank"> react-redux API文档</a>非常有用，并且会惊讶于它是如此的小和简单。</p><p id="35b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们还没有显示我们的待办事项，但它们实际上可以通过用户界面输入并存储在状态中。抓取<a class="ae jp" href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en" rel="noopener ugc nofollow" target="_blank"> Chrome React devtools扩展</a>，输入一个todo，然后点击提交。</p><p id="95ee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在去商店看看，看到它出现了:</p><figure class="ky kz la lb fq lc fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff me"><img src="../Images/e5f44fbb47d67d9f10f89a83dc09034a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IFtxA3Ei4TZxa6_EFpOdQg.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Storing a todo in state</figcaption></figure><ul class=""><li id="4c65" class="lj lk hu it b iu iv iy iz jc ll jg lm jk ln jo lo lp lq lr dt translated"><a class="ae jp" href="https://github.com/sanjsanj/my-react-todolist/commit/65c21c74199bf3e1c1f96932cc231578fc16585b" rel="noopener ugc nofollow" target="_blank"> Git提交</a>。</li><li id="e278" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated"><a class="ae jp" href="https://github.com/sanjsanj/my-react-todolist/tree/65c21c74199bf3e1c1f96932cc231578fc16585b" rel="noopener ugc nofollow" target="_blank">储存库的状态</a>。</li></ul><h1 id="3046" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">概述</h1><p id="e38e" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我们已经学会了如何:</p><ul class=""><li id="890f" class="lj lk hu it b iu iv iy iz jc ll jg lm jk ln jo lo lp lq lr dt translated">试驾行动的创建。</li><li id="4081" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated">减速器的试驾创作。</li><li id="da66" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated">将Redux连接到我们的应用程序，这样它就可以调度事件和订阅状态。</li></ul><h1 id="f834" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">下一个</h1><p id="3d90" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">让我们开始充分利用订阅state的能力，并开始展示一些待办事项吧！</p><p id="3c61" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@sanjsanj/a-guide-to-tdd-a-react-redux-todolist-app-part-1-b8a200bb7091">第1部分—链接</a>。</p><p id="4ccd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@sanjsanj/a-guide-to-tdd-a-react-redux-todolist-app-part-2-8d4cb2dc154c">第2部分—链接</a>。</p><p id="6ac4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">第三部分——你现在在这里。</p><p id="4833" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" rel="noopener" href="/@sanjsanj/a-guide-to-tdd-a-react-redux-todolist-app-part-4-edb62e113c9b">第4部分—链接</a>。</p><figure class="ky kz la lb fq lc"><div class="bz el l di"><div class="mf le l"/></div></figure></div></div>    
</body>
</html>