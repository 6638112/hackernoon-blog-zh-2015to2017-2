<html>
<head>
<title>/usr/bin/time: not the command you think you know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">/usr/bin/time:不是您认为自己知道的命令</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/usr-bin-time-not-the-command-you-think-you-know-34ac03e55cc3?source=collection_archive---------0-----------------------#2017-03-06">https://medium.com/hackernoon/usr-bin-time-not-the-command-you-think-you-know-34ac03e55cc3?source=collection_archive---------0-----------------------#2017-03-06</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="60cc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">[编辑:查看reddit上令人敬畏的评论,这些评论补充并纠正了以下内容]</p><p id="7561" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">打开一个终端。运行'<em class="jq">类型</em><a class="ae jp" href="https://hackernoon.com/tagged/time" rel="noopener ugc nofollow" target="_blank">T5】时间 </a>'。你会被告知“<em class="jq">时间是一个shell关键字</em>”。现在运行'<em class="jq"> which time' </em>，你会看到'<em class="jq"> /usr/bin/time </em>'，看起来像是一个二进制的路径。它们是一回事吗？<strong class="it hv">没有</strong>。事实上，其中一个可以给你很多有趣的信息，而另一个却不能。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff jr"><img src="../Images/789f0d61172489e1d01436f711117b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*P_sw5ECNl-MeoXiEstzuig.png"/></div></figure><p id="caef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">试试“男人时间”。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff jz"><img src="../Images/a0c4aa38c9b61db39c758b5da78684b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NA1i-vdHMH3v-AuCZx9jHg.png"/></div></div></figure><p id="36e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">哼，你知道<em class="jq">时间</em>有选择权吗？</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff ke"><img src="../Images/d3a5ca66407acc3677bbf8815f71eac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OE5Ebqu4To44wT3oRe1BTw.png"/></div></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">You’ll see different options on Linux, by the way, but it has the same basic functionality</figcaption></figure><p id="930c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我不知道这些是什么意思，但它们可能不会删除我在<strong class="it hv"> ~/Downloads </strong>中的盗版Hamilton shakycam录音，所以让我们试试其中一个:</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff kj"><img src="../Images/bb223f72a1e55fd2f6637243bb0cf35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92jpj7QNmuhaeXXFX7ABsQ.png"/></div></div></figure><p id="29ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我期待更令人兴奋的东西。让我们更仔细地阅读一下手册页:</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff kk"><img src="../Images/db9208fa3e59cd60d1188f584c890ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BpdrgSCPQuD4-0nGxElV9Q.png"/></div></div></figure><p id="1136" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">啊哈，也许这只是一个狂欢。让我们试试zsh，它基于GitHub上的明星数量，看起来更像是<a class="ae jp" href="http://www.mongodb-is-web-scale.com/" rel="noopener ugc nofollow" target="_blank">网络规模</a>。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff kl"><img src="../Images/5125ec22b45ad123f676be7bea1f3fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mahQcRdqOEzVC1qU505qKg.png"/></div></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">They actually have pretty top-notch night vision</figcaption></figure><p id="6b3a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">没有骰子！最后一次尝试:鱼，单源固定齿轮壳的选择。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff km"><img src="../Images/feecf7b186de8fc1e56afc3a80d10896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHOP_7SuC24u32Iphkz1gQ.png"/></div></div></figure><p id="1dfe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">天哪，那确实是许多信息。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/2aa3073a08fcb2553e135335183d67b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*yvhJEiDsEG6xFs7qk0gMPw.png"/></div></figure><p id="93ff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以，这些年来我一直使用的'<em class="jq"> time </em> ' <a class="ae jp" href="https://hackernoon.com/tagged/command" rel="noopener ugc nofollow" target="_blank"> command </a>实际上并不是手册页中描述的那个。我想知道为什么bash和zsh有时间作为内置？但是在我深入研究之前，让我们来看看时间能告诉我们什么。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff ko"><img src="../Images/0406c2ec387620aa83c3e6e56327f16b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QBkWDCGi-PAhv77Yp8q6EA.png"/></div></div></figure><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff kp"><img src="../Images/81f6d34ee0bb8f72633cf4b6a95b6055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*DhGlrDtrTI8ZhkHnrZYM8Q.png"/></div></figure><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff kq"><img src="../Images/0066b7e051ef669f66540d96cb526a50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*crVmvkb8AfXriW2-KLVD7w.png"/></div></div></figure><p id="d731" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">getrusage(一个系统调用)的<a class="ae jp" href="http://www.manpages.info/macosx/getrusage.2.html" rel="noopener ugc nofollow" target="_blank">手册页</a>详细描述了'<em class="jq"> time -l </em>'输出的每一位。例如</p><blockquote class="kr ks kt"><p id="f5a3" class="ir is jq it b iu iv iw ix iy iz ja jb ku jd je jf kv jh ji jj kw jl jm jn jo hn dt translated"><em class="hu">ru</em>T34】_T36】in block:文件系统必须执行输入的次数</p></blockquote><p id="2104" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我阅读410千磅的PDF文件时:</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff kx"><img src="../Images/154e3b1b7d91deb71b983561c93ba8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YP9W2MPj5-SxWsumMb9tzA.png"/></div></div></figure><p id="a63d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它做了一个“块输入操作”，所以它从我的SSD中一次性读取了所有内容。我用一个120MB的JSON文件试了一下，也是一次操作就搞定了。有意思。</p><p id="7212" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">自愿的上下文切换怎么样？</p><blockquote class="kr ks kt"><p id="e50b" class="ir is jq it b iu iv iw ix iy iz ja jb ku jd je jf kv jh ji jj kw jl jm jn jo hn dt translated">由于进程在其时间片完成之前自愿放弃处理器而导致的上下文切换的次数(通常是为了等待资源的可用性)。</p></blockquote><p id="5fd7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，这就是当<em class="jq"> wc </em>试图从磁盘中读取文件，但被内核告知等待，要么是因为磁盘正被其他人使用，要么是它仍在试图执行其操作(例如，如果进程消耗输入的速度快于磁盘吐出的速度)。</p><p id="57fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这在小PDF中根本不会发生，但在120MB的JSON文件中会发生三次。</p><p id="a078" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">占据我们从<em class="jq"/><a class="ae jp" href="https://utcc.utoronto.ca/~cks/space/blog/unix/UnderstandingRSS" rel="noopener ugc nofollow" target="_blank">得到的统计数据头条的“常驻集大小”很复杂</a>，但是你可以把它看作是进程在峰值时使用了多少内存的度量，以字节为单位。</p><p id="77e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想知道，在大文件或小文件上运行<em class="jq"> wc </em>在内存使用上几乎没有任何区别。这是有意义的，因为当它在一个文件中流动时，<em class="jq"> wc </em>唯一需要保存的东西是一些小的计数器(字符、行等)。)，以及文件在其缓冲区中的任何部分。</p><p id="0a44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">无论如何，你有它。<em class="jq">时间</em>不是你想象的<em class="jq">时间</em>，如果你想知道你的程序是如何处理IO的，或者它使用了多少内存，试试<em class="jq"> /usr/bin/time -l </em>。</p><div class="js jt ju jv fq ab cb"><figure class="ky jw kz la lb lc ld paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ky jw kz la lb lc ld paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ky jw kz la lb lc ld paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="kr ks kt"><p id="f922" class="ir is jq it b iu iv iw ix iy iz ja jb ku jd je jf kv jh ji jj kw jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是AMI家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jq it b iu iv iw ix iy iz ja jb ku jd je jf kv jh ji jj kw jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff le"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="lf lg l"/></div></figure></div></div>    
</body>
</html>