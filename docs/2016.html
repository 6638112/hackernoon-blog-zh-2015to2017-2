<html>
<head>
<title>My Alexa Skill with Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的Alexa存储技能</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/my-alexa-skill-with-storage-5adb1d097b88?source=collection_archive---------2-----------------------#2017-01-02">https://medium.com/hackernoon/my-alexa-skill-with-storage-5adb1d097b88?source=collection_archive---------2-----------------------#2017-01-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e99c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我最近写了关于我第一次尝试编写Alexa自定义技能的文章。我的下一步是扩展我非常简单的技能，以获得一些存储。</p><p id="70d7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">目前，我的自定义技能只是读取当前在房子里的人的列表——并且这个列表是硬编码的。我想更新它，这样它就可以从数据库中读取人名列表。</p><h1 id="319b" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">什么储藏室？</h1><p id="d51f" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我自然倾向于将我的信息存储在RDS下运行的PostgreSQL数据库中。但是我很确定我已经过了AWS的免费年，所以我被DynamoDB吸引了，因为少量的使用是无限期免费的。我以前从未使用过迪纳摩，但现在似乎是一个学习的好时机！</p><h1 id="9d36" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">创建表格</h1><p id="f8c4" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">设置我的姓名表并添加几个条目非常简单。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff kt"><img src="../Images/f395f7ac670ccf938a88a3ec3f47b799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7KBQTikgLG4CXwQwZK0DuQ.png"/></div></div></figure><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff lf"><img src="../Images/3b0993df3dfc77af789ab66c29a9e263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLmlBS0T42RKB2VKyEtpNg.png"/></div></div></figure><h1 id="e55f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">从表中读取名称的Python代码</h1><p id="f402" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我在亚马逊文档中找到了一些使用DynamoDB和Python的<a class="ae jp" href="http://docs.aws.amazon.com/amazondynamodb/latest/gettingstartedguide/GettingStarted.Python.04.html" rel="noopener ugc nofollow" target="_blank">样本代码</a>。以此为起点，我编写了以下代码，从我的DynamoDB表中读取姓名列表，并将其作为字符串返回。</p><pre class="ku kv kw kx fq lg lh li lj aw lk dt"><span id="d5d4" class="ll jr hu lh b fv lm ln l lo lp">def get_names():<br/>    names = ""</span><span id="1509" class="ll jr hu lh b fv lq ln l lo lp">    dynamodb = boto3.resource('dynamodb', region_name='eu-west-1')<br/>    table = dynamodb.Table('WhoIsInTheHouse')</span><span id="cf6c" class="ll jr hu lh b fv lq ln l lo lp">    response = table.scan()</span><span id="1fb9" class="ll jr hu lh b fv lq ln l lo lp">    nameCount == len(response['Items'])<br/>    for idx, item in enumerate(response['Items']):<br/>        names += item['NameId']<br/>        if idx == nameCount - 2:<br/>            names += " and "<br/>        else if idx != nameCount - 1:<br/>            names += ", "</span><span id="2f9d" class="ll jr hu lh b fv lq ln l lo lp">    return names</span></pre><p id="b0cd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">示例代码将localhost上的一个端点指定为<em class="lr"> boto3.resource </em>调用中的一个参数，因为它使用了本地运行的Dynamo实例，但是如果您在AWS上运行DynamoDB，您可以简单地忽略这个端点。您确实需要获得正确的region_name参数。</p><p id="deed" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想让我说出的名字听起来自然一些，所以我用逗号将它们分开，并用单词“and”将最后两个分开。我更新了几天前写的λ函数<a class="ae jp" href="https://hackernoon.com/my-first-alexa-custom-skill-6a198d385c84#.pnqpr7eyk" rel="noopener ugc nofollow" target="_blank">来使用这个名字列表，而不是之前的硬编码版本。</a></p><pre class="ku kv kw kx fq lg lh li lj aw lk dt"><span id="ca38" class="ll jr hu lh b fv lm ln l lo lp">def get_welcome_response():<br/>    session_attributes = {}<br/>    card_title = "Welcome"<br/>    speech_output = get_names() + " are here in the house."<br/>    should_end_session = True<br/>    return build_response(session_attributes, build_speechlet_response(<br/>        card_title, speech_output, None, should_end_session))</span></pre><h1 id="7599" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">许可</h1><p id="2ffe" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我的Lambda函数需要被允许访问Dynamo表。为了实现这一点，我将AmazonDynamoDBFullAccess策略添加到我的Lambda函数正在使用的IAM角色的托管策略集中(我之前创建了这个角色，并将其命名为<em class="lr"> myAlexaRole </em>)。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff ls"><img src="../Images/f6f58e67b35a114bb62f3e1e1726c169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCcRQYNOcFujxRMtGb7Bow.png"/></div></div></figure><h1 id="53c2" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">测试lambda函数</strong></h1><p id="0fac" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">和以前一样，您可以简单地点击Test按钮来查看函数是否如预期的那样运行。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff lt"><img src="../Images/09f20a14586b53908f2d72531a7b25ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_qv9yRrjkpMUlPjx3CT18w.png"/></div></div></figure><h1 id="2c43" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">连接到Alexa</h1><p id="13fd" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我之前撒了谎——或者至少我没有提到我创建了一个名为<em class="lr"> myStorageLambda </em>的新Lambda函数，而不是编辑原始版本。发布同一个Lambda函数的新版本是可能的，但我现在将跳过它。</p><p id="c720" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我不需要从我的Alexa技能中获得任何新的东西，但我只需要通过配置它使用ARN来更新它以指向<em class="lr"> myStorageLambda </em>。</p><h1 id="dc4f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">有用！</h1><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="lu lv l"/></div></figure><h1 id="0ca5" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">当我写这篇文章的时候…</h1><p id="801e" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">…我们开着电视作为背景，Alexa第一次把他们说的话误认为是对她的指示。我不知道他们到底说了什么，但我很确定她听到的不是那样…</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff lw"><img src="../Images/01b48c0b6501a390b2e2f344d41f01d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcAiCxIE54CG5IXH-ZCPEg.png"/></div></div></figure><h1 id="5978" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">下一步是什么？</h1><p id="0f00" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">接下来，我想改变lambda函数并添加一些更多的意图，以便我们可以让Alexa知道人们何时进入或离开房子，而不用直接修改Dynamo表。</p><p id="9661" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我打算把代码发布到GitHub上，但是我还没有找到时间。你会觉得有用吗？请在回复中告诉我。</p></div><div class="ab cl lx ly hc lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hn ho hp hq hr"><p id="f46d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢这篇文章，请点击推荐按钮，这样其他人可能会更容易找到它，并编写自己的Alexa技能或将DynamoDB整合到他们的Lambda函数中。</p><p id="1cea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">接下来——这是我的Alexa之旅的第三部分</strong><a class="ae jp" href="https://hackernoon.com/alexa-skills-and-intents-be8886645ff#.abjipg9j6" rel="noopener ugc nofollow" target="_blank"><strong class="it hv"/></a><strong class="it hv">，我在这里添加了对话意图</strong></p><div class="ku kv kw kx fq ab cb"><figure class="me ky mf mg mh mi mj paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="me ky mf mg mh mi mj paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="me ky mf mg mh mi mj paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mk ml mm"><p id="f922" class="ir is lr it b iu iv iw ix iy iz ja jb mn jd je jf mo jh ji jj mp jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is lr it b iu iv iw ix iy iz ja jb mn jd je jf mo jh ji jj mp jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff mq"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>