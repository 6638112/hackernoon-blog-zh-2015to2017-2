<html>
<head>
<title>Abstracting mongoose CRUD operations into a shared file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将mongoose CRUD操作抽象成一个共享文件</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/abstracting-mongoose-crud-operations-into-a-shared-file-34374f847f4a?source=collection_archive---------10-----------------------#2017-10-28">https://medium.com/hackernoon/abstracting-mongoose-crud-operations-into-a-shared-file-34374f847f4a?source=collection_archive---------10-----------------------#2017-10-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="a91f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当用<a class="ae jp" href="https://hackernoon.com/tagged/node" rel="noopener ugc nofollow" target="_blank">节点</a>构建一个<a class="ae jp" href="https://hackernoon.com/tagged/api" rel="noopener ugc nofollow" target="_blank"> API </a>时，Express和MongoDB你可以选择Mongoose作为你的ODM。猫鼬帮助你轻松地做CRUD操作。当您的API增长时，通常模型的数量会增长，因此快速路线的数量也会增长。在很多情况下，这些路由只做简单的创建、读取、更新或删除操作。如果这些路由不包含任何其他逻辑，那么如果我们能够将请求转发给一个可重用的共享函数来处理该请求就好了，对吗？</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/a12811bc6a23a5cf0a76a551879190ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ep7PUIzOJYA_BJLz2aoMEg.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">by <a class="ae jp" href="https://unsplash.com/@matteocatanese" rel="noopener ugc nofollow" target="_blank">Matteo Catanese</a> on <a class="ae jp" href="https://unsplash.com/photos/PI8Hk-3ZcCU" rel="noopener ugc nofollow" target="_blank">unsplash</a></figcaption></figure><p id="de2f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">嗯，是的！抽象出简单的逻辑有助于加速开发过程，提高可维护性，并减少潜在的错误或缺陷。假设我们正在开发一个应用程序，让您和您的同事管理他们的午餐订单。为了得到一个订单，如果我们写出所有的逻辑，<code class="eh kg kh ki kj b">GET</code>路线可能看起来像这样:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><p id="2ab6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这本身就很好。但是除了<code class="eh kg kh ki kj b">model.Order</code>之外，如果我们创建一个<code class="eh kg kh ki kj b">GET</code>路由来获取您可以为午餐订购的特定项目，并且如果我们创建一个<code class="eh kg kh ki kj b">GET</code>路由来检索特定用户，那么这个路由将是相同的。每次为每条路线写出这段代码是可行的，但是不太容易维护。解决这个问题的一个方法是将这个逻辑移到应用程序中的更高层次，将其抽象一点，然后使其对于需要上述逻辑的每个<code class="eh kg kh ki kj b">GET</code>路线都是可导入的。抽象的逻辑可能如下所示:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><p id="7364" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">既然我们已经抽象了逻辑，我们可以在我们的<code class="eh kg kh ki kj b">GET</code>路线中使用它，如下所示:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><p id="ee16" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们传递<code class="eh kg kh ki kj b">request</code>、<code class="eh kg kh ki kj b">response</code>、<code class="eh kg kh ki kj b">next</code>和<code class="eh kg kh ki kj b">model.Order</code>，其余的由<code class="eh kg kh ki kj b">get</code>函数负责。通过公开这个函数，我们将加速下一个需要简单<code class="eh kg kh ki kj b">GET</code>的路线的开发，并且我们增加了我们的可维护性，因为逻辑只在一个地方。</p><p id="2f58" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在当然有更多的常见操作。让我们看看用于创建新资源的<code class="eh kg kh ki kj b">POST</code>。<code class="eh kg kh ki kj b">POST</code>操作的路线可以是这样的:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><p id="d5a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们再抽象一下:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><p id="4f42" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">像这样使用它:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><p id="3ec0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后我们也可以对<code class="eh kg kh ki kj b">UPDATE</code>做同样的事情。因为我想你现在明白了。以下是<code class="eh kg kh ki kj b">CREATE</code>、<code class="eh kg kh ki kj b">UPDATE</code>、<code class="eh kg kh ki kj b">GET</code>和<code class="eh kg kh ki kj b">DELETE</code>的完整rest.js文件:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kk kl l"/></div></figure><h1 id="1119" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">结论</h1><p id="7e07" class="pw-post-body-paragraph ir is hu it b iu lk iw ix iy ll ja jb jc lm je jf jg ln ji jj jk lo jm jn jo hn dt translated">我们用可重用的助手函数创建了一个rest.js文件，可以处理公共逻辑。您可以根据自己的喜好扩展/更改该文件，并加入诸如填充或查询参数之类的内容。编码快乐！</p></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="3bc7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢阅读。如果你喜欢这篇文章，请点击拍手按钮。有反馈吗？让我知道。也查看我的其他文章:</p><ul class=""><li id="257a" class="lw lx hu it b iu iv iy iz jc ly jg lz jk ma jo mb mc md me dt translated"><a class="ae jp" href="https://hackernoon.com/validating-reactive-forms-with-default-and-custom-form-field-validators-in-angular-5586dc51c4ae" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/validating-reactive-forms-with-default-and-custom-form-field-validators-in-angular-5586 DC 51 C4 AE</a></li><li id="4ddc" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated"><a class="ae jp" href="https://hackernoon.com/manage-your-observable-subscriptions-in-angular-with-help-of-rx-js-f574b590a5cb" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/manage-your-observable-subscriptions-in-angular-help-of-rx-js-f 574 b 590 a5cb</a></li><li id="924c" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated"><a class="ae jp" href="https://hackernoon.com/understanding-creating-and-subscribing-to-observables-in-angular-426dbf0b04a3" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/understanding-creating-and-subscribe-observables-in-angular-426 DBF 0 b 04 a 3</a></li><li id="f2b6" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated"><a class="ae jp" href="https://hackernoon.com/managing-large-s-css-projects-using-the-inverted-triangle-architecture-3c03e4b1e6df" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/managing-large-s-CSS-projects-using-the-inverted-triangle-architecture-3c 03 e 4 B1 e 6 df</a></li><li id="a198" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated"><a class="ae jp" href="https://hackernoon.com/understanding-map-filter-and-reduce-in-javascript-5df1c7eee464" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/understanding-map-filter-and-reduce-in-JavaScript-5 df 1c 7 eee 464</a></li></ul><p id="dd2c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="mk">关注我上</em> <a class="ae jp" rel="noopener" href="/@luukgruijs"> <em class="mk">中</em> </a> <em class="mk">或</em> <a class="ae jp" href="https://twitter.com/luukgruijs" rel="noopener ugc nofollow" target="_blank"> <em class="mk">推特</em> </a> <em class="mk">让我们连线上</em><a class="ae jp" href="https://www.linkedin.com/in/luukgruijs/" rel="noopener ugc nofollow" target="_blank"><em class="mk">LinkedIn</em></a></p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ml kl l"/></div></figure></div></div>    
</body>
</html>