<html>
<head>
<title>From the blockchain of Ethereum through the Digital ocean and to the Google clouds</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从以太坊的区块链到数字海洋，再到谷歌云</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/from-the-blockchain-of-ethereum-through-the-digital-ocean-and-to-the-google-clouds-cf228e5f000f?source=collection_archive---------15-----------------------#2017-04-05">https://medium.com/hackernoon/from-the-blockchain-of-ethereum-through-the-digital-ocean-and-to-the-google-clouds-cf228e5f000f?source=collection_archive---------15-----------------------#2017-04-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="aec4" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">我的设置将智能合同数据推送到网站——可扩展、安全且几乎免费</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/de028b27564f14de51a104ee250541bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWdEyDBNN8L4Jmjlicjzsw.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Blockchain to www</figcaption></figure><h1 id="cb24" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">问题—如何连接我的智能合同和网站</h1><p id="882a" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">百万以太主页及其底层智能合约(一个去中心化的广告平台)的一个关键特征是，所有收入都在推荐人和慈善机构之间分享。这意味着有一种情况，我得到很少或根本没有钱(因为我也只是一个推荐人)。这为我连接智能合约和互联网的基础设施提出了第一个要求——它必须成本非常低或免费。</p><p id="5a1c" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">第二个需求来自于我的主要目标。也就是在媒体上得到尽可能多的宣传。这又意味着平台必须承受非常高且不一致的负载。所以便宜不应该意味着牺牲速度或安全性。</p><p id="04be" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">当然，这个平台必须是用户友好的，开发和维护起来相当简单。</p><p id="a2af" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">换句话说，我需要在廉价、可扩展、安全、简单和用户友好之间取得平衡。</p><h1 id="6aa2" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">解决方案</h1><p id="2e48" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我决定不在我的智能合同上附加任何自定义GUI(至少现在，至少对于<a class="ae ln" href="https://en.wikipedia.org/wiki/Minimum_viable_product" rel="noopener ugc nofollow" target="_blank"> MVP </a>)。由于进入区块链的门槛已经很高，我认为如果我给我的用户提供一个由区块链客户端自动生成的GUI，门槛不会高太多(参见<a class="ae ln" href="https://hackernoon.com/an-entrepreneur-programmer-and-user-walk-into-a-smart-contract-the-ultimate-ethereum-blockchain-7b8dbd0c8463" rel="noopener ugc nofollow" target="_blank">企业家智能合同指南</a>以了解GUI是如何附加的)。这将让我建立超级轻量级和超级简单的网页。网页将只代表智能合同的状态，需要很少的流量。</p><p id="1198" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">百万以太主页是一个1000×1000像素的区域，任何人都可以在这里购买(或出售)像素和放置广告。这意味着我需要在某个地方存储广告图像。为此，我决定使用Imgur.com来进一步减少流量。</p><p id="a8f5" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">根据定义，任何智能合约都是廉价且可扩展的(我努力打造一个安全、简单且用户友好的合约)。反过来，Imgur是一个无限持久的资源(免费、可伸缩、安全等)。).所以现在真正的问题是，如何让我的智能合约与外界互动。或者<strong class="kt hv">如何将数据从以太坊区块链推送到网站</strong>。</p><p id="8193" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我的解决方案包括5个部分:</p><ol class=""><li id="79e8" class="lt lu hu kt b ku lo kx lp la lv le lw li lx lm ly lz ma mb dt translated"><a class="ae ln" href="https://github.com/porobov/MillionEtherHomepage/blob/master/MillionEther.sol" rel="noopener ugc nofollow" target="_blank">智能合约</a>除了业务逻辑和数据库外，还提供UI(无G)</li><li id="81e7" class="lt lu hu kt b ku mc kx md la me le mf li mg lm ly lz ma mb dt translated">【Imgur.com】T2主持人图片</li><li id="7ac3" class="lt lu hu kt b ku mc kx md la me le mf li mg lm ly lz ma mb dt translated"><a class="ae ln" href="https://github.com/ethereum/go-ethereum/wiki/geth" rel="noopener ugc nofollow" target="_blank"> Geth以太坊节点</a> at <a class="ae ln" href="https://www.digitalocean.com/" rel="noopener ugc nofollow" target="_blank">数字海洋</a> droplet提供区块链访问</li><li id="812d" class="lt lu hu kt b ku mc kx md la me le mf li mg lm ly lz ma mb dt translated">Python应用程序(polyether.py)同时执行droplet监听合同、处理数据并将其推送到TheMillionEtherHomepage.com网站</li><li id="0360" class="lt lu hu kt b ku mc kx md la me le mf li mg lm ly lz ma mb dt translated"><a class="ae ln" href="https://appengine.google.com" rel="noopener ugc nofollow" target="_blank">谷歌应用引擎</a>托管网站</li></ol><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mh"><img src="../Images/eca293366e37b8be0ccc84d42a036f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKvYqDoaouZGo5IMtt_dJg.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Pushing smart contract data to www</figcaption></figure><p id="c10f" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">接下来，我将向您展示当用户放置新广告时会发生什么。或者换句话说使用<a class="ae ln" href="https://github.com/porobov/MillionEtherHomepage/blob/master/MillionEther.sol#L287" rel="noopener ugc nofollow" target="_blank"><strong class="kt hv"><em class="mi">place image</em></strong></a>功能的百万智能合约。</p><p id="eeb0" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">像这样的斜体注释显示了我的决策、附加信息和备选方案。</em></p><h1 id="2796" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">它是如何工作的</h1><h2 id="bd0d" class="mj ka hu bd kb mk ml mm kf mn mo mp kj la mq mr kl le ms mt kn li mu mv kp mw dt translated">1.用户上传图像到Imgur</h2><p id="9305" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated"><strong class="kt hv"> <em class="mi"> placeImage </em> </strong>功能的契约需要一个图片链接。所以用户的第一步是得到它——把一个广告拖到imgur.com并复制链接。</p><p id="a443" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我坚持Imgur.com，因为每个人都知道。对于非商业和开源项目是免费的。它有使用率限制“每天大约1，250次上传或每天大约12，500次请求”。它有<a class="ae ln" href="https://api.imgur.com/" rel="noopener ugc nofollow" target="_blank"><em class="mi">API</em></a><em class="mi">和</em> <a class="ae ln" href="https://github.com/Imgur/imgurpython" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> python库</em> </a> <em class="mi">。我所要做的就是</em> <a class="ae ln" href="https://api.imgur.com/#registerapp" rel="noopener ugc nofollow" target="_blank"> <em class="mi">注册我的应用</em> </a> <em class="mi">，获得一个令牌(应用密码)并开始使用它。</em></p><p id="0b98" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">作为Imgur的替代方案，我可以让用户用64进制  <em class="mi">对他们的图像进行</em> <a class="ae ln" href="https://www.base64-image.de/" rel="noopener ugc nofollow" target="_blank"> <em class="mi">编码，并将这些字节直接发送到智能合同。但这样一来，合同将无法与任何图像托管或群存储(进一步一句话)。这意味着对于用户来说太不灵活和太复杂。另一种解决方案是使用以太坊的</em> </a><a class="ae ln" href="https://swarm-guide.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank"> <em class="mi">蜂群存储</em> </a> <em class="mi">。但对我来说，它仍然太beta，太复杂。虽然我的合同与swarm兼容，但我很确定，以后我将能够切换到它。目前——Imgur。</em></p><h2 id="5484" class="mj ka hu bd kb mk ml mm kf mn mo mp kj la mq mr kl le ms mt kn li mu mv kp mw dt translated">2.用户与智能合同交互</h2><p id="2016" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">用户通过由区块链客户端(<a class="ae ln" href="http://www.myetherwallet.com/" rel="noopener ugc nofollow" target="_blank">MyEtherWallet.com</a>或<a class="ae ln" href="https://github.com/ethereum/mist/releases" rel="noopener ugc nofollow" target="_blank">以太网桌面应用</a>)自动生成的GUI与智能合约进行交互。如果你不熟悉这个过程，看看这个<a class="ae ln" href="https://www.youtube.com/watch?v=mTgXJVlBVdI&amp;feature=youtu.be" rel="noopener ugc nofollow" target="_blank">视频</a>。</p><p id="5aaa" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">投放广告需要向<strong class="kt hv"> <em class="mi"> placeImage </em> </strong>函数发送所需坐标(在1000x1000px字段内)、图像url(从imgur复制)、用户网站链接和广告文本。用户提交交易后，合同会为图像分配一个ID并触发一个事件:</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="3402" class="mj ka hu my b fv nc nd l ne nf">NewImage(numImages, fromX, fromY, toX, toY, imageSourceUrl, adUrl, adText);</span></pre><p id="030e" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">在事务被挖掘到一个块中之后，任何同步的区块链客户端都可以使用它的带有事件日志的收据。这就是<a class="ae ln" href="https://etherscan.io/tx/0xd5d42dd466e1e8ed40a24e576d3945e3b6d269fa82ac7ee4412ce761caa1bf2e" rel="noopener ugc nofollow" target="_blank"> placeImage函数收据</a>在Etherescan.io区块链资源管理器上的样子(点击<strong class="kt hv"> <em class="mi">转换成Ascii </em> </strong>看一些人类可读的东西)。</p><p id="3af7" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">智能合同信息的获取方式有两种:</em> <a class="ae ln" href="http://solidity.readthedocs.io/en/develop/contracts.html#constant-functions" rel="noopener ugc nofollow" target="_blank"> <em class="mi">常量函数</em> </a> <em class="mi">(不修改合同状态，即写入合同)和事件。从外部应用程序访问合同数据的最简单方法是使用事件。另一个合同访问合同数据的唯一方法是</em> <a class="ae ln" rel="noopener" href="/@ConsenSys/a-101-noob-intro-to-programming-smart-contracts-on-ethereum-695d15c1dab4#da4d"> <em class="mi">使用函数调用</em> </a> <em class="mi">。我的聚醚. py监听事件，但百万醚契约有</em> <a class="ae ln" href="https://github.com/porobov/MillionEtherHomepage/blob/master/MillionEther.sol#L357" rel="noopener ugc nofollow" target="_blank"> <em class="mi">常量函数</em> </a> <em class="mi">也让其他开发者附加自己的扩展(契约)。</em></p><h2 id="25a8" class="mj ka hu bd kb mk ml mm kf mn mo mp kj la mq mr kl le ms mt kn li mu mv kp mw dt translated">3.Geth随事务下载一个块</h2><p id="b151" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">在Digital Ocean droplet中，使用以下命令运行Geth:</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="fdcd" class="mj ka hu my b fv nc nd l ne nf">geth --cache=16 --rpc --rpcport 8545 --rpccorsdomain "localhost"</span></pre><p id="7a30" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">让任何本地应用程序通过<a class="ae ln" href="https://github.com/ethereum/wiki/wiki/JavaScript-API" rel="noopener ugc nofollow" target="_blank"> JavaScript API </a>与之交互。</p><p id="1981" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">Geth不断下载新块(同步)。现在它收到一个包含事件的块。</p><p id="ddea" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">我用的是最便宜的数字海洋水滴，附带40 GB容量。它让我可以同时运行完整的以太坊节点和我的python应用程序。下面是</em> <a class="ae ln" href="https://hackernoon.com/how-to-run-geth-at-512mb-ram-digital-ocean-droplet-e346986cf666" rel="noopener ugc nofollow" target="_blank"> <em class="mi">如何配置</em> </a> <em class="mi">。</em></p><p id="10e5" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">有几种</em> <a class="ae ln" href="https://github.com/ethereum/go-ethereum/wiki/Command-Line-Options" rel="noopener ugc nofollow" target="_blank"> <em class="mi">连接geth </em> </a> <em class="mi">的方式:ipc(通过一个本地文件)、rpc(通过http协议)、ws(通过web-socket)。我用rpc。下面会展示它的好处。</em></p><h2 id="735e" class="mj ka hu bd kb mk ml mm kf mn mo mp kj la mq mr kl le ms mt kn li mu mv kp mw dt translated">4.Python应用程序询问geth是否有任何新事件，如果有，就处理它们</h2><p id="bd5a" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">聚醚. py以与Geth相同的DO液滴运行。它每分钟都会询问Geth是否有新事件。</p><p id="9614" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">同</em><a class="ae ln" href="https://github.com/ConsenSys/ethjsonrpc" rel="noopener ugc nofollow" target="_blank"><em class="mi">EthJsonRpc</em></a><em class="mi">库听evens是轻而易举的事。这里是获取特定智能合约事件的所有日志所需的几乎所有代码(我将很快发布我的ethereum _ gateway.py请关注我以获取帖子)。</em></p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="713e" class="mj ka hu my b fv nc nd l ne nf">self.client = EthJsonRpc('127.0.0.1', 8545) <br/>params = { <br/>      "fromBlock": hex(from_block), <br/>      "toBlock": "latest", <br/>      "address": 0x15dbdB25f870f21eaf9105e68e249E0426DaE916, # million_ether contract address <br/>      "topics": [event_definition["signature"]]<br/>      } <br/>logs = self.client.eth_getLogs(params)</span></pre><p id="4de3" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi"/><a class="ae ln" href="https://hackernoon.com/how-to-monitor-geth-and-autorestart-it-on-crashes-with-monit-a6668de9b961" rel="noopener ugc nofollow" target="_blank"><em class="mi">Geth和聚醚. py都被monit </em> </a> <em class="mi">监控，防止它们崩溃(如果发生不好的事情，monit会自动重启两者)。</em></p><p id="5c67" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">如果一组块有任何新的<strong class="kt hv"> <em class="mi"> NewImage </em> </strong>事件的<strong class="kt hv"> <em class="mi"> MillionEther </em> </strong>智能合约聚醚. py接收并解码它们。然后，该应用程序验证Imgur链接，下载和存储新图像，生成1000 x 1000像素的图像，并将其上传回Imgur(作为回报，会收到url)。</p><p id="5b9a" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">用</em> <a class="ae ln" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> Infura.io(远程区块链客户端)</em> </a> <em class="mi">和纯</em><a class="ae ln" href="https://github.com/ethereum/wiki/wiki/JavaScript-API" rel="noopener ugc nofollow" target="_blank"><em class="mi">JavaScript</em></a><em class="mi">我可以在用户浏览器中正确生成1000乘1000的图像。但是图像在本地呈现有两个原因:1 .对区块链节点获取所有广告图像的查询非常繁重，而且随着时间的推移会越来越重(因为检查事件的块的数量增长很快)。将所有过去的事件和图像写入本地数据库并每隔一分钟搜索几个街区内的新事件更便宜。2.对于大多数计算机来说，从10000个小图像中生成1000乘1000的图像是难以承受的任务。</em></p><p id="6bbd" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">使用链接到1000x1000图像和广告细节聚醚. py生成新的网页(整个网页html)，哈希求和并通过POST方法以JSON格式发送到一个带有长密码的秘密GAE url。</p><p id="5511" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我可以将原始数据传递给应用引擎，并在那里生成网页，但我已经为DO droplet付费了。所以我尽量减少应用程序引擎的负载。</p><h2 id="98a6" class="mj ka hu bd kb mk ml mm kf mn mo mp kj la mq mr kl le ms mt kn li mu mv kp mw dt translated">5.谷歌应用引擎接收网页</h2><p id="2fbf" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">GAE应用程序接收POST请求，检查散列值和密码，并将网页放入数据库。</p><p id="59e1" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">据我所知，我可以使用</em><a class="ae ln" href="https://cloud.google.com/appengine/docs/standard/python/refdocs/" rel="noopener ugc nofollow" target="_blank"><em class="mi">App Engine API</em></a><em class="mi">代替那些POST请求，直接、安全、可靠地将数据写入数据库。但是谷歌文档…嗯，你知道…很复杂。</em></p><p id="5f14" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">在Google云平台上可以(至少)有6种方式存储数据:Bigtable、Cloud SQL、Datastore、Storage、Persistence disk和Spanner。我使用的是Datastore——“一个用于非关系数据的高可伸缩的NoSQL数据库”。我发现这是最简单的。此外，每个数据库查询都被自动缓存。我的网页虽然存储在数据库中，但通常是从缓存中加载的，缓存有更高的空闲配额，而且比它们更便宜。或者，我可以将我的网页存储在存储器中，这(可能)是为静态文件设计的，而且(可能)更便宜，但是……还是……谷歌文档。</em></p><h2 id="9985" class="mj ka hu bd kb mk ml mm kf mn mo mp kj la mq mr kl le ms mt kn li mu mv kp mw dt translated">6.GAE将网页交付给用户</h2><p id="5bd1" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">通常情况下，用户会通过一个类似于<a class="ae ln" href="http://themillionetherhomepage.com/0xF51f08910eC370DB5977Cff3D01dF4DfB06BfBe1" rel="noopener ugc nofollow" target="_blank">http://themillionetherhome page . com/0 xf 51 f 08910 EC 370 db 5977 cf F3 d 01 df F4 DFB 06 BF be 1</a>的url到达。斜杠后的42个字符串是邀请用户的推荐的以太坊地址。</p><p id="3bea" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">引荐地址以与图像相同的方式到达GAE应用程序:<a class="ae ln" href="https://github.com/porobov/MillionEtherHomepage/blob/master/MillionEther.sol#L151" rel="noopener ugc nofollow" target="_blank"> <strong class="kt hv"> <em class="mi">登录</em> </strong> </a>智能合同的功能触发<strong class="kt hv"> <em class="mi">新用户</em> </strong>事件- &gt; Geth - &gt;聚醚. py - &gt; GAE，地址保存在同一个数据库中。</p><p id="0840" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">当有人访问该链接时，app engine所经历的唯一负载是检查该地址是否在数据库中，并加载网页的当前版本。这两种操作通常都是使用缓存数据来执行的，这样既快又便宜。</p><p id="303e" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><em class="mi">我使用Google engine是因为它的可扩展性和它的</em> <a class="ae ln" href="https://cloud.google.com/appengine/quotas" rel="noopener ugc nofollow" target="_blank"> <em class="mi">免费配额</em> </a> <em class="mi">。我认为我的超级轻量级应用程序应该能够每天免费服务大约1000个请求，除此之外几乎不需要任何费用。</em></p><h1 id="7ee5" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">结论</h1><p id="581d" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我想要便宜、可扩展、安全和简单的基础设施，将数据从以太坊推送到互联网，并尽可能保持平台的用户友好性。这是我得到的。</p><p id="73e5" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我花了20美分将我的智能合约部署到区块链，它将永远免费。我每月为DO支付5美元，为额外的磁盘空间支付4美元(我很快就会摆脱这些空间)。app engine仍为0美元。Imgur是免费的。ReadTheDocs.com的医生是免费的。Youtube上免费的视频指导。便宜。</p><p id="f0dd" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">智能合约可以承受几乎任何负载(相当于整个以太坊区块链可以处理的负载)。Imgur深不见底。数字海洋设置没有繁重的任务，如果需要可以在任何计算机上复制(我不是已经说过了吗？).如果支付得当，App engine可以承受比整个Imgur.com更大的负载。希望缓存的数据将节省我的账单。可扩展。</p><p id="284a" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">假设我的智能合同是安全的(并且我努力遵守这些官方安全规则(<a class="ae ln" href="https://github.com/ConsenSys/smart-contract-best-practices" rel="noopener ugc nofollow" target="_blank"/>),唯一受到攻击的地方就是网站。但是那里几乎没有代码(也没什么可偷的)。另外，我很确定(因为我在文档中的某个地方看到过，但是再也找不到了)我的应用引擎有现成的DOS保护。安全。</p><p id="cf52" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">简单。我花了很多时间来建造这一切。我不能说这很简单，但肯定很有趣。我希望我能让你更简单。</p><p id="0607" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">方便用户。就像区块链科技目前让它变得对用户友好一样。</p><p id="308c" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我达到我的要求了吗？我想是的。当然完美是没有限制的…</p><h1 id="f9ca" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">奖金。如何让它工作得更好(更便宜)</h1><p id="fbba" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">目前，由于我运行完整的geth node，我每个月都要处理7 GB的磁盘空间链数据，并且必须购买越来越多的GB。我无法弥补。我想通过<a class="ae ln" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>摆脱本地节点，切换到远程节点</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff ng"><img src="../Images/b14de0f17ced2f3947a03745bd0aa2ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*fN2KYIzoujtcGzrYqcVIbA.png"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Buying additional disk space</figcaption></figure><p id="8302" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">它的核心就像只修改一行代码一样简单:</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="6743" class="mj ka hu my b fv nc nd l ne nf">- self.client = EthJsonRpc('127.0.0.1', 8545) <br/>+ self.client = EthJsonRpc('mainnet.infura.io/my-secret-token',443,True) # True for ssl</span></pre><p id="004f" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">只要把http改成https，把localhost改成infura.io就行了！漂亮吧？如果由另一个节点(例如<a class="ae ln" href="https://etherscan.io/apis" rel="noopener ugc nofollow" target="_blank">以太网扫描</a>)和本地<a class="ae ln" href="https://blog.ethereum.org/2016/11/17/whoa-geth-1-5/" rel="noopener ugc nofollow" target="_blank">轻型客户端</a>支持，效果会更好。</p><p id="671d" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><strong class="kt hv">感谢您的阅读。如果您觉得这很有用，请点赞，分享并关注我，以便将来获得更多类似的文章。再见！</strong></p><div class="jk jl jm jn fq ab cb"><figure class="nh jo ni nj nk nl nm paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nh jo ni nj nk nl nm paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nh jo ni nj nk nl nm paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nn no np"><p id="f922" class="kr ks mi kt b ku lo iv kw kx lp iy kz nq lq lc ld nr lr lg lh ns ls lk ll lm hn dt translated"><a class="ae ln" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae ln" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ln" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="kr ks mi kt b ku lo iv kw kx lp iy kz nq lq lc ld nr lr lg lh ns ls lk ll lm hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ln" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ln" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nt"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>