<html>
<head>
<title>Capsule Networks Are Shaking up AI — Here’s How to Use Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">胶囊网络正在动摇人工智能——以下是如何使用它们</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/capsule-networks-are-shaking-up-ai-heres-how-to-use-them-c233a0971952?source=collection_archive---------0-----------------------#2017-11-10">https://medium.com/hackernoon/capsule-networks-are-shaking-up-ai-heres-how-to-use-them-c233a0971952?source=collection_archive---------0-----------------------#2017-11-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/4cd6362dca24fffdf8c05dc82308ebf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HALSN5yfXwLFAObz2szi9g.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Geoffrey Hinton [<a class="ae jg" href="https://www.technologyreview.com/s/608911/is-ai-riding-a-one-trick-pony/" rel="noopener ugc nofollow" target="_blank">Source</a>]</figcaption></figure><p id="4e9b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你关注人工智能，你可能听说过具有潜在革命性的胶囊网络的出现。我将向您展示如何从今天开始使用它们。</p><p id="5c9f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">杰弗里·辛顿被称为“深度学习”之父。早在50年代，深度神经网络的想法就开始浮出水面，理论上，它可以解决大量的问题。然而，没有人能够找出如何训练他们，人们开始放弃。辛顿没有放弃，并在1986年表明反向传播的想法可以训练这些深层网络。然而，直到5年前的2012年，由于当时缺乏计算能力，辛顿才得以展示他的突破。这一突破为这十年人工智能的进步奠定了基础。</p><p id="a056" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在，在2017年10月26日，他发表了一篇关于一个新的突破性概念的论文，胶囊网络。</p><blockquote class="kf kg kh"><p id="fdc2" class="jh ji ki jj b jk jl jm jn jo jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd ke hn dt translated"><strong class="jj hv">注:</strong>关于胶囊如何工作的更深入的解释，请看<a class="ae jg" href="https://medium.freecodecamp.org/understanding-capsule-networks-ais-alluring-new-architecture-bdb228173ddc" rel="noopener ugc nofollow" target="_blank">第二部分</a>。还有，研究论文可以在<a class="ae jg" href="https://arxiv.org/pdf/1710.09829v1.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae jg" href="https://openreview.net/pdf?id=HJWLfGWRb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></blockquote><h1 id="00b0" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">传统神经网络的问题</h1><p id="b8e4" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">迄今为止，卷积神经网络(CNN)一直是最先进的图像分类方法。</p><p id="78c1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">CNN的工作原理是在每一层积累多组特征。它从寻找边缘开始，然后是形状，然后是实际的物体。但是，所有这些要素的空间关系信息都丢失了。</p><p id="89ec" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是一个过于简单化的想法，但是你可以这样想一个CNN:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="646b" class="ly kn hu lu b fv lz ma l mb mc">if (2 eyes &amp;&amp; 1 nose &amp;&amp; 1 mouth) {<br/>  It's a face!<br/>}</span></pre><p id="42a7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你可能会想，这听起来很好，很有意义，确实如此。虽然，我们可能会遇到一些问题，以金·卡戴珊的这张照片为例:</p><figure class="lp lq lr ls fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff md"><img src="../Images/eb69d32cd737435421e2ebf1145e499a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iX1qcKeLHEKtSZuzafrgjg.png"/></div></div></figure><p id="7ccb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">呀！肯定有两只眼睛，一个鼻子和一张嘴，但有些不对劲，你能发现吗？我们很容易看出眼睛和嘴的位置不对，这不是一个人应该有的样子。然而，训练有素的CNN很难理解这个概念:</p><figure class="lp lq lr ls fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff me"><img src="../Images/c64f49c9761fc53434a79c5618064292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-Be4Uj-a7N6_Qx-K03KkQ.png"/></div></div></figure><p id="0f32" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">除了容易被特征在错误位置的图像愚弄之外，当从不同方向观看图像时，CNN也容易被迷惑。解决这个问题的一个方法是对所有可能的角度进行过度训练，但这需要很多时间，而且似乎有悖直觉。我们可以看到，只要将Kim上下颠倒，性能就会大幅下降:</p><figure class="lp lq lr ls fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff me"><img src="../Images/7f66dd2fd854cd537ad7d52beb1f0d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RS9iLmj0r9i9zUeBVzo8Kg.png"/></div></div></figure><p id="a5ef" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最后，卷积神经网络容易受到白盒攻击。本质上是在一个物体中嵌入一个秘密图案，使它看起来像别的东西。</p><figure class="lp lq lr ls fq iv"><div class="bz el l di"><div class="mf mg l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Fooling Neural Networks in the Physical World with 3D Adversarial Objects [<a class="ae jg" href="http://www.labsix.org/physical-objects-that-fool-neural-nets/" rel="noopener ugc nofollow" target="_blank">Source</a>]</figcaption></figure><blockquote class="mh"><p id="8352" class="mi mj hu bd mk ml mm mn mo mp mq ke ek translated">“卷积神经网络注定要失败”——杰弗里·辛顿</p></blockquote><h1 id="9785" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx mr kz la lb ms ld le lf mt lh li lj dt translated">胶囊网络来拯救！</h1><figure class="lp lq lr ls fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mu"><img src="../Images/ba900ee66e19a2ee9c430a51c29d6e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJhYGZZPYF44UZMfFpKkfw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Architecture of CapsNet</figcaption></figure><p id="5e8b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">胶囊网络的引入让我们有能力充分利用空间关系，因此我们可以开始看到更像:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="c9ea" class="ly kn hu lu b fv lz ma l mb mc">if (2 adjacent eyes &amp;&amp; nose under eyes &amp;&amp; mouth under nose) {<br/>  It's a face!<br/>}</span></pre><p id="d607" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你应该能够看到，有了这个定义，我们的神经网络就不会那么容易被我们畸形的卡戴珊愚弄。</p><p id="12b7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这种新的架构还在以下数据集上实现了显著更好的准确性。这个数据集被精心设计成一个纯粹的形状识别任务，显示出即使从不同的角度识别物体的能力。它击败了最先进的CNN，将错误数量减少了45%。</p><figure class="lp lq lr ls fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mv"><img src="../Images/53e8203c094e1840dcb82de199835584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gHnUO-A3vYj0qtqHXSkGPw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">CapsNet was able to identify the bottom images were within the same category (animals, humans, airplanes, cars, trucks) as the correspoding top image far better than CNNs.</figcaption></figure><p id="5d18" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">此外，在他们最近的论文中，他们发现胶囊比基线卷积神经网络显示出更强的抵抗白盒攻击的能力。</p><h1 id="7833" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">培训顶网</h1><p id="909b" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">我已经拼凑了一个回购协议，这是辛顿论文的一个实现(非常感谢<a class="ae jg" href="https://github.com/naturomics/CapsNet-Tensorflow" rel="noopener ugc nofollow" target="_blank">自然经济学</a>)。为了使用胶囊网络模型，你首先需要训练它。</p><p id="3662" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">以下指南将为您提供一个在MNIST数据集上训练的模型。对于那些不知道的人来说，MNIST是一个手写数字的数据集，是测试机器学习算法的一个很好的基线。</p><p id="5404" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">从克隆<a class="ae jg" href="https://github.com/bourdakos1/capsule-networks" rel="noopener ugc nofollow" target="_blank">回购</a>开始:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="568d" class="ly kn hu lu b fv lz ma l mb mc">git clone <a class="ae jg" href="https://github.com/bourdakos1/capsule-networks.git" rel="noopener ugc nofollow" target="_blank">https://github.com/bourdakos1/capsule-networks.git</a></span></pre><p id="4e00" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后安装需求并下载数据集:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="011e" class="ly kn hu lu b fv lz ma l mb mc">pip install -r requirements.txt<br/>python download_data.py</span></pre><p id="e89a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">开始训练！</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="422c" class="ly kn hu lu b fv lz ma l mb mc">python main.py</span></pre><p id="f10a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">MNIST数据集是60，000幅训练图像。默认情况下，该模型将在128的批量大小下被训练50个时期。一个时期是整个训练集的一次完整运行。由于批次大小为128，因此每个时期将处理大约468个批次。</p><p id="ac4d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">注意:</strong>如果你没有GPU，训练可能会花很长时间。你可以阅读<a class="ae jg" href="https://medium.freecodecamp.org/tracking-the-millenium-falcon-with-tensorflow-c8c86419225e#6415" rel="noopener ugc nofollow" target="_blank">这篇关于如何加快训练时间的文章</a>。</p><h1 id="3faf" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">做出推论</h1><p id="2efa" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">一旦我们的模型完全定型，我们就可以通过运行以下命令来测试它:</p><pre class="lp lq lr ls fq lt lu lv lw aw lx dt"><span id="9eac" class="ly kn hu lu b fv lz ma l mb mc">python main.py <!-- -->--is_training False</span></pre><h1 id="83cb" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">最后的想法</h1><p id="2f9c" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">胶囊网络看起来很棒，但它们仍然是婴儿。我们可以在未来训练大型数据集时看到问题，但我有信心。</p><p id="2285" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你喜欢阅读这篇文章，并想了解更多，还有第二部分<a class="ae jg" href="https://medium.freecodecamp.org/understanding-capsule-networks-ais-alluring-new-architecture-bdb228173ddc" rel="noopener ugc nofollow" target="_blank"/>！</p><p id="31a7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">附:这里有一个很棒的视频，我推荐你花时间去看。</p><figure class="lp lq lr ls fq iv"><div class="bz el l di"><div class="mf mg l"/></div></figure><p id="88ed" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">感谢阅读！如果您有任何问题，请随时联系bourdakos1@gmail.com，通过<a class="ae jg" href="https://www.linkedin.com/in/nicholasbourdakos" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系，或者通过<a class="ae jg" rel="noopener" href="/@bourdakos1"> Medium </a>和<a class="ae jg" href="https://twitter.com/bourdakos1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>关注我。</p><p id="f27b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你觉得这篇文章很有帮助，给它一些掌声会很有意义👏并分享出来帮别人找！并欢迎在下方发表评论。</p></div></div>    
</body>
</html>