<html>
<head>
<title>Python Excel Tutorial: The Definitive Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Excel教程:权威指南</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/python-excel-tutorial-the-definitive-guide-934ee6dd15b0?source=collection_archive---------3-----------------------#2017-02-01">https://medium.com/hackernoon/python-excel-tutorial-the-definitive-guide-934ee6dd15b0?source=collection_archive---------3-----------------------#2017-02-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="09f8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">最初发布于</em><a class="ae jq" href="https://www.datacamp.com/community/tutorials/python-excel-tutorial" rel="noopener ugc nofollow" target="_blank"><em class="jp">https://www . data camp . com/community/tutorials/python-excel-tutorial</em></a></p><p id="d039" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可能已经知道Excel是由微软开发的电子表格应用程序。您可以使用这个易于访问的工具来组织、分析和存储表格中的数据。更重要的是，这种软件在全世界许多不同的应用领域中被广泛使用。</p><p id="eda1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不管你喜不喜欢，这也适用于数据科学。</p><p id="31da" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在某些时候，您需要处理这些电子表格，但是您也不会总是想要继续在其中工作。这就是为什么<a class="ae jq" href="https://hackernoon.com/tagged/python" rel="noopener ugc nofollow" target="_blank"> Python </a>开发人员不仅实现了读取、写入和操作这些文件的方法，还实现了许多其他类型的文件。</p><p id="50ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今天的教程将让你了解如何使用Excel和Python。它将为您提供一些包的概述，您可以使用这些包在Python的帮助下加载这些电子表格并将其写入文件。您将学习如何使用<code class="eh jr js jt ju b">pandas</code>、<code class="eh jr js jt ju b">openpyxl</code>、<code class="eh jr js jt ju b">xlrd</code>、<code class="eh jr js jt ju b">xlutils</code>和<code class="eh jr js jt ju b">pyexcel</code>等软件包。</p><p id="f587" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看一下DataCamp的<a class="ae jq" href="https://www.datacamp.com/courses/importing-data-in-python-part-1" rel="noopener ugc nofollow" target="_blank">在Python课程</a>中导入数据可能会很有趣。如果你还想了解更多关于如何将文件读入R的知识，可以考虑上DataCamp的<a class="ae jq" href="https://www.datacamp.com/community/tutorials/r-tutorial-read-excel-into-r" rel="noopener ugc nofollow" target="_blank"> R教程，学习如何将Excel文件读入R </a>。</p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div class="fe ff jv"><img src="../Images/eeb0146bab31b3ebd0dd8f68f6eefd2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/0*ZZHwku2SIPXxvdxf.png"/></div></figure><h1 id="4335" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">起点:数据</h1><p id="a7c4" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">当你开始一个<a class="ae jq" href="https://hackernoon.com/tagged/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>项目时，你经常会从你收集的数据中工作，这些数据可能来自网络搜集，但大部分可能来自你从其他地方下载的数据集，比如<a class="ae jq" href="https://www.datacamp.com/community/tutorials/www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>、<a class="ae jq" href="https://www.datacamp.com/community/tutorials/www.quandl.com" rel="noopener ugc nofollow" target="_blank"> Quandl </a>等。</p><p id="47f8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但通常情况下，你也会在谷歌或其他用户共享的存储库上找到数据。这些数据可能在一个Excel文件中，或者保存到一个扩展名为<code class="eh jr js jt ju b">.csv</code>的文件中，……这种可能性有时似乎是无穷无尽的。但是无论何时你有数据，你的第一步应该是确保你在处理定性数据。</p><p id="0192" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在电子表格的情况下，你应该证实它是定性的，因为你可能不仅要检查这些数据是否能回答你脑海中的研究问题，还要检查你是否能信任电子表格中的数据。</p><h1 id="5a95" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">Excel电子表格的质量</h1><p id="c3ad" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">要检查电子表格的整体质量，您可以查看以下清单:</p><ul class=""><li id="88c3" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated">电子表格代表静态数据吗？</li><li id="a4f8" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">您的电子表格是否混合了数据、计算和报告？</li><li id="716d" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">您的电子表格中的数据是否完整且一致？</li><li id="11c7" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">你的电子表格有系统的工作表结构吗？</li><li id="c7c3" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">您是否检查了电子表格中的实时公式是否有效？</li></ul><p id="0d44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个问题列表是为了确保您的电子表格不会“违背”业界公认的最佳实践。当然，上面的列表并不详尽:还有许多更通用的规则可以遵循，以确保您的电子表格不是丑小鸭。然而，当您想要确定电子表格是否是定性的时，上面列出的问题是最相关的。</p><h1 id="0278" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">您的数据质量</h1><p id="d813" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">在Python中读取电子表格之前，您还需要考虑调整文件以符合一些基本原则，例如:</p><ul class=""><li id="0c2f" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated">电子表格的第一行通常是为标题保留的，而第一列用于标识抽样单位；</li><li id="e2c2" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">避免名称、值或字段带有空格。否则，每个单词都将被解释为一个单独的变量，从而导致与数据集中每行的元素数量相关的错误。考虑使用下划线、破折号、大小写或连接单词。</li><li id="1a14" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">短名字优先于长名字；</li><li id="cca6" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">尽量避免使用含有<code class="eh jr js jt ju b">?</code>、<code class="eh jr js jt ju b">$</code>、<code class="eh jr js jt ju b">%</code>、<code class="eh jr js jt ju b">^</code>、<code class="eh jr js jt ju b">&amp;</code>、<code class="eh jr js jt ju b">*</code>、<code class="eh jr js jt ju b">(</code>、<code class="eh jr js jt ju b">)</code>、<code class="eh jr js jt ju b">-</code>、<code class="eh jr js jt ju b">#</code>、<code class="eh jr js jt ju b">?</code>、<code class="eh jr js jt ju b">,</code>、<code class="eh jr js jt ju b">&lt;</code>、<code class="eh jr js jt ju b">&gt;</code>、<code class="eh jr js jt ju b">/</code>、<code class="eh jr js jt ju b">|</code>、<code class="eh jr js jt ju b">\</code>、<code class="eh jr js jt ju b">[</code>、<code class="eh jr js jt ju b">]</code>、<code class="eh jr js jt ju b">{</code>、<code class="eh jr js jt ju b">}</code>等符号的名称；</li><li id="0ed4" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">删除您在文件中所做的任何注释，以避免在文件中添加额外的列或NA；和</li><li id="8973" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">确保数据集中任何缺失的值都用NA表示。</li></ul><p id="45a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，在完成必要的更改后，或者在彻底查看数据后，如果进行了任何更改，请确保保存更改。通过这样做，您可以在以后重新访问数据以编辑它，添加更多数据或更改它们，同时保留您可能用于计算数据的公式，等等。</p><p id="751d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你正在使用Microsoft Excel，你会看到有相当多的选项来保存你的文件:除了默认的扩展名<code class="eh jr js jt ju b">.xls</code>或<code class="eh jr js jt ju b">.xlsx</code>，你可以转到“文件”标签，点击“另存为”并选择一个作为“保存类型”选项列出的扩展名。为数据科学保存数据集最常用的扩展是<code class="eh jr js jt ju b">.csv</code>和<code class="eh jr js jt ju b">.txt</code>(作为制表符分隔的文本文件)。根据您选择的保存选项，数据集的字段由制表符或逗号分隔，这将构成数据集的“字段分隔符”。</p><p id="f793" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">既然已经检查并保存了数据，您可以开始准备您的工作空间了！</p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/98e4f78cc6bc37306d241f77181f13e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*14IchM1baqxFjdFt.png"/></div></div></figure><h1 id="ed72" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">准备您的工作空间</h1><p id="e330" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">准备你的工作空间是你能做的第一件事，以确保你有一个好的开始。第一步是检查你的工作目录。</p><p id="17fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您在终端中工作时，您可能首先导航到您的文件所在的目录，然后启动Python。这也意味着您必须确保您的文件位于您想要工作的目录中！</p><p id="8b7b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但也许更重要的是，如果您已经启动了Python会话，但却不知道您正在工作的目录，那么您应该考虑执行以下命令:</p><pre class="jw jx jy jz fq lz ju ma mb aw mc dt"><span id="7e59" class="md ke hu ju b fv me mf l mg mh"># Import `os` <br/>import os </span><span id="e103" class="md ke hu ju b fv mi mf l mg mh"># Retrieve current working directory (`cwd`) <br/>cwd = os.getcwd()</span><span id="b980" class="md ke hu ju b fv mi mf l mg mh"># Change directory <br/>os.chdir("/path/to/your/folder") </span><span id="1fcb" class="md ke hu ju b fv mi mf l mg mh"># List all files and directories in current directory os.listdir('.')</span></pre><p id="0ff2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很棒吧。</p><p id="3ba6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您会发现这些命令不仅对于加载数据非常重要，对于进一步的分析也非常重要。现在，让我们继续:您已经完成了所有的检查，您已经保存了您的数据并准备好了您的工作空间。</p><p id="a17d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你已经可以开始用Python读取数据了吗？</p><p id="5a3e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不幸的是，你还需要做最后一件事。</p><p id="07ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">即使您还不知道导入数据所需的软件包，您也必须确保您已经做好了安装这些软件包的一切准备。</p><p id="1fcd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> Pip </strong></p><p id="15d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是为什么你需要安装<code class="eh jr js jt ju b">pip</code>和<code class="eh jr js jt ju b">setuptools</code>的原因。如果你已经安装了Python 2 &gt; =2.7.9或Python 3 &gt; =3.4，你不需要担心，因为这样你通常已经准备好了。在这种情况下，只要确保您已经升级到最新版本。</p><p id="ebf9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为此，请在终端中运行以下命令:</p><pre class="jw jx jy jz fq lz ju ma mb aw mc dt"><span id="404b" class="md ke hu ju b fv me mf l mg mh"># For Linux/OS X <br/>pip install -U pip setuptools<br/> <br/># For Windows <br/>python -m pip install -U pip setuptools</span></pre><p id="a722" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你还没有安装<code class="eh jr js jt ju b">pip</code>，运行<code class="eh jr js jt ju b">python get-pip.py</code>脚本，你可以在这里找到<a class="ae jq" href="https://packaging.python.org/installing/#install-pip-setuptools-and-wheel" rel="noopener ugc nofollow" target="_blank"/>。此外，如果您需要更多帮助来正确安装所有内容，您可以按照页面上的安装说明进行操作。</p><p id="4fc7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">蟒蛇</strong></p><p id="43a6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您将Python用于数据科学，您可以考虑的另一个选项是安装Anaconda Python发行版。通过这样做，您将有一个简单快捷的方法来开始进行数据科学，因为您不需要担心单独安装您需要进行数据科学的包。</p><p id="b354" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您是初学者，这尤其方便，但即使对于更有经验的开发人员，这也是一种快速测试一些东西的方法，而不必单独安装每个包。</p><p id="35bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Anaconda包括<a class="ae jq" href="https://docs.continuum.io/anaconda/pkg-docs" rel="noopener ugc nofollow" target="_blank"> 100个最流行的Python、R和Scala包</a>，用于数据科学和几个开源开发环境，如Jupyter和Spyder。如果您想在本教程结束后开始使用Jupyter Notebook，请转到<a class="ae jq" href="https://www.datacamp.com/community/tutorials/tutorial-jupyter-notebook" rel="noopener ugc nofollow" target="_blank">本页</a>。</p><p id="9f1f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以去<a class="ae jq" href="https://www.continuum.io/downloads" rel="noopener ugc nofollow" target="_blank">这里</a>安装Anaconda。按照说明进行安装，您就可以开始了！</p><p id="2832" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是设置您的环境所需要做的一切！</p><p id="7e12" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您可以开始导入文件了。</p><h1 id="5b10" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">用熊猫导入Excel文件</h1><p id="9f70" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">当您在数据科学中使用文件时，您经常使用的导入文件的方法之一是借助Pandas包。Pandas库建立在NumPy之上，为Python编程语言提供了易于使用的数据结构和数据分析工具。</p><p id="8c71" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个强大而灵活的库经常被(有抱负的)数据科学家用来将他们的数据转换成对他们的分析具有高度表达能力的数据结构。</p><p id="bb78" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你已经通过Anaconda获得了熊猫，你可以用<code class="eh jr js jt ju b">pd.Excelfile().</code>将你的文件加载到熊猫数据帧中</p><p id="3e30" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您没有安装Anaconda，只需执行<code class="eh jr js jt ju b">pip install pandas</code>在您的环境中安装Pandas包，然后执行上面代码块中包含的命令。</p><p id="3765" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">小菜一碟，对吧？</p><p id="96eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了读入<code class="eh jr js jt ju b">.csv</code>文件，您有一个类似的函数将数据加载到DataFrame: <code class="eh jr js jt ju b">read_csv()</code>。</p><p id="8f60" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，该函数考虑的分隔符是逗号，但是如果您愿意，可以指定一个替代分隔符。转到<a class="ae jq" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank">文档</a>,找出您可以指定哪些其他参数来使您的导入成功！</p><p id="81ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意，还有<code class="eh jr js jt ju b">read_table()</code>和<code class="eh jr js jt ju b">read_fwf()</code>函数将固定宽度格式化行的一般定界文件和表格读入数据帧。对于第一个函数，默认分隔符是制表符，但是您可以再次覆盖它，也可以指定一个替代分隔符。此外，您还可以使用其他函数来获取数据帧中的数据:您可以在这里找到它们<a class="ae jq" href="http://pandas.pydata.org/pandas-docs/stable/api.html#input-output" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="f7c6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">假设在您分析完数据后，您想将数据写回到一个新文件中。还有一种方法可以用<code class="eh jr js jt ju b"><a class="ae jq" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_excel.html" rel="noopener ugc nofollow" target="_blank">to_excel()</a></code>函数将你的熊猫数据帧写回文件。</p><p id="a8ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，在使用这个函数之前，如果您想将数据写入一个<code class="eh jr js jt ju b">.xlsx</code>文件中的多个工作表，请确保您已经安装了<code class="eh jr js jt ju b">XlsxWriter</code>。将<code class="eh jr js jt ju b">writer</code>变量传递给<code class="eh jr js jt ju b">to_excel()</code>函数，并指定工作表名称。这样，您可以将一个包含数据的工作表添加到一个现有的工作簿中:您可以使用<code class="eh jr js jt ju b">ExcelWriter</code>将多个(稍微)不同的数据框架保存到一个工作簿中。</p><p id="9362" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这意味着如果你只想保存一个数据帧到一个文件，你也可以不安装<code class="eh jr js jt ju b">XlsxWriter</code>包。然后，不要指定要传递给<code class="eh jr js jt ju b">pd.ExcelWriter()</code>函数的<code class="eh jr js jt ju b">engine</code>参数。其余步骤保持不变。</p><p id="b0dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">类似于您过去在<code class="eh jr js jt ju b">.csv</code>文件中读取的函数，您也有一个函数<code class="eh jr js jt ju b">to_csv()</code>将结果写回到一个逗号分隔的文件中。它的工作方式与您使用它读取文件的方式非常相似:</p><pre class="jw jx jy jz fq lz ju ma mb aw mc dt"><span id="d868" class="md ke hu ju b fv me mf l mg mh"># Write the DataFrame to csv <br/>df.to_csv("example.csv")</span></pre><p id="bd40" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您想要一个制表符分隔的文件，您也可以将一个<code class="eh jr js jt ju b">\t</code>传递给<code class="eh jr js jt ju b">sep</code>参数来使其清晰。请注意，您可以使用各种其他函数来输出文件。你可以在这里找到所有的<a class="ae jq" href="http://pandas.pydata.org/pandas-docs/stable/api.html#id12" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="f7f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除了Pandas包(您可能会经常使用它来加载数据)，您还可以使用其他包来获取Python中的数据。我们对可用包的概述基于<a class="ae jq" href="http://www.python-excel.org/" rel="noopener ugc nofollow" target="_blank">这一页</a>，其中包括一个包列表，您可以使用这些包在Python中处理Excel文件。</p><p id="e356" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在接下来的内容中，您将在一些真实但简化的例子的帮助下看到如何使用这些包。</p><p id="0e4b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安装这些包的一般建议是在没有系统包的Python virtualenv中完成。您可以使用virtualenv来创建独立的Python环境:它会创建一个文件夹，其中包含使用Python项目所需的包所需的所有可执行文件。</p><p id="f1a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要开始使用<code class="eh jr js jt ju b">virtualenv</code>，你首先需要安装它。然后，转到您想要放置项目的目录。在这个文件夹中创建一个virtualenv，如果需要的话，可以加载到一个特定的Python版本中。然后，您激活虚拟环境。之后，您可以开始加载其他包，开始使用它们，等等。</p><p id="ee38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">提示</strong>:完成后不要忘记关闭环境！</p><p id="90cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，当您刚刚开始使用Python进行数据科学项目时，虚拟环境一开始可能会有点麻烦。而且，特别是当您只有一个项目要考虑时，您可能看不清楚为什么您需要一个虚拟环境。</p><p id="a5fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是考虑一下，当您同时运行多个项目，并且不希望它们共享同一个Python安装时，这是多么容易。或者当您的项目有冲突的需求时，那么虚拟环境将派上用场！</p><p id="0274" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您终于可以开始安装和导入您已经读到的要加载到电子表格数据中的包了。</p><h1 id="4c39" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated"><strong class="ak"> Openpyxl </strong></h1><p id="bc42" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">如果你想读写<code class="eh jr js jt ju b">.xlsx, xlsm</code>、<code class="eh jr js jt ju b">xltx</code>和<code class="eh jr js jt ju b">xltm</code>文件，一般推荐使用这个包。</p><p id="a9b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用<code class="eh jr js jt ju b">pip</code>安装<code class="eh jr js jt ju b">openpyxl</code>:您在上一节已经看到了如何做！</p><p id="3e21" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安装这个包的一般建议是在没有系统包的Python虚拟环境中进行。您可以使用虚拟环境来创建独立的Python环境:它会创建一个文件夹，其中包含使用Python项目所需的包所需的所有可执行文件。</p><p id="6888" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">转到您的项目所在的目录，并重新激活虚拟环境<code class="eh jr js jt ju b">venv</code>。然后继续安装带有<code class="eh jr js jt ju b">pip</code>的<code class="eh jr js jt ju b">openpyxl</code>，确保你可以用它读写文件。</p><p id="c479" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是这些数据到底是什么呢？</p><p id="5856" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">包含您试图在Python中获取的数据的工作簿包含以下工作表:</p><p id="1e62" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第1页</strong></p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div class="fe ff mj"><img src="../Images/adc5cf05733cbefc1020fbfe3f13fcd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/0*5zMO4rkaGTj3QwDN.png"/></div></figure><p id="fe38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第二页</strong></p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/5736c8a1eb5af693fa7d6173d730358c.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/0*4evVCUpwwwAYV9fG.png"/></div></figure><p id="751f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第3页</strong></p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div class="fe ff ml"><img src="../Images/b2fa8037e7a9f6546a936317650081df.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/0*Ypk7OWkH3NfbxFEX.png"/></div></figure><p id="db0a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如您所见，<code class="eh jr js jt ju b">load_workbook()</code>函数将文件名作为参数，并返回一个代表文件的<code class="eh jr js jt ju b">workbook</code>对象。您可以通过运行<code class="eh jr js jt ju b">type(wb)</code>来检查这一点。请记住，确保您位于电子表格所在的正确目录中。否则，导入时会出错！</p><p id="386f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">记住</strong>你可以在<code class="eh jr js jt ju b">os.chdir()</code>的帮助下改变工作目录。</p><p id="db58" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您会看到上面的代码块返回了您在Python中加载的工作簿的工作表名称。接下来，您还可以使用该信息检索工作簿的单独工作表。</p><p id="e81e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您也可以使用<code class="eh jr js jt ju b">wb.active</code>检查当前哪个工作表是活动的。</p><p id="0b07" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你会发现，有了这些<code class="eh jr js jt ju b">Worksheet</code>物件，乍一看你做不了多少事。但是，您可以通过使用方括号<code class="eh jr js jt ju b">[]</code>从工作簿的工作表中的某些单元格中检索值，您可以将想要检索值的确切单元格传递给方括号。</p><p id="856c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意，这看起来非常类似于选择、获取和索引NumPy数组和Pandas数据帧，然而这并不是获取值所需要做的全部工作；您需要添加属性<code class="eh jr js jt ju b">value;</code>除了<code class="eh jr js jt ju b">value</code>，还有其他属性可以用来检查您的单元格，即<code class="eh jr js jt ju b">row</code>、<code class="eh jr js jt ju b">column</code>和<code class="eh jr js jt ju b">coordinate</code>。</p><ul class=""><li id="b1a5" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated"><code class="eh jr js jt ju b">row</code>属性将返回<code class="eh jr js jt ju b">2</code>；</li><li id="bf27" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">将<code class="eh jr js jt ju b">column</code>属性添加到<code class="eh jr js jt ju b">c</code>将得到<code class="eh jr js jt ju b">'B'</code>，并且</li><li id="d695" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">这个<code class="eh jr js jt ju b">coordinate</code>会把<code class="eh jr js jt ju b">'B2'</code>给退了。</li></ul><p id="064f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还可以通过使用<code class="eh jr js jt ju b">cell()</code>函数来检索单元格值。传递<code class="eh jr js jt ju b">row</code>和<code class="eh jr js jt ju b">column</code>参数，并向这些参数添加与您想要检索的单元格的值相对应的值，当然，不要忘记添加属性<code class="eh jr js jt ju b">value.</code>注意，如果您不指定属性<code class="eh jr js jt ju b">value</code>，您将返回<code class="eh jr js jt ju b">&lt;Cell Sheet3.B1&gt;</code>，它不会告诉您关于特定单元格中包含的值的任何信息。</p><p id="0c34" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以看到，在<code class="eh jr js jt ju b">range()</code>函数的帮助下，您使用了一个for循环来帮助您打印出在第2列中有值的行的值。如果那些特定的单元格是空的，你将返回<code class="eh jr js jt ju b">None</code>。如果你想了解更多关于for循环的知识，可以考虑参加我们的<a class="ae jq" href="https://www.datacamp.com/courses/intermediate-python-for-data-science" rel="noopener ugc nofollow" target="_blank">数据科学中级Python</a>课程。</p><p id="bea6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">此外，还有一些特殊的函数，您可以调用它们来取回某些其他值，比如<code class="eh jr js jt ju b">get_column_letter()</code>和<code class="eh jr js jt ju b">column_index_from_string</code>。</p><p id="bd3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这两个函数已经或多或少地说明了使用它们可以检索什么，但是为了清楚起见，最好让它们显式:虽然可以用前者检索列的字母，但是可以反过来，或者在将字母传递给后者时获取列的索引。</p><p id="8985" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，您可以使用一些属性来检查导入的结果，即<code class="eh jr js jt ju b">max_row</code>和<code class="eh jr js jt ju b">max_column</code>。这些属性当然是确保您正确加载数据的一般方法，但尽管如此，它们仍然是有用的。</p><p id="c445" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这一切都很好，但我几乎可以听到你现在的想法，这似乎是一个非常困难的方式来处理这些文件，特别是如果你还想操纵数据。</p><p id="0712" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">肯定有更简单的，对吧？</p><p id="5a21" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你说得对！</p><p id="d384" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还可以使用Pandas包中的<code class="eh jr js jt ju b">DataFrame()</code>函数将工作表的值放入DataFrame。接下来，您可以开始使用Pandas包提供的所有功能来操作数据。但是，请记住您是在虚拟环境中，所以如果这个包还不存在，您需要通过<code class="eh jr js jt ju b">pip</code>再次安装它。</p><p id="bfe2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">记住</strong>完成后，不要忘记关闭虚拟环境。</p><p id="62e7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">尽管如此，还有其他一些包可以用来在Python中获取电子表格数据。</p><p id="ac12" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请继续阅读，了解更多信息！</p><h1 id="18f4" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">xlrd</h1><p id="6ea4" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">如果您想从扩展名为<code class="eh jr js jt ju b">.xls</code>或<code class="eh jr js jt ju b">.xlsx</code>的文件中读取数据和格式化数据，这个软件包是理想的。当您不想考虑整个工作簿时，您可能想使用诸如<code class="eh jr js jt ju b">sheet_by_name()</code>或<code class="eh jr js jt ju b">sheet_by_index()</code>之类的函数来检索您确实想在分析中使用的工作表。</p><p id="085b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，您还会看到，您可以从工作表中检索特定坐标处的值，这些值用索引来表示。</p><p id="fe3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">继续阅读<code class="eh jr js jt ju b">xlwt</code>和<code class="eh jr js jt ju b">xlutils</code>，了解更多关于它们与<code class="eh jr js jt ju b">xlrd</code>包的关系！</p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/6dfc2293a2d19eefde6c3fac50dcf0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3HS1Q8YFgJPT_jdM.png"/></div></div></figure><h1 id="6351" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">xlwt</h1><p id="5870" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">如果您想创建包含您的数据的电子表格，除了使用<code class="eh jr js jt ju b">XlsxWriter</code>包之外，您还可以使用<code class="eh jr js jt ju b">xlwt</code>包。<code class="eh jr js jt ju b">xlwt</code>非常适合将数据和格式信息写入扩展名为<code class="eh jr js jt ju b">.xls</code>的文件。</p><p id="b44e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想把数据写到一个文件中，但是你不想麻烦地自己做所有的事情，你可以求助于一个for循环来稍微自动化整个过程。编写一个脚本，在其中初始化工作簿并向其中添加一个工作表。指定一个包含列的列表和一个包含将在工作表中填充的值的列表。</p><p id="e5fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">既然您已经看到了<code class="eh jr js jt ju b">xlrd</code>和<code class="eh jr js jt ju b">xlwt</code>是如何合作的，那么是时候看看与这两者紧密相关的包:<code class="eh jr js jt ju b">xlutils</code>。</p><h1 id="cf2c" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">xlutils</h1><p id="b178" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">这个包基本上是需要<code class="eh jr js jt ju b">xlrd</code>和<code class="eh jr js jt ju b">xlwt</code>的实用程序的集合，包括复制、修改或过滤现有文件的能力。一般来说，这些用例现在被<code class="eh jr js jt ju b">openpyxl</code>覆盖了。</p><p id="3535" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回到关于<code class="eh jr js jt ju b">openpyxl</code>的部分，获得更多关于如何使用这个包在Python中获取数据的信息。</p><h1 id="884a" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">派塞尔</h1><p id="ecda" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">另一个可以用来在Python中读取电子表格数据的包是<code class="eh jr js jt ju b">pyexcel</code>；它是一个Python包装器，提供了一个API来读取、操作和写入<code class="eh jr js jt ju b">.csv</code>、<code class="eh jr js jt ju b">.ods</code>、<code class="eh jr js jt ju b">.xls</code>、<code class="eh jr js jt ju b">.xlsx</code>和<code class="eh jr js jt ju b">.xlsm</code>文件中的数据。当然，对于本教程，您将只关注<code class="eh jr js jt ju b">.xls </code>和<code class="eh jr js jt ju b">.xls</code>文件。</p><p id="48f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要获取数组中的数据，可以使用包含在<code class="eh jr js jt ju b">pyexcel</code>包中的<code class="eh jr js jt ju b">get_array()</code>函数。您还可以在有序的列表字典中获取数据。您可以使用<code class="eh jr js jt ju b">get_dict()</code>功能。</p><p id="27e3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是，您还会看到，如果您想获得一个二维数组的字典，或者换句话说，在一个字典中获得所有的工作簿工作表，您可以求助于<code class="eh jr js jt ju b">get_book_dict()</code>。</p><p id="93c5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意，上面提到的这两种数据结构，电子表格的数组和字典，允许你用<code class="eh jr js jt ju b">pd.DataFrame()</code>创建数据的数据框架。这将使处理您的数据变得更加容易！</p><p id="b7ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，由于有了<code class="eh jr js jt ju b">get_records()</code>功能，您还可以使用<code class="eh jr js jt ju b">pyexcel</code>来检索记录。只需将参数<code class="eh jr js jt ju b">file_name</code>传递给函数，您应该会得到一个字典列表。要了解如何操作Python列表，请查看我们的<a class="ae jq" href="https://www.datacamp.com/community/tutorials/18-most-common-python-list-questions-learn-python" rel="noopener ugc nofollow" target="_blank"> 18个最常见的Python列表问题</a>。</p><p id="2b3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就像使用这个包可以很容易地将数据加载到数组中一样，您也可以很容易地将数组导出到电子表格中。使用<code class="eh jr js jt ju b">save_as()</code>函数并将数组和目标文件的名称传递给<code class="eh jr js jt ju b">dest_file_name</code>参数。请注意，如果您想要指定一个分隔符，您可以添加<code class="eh jr js jt ju b">dest_delimiter</code>参数，并在<code class="eh jr js jt ju b">""</code>之间传递您想要用作分隔符的符号。</p><p id="a5a5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，如果你有一本字典，你将需要使用<code class="eh jr js jt ju b">save_book_as()</code>函数。将二维字典传递给<code class="eh jr js jt ju b">bookdict</code>并指定文件名，就可以了。当您使用上面代码块中打印的代码时，您应该记住的一点是，您的数据在字典中的顺序不会被保留。如果你不想这样，你就需要走一个小弯路。你可以在这里阅读全部内容<a class="ae jq" href="https://pyexcel.readthedocs.io/en/latest/tutorial_data_conversion.html#save-an-array-to-an-excel-sheet" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="4387" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果除了Pandas之外，你还在寻找允许你加载和写入数据到<code class="eh jr js jt ju b">.csv</code>文件的包，你最好使用<code class="eh jr js jt ju b">csv</code>包。还要注意的是，NumPy包有一个函数<code class="eh jr js jt ju b">genfromtxt()</code>，它允许您加载包含在数组中的<code class="eh jr js jt ju b">.csv</code>文件中的数据，然后您可以将这些数据放入数据帧中。你可以在DataCamp的<a class="ae jq" href="https://www.datacamp.com/community/tutorials/python-numpy-tutorial" rel="noopener ugc nofollow" target="_blank"> NumPy教程</a>中找到更多关于这个函数的信息。</p><h1 id="e688" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">对您的数据进行最终检查</h1><p id="e031" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">当数据可用时，不要忘记最后一步:检查数据是否已经正确加载。如果您已经将数据放入数据框架中，您可以轻松快速地检查导入是否成功。</p><p id="2df7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">提示</strong>:当你考虑将文件作为熊猫数据帧加载时，使用DataCamp的<a class="ae jq" href="https://www.datacamp.com/community/blog/python-pandas-cheat-sheet" rel="noopener ugc nofollow" target="_blank">熊猫备忘单</a>。关于如何操作Python数据帧的更多指导，请阅读我们的<a class="ae jq" href="https://www.datacamp.com/community/tutorials/pandas-tutorial-dataframe-python" rel="noopener ugc nofollow" target="_blank"> Pandas教程:Python中的数据帧</a>。</p><p id="cb7d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你有一个数组中的数据，你可以使用下面的数组属性来检查它:<code class="eh jr js jt ju b">shape</code>、<code class="eh jr js jt ju b">ndim</code>、<code class="eh jr js jt ju b">dtype</code>等。</p><p id="c2ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您想了解更多关于如何利用NumPy数组进行数据分析的信息，也可以考虑浏览一下我们的<a class="ae jq" href="https://www.datacamp.com/community/tutorials/python-numpy-tutorial" rel="noopener ugc nofollow" target="_blank"> NumPy教程</a>，并且一定不要忘记使用我们的<a class="ae jq" href="https://www.datacamp.com/community/blog/python-numpy-cheat-sheet" rel="noopener ugc nofollow" target="_blank"> NumPy备忘单</a>！</p><h1 id="e2f1" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">下一步是什么？</h1><p id="fbd8" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">恭喜你！您已经成功地完成了我们的教程，该教程教您如何使用Python读取Excel文件。</p><p id="b935" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是导入数据只是数据科学工作流程的开始。一旦您的环境中有了来自电子表格的数据，您就可以专注于真正重要的事情:分析您的数据。如果您已经将数据加载到数据框架中，可以考虑参加我们的<a class="ae jq" href="https://www.datacamp.com/courses/pandas-foundations" rel="noopener ugc nofollow" target="_blank">熊猫基础课程</a>或<a class="ae jq" href="https://www.datacamp.com/courses/manipulating-dataframes-with-pandas" rel="noopener ugc nofollow" target="_blank">用熊猫操纵数据框架</a>课程，这两个课程都是由连续分析公司的培训总监、Anaconda的创造者和驱动力Dhavide Aruliah教授的。</p><p id="655a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，如果你想继续研究这个主题，可以考虑看看<a class="ae jq" href="https://www.enthought.com/products/pyxll/introduction/" rel="noopener ugc nofollow" target="_blank"> PyXll </a>，它允许用Python编写函数，并在Excel中调用它们。</p></div><div class="ab cl mm mn hc mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="hn ho hp hq hr"><p id="05e1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">原载于</em><a class="ae jq" href="http://www.datacamp.com/community/tutorials/python-excel-tutorial" rel="noopener ugc nofollow" target="_blank"><em class="jp">www.datacamp.com</em></a><em class="jp">。</em></p><div class="jw jx jy jz fq ab cb"><figure class="mt ka mu mv mw mx my paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mt ka mu mv mw mx my paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mt ka mu mv mw mx my paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mz na nb"><p id="f922" class="ir is jp it b iu iv iw ix iy iz ja jb nc jd je jf nd jh ji jj ne jl jm jn jo hn dt translated"><a class="ae jq" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae jq" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jq" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>的机会。</p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb nc jd je jf nd jh ji jj ne jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jq" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jq" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff nf"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="ng nh l"/></div></figure></div></div>    
</body>
</html>