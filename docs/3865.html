<html>
<head>
<title>Unnecessary promise wrapping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不必要的承诺包装</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/unnecessary-promise-wrapping-4ab64b2e985f?source=collection_archive---------11-----------------------#2017-04-27">https://medium.com/hackernoon/unnecessary-promise-wrapping-4ab64b2e985f?source=collection_archive---------11-----------------------#2017-04-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="8f8c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">假设你正在开发一个有函数<code class="eh jp jq jr js b">isPi</code>的数学库。</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="8dcb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您可能会说—我们不想关心将数据放在哪里(数据库、网络等)。所以，这个功能应该得到一个承诺:</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="74fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们可以像这样使用函数:</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="6e22" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很酷，是吗？<strong class="it hv">号</strong></p><p id="6581" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你没有“包装任意的用户<a class="ae ka" href="https://hackernoon.com/tagged/code" rel="noopener ugc nofollow" target="_blank">代码</a>在承诺中，不必关心用户的代码是同步的还是异步的”，但是一个承诺是在某个时刻会用一些数据解决或者用一些错误拒绝的东西</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="fabf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以，我可以删除一些不必要的代码</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="77a5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以问:<em class="kb">好吧，初始代码是多余的，但为什么是坏的？</em>添加一些错误处理的时候问题就出现了。您可以使用下面的代码轻松完成:</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="5ac8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是错误的，因为<code class="eh jp jq jr js b">isPi</code>实现对承诺的来源有太多的了解。重写这段代码的正确方法如下:</p><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="jy jz l"/></div></figure><p id="3b5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以，这里有两条经验法则:</p><ol class=""><li id="a098" class="kc kd hu it b iu iv iy iz jc ke jg kf jk kg jo kh ki kj kk dt translated">尽可能“靠近”错误的来源来处理错误</li><li id="ddc2" class="kc kd hu it b iu kl iy km jc kn jg ko jk kp jo kh ki kj kk dt translated">将异步操作与同步操作分开。将一切都视为异步操作会导致耦合代码。</li></ol><blockquote class="kq kr ks"><p id="ac23" class="ir is kb it b iu iv iw ix iy iz ja jb kt jd je jf ku jh ji jj kv jl jm jn jo hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is kb it b iu iv iw ix iy iz ja jb kt jd je jf ku jh ji jj kv jl jm jn jo hn dt translated">要了解更多信息，请阅读我们的“关于”页面、<a class="ae ka" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书</a>上给我们点赞/发消息，或者简单地发送<a class="ae ka" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is kb it b iu iv iw ix iy iz ja jb kt jd je jf ku jh ji jj kv jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jt ju jv jw fq jx"><div class="bz el l di"><div class="kw jz l"/></div></figure></div></div>    
</body>
</html>