<html>
<head>
<title>Improve your command-line Go application with Promptui</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Promptui改进您的命令行Go应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/improve-your-command-line-go-application-with-promptui-258ebe9eed1?source=collection_archive---------14-----------------------#2017-12-07">https://medium.com/hackernoon/improve-your-command-line-go-application-with-promptui-258ebe9eed1?source=collection_archive---------14-----------------------#2017-12-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/f2b31fce4145530a886397cccca4c25b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50kRjlu0fgtTNpe8gLs15w.png"/></div></div></figure><p id="1c98" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">promptui 是一个Go库，它提供了一个简单的界面来创建cli提示符。该库有两种主要模式:<em class="kb">提示</em>——为用户输入提供单行，以及<em class="kb">选择</em>——显示可供选择的项目列表。两种模式都有几个定制选项，并利用强大的<a class="ae ka" href="https://github.com/chzyer/readline" rel="noopener ugc nofollow" target="_blank"> readline </a>支持多个终端。</p><p id="6be4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这篇文章中，我们将创建一个食物食谱命令行应用程序，它询问菜肴类型，从API中检索信息，并显示相关的食谱。</p><p id="3c61" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你想跳到完整的应用程序源代码，去:<a class="ae ka" href="https://github.com/luizbranco/promptui-demo/" rel="noopener ugc nofollow" target="_blank">https://github.com/luizbranco/promptui-demo/</a></p><h1 id="c0c3" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">初始提示</h1><p id="94a9" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">在我们开始应用之前，我们首先需要获得库:</p><pre class="lf lg lh li fq lj lk ll lm aw ln dt"><span id="0e17" class="lo kd hu lk b fv lp lq l lr ls">go get -u github.com/manifoldco/promptui</span></pre><p id="80ea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有了这个，我们就可以开始写我们的<code class="eh lt lu lv lk b">main.go</code>文件了。</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="c537" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您随后运行该程序，您应该会看到一个要求搜索的提示:</p><pre class="lf lg lh li fq lj lk ll lm aw ln dt"><span id="1c96" class="lo kd hu lk b fv lp lq l lr ls">go run main.go</span></pre><p id="fcae" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这看起来不错，但是如果我们只是按下enter而不输入信息，它仍然可以工作。如果我们能防止空搜索就好了。因此，让我们在提示中添加一个验证:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="ly lx l"/></div></figure><p id="6dee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个非常简单的验证。但是您可以使用regexp或<a class="ae ka" href="https://github.com/asaskevich/govalidator" rel="noopener ugc nofollow" target="_blank"> govalidator </a>创建更复杂的。</p><h1 id="5ff8" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">检索数据</h1><p id="42e7" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">对于这个cli应用程序，我们将使用棒极了的<a class="ae ka" href="http://www.recipepuppy.com" rel="noopener ugc nofollow" target="_blank"> RecipePuppy </a>来搜索食谱。它的<a class="ae ka" href="https://hackernoon.com/tagged/api" rel="noopener ugc nofollow" target="_blank"> API </a>不需要认证，所以非常适合我们的<a class="ae ka" href="https://hackernoon.com/tagged/experiment" rel="noopener ugc nofollow" target="_blank">实验</a>。</p><p id="13b6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，我们定义如何请求数据:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="93b8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">那很简单！现在我们必须解析响应JSON。首先，我们需要一个返回数据的示例:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="5c37" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">正如我们所看到的，有一个带有标题、链接和每个食谱的成分列表的结果数组。这样，我们可以定义一些结构来解析主体:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><h1 id="b1a2" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">显示数据</h1><p id="904c" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">既然我们已经解析了食谱列表，我们可以使用<em class="kb"> Select </em>向用户显示它。</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="ly lx l"/></div></figure><p id="185e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">嗯，那有点难看。这里的问题是promptui通常期望显示一部分字符串。但是我们有配方结构。我们必须教promptui如何展示它们。这时模板就派上了用场:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="ba3c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你使用过Go <a class="ae ka" href="https://golang.org/pkg/html/template/" rel="noopener ugc nofollow" target="_blank">模板/html </a>，你应该对语法很熟悉。Promptui开箱即用支持一些模板功能，如颜色和样式，但您可以定义自己的助手。</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="ly lx l"/></div></figure><p id="9e4a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">好多了！注意这里的披萨unicode符号。Go支持UTF-8源代码👍。</p><h1 id="c8c9" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">其他详细信息</h1><p id="dcb3" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">因为我们也有一个成分列表，所以当用户使用<code class="eh lt lu lv lk b">Details</code>模板选项悬停在一个元素上时，我们可以显示它。但首先，让我们成为良好的cli公民，避免一长串的成分！</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="e9bc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这定义了一个定制的助手函数，它截断长度超过X个字符的字符串。然后我们将模板更改为:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><h1 id="00d1" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">搜索</h1><p id="98d7" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">最后，允许用户在列表中搜索菜谱名称或配料:</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="7eea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">与验证示例一样，这是一个简单的字符串搜索，但是您可以根据需要进行复杂的搜索。</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="ly lx l"/></div></figure><h1 id="3295" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">最后的想法</h1><p id="9638" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">promptui是我们的<a class="ae ka" href="https://github.com/manifoldco/manifold-cli" rel="noopener ugc nofollow" target="_blank">命令行工具</a> <a class="ae ka" href="https://www.manifold.co/" rel="noopener ugc nofollow" target="_blank">歧管</a>的一部分，当用户没有输入命令所需的所有标志时，我们主要使用它作为后备。这个小应用程序展示了promptui的一些特性，但是这个库还能提供更多。确保查看<a class="ae ka" href="https://github.com/manifoldco/promptui" rel="noopener ugc nofollow" target="_blank"> Github项目页面</a>。</p><figure class="lf lg lh li fq iv"><div class="bz el l di"><div class="lz lx l"/></div></figure></div></div>    
</body>
</html>