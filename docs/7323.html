<html>
<head>
<title>TensorRec: A Recommendation Engine Framework in TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">tensor rec:tensor flow中的推荐引擎框架</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/tensorrec-a-recommendation-engine-framework-in-tensorflow-d85e4f0874e8?source=collection_archive---------2-----------------------#2017-10-24">https://medium.com/hackernoon/tensorrec-a-recommendation-engine-framework-in-tensorflow-d85e4f0874e8?source=collection_archive---------2-----------------------#2017-10-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e259" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当构建推荐系统时，当真正的进展来自于开发更好地理解我的用户和项目的算法时，我对我在数据操作和API构建上花费的精力感到沮丧。</p><p id="7cd5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是为什么我建立了TensorRec ，这是一个旨在简化基于TensorFlow推荐引擎的物流的框架，让你专注于有趣的事情:开发你对表示(也称为嵌入)函数、损失函数和更健壮的<a class="ae jp" href="https://hackernoon.com/tagged/learning" rel="noopener ugc nofollow" target="_blank">学习的想法</a>。</p><p id="44c3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">2019年1月22日编辑:TensorRec </em> 现在有了 <a class="ae jp" rel="noopener" href="/@jameskirk1/getting-started-with-recommender-systems-and-tensorrec-8f50a9943eef"> <em class="jq">入门指南</em></a></p><p id="8d2d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">TensorRec是一种推荐算法，具有用于训练和预测的简单API，类似于Python中常见的机器学习<a class="ae jp" href="https://hackernoon.com/tagged/tools" rel="noopener ugc nofollow" target="_blank">工具</a>。它还为您提供了试验自己的表示和损失函数的灵活性，让您可以构建一个适合于理解特定用户和项目的推荐系统。</p><p id="2c0a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">TensorRec项目还很年轻，但是我邀请您提供任何用法、参与或批评。</p><p id="4736" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在建立TensorRec的过程中，我有四个目标:</p><ol class=""><li id="8b2c" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">构建一个能够从明确的正面和负面反馈中学习的推荐引擎。</li><li id="38fa" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">允许将任意张量流图用作表示函数和损失函数。</li><li id="9f3b" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">为表示函数和损失函数提供合理的默认值。</li><li id="bd97" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">将尽可能多的机器学习术语打包到一个中等帖子中。</li></ol><p id="f56e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然前三个目标仍在进行中——你的里程可能会有所不同——但我对第四个目标非常满意。</p><h1 id="6173" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">它是如何工作的</h1><p id="86da" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">TensorRec通过消费用户和项目<a class="ae jp" href="https://en.wikipedia.org/wiki/Feature_(machine_learning)" rel="noopener ugc nofollow" target="_blank">特征</a>(id、标签或其他元数据)并构建两个低维向量，一个“用户表示”和一个“项目表示”，来对推荐进行评分。这两个向量的<a class="ae jp" href="https://en.wikipedia.org/wiki/Dot_product" rel="noopener ugc nofollow" target="_blank">点积</a>是该用户和该项目之间关系的得分——最高得分被预测为最佳推荐。</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="adc3" class="lr kg hu ln b fv ls lt l lu lv"># Predict scores for all users and all items<br/>predictions = model.predict(user_features=user_features,<br/>                            item_features=item_features)</span></pre><p id="9a98" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用于生成这些表示的算法称为表示函数，可以定制:可以应用从直接线性变换到深度神经网络的任何东西，这取决于您需要TensorRec解决的问题的细节和您可用的特征数据。此外，用户和项目表示功能可以独立定制。你可以在这里找到一个表示函数定制<a class="ae jp" href="https://github.com/jfkirk/tensorrec/wiki/Representation-Graphs" rel="noopener ugc nofollow" target="_blank">的例子。</a></p><p id="8294" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">TensorRec通过将其生成的分数与用户和物品之间的实际交互(喜欢/不喜欢)进行比较来进行学习。比较器被称为“损失函数”，TensorRec还允许您自定义自己的损失函数。你可以在这里找到一个自定义损失函数<a class="ae jp" href="https://github.com/jfkirk/tensorrec/wiki/Loss-Graphs" rel="noopener ugc nofollow" target="_blank">的例子</a>。</p><p id="3cd0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用于拟合TensorRec模型的函数类似于用于其他常见机器学习工具的拟合函数:</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="78bb" class="lr kg hu ln b fv ls lt l lu lv"># Fit the model for 5 epochs<br/>model.fit(interactions, user_features, item_features,<br/>          epochs=5, verbose=True)</span></pre><figure class="li lj lk ll fq lx fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff lw"><img src="../Images/4378bfc57cb01e2f173b0e5e4e96d28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7HdQ__6RDdtueu-GMETkng.png"/></div></div><figcaption class="me mf fg fe ff mg mh bd b be z ek">Update 3/30/18 — System Diagram</figcaption></figure><h1 id="5907" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">灵感</h1><p id="b3e5" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">我已经广泛使用了由马切伊·库拉和<a class="mi mj gr" href="https://medium.com/u/e49fe8455a34?source=post_page-----d85e4f0874e8--------------------------------" rel="noopener" target="_blank"> Lyst </a>开发的<a class="ae jp" href="https://github.com/lyst/lightfm" rel="noopener ugc nofollow" target="_blank"> LightFM </a>，我对它的性能和可用性印象深刻。我在这里写了一篇关于使用LightFM <a class="ae jp" rel="noopener" href="/product-at-catalant-technologies/using-lightfm-to-recommend-projects-to-consultants-44084df7321c">的博文</a>。</p><figure class="li lj lk ll fq lx fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/9762664fcb90f88036564bfa6b8c4647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wamAT2hw_sYn0dy8Pftavw.png"/></div></figure><p id="a574" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">LightFM通过充当因式分解机器并学习每个特征的线性嵌入来生成用户和项目表示。通过取这两个表示向量的点积，可以得到一个无单位的分数，当对这个分数进行排序时，它会告诉你一个给定的用户-项目匹配的好坏。</p><p id="6be1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这种线性因子分解方法是有效的，计算效率高，但我在使用LightFM时遇到了不平衡、冗余、不一致或高度相关的特征的问题——学习有意义地嵌入这些特征需要更复杂的表示函数，如深度神经网络。该表示功能将能够学习用户和项目特征中的细微关系，并增加系统的总体信息容量。这让我对探索非线性表示函数的选项感到好奇，我开发了TensorRec作为框架来做这件事。</p><h1 id="d6fb" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">TensorFlow求推荐</h1><p id="77c8" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated"><a class="ae jp" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow，</a>最初由Google开发，是一个开源工具，允许您构建、优化和分发大型、任意的机器学习系统。</p><figure class="li lj lk ll fq lx fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff ml"><img src="../Images/60eda5021e319a8e568c2abd0061e238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pidw2QNb9nG5BrcNzbY4NA.jpeg"/></div></div></figure><p id="70f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在TensorFlow中，机器学习过程被表示为“图形”,显示数据如何在系统中流动。这些图表可以使用<a class="ae jp" href="https://www.tensorflow.org/get_started/summaries_and_tensorboard" rel="noopener ugc nofollow" target="_blank"> TensorBoard </a>可视化，给出手头的机器学习过程的更清晰的解释。</p><figure class="li lj lk ll fq lx fe ff paragraph-image"><div class="fe ff mm"><img src="../Images/f6e072a70420605d00432264e07d1280.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*uxA7W7d1rO9tjziEGSdPOg.png"/></div><figcaption class="me mf fg fe ff mg mh bd b be z ek">A single ReLU layer of a neural network shown as a TensorFlow graph.</figcaption></figure><p id="00f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了构建我们的推荐系统，我们需要完成四项任务的张量流图:</p><ol class=""><li id="1817" class="jr js hu it b iu iv iy iz jc jt jg ju jk jv jo jw jx jy jz dt translated">将输入数据转换为便于嵌入的特征张量。</li><li id="cabb" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">将用户/项目特征张量转换为用户/项目表示(表示功能)。</li><li id="68ae" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">将一对表示转换成一个预测。</li><li id="17c0" class="jr js hu it b iu ka iy kb jc kc jg kd jk ke jo jw jx jy jz dt translated">将预测值和真实值转换为损失值(损失函数)。</li></ol><p id="3b46" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">TensorRec解决了1和3，同时为2和4提供了模块化和合理的默认值，让您可以自由地试验表示和损失函数。你所需要做的就是插入一个函数，构建你的自定义表示函数图或损失函数图，就像<a class="ae jp" href="https://github.com/jfkirk/tensorrec/wiki/Representation-Graphs" rel="noopener ugc nofollow" target="_blank">这个例子</a>。</p><h1 id="2a49" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">少了什么</h1><p id="ee1d" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">信息检索的许多最新进展都来自复杂的损失函数。我特别感兴趣的是成对的损失函数，如<a class="ae jp" href="http://www.thespermwhale.com/jaseweston/papers/wsabie-ijcai.pdf" rel="noopener ugc nofollow" target="_blank">扭曲</a>，但这些很难用张量流图来表示。TensorRec对用户的价值将随着这些损失函数的实施而增加。</p><p id="feef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对TensorRec有价值的补充是处理大量交互数据、管理模型状态和处理隐式交互的新特性。</p></div><div class="ab cl mn mo hc mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hn ho hp hq hr"><p id="ca2b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想为TensorRec做贡献，或者只是尝试一下，我很乐意在GitHub上或者在这篇文章的评论区听到你的反馈。</p><p id="e0d6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">注:这是一个个人项目，在撰写本文时，与Spotify无关</em></p><figure class="li lj lk ll fq lx"><div class="bz el l di"><div class="mu mv l"/></div></figure></div></div>    
</body>
</html>