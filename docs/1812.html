<html>
<head>
<title>1-Minute Multi-Node VM Setup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">1分钟多节点虚拟机设置</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/1-minute-multi-node-vm-setup-413dfc836fc9?source=collection_archive---------8-----------------------#2016-12-09">https://medium.com/hackernoon/1-minute-multi-node-vm-setup-413dfc836fc9?source=collection_archive---------8-----------------------#2016-12-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><h1 id="0d11" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">TL；博士；医生</h1><p id="82d3" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在本地计算机上使用有用的DNS快速启动多个虚拟机，轻松自动化复杂的环境。</p><p id="5a46" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated"><strong class="jr hv">这里有一个视频:</strong></p><div class="ks kt fm fo ku kv"><a href="https://asciinema.org/a/95530" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">多节点虚拟机设置</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">伊恩米尔录制的</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">asciinema.org</p></div></div><div class="le l"><div class="lf l lg lh li le lj lk kv"/></div></div></a></div><h1 id="a83d" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">介绍</h1><p id="7129" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">保持<a class="ae ll" href="https://hackernoon.com/tagged/docker" rel="noopener ugc nofollow" target="_blank"> Docker </a>的规模，我更关心虚拟机的集群，而不是容器本身。</p><p id="eba8" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">讽刺的是，我没有忘记这一点。</p><p id="041e" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">我经常需要启动机器集群。这要么非常慢/不可靠(Enterprise OpenStack实现)，要么非常昂贵(Amazon)。</p><p id="5fba" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">显而易见的答案是使用流浪者，但<a class="ae ll" href="https://hackernoon.com/tagged/managing" rel="noopener ugc nofollow" target="_blank">管理</a>这可能具有挑战性。</p><p id="327e" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">所以我在这里介绍一个非常简单的方法来建立一个有用的流浪者集群。有了这个框架，你就可以自动化你的“真实”环境，随心所欲地玩耍。</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="4f6d" class="lv is hu lr b fv lw lx l ly lz">$ <strong class="lr hv">pip install shutit</strong><br/>$ <strong class="lr hv">shutit skeleton</strong></span><span id="511e" class="lv is hu lr b fv ma lx l ly lz"># Input a name for this module.<br/># Default: /Users/imiell/shutit_resins</span><span id="4c47" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv">[hit return to take default]</strong></span><span id="24b9" class="lv is hu lr b fv ma lx l ly lz"># Input a ShutIt pattern.<br/>Default: bash<br/>bash: a shell script<br/>docker: a docker image build<br/>vagrant: a vagrant setup<br/>docker_tutorial: a docker-based tutorial<br/>shutitfile: a shutitfile-based project</span><span id="d28a" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv">[type in vagrant]</strong></span><span id="f482" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv">vagrant</strong></span><span id="1831" class="lv is hu lr b fv ma lx l ly lz">How many machines do you want (default: 3)? 3</span><span id="e2e6" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv">[hit return to take default]</strong></span><span id="2155" class="lv is hu lr b fv ma lx l ly lz">What do you want to call the machines (eg superserver) (default: machine)?</span><span id="7440" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv">[hit return to take default]</strong></span><span id="07d8" class="lv is hu lr b fv ma lx l ly lz">Do you want to have open ssh access between machines? (default: yes) <strong class="lr hv">yes</strong></span><span id="2dc8" class="lv is hu lr b fv ma lx l ly lz">Initialized empty Git repository in /Users/imiell/shutit_resins/.git/<br/>Cloning into ‘shutit-library’...<br/>remote: Counting objects: 1322, done.<br/>remote: Compressing objects: 100% (33/33), done.<br/>remote: Total 1322 (delta 20), reused 0 (delta 0), pack-reused 1289<br/>Receiving objects: 100% (1322/1322), 1.12 MiB | 807.00 KiB/s, done.<br/>Resolving deltas: 100% (658/658), done.<br/>Checking connectivity… done.</span><span id="2c78" class="lv is hu lr b fv ma lx l ly lz"># Run:<br/>cd /Users/imiell/shutit_resins &amp;&amp; ./run.sh<br/>to run.</span><span id="8587" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv">[follow the instructions to run up your cluster.</strong></span><span id="01ff" class="lv is hu lr b fv ma lx l ly lz">$ <strong class="lr hv">cd /Users/imiell/shutit_resins &amp;&amp; ./run.sh</strong></span></pre><p id="3078" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">这将自动运行一个n节点集群，然后结束。</p><p id="933a" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">注意:请确保您的机器上有足够的资源来运行此操作！</p><p id="bbab" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">顺便说一句，如果您重新运行run.sh，它会自动清除脚本启动的以前的虚拟机，以防止您的机器因旧机器而停止运行。</p><div class="ks kt fm fo ku kv"><a href="https://asciinema.org/a/95530" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">多节点虚拟机设置</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">伊恩米尔录制的</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">asciinema.org</p></div></div><div class="le l"><div class="lf l lg lh li le lj lk kv"/></div></div></a></div><h1 id="f485" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">更深入</h1><p id="99b3" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">您可以根据需要自动设置这些节点。</p><p id="8019" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">例如:</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="4150" class="lv is hu lr b fv lw lx l ly lz">def build(self, shutit):<br/>[... go to end of this function ...]</span><span id="2c02" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv"># Install apache<br/>    shutit.login(command='vagrant ssh machine1')<br/>    shutit.login(command='sudo su - ')<br/>    shutit.install('apache2')<br/>    shutit.logout()<br/>    shutit.logout()</strong></span><span id="017b" class="lv is hu lr b fv ma lx l ly lz"><strong class="lr hv"># Go to machine2 and call machine1's server<br/>    shutit.login(command='vagrant ssh machine2')<br/>    shutit.login(command='sudo su -')<br/>    shutit.install('curl')<br/>    shutit.send('curl machine1.vagrant.test')<br/>    shutit.logout()<br/>    shutit.logout()</strong></span></pre><p id="13be" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated">将设置一个apache服务器，并从第二台机器向第一台机器发送请求。</p><h1 id="3316" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated"><strong class="ak">例题</strong></h1><p id="e28a" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这显然是一个简单的例子。我在这些更复杂的设置中使用了这种方法，它们很有启发性，也很有用:</p><h2 id="db05" class="lv is hu bd it mb mc md ix me mf mg jb ka mh mi jf ke mj mk jj ki ml mm jn mn dt translated">Chef服务器和客户端</h2><p id="16e1" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">创建一个chef服务器和客户端。</p><div class="ks kt fm fo ku kv"><a href="https://github.com/ianmiell/shutit-chef-env" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">ianmiell/shutit-chef-env</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">shutit-chef-env - Chef服务器内自动设置的流浪者</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">github.com</p></div></div><div class="le l"><div class="mo l lg lh li le lj lk kv"/></div></div></a></div><h2 id="635e" class="lv is hu bd it mb mc md ix me mf mg jb ka mh mi jf ke mj mk jj ki ml mm jn mn dt translated">码头工人群</h2><p id="bc19" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">创建一个3节点码头群</p><div class="ks kt fm fo ku kv"><a href="https://github.com/ianmiell/shutit-library/blob/master/swarm/swarm.py" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">Ian miell/shut it-图书馆</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">在GitHub上创建一个帐户，为shutit-library的开发做出贡献。</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">github.com</p></div></div><div class="le l"><div class="mp l lg lh li le lj lk kv"/></div></div></a></div><h2 id="52e6" class="lv is hu bd it mb mc md ix me mf mg jb ka mh mi jf ke mj mk jj ki ml mm jn mn dt translated">OpenShift集群</h2><p id="4d85" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这个例子使用标准的ansible脚本建立了一个完整的OpenShift集群。</p><div class="ks kt fm fo ku kv"><a href="https://github.com/ianmiell/shutit-openshift-cluster" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">ianmiell/shut it-open shift-cluster</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">使用ansible建立基于shut it-openshift-cluster-vagger的open shift源集群</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">github.com</p></div></div><div class="le l"><div class="mq l lg lh li le lj lk kv"/></div></div></a></div><h2 id="ac2e" class="lv is hu bd it mb mc md ix me mf mg jb ka mh mi jf ke mj mk jj ki ml mm jn mn dt translated">OpenShift上etcd迁移的自动化</h2><p id="1373" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">上面代码的这个分支使用备选Chef脚本设置OpenShift，并将etcd集群从一组节点迁移到另一组节点。</p><div class="ks kt fm fo ku kv"><a href="https://github.com/ianmiell/shutit-openshift-cluster/tree/chef_etcd_migration" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">ianmiell/shut it-open shift-cluster</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">使用ansible建立基于shut it-openshift-cluster-vagger的open shift源集群</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">github.com</p></div></div><div class="le l"><div class="mr l lg lh li le lj lk kv"/></div></div></a></div><h2 id="7d99" class="lv is hu bd it mb mc md ix me mf mg jb ka mh mi jf ke mj mk jj ki ml mm jn mn dt translated">码头公证人</h2><p id="b5fe" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">建立一个码头公证沙箱。</p><div class="ks kt fm fo ku kv"><a href="https://github.com/ianmiell/shutit-notary-trust-sandbox" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab ej"><div class="kx ab ky cl cj kz"><h2 class="bd hv fv z el la eo ep lb er et ht dt translated">ianmiell/shut it-公证-信任-沙盒</h2><div class="lc l"><h3 class="bd b fv z el la eo ep lb er et ek translated">通过在GitHub上创建一个帐户，为shut it-公证人-信托-沙盒开发做出贡献。</h3></div><div class="ld l"><p class="bd b gc z el la eo ep lb er et ek translated">github.com</p></div></div><div class="le l"><div class="ms l lg lh li le lj lk kv"/></div></div></a></div><h1 id="8cc7" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">招聘广告</h1><p id="c238" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">如果您需要一个环境，或者可以改进以上任何设置，请告诉我:@ianmiell</p><h1 id="80f8" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">了解更多信息</h1><p id="facb" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我的书<a class="ae ll" href="http://manning.com/miell/?a_aid=zwischenzugs&amp;a_bid=e0d48f62" rel="noopener ugc nofollow" target="_blank"> Docker in Practice </a>:</p><figure class="lm ln lo lp fq mu fe ff paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="fe ff mt"><img src="../Images/b89fe083a23c57654b75ab6836751a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/0*V9jkBlIyI3UZefQq.jpg"/></div></div></figure><p id="f56f" class="pw-post-body-paragraph jp jq hu jr b js kn ju jv jw ko jy jz ka kp kc kd ke kq kg kh ki kr kk kl km hn dt translated"><strong class="jr hv"> <em class="na">代码:39米尔</em> </strong>享受39折优惠</p><div class="lm ln lo lp fq ab cb"><figure class="nb mu nc nd ne nf ng paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nb mu nc nd ne nf ng paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nb mu nc nd ne nf ng paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nh ni nj"><p id="f922" class="jp jq na jr b js kn ju jv jw ko jy jz nk kp kc kd nl kq kg kh nm kr kk kl km hn dt translated"><a class="ae ll" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ll" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ll" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ll" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jp jq na jr b js kn ju jv jw ko jy jz nk kp kc kd nl kq kg kh nm kr kk kl km hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ll" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ll" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lm ln lo lp fq mu fe ff paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="fe ff nn"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="lm ln lo lp fq mu"><div class="bz el l di"><div class="no np l"/></div></figure></div></div>    
</body>
</html>