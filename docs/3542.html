<html>
<head>
<title>Angular v4: Practical Countries Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度v4:实际国家应用</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/angular-v4-practical-countries-application-f866b567ead1?source=collection_archive---------3-----------------------#2017-04-07">https://medium.com/hackernoon/angular-v4-practical-countries-application-f866b567ead1?source=collection_archive---------3-----------------------#2017-04-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/cf9183b72e00030fbd173fa9e4f54ba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RJ-r_WLNC7KWLTCllbPaew.png"/></div></div></figure><p id="7f7c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ka">本</em>条</strong> <strong class="je hv"> <em class="ka">原本出现在</em></strong><a class="ae kb" href="https://dormoshe.io/articles/angular-v4-practical-countries-application-3" rel="noopener ugc nofollow" target="_blank"><strong class="je hv"><em class="ka">dormoshe . io</em></strong></a></p><p id="80c3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">countries-data项目提供了关于国家概况、语言和国歌的JSON数据。该项目托管在GitHub存储库中，并在npm中发布。存储在typescript文件中并准备在项目中使用的数据。</p><p id="1cb9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本文中，我们将回顾国家数据结构，查看示例并展示如何通过Angular v4应用程序使用它。此外，我们将学习如何使用InjectionToken。</p><p id="1277" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">可以玩<a class="ae kb" href="https://dormd.github.io/countries-data-angular4/" rel="noopener ugc nofollow" target="_blank">演示应用</a>。</p></div><div class="ab cl kc kd hc ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hn ho hp hq hr"><h1 id="5bff" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">装置</h1><p id="6b7f" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated"><code class="eh lm ln lo lp b">npm install countries-data</code></p><h1 id="2504" class="kj kk hu bd kl km lq ko kp kq lr ks kt ku ls kw kx ky lt la lb lc lu le lf lg dt translated">ISO 3166–1 alpha-2代码</h1><p id="a1a7" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">国家数据基于<a class="ae kb" href="https://en.m.wikipedia.org/wiki/ISO_3166-1_alpha-2" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">ISO 3166-1 alpha-2</strong></a>(本文中的a2)国家代码。a2代码是ISO 3166-1定义的两个字母的国家代码，是国际标准化组织(ISO)发布的ISO 3166标准的一部分，用于表示国家、附属领土和特殊地理区域。它们是ISO发布的使用最广泛的国家/地区代码，在互联网国家/地区代码顶级域名中使用最为广泛。</p><h1 id="6252" class="kj kk hu bd kl km lq ko kp kq lr ks kt ku ls kw kx ky lt la lb lc lu le lf lg dt translated">国家数据结构</h1><p id="4762" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">每个国家的数据包含许多细节，如国家的名称(普通，官方，本土)，居民，首都，其他代码，语言，国家的名称翻译，地理数据(经度，纬度，大陆，地区，面积，边界国家)，拨号信息，人口，维基百科链接等..</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">Part of Israel’s object</figcaption></figure><p id="dd47" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以在GitHub的readme文件中看到<a class="ae kb" href="https://github.com/dormd/countries-data/blob/master/README.md#data-structure" rel="noopener ugc nofollow" target="_blank">的完整数据结构</a>和一个<a class="ae kb" href="https://github.com/dormd/countries-data#example-israel" rel="noopener ugc nofollow" target="_blank">国家的例子</a>。在现实生活中，如此大量的数据通常保存在数据库中，但对于我们的迷你应用程序，我们可以尽情发挥。</p><figure class="lv lw lx ly fq iv fe ff paragraph-image"><div class="fe ff mf"><img src="../Images/558928cc07a6e3db55ca0e33f85dae06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*oQisH_nkWDbYzNWxQspdQg@2x.jpeg"/></div></figure><h1 id="b05d" class="kj kk hu bd kl km lq ko kp kq lr ks kt ku ls kw kx ky lt la lb lc lu le lf lg dt translated">语言数据结构</h1><p id="0148" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">每个语言数据包含完整的语言名称、说话者(如果母语说话者存在于<a class="ae kb" href="https://responsivevoice.org" rel="noopener ugc nofollow" target="_blank"> responsivevoice.js </a>服务中)、备选说话者和说话者性别限制。这将在以后的文章中讨论。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">Some languages objects</figcaption></figure><p id="dba4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以在GitHub知识库自述文件中看到<a class="ae kb" href="https://github.com/dormd/countries-data/blob/master/README.md#data-structure-1" rel="noopener ugc nofollow" target="_blank">的完整数据结构</a>和一个<a class="ae kb" href="https://github.com/dormd/countries-data/blob/master/README.md#example-hebrew" rel="noopener ugc nofollow" target="_blank">国家示例</a>。</p><h1 id="2b02" class="kj kk hu bd kl km lq ko kp kq lr ks kt ku ls kw kx ky lt la lb lc lu le lf lg dt translated">花药数据结构</h1><p id="527c" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">每个anthem数据包含一个在线音频anthem文件和文件来源的链接(如<a class="ae kb" href="https://www.wikimedia.org/" rel="noopener ugc nofollow" target="_blank"> Wikimedia </a>)。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">Israel’s anthem object</figcaption></figure><p id="54d2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以在GitHub repository自述文件中看到<a class="ae kb" href="https://github.com/dormd/countries-data/blob/master/README.md#data-structure-2" rel="noopener ugc nofollow" target="_blank">完整的数据结构</a>和<a class="ae kb" href="https://github.com/dormd/countries-data/blob/master/README.md#example-israel-1" rel="noopener ugc nofollow" target="_blank">国家示例</a>。</p></div><div class="ab cl kc kd hc ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hn ho hp hq hr"><h1 id="f771" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">代码示例:角度4应用程序</h1><p id="7a39" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">为了展示国家数据npm的用法，我使用Angular v4构建了一个应用程序。这个应用程序由Angular-CLI初始化，使用bootstrap和font-awesome。</p><h2 id="8f64" class="mg kk hu bd kl mh mi mj kp mk ml mm kt jn mn mo kx jr mp mq lb jv mr ms lf mt dt translated">令牌创建</h2><p id="7c1b" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">安装npm后，我们想要访问国家的数据，这可以通过v4 <a class="ae kb" href="https://blog.thoughtram.io/angular/2016/05/23/opaque-tokens-in-angular-2.html#injectiontoken-since-angular-4x" rel="noopener ugc nofollow" target="_blank"> InjectionToken </a>来完成。InjectionToken是Angular v2 OpaqueToken的改进版本(<a class="ae kb" href="https://hackernoon.com/top-8-resources-to-explore-angular-4-ff2c1b42020a" rel="noopener ugc nofollow" target="_blank">v4</a>的变化之一)。它允许我们创建基于字符串的令牌，而不会在依赖注入机制中遇到任何冲突。创建InjectionToken很容易。</p><p id="6721" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们使用三个注入令牌，分别用于国家、语言和国歌。创建令牌后，我们可以使用<code class="eh lm ln lo lp b">useValue</code>选项创建提供者。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">Data tokens and tokens providers</figcaption></figure><h2 id="6e76" class="mg kk hu bd kl mh mi mj kp mk ml mm kt jn mn mo kx jr mp mq lb jv mr ms lf mt dt translated">数据访问服务</h2><p id="4628" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">创建提供者后，我们可以在服务的构造函数中注入带有<code class="eh lm ln lo lp b">@Inject</code>注释的数据。这是我们的数据访问服务。他的角色是数据访问层。我们可以看到在他的构造函数中注入了标记。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">The data access service</figcaption></figure><p id="620b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些方法通过a2代码提供数据。在<code class="eh lm ln lo lp b">getCountryObjByA2</code>中，我们可以看到如何通过a2检索特定国家的对象。很简单。获取对象后，我们可以访问他的属性，如维基链接，面积，人口，资本等。<code class="eh lm ln lo lp b">getCountryNativeName</code>有点棘手，因为这个国家的本地名字对象的结构。例如，下面是以色列(IL)对象。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">The name part of Israel country object</figcaption></figure><p id="7984" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">根据通用语言，一个国家可以有一个以上的本土名称。下一部分中的方法使用对象中的第一种语言(对于IL是heb)。</p><h2 id="7400" class="mg kk hu bd kl mh mi mj kp mk ml mm kt jn mn mo kx jr mp mq lb jv mr ms lf mt dt translated">组件类</h2><p id="04a8" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">所以我们有一个公开我们需要什么的服务。所以让我们用它来画我们的组件。它包含一个选择框，用于选择a2代码和所选国家的详细信息。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">Part of the app component class</figcaption></figure><p id="1371" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">正如我们所看到的，数据访问服务被注入到组件中。<code class="eh lm ln lo lp b">ngOnInit</code>生命周期钩子为选择框询问国家字母2代码。此外，它用默认国家a2 (IL)调用<code class="eh lm ln lo lp b">onA2Changed</code>方法。当用户选择另一个a2时，选择框用新的a2调用<code class="eh lm ln lo lp b">onA2Changed</code>。然后a2被保存，国家的详细信息被服务获取。</p><h2 id="6a7a" class="mg kk hu bd kl mh mi mj kp mk ml mm kt jn mn mo kx jr mp mq lb jv mr ms lf mt dt translated">组件Html</h2><p id="d383" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">该视图包含a2代码选择框。被选择的a2被<code class="eh lm ln lo lp b">ngModel</code>指令绑定，当新的a2被选择时，<code class="eh lm ln lo lp b">ngModelChange</code>输出调用处理程序。第二部分包含该国的细节。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">Part of the app component html</figcaption></figure><p id="d477" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">正如我们所看到的，视图使用了<code class="eh lm ln lo lp b">ngIf</code>指令作为可选属性。还有一个到国歌的链接和一个到该国网页的维基百科图标链接。</p><h2 id="75bf" class="mg kk hu bd kl mh mi mj kp mk ml mm kt jn mn mo kx jr mp mq lb jv mr ms lf mt dt translated">AppModule</h2><p id="ea3e" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">现在，只需在AppModule中注册服务、组件和令牌提供者，就可以将所有这些放在一起了。</p><figure class="lv lw lx ly fq iv"><div class="bz el l di"><div class="lz ma l"/></div><figcaption class="mb mc fg fe ff md me bd b be z ek">The app module</figcaption></figure></div><div class="ab cl kc kd hc ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hn ho hp hq hr"><h1 id="d293" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">参考</h1><p id="3100" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">以下是一些有用的链接:</p><ul class=""><li id="5892" class="mu mv hu je b jf jg jj jk jn mw jr mx jv my jz mz na nb nc dt translated"><a class="ae kb" href="https://dormd.github.io/countries-data-angular4/" rel="noopener ugc nofollow" target="_blank">演示应用</a>。</li><li id="85ed" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">GitHub <a class="ae kb" href="https://github.com/dormd/countries-data-angular4" rel="noopener ugc nofollow" target="_blank">资源库</a>中的示例代码项目</li><li id="fd13" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">国家数据<a class="ae kb" href="https://github.com/dormd/countries-data" rel="noopener ugc nofollow" target="_blank"> GitHub知识库</a></li><li id="342e" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">国家-数据<a class="ae kb" href="https://www.npmjs.com/package/countries-data" rel="noopener ugc nofollow" target="_blank">国家预防机制</a></li><li id="20db" class="mu mv hu je b jf nd jj ne jn nf jr ng jv nh jz mz na nb nc dt translated">使用该npm的项目:<a class="ae kb" href="https://github.com/dormd/ng2-pipe" rel="noopener ugc nofollow" target="_blank">ng2-管道</a>&amp;<a class="ae kb" href="https://github.com/dormd/ng2-countries" rel="noopener ugc nofollow" target="_blank">ng2-国家</a></li></ul><figure class="lv lw lx ly fq iv fe ff paragraph-image"><div class="fe ff ni"><img src="../Images/f009d10b1bb7fbe4af76161b21c9699c.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*hwU5wgvjRFAl-tkigI5WRA.png"/></div></figure><p id="fd84" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ka">您可以关注我的</em></strong><a class="ae kb" href="https://www.dormoshe.io" rel="noopener ugc nofollow" target="_blank"><strong class="je hv"><em class="ka">dormo she . io</em></strong></a><strong class="je hv"><em class="ka">或</em></strong><a class="ae kb" href="https://twitter.com/DorMoshe" rel="noopener ugc nofollow" target="_blank"><strong class="je hv"><em class="ka">Twitter</em></strong></a><strong class="je hv"><em class="ka">阅读更多关于Angular、JavaScript和web开发的内容。</em>T41】</strong></p></div></div>    
</body>
</html>