<html>
<head>
<title>Is NodeJs Faster Than JSP?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NodeJs比JSP快吗？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/is-nodejs-faster-than-jsp-f74463ed54ee?source=collection_archive---------2-----------------------#2017-02-18">https://medium.com/hackernoon/is-nodejs-faster-than-jsp-f74463ed54ee?source=collection_archive---------2-----------------------#2017-02-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c0d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最近，我和一位软件工程师聊天，慢慢地我们谈到了JSP这个话题。对于那些不知道JSP是什么的人来说，它代表Java Server Pages(JSP ),一种建于20世纪90年代的技术。总之，<em class="jp">T3】我是那些使用JSP开发html页面的开发者之一。</em></p><p id="8a3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他问“你为什么还在使用<em class="jp">旧的</em> JSP页面？到底是谁干的？”</p><p id="8f8a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我的回答是“我希望我的页面尽可能快，如果不是最快的话。所以我使用JSP”</p><p id="938d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他说“JSP不可能比Node更快。否则人们为什么会搬到Node？”</p></div><div class="ab cl jq jr hc js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hn ho hp hq hr"><p id="bc8d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">只有一个办法可以知道。:)</p><p id="c7f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们进入测试细节，</p><p id="7d88" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">硬件</strong></p><p id="3c52" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jx" href="https://www.asus.com/us/Notebooks/ASUS-ZenBook-Pro-UX501VW/" rel="noopener ugc nofollow" target="_blank">华硕Zenbook Pro </a>笔记本电脑，搭载<em class="jp">英特尔i7 </em>处理器，16GB内存。CPU有8个核心。</p><p id="ae24" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">软件</strong></p><p id="fa54" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Ubuntu 16.04，Tomcat8+Java8和NodeJS 7.5.0+PM2模块。</p><p id="8295" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">代码</strong></p><p id="bc17" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于JSP，我没有写任何代码。从<a class="ae jx" href="https://tomcat.apache.org/tomcat-7.0-doc/appdev/sample/" rel="noopener ugc nofollow" target="_blank">https://tomcat.apache.org/tomcat-7.0-doc/appdev/sample/</a>下载示例WAR文件，并复制到Tomcat的webapps文件夹中。</p><p id="1d28" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于节点，从<a class="ae jx" href="https://blog.risingstack.com/your-first-node-js-http-server/" rel="noopener ugc nofollow" target="_blank">https://blog . rising stack . com/your-first-node-js-http-server/</a>复制index.js文件。</p><p id="f034" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">设置</strong></p><p id="627d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于nodeJs是单线程的，所以我使用“pm2”模块来运行8个node-js进程，以充分利用所有的内核。</p><p id="1f4b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了公平起见，我添加了“NIO”配置，以便连接器是非阻塞的。</p><p id="eaee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">测试</strong></p><p id="6067" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试由“Apache基准测试”工具“ab”执行。在http服务器上进行大量请求的最简单的工具。目标是使用100个并发连接发出50万个请求。命令如下所示，</p><p id="a79b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">雄猫</strong></p><pre class="jy jz ka kb fq kc kd ke kf aw kg dt"><span id="198c" class="kh ki hu kd b fv kj kk l kl km">ab -n 500000 -c 100 <a class="ae jx" href="http://localhost:8080/sample/hello" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/sample/hello</a></span></pre><p id="3a52" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">节点</strong></p><pre class="jy jz ka kb fq kc kd ke kf aw kg dt"><span id="fed1" class="kh ki hu kd b fv kj kk l kl km">ab -n 500000 -c 100 <a class="ae jx" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/</a></span></pre><p id="ffe9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，让我们看看结果吧！！</p><p id="13be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">速度</strong></p><p id="7470" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在Tomcat和NodeJs上运行了5次500K的请求。</p><p id="3ee2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">PM2集群的8个Nodejs进程用了32秒来处理50万个请求。</p><p id="37cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1 NodeJs进程用了28秒来处理50万个请求。(无pm2)</p><p id="82dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Tomcat用了20秒来处理50万个请求。</p><p id="7deb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">定论:NodeJs比Tomcat慢50%左右。</strong></p><p id="6aeb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完整的结果可以在谷歌文档中找到</p><figure class="jy jz ka kb fq kn"><div class="bz el l di"><div class="ko kp l"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">8 NodeJs processes run with PM2 cluster module</figcaption></figure><figure class="jy jz ka kb fq kn"><div class="bz el l di"><div class="ko kp l"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Single NodeJs process without PM2 cluster module</figcaption></figure><figure class="jy jz ka kb fq kn"><div class="bz el l di"><div class="ko kp l"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Tomcat8 with “nio” connector and 200 threads running on JDK8</figcaption></figure><p id="525a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> CPU使用率</strong></p><p id="0b59" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一个快速测试，所以我没有进行详细的CPU测量。我刚刚运行了“htop ”,观察了CPU的使用情况。看htop很有趣。我录下了Node和Tomcat的其中一段视频，它们不到一分钟，请欣赏！</p><figure class="jy jz ka kb fq kn"><div class="bz el l di"><div class="ku kp l"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Screencast of 8-nodejs processes with pm2 cluster.</figcaption></figure><figure class="jy jz ka kb fq kn"><div class="bz el l di"><div class="ku kp l"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Screencast of single NodeJs process</figcaption></figure><figure class="jy jz ka kb fq kn"><div class="bz el l di"><div class="ku kp l"/></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Tomcat with “nio” connector and 200 threads running on JDK8</figcaption></figure><p id="bf5b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您观看了这两个视频，您会注意到，在测试NodeJs时，内核利用率约为70%。</p><p id="9eb9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">另一方面，在测试tomcat时，内核的利用率约为45%。</p><p id="c965" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">结论:NodeJS多消耗50%的CPU </strong></p><p id="685c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">如果你是NodeJs开发者，请不要把这个当回事，辞职吧。这纯粹是为了好玩。然而结果是真实的。</em></p><p id="7367" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">请让我知道你的想法。欢迎您的评论！</em></p><p id="d482" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">更新</strong></p><p id="f3e7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我添加了没有集群的1 nodejs进程的结果。</p><blockquote class="kv kw kx"><p id="1cb3" class="ir is jp it b iu iv iw ix iy iz ja jb ky jd je jf kz jh ji jj la jl jm jn jo hn dt translated">感谢Ramesh 对NodeJs的帮助。</p></blockquote><p id="3a64" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢<a class="lb lc gr" href="https://medium.com/u/5eb45e25873e?source=post_page-----f74463ed54ee--------------------------------" rel="noopener" target="_blank">Vigneshkumar Chinnachamy</a>的建议，我也添加了1 nodejs流程的结果。</p><div class="jy jz ka kb fq ab cb"><figure class="ld kn le lf lg lh li paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ld kn le lf lg lh li paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ld kn le lf lg lh li paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="kv kw kx"><p id="f922" class="ir is jp it b iu iv iw ix iy iz ja jb ky jd je jf kz jh ji jj la jl jm jn jo hn dt translated"><a class="ae jx" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是AMI家庭的一员。我们现在<a class="ae jx" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jx" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is jp it b iu iv iw ix iy iz ja jb ky jd je jf kz jh ji jj la jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jx" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jx" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jy jz ka kb fq kn fe ff paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="fe ff ll"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>