<html>
<head>
<title>Continuous Integration for Angular Projects with TravisCI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TravisCI持续集成角度项目</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/continuous-integration-for-angular-projects-with-travisci-4d2cc72d7853?source=collection_archive---------11-----------------------#2017-12-01">https://medium.com/hackernoon/continuous-integration-for-angular-projects-with-travisci-4d2cc72d7853?source=collection_archive---------11-----------------------#2017-12-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/ba1ea63ea8173e092cfe76efd4b537af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nccd2ofdArlXF7v58UK94Q.jpeg"/></div></div></figure><p id="54e2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在过去的几十年里，web开发的旅程令人惊叹。标准已经改变，实践已经发展，web开发世界的情况变得越来越好。例如，人们从猴子修补代码转移到MVC和设计模式。公司和个人都倾向于<a class="ae ka" href="https://en.wikipedia.org/wiki/Test-driven_development" rel="noopener ugc nofollow" target="_blank"> TDD </a>(测试驱动开发)，而不是<a class="ae ka" href="https://en.wikipedia.org/wiki/Behavior-driven_development" rel="noopener ugc nofollow" target="_blank"> BDD </a>(业务驱动开发)。最后但同样重要的是，CI(持续集成)和CD(持续交付)在技术行业越来越受欢迎。</p><p id="2171" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本文中，我将解释如何使用<a class="ae ka" href="http://travis-ci.org/" rel="noopener ugc nofollow" target="_blank"> TravisCI </a>在<a class="ae ka" href="http://www.github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上为您的<a class="ae ka" href="https://hackernoon.com/tagged/angular" rel="noopener ugc nofollow" target="_blank"> Angular </a>项目设置持续集成。这适用于angular应用程序以及您创建的任何Angular库/插件。</p><h1 id="b163" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">但是为什么呢？</h1><p id="51cf" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在进入<strong class="je hv">如何</strong>之前，我们先来看看<strong class="je hv">为什么</strong>。为什么我们实际上需要在我们的项目中实施CI？这样做有几个好处:</p><ol class=""><li id="027d" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">对于所有手动运行测试的开发人员来说，它节省了时间，并确保一切顺利进行。</li><li id="9197" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">开发人员发现很难记住<strong class="je hv">哪些分支需要测试，哪些分支应该忽略</strong>。没必要再记起那件事了。</li><li id="0c42" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">不再'它在我的机器上工作。“咄！”。正确设置CI后，您可以在您选择的环境中运行测试。</li><li id="68b2" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">详细说明第三点，它使得在你的CI集成中复制生产环境变得更加容易，所以你将知道它在生产中是如何工作的。</li><li id="033b" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><strong class="je hv">实施CI就是爽</strong>。</li></ol><h1 id="fe4c" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">那么我们该怎么做呢？</h1><p id="b64a" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">我将使用<a class="ae ka" href="http://ahsanayaz.github.io/ng-traffic-ci" rel="noopener ugc nofollow" target="_blank">这个示例应用程序</a>来演示<a class="ae ka" href="https://hackernoon.com/tagged/travisci" rel="noopener ugc nofollow" target="_blank"> TravisCI </a>的集成。我已经在应用程序中添加了一些单元测试和端到端测试。这是应用程序的代码库。完成CI实施后，我们将能够:。</p><ol class=""><li id="5611" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">运行单元测试</li><li id="97cb" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">运行E2E测试</li><li id="918a" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">生成生产版本</li><li id="a126" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">在gh-pages上部署生产版本进行演示。</li></ol><p id="de3d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以让我们开始吧。首先，我将通过执行以下命令在我的项目中创建一个名为<code class="eh ls lt lu lv b">travis-ci</code>的分支:</p><p id="5e62" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">git checkout -b travis-ci master</code></p><p id="359b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我们将前往<a class="ae ka" href="https://travis-ci.org/" rel="noopener ugc nofollow" target="_blank">https://travis-ci.org</a>。由于我已经设置了一个Github帐户，我可以快速登录。您可以注册或使用您的GitHub帐户登录。然后，我们将从那里启用我的帐户下的存储库。请参见下面的快照:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/8d2d2f24a66e74384a7afaeded303193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5HlcvfotAAbQdm2dagjR4w.png"/></div></div><figcaption class="mb mc fg fe ff md me bd b be z ek"><em class="mf">Turning on TravisCI for our app</em></figcaption></figure><p id="5ec7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因此，我们为GitHub repo打开了TravisCI，但它现在实际上什么也不做。我们需要在项目的根目录下添加一个<code class="eh ls lt lu lv b">.travis.yml</code>文件。那份文件会告诉特拉维斯该怎么做。(例如，在哪个环境下工作、操作系统、语言、版本、CI要考虑的分支等。)<br/>这是我们将要使用的<a class="ae ka" href="https://gist.github.com/AhsanAyaz/820d40da5d1aa45c138f9e55d5193d34" rel="noopener ugc nofollow" target="_blank"> YAML </a>文件(记得我们在git repo中切换到了分支<code class="eh ls lt lu lv b">travis-ci</code>)。让我们快速浏览一下这个文件的内容。</p><ul class=""><li id="e8ce" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz mg lk ll lm dt translated">语言:告诉travis哪个环境将用于管道。我们在测试中使用了node_js容器。</li><li id="4ce2" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz mg lk ll lm dt translated">node_js:指定使用哪个版本的node_js。我们可以指定<code class="eh ls lt lu lv b">stable</code>获得最新的稳定版本等等。</li><li id="9ada" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz mg lk ll lm dt translated">分支步骤配置哪些分支应该执行管道。对于我们的配置，我们只对主分支的构建感兴趣。点击查看更多关于分支<a class="ae ka" href="https://docs.travis-ci.com/user/customizing-the-build#Building-Specific-Branches" rel="noopener ugc nofollow" target="_blank">的选项。</a></li><li id="5d41" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz mg lk ll lm dt translated"><code class="eh ls lt lu lv b">before_script</code>阶段在运行脚本之前执行，我们实际上正在为我们的测试环境安装一堆东西，比如用于运行单元的Google Chrome stable和基于它的E2E测试。</li><li id="e370" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz mg lk ll lm dt translated">脚本阶段包含实际的步骤，我们运行我们的单元测试，e2e测试，然后我们生成一个产品构建，它将构建保存在dist文件夹中。</li></ul><p id="626a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">之后，我们使用GitHub的pages服务，通过将dist文件夹推到gh-pages分支来部署我们的代码。我们仅为部署的主分支进行了配置。注意skip_cleanup标志设置为true？它确保在脚本阶段生成并保存到dist的构建不会被清除。<br/>最后，为了部署，我们将<code class="eh ls lt lu lv b">github_token</code>设置为<code class="eh ls lt lu lv b">$GITHUB_TOKEN</code>，这应该是一个我们必须提供给TravisCI的ENV变量。但在此之前，我们需要从GitHub概要文件中生成令牌。<br/>我将进入我的GitHub设置&gt;个人访问令牌&gt;生成新令牌，如下图所示。<br/> <strong class="je hv">注意:确保允许作用域中的回购访问，并复制和保存您生成的令牌以备后用</strong>:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/b7a3a102fdd2fab22489188859656d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j3H8jPUozU1oNFdbhC5JwA.png"/></div></div></figure><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/fb06b6833b1d910ec51d6f1778b47985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F8LpQBDZ-tIO92fdv2vaAw.png"/></div></div></figure><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/c64b6e7b2325035c81b093faae7163cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8n5cMiieyYNaIt-eHDiXJA.png"/></div></div></figure><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mi"><img src="../Images/2698a38d2e978ce4885def29dd76f4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyUjXb3A5WuwbPjElNi63Q.png"/></div></div></figure><p id="d485" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们已经生成了令牌并复制到剪贴板，因此我们将转到travis-ci.org项目的设置页面。</p><ol class=""><li id="5ee6" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">打开<code class="eh ls lt lu lv b">Build only if .travis.yml is present</code></li><li id="1e2e" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">输入复制的令牌并赋给变量GITHUB_TOKEN</li></ol><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/e3222c9b58256a1a788ae0db1b92c171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6WF8WclTZcY1ZFzJDnN0mQ.png"/></div></div></figure><p id="4df9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">既然已经处理好了，我们可以将我们的<code class="eh ls lt lu lv b">.travis.yml</code>提交到GitHub repo。从那里，我们将创建一个到主分支的Pull请求，因为我们已经将TravisCI配置为只在主分支上执行脚本和部署。请参见下面的快照:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/ec016e0a2dee48b573e02b8b34c4cd9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VEfyS9Abe_tV1qyHF5dPeA.png"/></div></div></figure><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/79d64ca6ec90a8a3c028002c9b4007ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sWPM31nVAFpCibBgh6WJQ.png"/></div></div></figure><p id="a3ea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦这个<a class="ae ka" href="https://github.com/AhsanAyaz/ng-traffic-ci/pull/1" rel="noopener ugc nofollow" target="_blank"> PR </a>被创建，您将看到TravisCI构建被触发用于这个PR。</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/ad0c96cb55863134871601f35df3b87d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fW1z6M7WG3YMqhNPBmEeg.png"/></div></div></figure><p id="6312" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将跳过部署，因为这是一个合并请求。但是一旦合并，部署就会完成。您仍然可以在PR页面上看到TravisCI构建通过并更新了状态。</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/9bf4cc9f519159450e34b4d108cf9e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cq0lxR-IxqCSxLMlF-1GxA.png"/></div></div></figure><p id="351b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我现在已经合并了公关和应用程序的最终代码部署<a class="ae ka" href="https://ahsanayaz.github.io/ng-traffic-ci/" rel="noopener ugc nofollow" target="_blank">在这里</a>。看看吧，这很酷😉<br/>最后但同样重要的是，你可以在你的自述文件或网站中添加TravisCI的build徽章。您将直接从您的回购页面上看到当前构建是否通过。以下是获取徽章网址的方法:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/964d539c48b8015ac0b8590572d8f16c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05LKMwDGJRhZ7IPT6V-WSw.png"/></div></div></figure><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/5979bf4fd24ecdd4e2b12e19d974dfc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EjzqUY5NE97JvLlHliButA.png"/></div></div></figure><p id="8852" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以参考我的<a class="ae ka" href="https://raw.githubusercontent.com/AhsanAyaz/ng-traffic-ci/master/README.md" rel="noopener ugc nofollow" target="_blank">项目的自述文件</a>，看看我是如何在那里嵌入TravisCI build徽章的。</p><h1 id="b74e" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="e829" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">TravisCI是将CI整合到您的项目中的一个很好的工具(无论是否有角度)。在插件/项目中设置和实现CI非常简单，为您的工作增加了额外的好处。大家都在做！请尽你所能支持我们！反馈，掌声，GitHub明星，任何东西都欢迎。感谢阅读</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="mj mk l"/></div></figure></div></div>    
</body>
</html>