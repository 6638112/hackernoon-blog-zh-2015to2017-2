<html>
<head>
<title>How to automate all the things with Gulp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Gulp实现所有事情的自动化</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-automate-all-the-things-with-gulp-b21a3fc96885?source=collection_archive---------1-----------------------#2017-04-10">https://medium.com/hackernoon/how-to-automate-all-the-things-with-gulp-b21a3fc96885?source=collection_archive---------1-----------------------#2017-04-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/658c6a9d91ede89e3ab787da590ac47d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPW7aLlD_6UXm8eb0E3hxg.jpeg"/></div></div></figure><div class=""/><p id="5a33" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你曾经厌倦过频繁地按F5键吗？是的，我理解这种痛苦。这就是任务自动化的亮点。编写脚本来持续处理开发工作流中实际需要的耗时任务。不要在这里对我临阵退缩。这比听起来可怕多了。相信我。一旦你掌握了它的窍门，你就再也不想不用它来写代码了。</p><p id="b260" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">那么为什么要吞咽呢？因为你正在和你最好的伙伴，普通的老JavaScript一起写任务。没有比这更好的了。</p><div class="ht hu fm fo hv ka"><a href="http://gulpjs.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab ej"><div class="kc ab kd cl cj ke"><h2 class="bd ig fv z el kf eo ep kg er et ie dt translated">gulp.js</h2><div class="kh l"><h3 class="bd b fv z el kf eo ep kg er et ek translated">通过优先选择代码而不是配置、节点最佳实践和最小化API表面吞咽，事情变得简单起来，比如…</h3></div><div class="ki l"><p class="bd b gc z el kf eo ep kg er et ek translated">gulpjs.com</p></div></div><div class="kj l"><div class="kk l kl km kn kj ko ib ka"/></div></div></a></div><h2 id="14c2" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">炸毁死星。</h2><p id="5b93" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">一饮而尽。你需要的英雄，而且绝对值得拥有。关于Gulp的使用，有几个关键特征会让你想要使用它。我认为最重要的一点是它可以模拟服务器环境，你最终将在那里托管你的代码。这包括在您的项目目录中移动文件，更重要的是将它们放在您将运行web服务器的<strong class="je ig">开发目录</strong>中。Gulp还能让你<strong class="je ig">编译</strong>、<strong class="je ig">缩小</strong>和<strong class="je ig">连接</strong>任何你想要的文件。所有这些都是为了将您的代码库的占用空间降到最低。在此过程中，为<strong class="je ig">运输到生产</strong>做好准备。如果你不知道上面的任何一个术语，那也没关系，我们会在下面更详细地讨论它们。</p></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><h2 id="b6e5" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">TLDR；</h2><p id="a616" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">你只看这一本TLDR就能严重伤害我的感情；或者干脆牛逼一点，把整篇文章看完。玩得开心！</p><ol class=""><li id="8bf8" class="lw lx if je b jf jg jj jk jn ly jr lz jv ma jz mb mc md me dt translated">三个主要的吞咽命令:<code class="eh mf mg mh mi b">gulp.task</code>、<code class="eh mf mg mh mi b">gulp.src</code>、<code class="eh mf mg mh mi b">gulp.dest</code>。</li><li id="7796" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated"><code class="eh mf mg mh mi b">pipe</code> ing太牛逼了！<code class="eh mf mg mh mi b">pipe()</code>方法内置在Node.js中，用于将文件从一个文件夹复制到另一个文件夹。</li><li id="4884" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">有一个逻辑文件夹结构，有三个主要文件夹。<strong class="je ig"> <em class="mo"> src </em> </strong>文件夹用于预处理文件，<strong class="je ig"> <em class="mo"> tmp </em> </strong>用于本地开发服务器，而<strong class="je ig"> <em class="mo"> dist </em> </strong>用于处理和缩小的文件。</li><li id="0af2" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">为从<strong class="je ig"> <em class="mo"> src </em> </strong>到<strong class="je ig"> <em class="mo"> tmp </em> </strong>的HTML、CSS和JavaScript文件创建单独的任务。</li><li id="66a3" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">将HTML、CSS和JavaScript任务合并成一个主任务<strong class="je ig"> <em class="mo">【复制】</em> </strong>。这将让你用一个命令复制所有的文件。</li><li id="d858" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">在所有文件被复制后，你想在你的主【index.html】<em class="mo"/>中自动引用它们。这是通过一个<strong class="je ig"> <em class="mo">【注入】</em> </strong>任务完成的，称为注入依赖项。</li><li id="87dd" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">当文件被复制和注入后，就该在<strong class="je ig"> <em class="mo"> tmp </em> </strong>文件夹中运行开发服务器了。</li><li id="20d8" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">当服务器运行时，您可以<strong class="je ig"> <em class="mo">【观察】</em> </strong>变化，并在本地开发服务器上启用实时重新加载。</li><li id="216a" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">对你的代码满意吗？继续操作<strong class="je ig"><em class="mo">‘构建’</em></strong>生产文件，并将它们放置在<strong class="je ig"> <em class="mo"> dist </em> </strong>目录中。</li><li id="de51" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">推送到GitHub前删除<strong class="je ig"> <em class="mo"> tmp </em> </strong>和<strong class="je ig"> <em class="mo"> dist </em> </strong>。(或者将它们添加到您的。gitignore)</li><li id="6ae1" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz mb mc md me dt translated">您将在本教程中编写的代码在GitHub上，并将在文章底部链接。抱歉，但是你必须滚动到底部。:)</li></ol></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><h2 id="7068" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">安装工具</h2><p id="1585" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">首先，您需要在您的机器上安装Node。要检查您是否知道，请打开命令提示符并键入<code class="eh mf mg mh mi b">node -v</code>。您安装的节点的版本号将在命令行上显示为输出。如果没有，则您的计算机上没有安装节点。不要担心，前往Node的官方网站开始。</p><div class="ht hu fm fo hv ka"><a href="https://nodejs.org/en/download/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab ej"><div class="kc ab kd cl cj ke"><h2 class="bd ig fv z el kf eo ep kg er et ie dt translated">下载| Node.js</h2><div class="kh l"><h3 class="bd b fv z el kf eo ep kg er et ek translated">下载Node.js源代码或适合您平台的预建安装程序，并立即开始开发。</h3></div><div class="ki l"><p class="bd b gc z el kf eo ep kg er et ek translated">nodejs.org</p></div></div><div class="kj l"><div class="mp l kl km kn kj ko ib ka"/></div></div></a></div><p id="02ec" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">完成了吗？现在，您可以安装关于实际任务自动化的必要工具了。返回到您的命令提示符并运行:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="75da" class="kp kq if mi b fv my mz l na nb">npm install -g gulp</span></pre><p id="b787" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mo">注意:Linux和Mac用户很可能需要使用</em><strong class="je ig"><em class="mo">sudo</em></strong><em class="mo">来运行这个命令，以启用所需的权限。</em></p><p id="3560" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在你已经在你的机器上全局安装了Gulp。这一步很重要，因为无论您在哪个目录下，Gulp都必须在命令行中可见。更技术性的解释是，现在已经在<strong class="je ig">路径</strong>中添加了Gulp。</p><p id="b30c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您已经准备好开始编写任务了。</p><h2 id="78f3" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">自我介绍</h2><p id="d275" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">Gulp提供了三个主要命令:</p><ul class=""><li id="88a4" class="lw lx if je b jf jg jj jk jn ly jr lz jv ma jz nc mc md me dt translated"><code class="eh mf mg mh mi b">gulp.task</code> —定义一个新任务，给它一个名称、一组依赖项和一个回调函数，当任务运行时将调用该函数。</li><li id="c6a8" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz nc mc md me dt translated"><code class="eh mf mg mh mi b">gulp.src</code> —设置文件所在的源文件夹。</li><li id="a03e" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz nc mc md me dt translated"><code class="eh mf mg mh mi b">gulp.dest</code> —设置放置文件的目标文件夹。</li></ul><p id="8c89" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用Gulp的根本在于以<code class="eh mf mg mh mi b">.pipe</code>方法为桥梁的<code class="eh mf mg mh mi b">gulp.src</code>和<code class="eh mf mg mh mi b">gulp.dest</code>之间的互动。</p><p id="f984" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh mf mg mh mi b">.pipe</code>方法是Node.js中的默认方法，不要深入研究这个特定的主题，把它看作是一种把文件从一个目录复制到另一个目录的方法。</p><p id="295f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是什么意思？</p><p id="878f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Gulp本身只提供了任务自动化所需的基础。开发工作流中需要的大部分工作存在于为Gulp创建的大量插件中。没有他们，你只有一个空壳。当然，你可以自己写，但是有超过3000个可以在<a class="ae nd" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="je ig"> npm </strong> </a>上下载，我建议不要这么做。不要重新发明轮子。利用你已经掌握的资源。随意看看这里的<a class="ae nd" href="http://gulpjs.com/plugins/" rel="noopener ugc nofollow" target="_blank"/>，或者谷歌一下“guoping<em class="mo">what</em>”就能见证这一神奇。</p><h2 id="989a" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">婴儿学步</h2><p id="fa02" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">让我们编写一个非常基本的主干，只是为了让我们的头脑围绕这个概念。我们将在本文中逐步深入。</p><p id="f7c5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先创建一个新的目录，给它起一个超级鼓舞人心的名字，比如<em class="mo">超级棒-囧-教程</em>就可以了。一旦你这样做了，在这个目录中打开一个命令提示符。因为Gulp是<strong class="je ig"> npm </strong>上的一个包，所以你需要初始化<strong class="je ig"> npm </strong>来链接到包管理器。</p><p id="8f38" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不熟悉<strong class="je ig"> npm —节点包管理器</strong>？看看这里。</p><div class="ht hu fm fo hv ka"><a href="https://www.npmjs.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab ej"><div class="kc ab kd cl cj ke"><h2 class="bd ig fv z el kf eo ep kg er et ie dt translated">npm</h2><div class="kh l"><h3 class="bd b fv z el kf eo ep kg er et ek translated">npm是javascript的包管理器</h3></div><div class="ki l"><p class="bd b gc z el kf eo ep kg er et ek translated">www.npmjs.com</p></div></div><div class="kj l"><div class="ne l kl km kn kj ko ib ka"/></div></div></a></div><p id="69c7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">完成这些之后，您还需要在本地安装Gulp。为什么？Gulp将总是在项目文件夹中使用自己的本地版本。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="35a0" class="kp kq if mi b fv my mz l na nb">npm init<br/>npm install gulp --save-dev</span></pre><p id="66e6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用<em class="mo"> - save-dev </em>标志安装它，会将它包含在开发依赖项下的<strong class="je ig"> <em class="mo"> package.json </em> </strong>中。干得好，准备好写代码了吗？让我们跳进来。新建一个文件，命名为<strong class="je ig"><em class="mo">gulpfile . js</em></strong><em class="mo">。这个文件是Gulp的入口点，在这里你将编写所有的代码来自动执行任务。继续写在你的<strong class="je ig"> <em class="mo"> gulpfile.js </em> </strong>中:</em></p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="e972" class="kp kq if mi b fv my mz l na nb">var gulp = require('gulp');</span><span id="999c" class="kp kq if mi b fv nf mz l na nb">gulp.task('default', function () {<br/>  console.log('Hello World!');<br/>});</span></pre><p id="ec4a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">恭喜你。你刚刚完成了你的第一个吞咽任务。我打赌这对于您来说似乎很熟悉，一个事件监听器后面跟着一个回调函数。让我们试一试。跳回您的命令提示符，只需键入:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="0b15" class="kp kq if mi b fv my mz l na nb">gulp</span></pre><p id="12cc" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">按enter键，您将看到类似这样的内容被记录回命令行:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="47a3" class="kp kq if mi b fv my mz l na nb">[19:41:16] Using gulpfile ~/super-awesome-gulp-tutorial/gulpfile.js<br/>[19:41:16] Starting 'default'...<br/>Hello World!<br/>[19:41:16] Finished 'default' after 162 μs</span></pre><p id="4ed4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通过使用关键字<code class="eh mf mg mh mi b">gulp</code>，您告诉Gulp解释一个特定的任务，由于关键字后面没有写任何内容，因此运行了<strong class="je ig"><em class="mo">‘默认’</em></strong>任务。假设您有一个名为'<strong class="je ig"><em class="mo">build</em></strong><em class="mo">'</em>的任务，并且您希望运行它。写<code class="eh mf mg mh mi b">gulp build</code>将触发特定的吞咽任务。你甚至可以运行多个任务，这也很好。看起来是这样的。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="3525" class="kp kq if mi b fv my mz l na nb">gulp sometask anothertask</span></pre><p id="f860" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你一直跟着吗？太好了，你现在已经准备好编写一些重要的东西了。让我们建立并运行一个开发环境。</p><h2 id="0d17" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">完全黑客模式，开启</h2><p id="752e" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">我将首先概述一个示例项目的基本文件夹结构。许多最佳实践之一是有三个主文件夹，<strong class="je ig"> <em class="mo"> src </em> </strong>用于所有的源文件，<strong class="je ig"> <em class="mo"> dist </em> </strong>用于打包和缩小的文件，最后是一个<strong class="je ig"><em class="mo">tmp</em></strong><em class="mo"/>目录，它将被用作我们本地web服务器的沙箱。</p><ul class=""><li id="c6e1" class="lw lx if je b jf jg jj jk jn ly jr lz jv ma jz nc mc md me dt translated"><strong class="je ig"> src </strong> —源文件，预处理，未缩小。</li><li id="a05b" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz nc mc md me dt translated"><strong class="je ig"> tmp </strong> —开发文件，预处理，未缩小。运行web服务器的目录。</li><li id="5960" class="lw lx if je b jf mj jj mk jn ml jr mm jv mn jz nc mc md me dt translated"><strong class="je ig"> dist </strong> —生产文件，已处理，已缩小。</li></ul><p id="f7cd" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建<strong class="je ig"> <em class="mo"> src </em> </strong>文件夹，但是<strong class="je ig">没有</strong>创建<strong class="je ig"> <em class="mo"> dist </em>也没有<em class="mo"> tmp </em> </strong>文件夹。您将进一步了解如何动态地创建它，并将其合并到自动化任务中。让我们将一些文件添加到<strong class="je ig"> <em class="mo"> src </em> </strong>文件夹中，以便最终有东西可玩。一个<strong class="je ig"><em class="mo">index.html</em></strong>，一个<strong class="je ig"> <em class="mo"> script.js </em> </strong>和一个<strong class="je ig"> <em class="mo"> style.css </em> </strong>应该绰绰有余。这些将作为您的源文件，是您将编辑的唯一文件。Gulp会处理所有其他事情。</p><p id="2a64" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们开始吞咽所有的东西吧！</p><h2 id="0bcc" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤1-设置文件夹结构</h2><p id="0595" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">首先你需要一个<strong class="je ig"> <em class="mo">路径</em> </strong>变量来存储你的项目的所有文件和目录路径。把这个放在你需要吞咽的地方。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="d9a5" class="kp kq if mi b fv my mz l na nb">// gulpfile.js<br/>var gulp = require('gulp');<br/>var paths = {<br/>  src: 'src/**/*',<br/>  srcHTML: 'src/**/*.html',<br/>  srcCSS: 'src/**/*.css',<br/>  srcJS: 'src/**/*.js',</span><span id="f435" class="kp kq if mi b fv nf mz l na nb">  tmp: 'tmp',<br/>  tmpIndex: 'tmp/index.html',<br/>  tmpCSS: 'tmp/**/*.css',<br/>  tmpJS: 'tmp/**/*.js',</span><span id="4ffe" class="kp kq if mi b fv nf mz l na nb">  dist: 'dist',<br/>  distIndex: 'dist/index.html',<br/>  distCSS: 'dist/**/*.css',<br/>  distJS: 'dist/**/*.js'<br/>};</span><span id="b4ad" class="kp kq if mi b fv nf mz l na nb">gulp.task('default', function () {<br/>  console.log('Hello World!');<br/>});</span></pre><p id="3b8a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">指定<code class="eh mf mg mh mi b">/**/*</code>部分相当于包含文件夹和任何可能的子文件夹中的所有文件。</p><h2 id="290a" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤2 —设置HTML任务</h2><p id="fb8f" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">现在您需要创建一个任务，将所有HTML文件从<strong class="je ig"> <em class="mo"> src </em> </strong>目录复制到运行web服务器的<strong class="je ig"> <em class="mo"> tmp </em> </strong>目录。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="cf58" class="kp kq if mi b fv my mz l na nb">gulp.task('html', function () {<br/>  return gulp.src(paths.srcHTML).pipe(gulp.dest(paths.tmp));<br/>});</span></pre><h2 id="60db" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤3 —设置CSS任务</h2><p id="8107" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">CSS文件也是如此。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="2a18" class="kp kq if mi b fv my mz l na nb">gulp.task('css', function () {<br/>  return gulp.src(paths.srcCSS).pipe(gulp.dest(paths.tmp));<br/>});</span></pre><h2 id="f013" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤4 —设置JavaScript任务</h2><p id="117b" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">是的，JavaScript文件也是如此。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="15eb" class="kp kq if mi b fv my mz l na nb">gulp.task('js', function () {<br/>  return gulp.src(paths.srcJS).pipe(gulp.dest(paths.tmp));<br/>});</span></pre><h2 id="efba" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤5-将所有任务合并成一个任务</h2><p id="3d85" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">这部分很好玩。Gulp允许您组合任务，并将任务作为依赖项添加到其他任务中。这个特性非常有用，因为你可以告诉Gulp在开始其他任务之前运行并完成某些任务。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="2faf" class="kp kq if mi b fv my mz l na nb">gulp.task('copy', ['html', 'css', 'js']);</span></pre><p id="6e77" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">试试吧！以下是运行<code class="eh mf mg mh mi b">gulp copy</code>后您将看到的内容。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="fe9f" class="kp kq if mi b fv my mz l na nb">[19:39:08] Using gulpfile ~/super-awesome-gulp-tutorial/gulpfile.js<br/>[19:39:08] Starting 'html'...<br/>[19:39:08] Starting 'css'...<br/>[19:39:08] Starting 'js'...<br/>[19:39:08] Finished 'css' after 19 ms<br/>[19:39:08] Finished 'html' after 30 ms<br/>[19:39:08] Finished 'js' after 18 ms<br/>[19:39:08] Starting 'copy'...<br/>[19:39:08] Finished 'copy' after 4.67 μs</span></pre><p id="02a1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">跳回你的项目文件夹，看一看。现在你有了一个<strong class="je ig"> <em class="mo"> tmp </em> </strong> <em class="mo"> </em>目录。它是动态创建的。神奇！(开个玩笑，不尽然。)<br/><strong class="je ig"><em class="mo">tmp</em></strong>目录包含与<strong class="je ig"> <em class="mo"> src </em> </strong>目录中相同的文件。<code class="eh mf mg mh mi b">.pipe()</code>命令已经将文件从源复制到给定的目的地。</p><h2 id="a7f2" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤6 —将文件注入index.html</h2><p id="0df4" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">这是什么？好了，你已经把文件复制到了<strong class="je ig"> <em class="mo"> tmp </em> </strong>文件夹。现在你需要告诉<strong class="je ig"><em class="mo">index.html</em></strong>你想要引用哪个CSS和JavaScript文件。这可以通过一个叫做<code class="eh mf mg mh mi b"><a class="ae nd" href="https://www.npmjs.com/package/gulp-inject" rel="noopener ugc nofollow" target="_blank">gulp-inject</a></code>的大口插件很容易地完成。继续跳回命令提示符并运行:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="c7e5" class="kp kq if mi b fv my mz l na nb">npm install gulp-inject --save-dev</span></pre><p id="437d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，你需要在<strong class="je ig"><em class="mo">index.html</em></strong>中添加一个你希望注入文件的引用。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="d6be" class="kp kq if mi b fv my mz l na nb">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;!-- src/index.html --&gt;<br/>  <br/>    &lt;!-- inject:css --&gt;<br/>    &lt;!-- endinject --&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;</span><span id="dcd7" class="kp kq if mi b fv nf mz l na nb">    &lt;!-- inject:js --&gt;<br/>    &lt;!-- endinject --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="fb5a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">运行完<code class="eh mf mg mh mi b">gulp-inject</code>后，这些注释之间会有文件。请记住，他们需要看起来完全像上面写的。</p><p id="5dfe" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">跳回<strong class="je ig"> <em class="mo"> gulpfile.js </em> </strong>并添加这个:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="fa39" class="kp kq if mi b fv my mz l na nb">var inject = require('gulp-inject');</span></pre><p id="117d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请记住，您已经在tmp文件夹中添加了对文件的引用。它应该是这样的:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="e57f" class="kp kq if mi b fv my mz l na nb">var paths = {<br/>  src: 'src/**/*',<br/>  srcHTML: 'src/**/*.html',<br/>  srcCSS: 'src/**/*.css',<br/>  srcJS: 'src/**/*.js',</span><span id="da92" class="kp kq if mi b fv nf mz l na nb">  tmp: 'tmp', // tmp folder<br/>  tmpIndex: 'tmp/index.html', // index.html in tmp folder<br/>  tmpCSS: 'tmp/**/*.css', // css files in tmp folder<br/>  tmpJS: 'tmp/**/*.js', // js files in tmp folder</span><span id="4ff3" class="kp kq if mi b fv nf mz l na nb">  dist: 'dist',<br/>  distIndex: 'dist/index.html',<br/>  distCSS: 'dist/**/*.css',<br/>  distJS: 'dist/**/*.js'<br/>};</span></pre><p id="9874" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您已经准备好添加另一个任务来注入文件。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="7136" class="kp kq if mi b fv my mz l na nb">gulp.task('inject', ['copy'], function () {<br/>  var css = gulp.src(paths.tmpCSS);<br/>  var js = gulp.src(paths.tmpJS);<br/>  return gulp.src(paths.tmpIndex)<br/>    .pipe(inject( css, { relative:true } ))<br/>    .pipe(inject( js, { relative:true } ))<br/>    .pipe(gulp.dest(paths.tmp));<br/>});</span></pre><p id="d726" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在看看这个。您已经添加了<strong class="je ig"> <em class="mo">【复制】</em> </strong>任务作为<strong class="je ig"> <em class="mo">【注入】</em> </strong>任务的依赖项。Gulp会先把所有文件复制到<strong class="je ig"> <em class="mo"> tmp </em> </strong>目录下，然后才会做注入。我们来分析一下。你把复制到<strong class="je ig"> <em class="mo"> tmp </em> </strong>文件夹的文件的<code class="eh mf mg mh mi b">gulp.src</code>放入两个各自的变量中。一个用于CSS，另一个用于JavaScript文件。在return语句中，您使用<strong class="je ig"><em class="mo"/></strong>任务和<code class="eh mf mg mh mi b">.pipe()</code>函数从<strong class="je ig"> <em class="mo"> tmp </em> </strong>目录中获取已经通过管道传输到<strong class="je ig"> <em class="mo"> tmp </em> </strong>的<strong class="je ig"><em class="mo">index.html</em></strong>和<code class="eh mf mg mh mi b">.pipe()</code><code class="eh mf mg mh mi b">inject()</code>函数中的变量。传递给<code class="eh mf mg mh mi b">inject()</code>函数的第二个参数是一个选项对象。这里，<code class="eh mf mg mh mi b">relative:true</code>表示<strong class="je ig"><em class="mo"/></strong>中引用的文件路径是相对的。你想要这个。相信我。这会让你省去很多头痛。</p><p id="d4a1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">切换回命令提示符并运行<code class="eh mf mg mh mi b">gulp inject</code>。你的<strong class="je ig"><em class="mo">tmp</em></strong><em class="mo"/>目录中的<strong class="je ig"><em class="mo">index.html</em></strong>现在应该是这样的。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="feed" class="kp kq if mi b fv my mz l na nb">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;!-- tmp/index.html --&gt;<br/>  <br/>    &lt;!-- inject:css --&gt;<br/>    &lt;link rel="stylesheet" href="style.css"&gt;<br/>    &lt;!-- endinject --&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;</span><span id="6e5e" class="kp kq if mi b fv nf mz l na nb">    &lt;!-- inject:js --&gt;<br/>    &lt;script src="script.js"&gt;&lt;/script&gt;<br/>    &lt;!-- endinject --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="7dcb" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤7 —为开发web服务器提供服务</h2><p id="ebdd" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">我打赌你想看看你的劳动成果。我也会的。让我们启动并运行一个服务器来解渴。</p><p id="29dd" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">继续切换回命令行并运行:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="1e1f" class="kp kq if mi b fv my mz l na nb">npm install gulp-webserver --save-dev</span></pre><p id="2f74" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个Gulp插件，允许您在本地机器上运行web服务器。正是你所需要的。在你安装好它之后，继续在你的<strong class="je ig"> <em class="mo"> gulpfile.js </em> </strong>顶部要求它。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="82a1" class="kp kq if mi b fv my mz l na nb">var webserver = require('gulp-webserver');</span></pre><p id="b4fe" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">太好了！让我们把<strong class="je ig"><em class="mo">【serve】</em></strong>任务编码起来。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="2982" class="kp kq if mi b fv my mz l na nb">gulp.task('serve', ['inject'], function () {<br/>  return gulp.src(paths.tmp)<br/>    .pipe(webserver({<br/>      port: 3000,<br/>      livereload: true<br/>    }));<br/>});</span></pre><p id="25d5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">同样，您需要包含一个依赖项。这里您希望在运行web服务器之前完成<strong class="je ig"> <em class="mo">【注入】</em> </strong>任务。只需引用<strong class="je ig"> <em class="mo"> tmp </em> </strong>目录并<code class="eh mf mg mh mi b">.pipe()</code>到web服务器。<code class="eh mf mg mh mi b">gulp-webserver</code>插件将一个选项对象作为参数。您需要指定它将运行的端口，并告诉服务器如果它感觉到任何变化就重新加载。一旦你习惯了这个。没有回头路了。</p><p id="4338" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们来测试一下。在<strong class="je ig"> <em class="mo"> src </em> </strong>目录下的文件中添加几行代码。这里有一个简单的例子:</p><p id="48c9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"><em class="mo">index.html</em></strong></p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="ce16" class="kp kq if mi b fv my mz l na nb">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;!-- inject:css --&gt;<br/>    &lt;!-- endinject --&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div class="awesome"&gt;This is awesome!&lt;/div&gt;</span><span id="9b5d" class="kp kq if mi b fv nf mz l na nb">    &lt;!-- inject:js --&gt;<br/>    &lt;!-- endinject --&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e3cc" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> <em class="mo"> style.css </em> </strong></p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="5623" class="kp kq if mi b fv my mz l na nb">.awesome {<br/>  color: red;<br/>}</span></pre><p id="e074" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> <em class="mo"> script.js </em> </strong></p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="20c7" class="kp kq if mi b fv my mz l na nb">console.log('Awesome!');</span></pre><p id="e680" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">跳回命令行并运行<code class="eh mf mg mh mi b">gulp serve</code>。你应该会看到这个日志返回给你。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="2dfd" class="kp kq if mi b fv my mz l na nb">[23:50:44] Using gulpfile ~/super-awesome-gulp-tutorial/gulpfile.js<br/>[23:50:44] Starting 'html'...<br/>[23:50:44] Starting 'css'...<br/>[23:50:44] Starting 'js'...<br/>[23:50:44] Finished 'html' after 30 ms<br/>[23:50:44] Finished 'js' after 19 ms<br/>[23:50:44] Finished 'css' after 22 ms<br/>[23:50:44] Starting 'copy'...<br/>[23:50:44] Finished 'copy' after 4.77 μs<br/>[23:50:44] Starting 'inject'...<br/>[23:50:44] gulp-inject 1 files into index.html.<br/>[23:50:44] gulp-inject 1 files into index.html.<br/>[23:50:44] Finished 'inject' after 16 ms<br/>[23:50:44] Starting 'serve'...<br/>[23:50:44] Webserver started at <a class="ae nd" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a><br/>[23:50:44] Finished 'serve' after 18 ms</span></pre><p id="0450" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通过运行serve任务，所有被指定为依赖项的任务都已首先运行。正是你想要的。前往你选择的浏览器，打开<a class="ae nd" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>。希望你会看到这样的东西。</p><figure class="mq mr ms mt fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ng"><img src="../Images/f609b7f9b703346f65cafa9a806a4e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Z_ZjxwF-8qoje6cn0OzJQ.png"/></div></div></figure><h2 id="08c2" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">第八步——观察变化</h2><p id="ff7b" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">观察变化意味着Gulp将不断地检查你的文件中的变化。您只需指定它必须监视的文件。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="3fed" class="kp kq if mi b fv my mz l na nb">gulp.task('watch', ['serve'], function () {<br/>  gulp.watch(paths.src, ['inject']);<br/>});</span></pre><p id="f1f5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"><em class="mo"/></strong>任务会先等待<strong class="je ig"><em class="mo">【serve】</em></strong>任务完成，才会开始观察。你告诉Gulp观看<strong class="je ig"> <em class="mo"> src </em> </strong>目录下的文件。如果它感觉到任何变化，它将启动<strong class="je ig"> <em class="mo">【注入】</em> </strong>吞咽任务。现在，每当你在任何指定的文件中保存更改时，Gulp都会触发<strong class="je ig"><em class="mo">‘inject’</em></strong>任务。太棒了。你甚至可以将<strong class="je ig"> <em class="mo">【观察】</em> </strong>任务链接到默认任务。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="bdfe" class="kp kq if mi b fv my mz l na nb">gulp.task('default', ['watch']);</span></pre><p id="8aa3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在您可以运行<code class="eh mf mg mh mi b">gulp</code>，它将依次运行您已经构建的所有任务。我猜你刚刚吞下了所有的东西。</p><h2 id="b38a" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤9 —建立dist</h2><p id="7ae1" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">随着开发环境的建立和运行，您已经到了想要打包文件以便为生产做准备的时候了。这是Gulp真正展示肌肉的地方。继续安装下面的Gulp插件。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="3bc8" class="kp kq if mi b fv my mz l na nb">npm install gulp-htmlclean --save-dev<br/>npm install gulp-clean-css --save-dev<br/>npm install gulp-concat --save-dev<br/>npm install gulp-uglify --save-dev</span></pre><p id="53c9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">并要求他们在<strong class="je ig">顶部<em class="mo"> gulpfile.js </em>顶部</strong>。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="f23f" class="kp kq if mi b fv my mz l na nb">var htmlclean = require('gulp-htmlclean');<br/>var cleanCSS = require('gulp-clean-css');<br/>var concat = require('gulp-concat');<br/>var uglify = require('gulp-uglify');</span></pre><p id="3d06" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您可以重用大多数已经编写好的任务来创建构建任务。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="3baf" class="kp kq if mi b fv my mz l na nb">gulp.task('html:dist', function () {<br/>  return gulp.src(paths.srcHTML)<br/>    .pipe(htmlclean())<br/>    .pipe(gulp.dest(paths.dist));<br/>});</span><span id="da39" class="kp kq if mi b fv nf mz l na nb">gulp.task('css:dist', function () {<br/>  return gulp.src(paths.srcCSS)<br/>    .pipe(concat('style.min.css'))<br/>    .pipe(cleanCSS())<br/>    .pipe(gulp.dest(paths.dist));<br/>});</span><span id="47b5" class="kp kq if mi b fv nf mz l na nb">gulp.task('js:dist', function () {<br/>  return gulp.src(paths.srcJS)<br/>    .pipe(concat('script.min.js'))<br/>    .pipe(uglify())<br/>    .pipe(gulp.dest(paths.dist));<br/>});</span><span id="584c" class="kp kq if mi b fv nf mz l na nb">gulp.task('copy:dist', ['html:dist', 'css:dist', 'js:dist']);</span><span id="b4e9" class="kp kq if mi b fv nf mz l na nb">gulp.task('inject:dist', ['copy:dist'], function () {<br/>  var css = gulp.src(paths.distCSS);<br/>  var js = gulp.src(paths.distJS);<br/>  return gulp.src(paths.distIndex)<br/>    .pipe(inject( css, { relative:true } ))<br/>    .pipe(inject( js, { relative:true } ))<br/>    .pipe(gulp.dest(paths.dist));<br/>});</span><span id="7057" class="kp kq if mi b fv nf mz l na nb">gulp.task('build', ['inject:dist']);</span></pre><p id="352c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">添加的插件通过管道连接在<code class="eh mf mg mh mi b">gulp.src</code>和<code class="eh mf mg mh mi b">gulp.dest</code>命令之间。其他一切都保持不变。</p><p id="14f3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">只有一件事要补充给你<strong class="je ig"><em class="mo"/></strong>:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="1032" class="kp kq if mi b fv my mz l na nb">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;!--[htmlclean-protect]--&gt;<br/>    &lt;!-- inject:css --&gt;<br/>    &lt;!-- endinject --&gt;<br/>    &lt;!--[/htmlclean-protect]--&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div class="awesome"&gt;This is awesome!&lt;/div&gt;</span><span id="0613" class="kp kq if mi b fv nf mz l na nb">    &lt;!--[htmlclean-protect]--&gt;<br/>    &lt;!-- inject:js --&gt;<br/>    &lt;!-- endinject --&gt;<br/>    &lt;!--[/htmlclean-protect]--&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="5578" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">默认情况下，htmlclean插件会清除模板中的所有注释。您只需要为注入注释禁用此行为。</p><p id="894f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">继续运行<strong class="je ig"> <em class="mo">【构建】</em> </strong>任务。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="7edc" class="kp kq if mi b fv my mz l na nb">gulp build</span></pre><p id="2e50" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">看看你的项目文件夹。你现在可以看到一个<strong class="je ig"> <em class="mo">区</em> </strong>的文件夹。其中的文件已经被连接和缩小，准备发送到生产服务器。</p><h2 id="ba1a" class="kp kq if bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">步骤10 —清理</h2><p id="b868" class="pw-post-body-paragraph jc jd if je b jf lk jh ji jj ll jl jm jn lm jp jq jr ln jt ju jv lo jx jy jz hn dt translated">将<strong class="je ig"> <em class="mo"> tmp </em> </strong>和<strong class="je ig"> <em class="mo"> dist </em> </strong>文件夹发送到GitHub或您可能正在使用的任何版本控制，这不是一个好的做法。你需要一种没有太多麻烦的方法来删除它们。</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="dde3" class="kp kq if mi b fv my mz l na nb">npm install del --save-dev</span></pre><p id="c57f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">安装上面的包。这会让你的生活轻松很多。要求它在<strong class="je ig">顶部<em class="mo"> gulpfile.js </em>顶部</strong>这样:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="07f4" class="kp kq if mi b fv my mz l na nb">var del = require('del');</span></pre><p id="50b3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">并添加以下代码片段:</p><pre class="mq mr ms mt fq mu mi mv mw aw mx dt"><span id="44e9" class="kp kq if mi b fv my mz l na nb">gulp.task('clean', function () {<br/>  del([paths.tmp, paths.dist]);<br/>});</span></pre><p id="2997" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">跳回你的命令行并运行<code class="eh mf mg mh mi b">gulp clean</code>。看魔术。<strong class="je ig"> <em class="mo"> tmp </em> </strong>和<strong class="je ig"> <em class="mo"> dist </em> </strong>文件夹已被删除！</p><p id="59ef" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一个好的做法是将<strong class="je ig"> <em class="mo"> tmp </em> </strong>和<strong class="je ig"> <em class="mo"> dist </em> </strong>文件夹添加到您的<strong class="je ig"> <em class="mo">文件夹中。gitignore </em> </strong>，确保你绝对不会把它们推到你的GitHub库。</p></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="d29d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你错过了上面的任何一个步骤，可以跳到GitHub <strong class="je ig"> </strong> <a class="ae nd" href="https://github.com/adnanrahic/gulp-all-the-things" rel="noopener ugc nofollow" target="_blank"> <strong class="je ig">库</strong> </a>中喘口气。整个代码库都在那边，不用担心。</p></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="4d93" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你面对了黑暗面，成为了英雄。干得好！这是一个关于任务自动化的<em class="mo">“把你扔进水池的深水区】</em>速成班。我很自信地说，如果你已经走了这么远，你会游泳的。但是不要就此打住。关于Gulp还有很多东西需要学习，这仅仅是个开始。但是，尽管如此，对于您来说，开始构建严肃的应用程序并开始发布代码已经足够了。学习的最好方法是通过具体的例子。尽可能多地破解和发布代码。</p><p id="490d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">希望你们和我写这篇文章的时候一样开心。 <em class="mo">如果你认为它对某人有帮助，或者你喜欢它，请随意分享💚所以其他人会在媒体上看到这个。</em></p><div class="mq mr ms mt fq ab cb"><figure class="nh hw ni nj nk nl nm paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nh hw ni nj nk nl nm paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nh hw ni nj nk nl nm paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nn no np"><p id="f922" class="jc jd mo je b jf jg jh ji jj jk jl jm nq jo jp jq nr js jt ju ns jw jx jy jz hn dt translated"><a class="ae nd" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae nd" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae nd" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae nd" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd mo je b jf jg jh ji jj jk jl jm nq jo jp jq nr js jt ju ns jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae nd" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae nd" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="mq mr ms mt fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nt"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>