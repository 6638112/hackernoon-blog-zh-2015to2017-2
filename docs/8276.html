<html>
<head>
<title>Real-time Facial Performance Capture with iPhone X</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用iPhone X实时捕捉面部表情</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/real-time-facial-performance-capture-with-iphone-x-b378e21d077f?source=collection_archive---------7-----------------------#2017-11-27">https://medium.com/hackernoon/real-time-facial-performance-capture-with-iphone-x-b378e21d077f?source=collection_archive---------7-----------------------#2017-11-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d63e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当苹果宣布iPhone X和Animoji时，我们的第一个想法是:我们能不能用它来制作任意3D角色的动画？也就是不仅仅是苹果设计的Animoji。</p><p id="0546" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">事实证明，是的，这不仅是可能的。这非常简单，ARKit face APIs足够强大，可以制作出有用的动画。我们可以实时捕捉它。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/0d352a3f7da4b18ae2708808e52c5bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6-Ezsb0kc_v18n0opUsHEw.gif"/></div></div></figure><p id="4dba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将涵盖以下内容:</p><ul class=""><li id="0179" class="kb kc hu it b iu iv iy iz jc kd jg ke jk kf jo kg kh ki kj dt translated">苹果的混合形状</li><li id="d0f9" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">在我们的模型上构建混合形状</li><li id="f5d3" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">我们的iOS应用程序通过UDP传输混合形状</li><li id="1aa1" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">Unity扩展从我们的iOS应用程序接收数据</li><li id="762e" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">两个项目的源代码</li></ul><p id="e99d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">结果是能够将混合形状参数从iPhone X实时传输到Unity中，以控制您的动画装备。</p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="kp kq l"/></div></figure><h1 id="8b38" class="kr ks hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">这不是已经做了吗？</h1><p id="679b" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">最近有一篇<a class="ae lu" href="http://prostheticknowledge.tumblr.com/post/167520295696/iphone-x-face-motion-capture-into-houdini-were" rel="noopener ugc nofollow" target="_blank">文章</a>展示了iPhone X前置摄像头模块的3D输出。它显示了从iPhone X捕获并输入到Houdini (3D动画软件)中的原始顶点数据。然而，我们想要的是获得面部运动数据本身，并将其重新定向到任意的3D模型。</p><p id="7b22" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，举例来说，你只需把iPhone X举到脸前，就可以表演游戏中角色的口型同步和面部表情。或者你可以为一部电视剧制作一个角色的动画。</p><p id="e335" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当前的自动面部动画技术分析音素的语音数据(例如，<code class="eh lv lw lx ly b">ee</code>、<code class="eh lv lw lx ly b">oo</code>、<code class="eh lv lw lx ly b">ah</code>)，并将这些声音映射到3D模型混合形状。我们认为iPhone X可以产生更动态的面部表情，包括眉毛运动、眨眼、鼻子张开和眼睑运动。</p><h1 id="39b4" class="kr ks hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">使用iPhone X将面部运动重定向到网格</h1><p id="f0a9" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">原来ARKit不仅给你从你的脸计算的原始顶点数据，它给你一组混合形状值。混合形状值只是介于0.0和1.0之间的数字，它告诉你ARKit认为你脸上的某块肌肉在运动。</p><p id="6c82" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，例如，<code class="eh lv lw lx ly b">Jaw Open</code>混合形状在下颚闭合时为0.0，在下颚张开时为1.0。任何介于两者之间的值都表示下颚部分张开。</p><p id="fae8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这真的很强大，因为如果你是一名3D艺术家，你不仅可以将苹果的混合形状映射到你的3D角色，还可以围绕各种值设计动画装备。例如，也许你有一只长着尖耳朵的卡通狐狸，当你发现有人皱眉时，你可以自动将耳朵转向下方(事实上，苹果公司也用他们自己的Animoji做到了这一点)。</p><h1 id="231e" class="kr ks hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">制作变形目标</h1><p id="580d" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">最费力的部分是在你定制的3D网格上模仿苹果的变形目标。</p><p id="a4ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有很多混合形状。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/1140baf34e18a5ea825b699428c9d13a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*Jw3OPzfzn33ODkKhT_6bIw.gif"/></div></figure><p id="1684" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">总共有<a class="ae lu" href="https://developer.apple.com/documentation/arkit/arfaceanchor.blendshapelocation" rel="noopener ugc nofollow" target="_blank"> 51种混合形状</a>，包括<code class="eh lv lw lx ly b">eyeBlinkLeft</code>、<code class="eh lv lw lx ly b">eyeWideRight</code>、<code class="eh lv lw lx ly b">mouthFunnel</code>、<code class="eh lv lw lx ly b">mouthLowerDownLeft</code>等等。这些中的大多数是对称的，因为它们有左和右等价物。</p><p id="92f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是我们为样本模型制作的混合形状。这些都是相当基本的，而且制作很快，所以我们可以测试这个想法的有效性。您自己的定制模型可以有更好、更复杂的混合形状。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff mb"><img src="../Images/965ab6f8a5d338ba1ffbeaa962092d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/1*7saZqJan4fuVZGrRxseTFg.gif"/></div></figure><h1 id="1bbb" class="kr ks hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">它是如何工作的？</h1><p id="2956" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">演示由两部分组成。iOS应用程序和Unity extension主机。</p><h2 id="eb86" class="mc ks hu bd kt md me mf kx mg mh mi lb jc mj mk lf jg ml mm lj jk mn mo ln mp dt translated">iOS应用程序</h2><p id="876e" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">在这里可以得到<a class="ae lu" href="http://github.com/johnjcsmith/iPhoneMoCap" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="737c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">iOS应用程序通过UDP套接字将苹果在<code class="eh lv lw lx ly b">ARFaceAnchor.blendShapes</code>提供的混合形状传输到Unity主机。本质上是发出一个消息流，每个消息都有50个混合形状，格式为<code class="eh lv lw lx ly b">'blend-shape-name:blend-shape-value'</code>。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mq"><img src="../Images/7ff02faad3571021618aa9f2e4594d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yZoWehY51AxFJ2sMFoCkPQ.jpeg"/></div></div></figure><p id="6360" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里有很多性能上的改进，但这只是为了演示的目的。</p><h2 id="4e03" class="mc ks hu bd kt md me mf kx mg mh mi lb jc mj mk lf jg ml mm lj jk mn mo ln mp dt translated">Unity扩展主机</h2><p id="0600" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">在这里可以得到<a class="ae lu" href="http://github.com/johnjcsmith/iPhoneMoCapUnity" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="566b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在Unity主机内部，我们有一个扩展，它打开一个UDP套接字来监听iPhone的消息。当它收到消息时，它会将混合变形值应用到装备上相应的混合变形。</p><h1 id="3454" class="kr ks hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">如何运行项目</h1><ul class=""><li id="c94c" class="kb kc hu it b iu lp iy lq jc mr jg ms jk mt jo kg kh ki kj dt translated">从<a class="ae lu" href="https://github.com/johnjcsmith/iPhoneMoCapUnity" rel="noopener ugc nofollow" target="_blank">这里</a>克隆并打开Unity项目。</li><li id="ae22" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">运行Unity项目的场景</li><li id="c60b" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">在菜单栏中选择<code class="eh lv lw lx ly b">iPhoneMoCap</code>-&gt;-T7】</li><li id="6365" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">启用网格预览</li><li id="e826" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">从<a class="ae lu" href="https://github.com/johnjcsmith/iPhoneMoCapiOS" rel="noopener ugc nofollow" target="_blank">这里</a>抓取iOS应用项目</li><li id="7e1f" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">确保您的iPhone X连接到同一个Wifi网络，并构建/运行此应用程序。(不要忘记pod安装)</li><li id="6761" class="kb kc hu it b iu kk iy kl jc km jg kn jk ko jo kg kh ki kj dt translated">该应用程序应该会发现unity主机并开始传输运动数据。</li></ul></div><div class="ab cl mu mv hc mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hn ho hp hq hr"><h2 id="66fd" class="mc ks hu bd kt md me mf kx mg mh mi lb jc mj mk lf jg ml mm lj jk mn mo ln mp dt translated">作者</h2><p id="a0ef" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated"><strong class="it hv">西蒙·桑斯</strong>领导<a class="ae lu" href="http://enabled.com.au" rel="noopener ugc nofollow" target="_blank">使</a>的移动开发活动非常注重设计和人机交互。Simeon还被要求会见客户，了解他们的需求并开发技术解决方案。<br/>在<a class="ae lu" href="https://twitter.com/TwoLivesLeft" rel="noopener ugc nofollow" target="_blank">推特上关注西蒙</a></p><p id="bdca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">约翰·史密斯通常在9-5点出现在<a class="ae lu" href="http://enabled.com.au" rel="noopener ugc nofollow" target="_blank">的办公室</a>。他在较冷的月份穿鞋。除了服装，约翰的作品包括手机、网络和少量的DevOps。<br/>在推特<a class="ae lu" href="https://twitter.com/johnjamescsmith" rel="noopener ugc nofollow" target="_blank">上关注约翰</a></p></div><div class="ab cl mu mv hc mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hn ho hp hq hr"><h2 id="273e" class="mc ks hu bd kt md me mf kx mg mh mi lb jc mj mk lf jg ml mm lj jk mn mo ln mp dt translated">获得更多移动应用程序设计技巧或问题？推文给我们<a class="ae lu" href="https://twitter.com/EnabledHQ" rel="noopener ugc nofollow" target="_blank"> @EnabledHQ </a></h2></div></div>    
</body>
</html>