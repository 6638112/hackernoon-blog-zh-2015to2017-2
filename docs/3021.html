<html>
<head>
<title>[Nodemon] Auto-Watch-Reload Node.js file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[Nodemon]自动观察-重新加载Node.js文件</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/nodemon-example-tutorial-npm-start-script-auto-watch-47cd702fe442?source=collection_archive---------2-----------------------#2017-03-07">https://medium.com/hackernoon/nodemon-example-tutorial-npm-start-script-auto-watch-47cd702fe442?source=collection_archive---------2-----------------------#2017-03-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/cb3a928a39494cbbad86a59356919116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*3uoizvRlK9KoI6o1z5panA.png"/></div></figure><p id="65cf" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我喜欢高效工作，并且总是在寻找高效工作的工具。现在我正在做一个<strong class="ja hv"> React同构</strong>项目，自动观察设置在<strong class="ja hv">服务器端</strong>(当文件改变时重启服务器)和<strong class="ja hv">客户端</strong>(当文件改变时构建静态文件)是不同的。然而,<strong class="ja hv">同构</strong>的思想在服务器端和客户端共享相同的<strong class="ja hv">反应组件</strong>。有足够多的自动观察工具:webpack、grunt、gulp、nodemon等，以及自动构建工具:webpack、grunt、gulp、browserify等。</p><p id="0f71" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">找到合适的工具来做合适的任务，一个接一个地玩它们，这就是这个例子的<a class="ae jw" href="https://github.com/wahengchang/nodemon-example" rel="noopener ugc nofollow" target="_blank"> git </a>，希望有帮助。</p><h2 id="f95f" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">1-创建一个简单的Express服务器</h2><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="7ba3" class="jx jy hu kx b fv lb lc l ld le">//app.js<br/>var express = require('express')<br/>var app = express()<br/></span><span id="0f69" class="jx jy hu kx b fv lf lc l ld le">app.get('/', function (req, res) {<br/>   res.send('Hello World!')<br/>})<br/></span><span id="c596" class="jx jy hu kx b fv lf lc l ld le">app.listen(3000, function () {<br/>   console.log('Example app listening on port 3000!')<br/>})</span></pre><h2 id="2bb3" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">2-运行快速服务器</h2><p id="34ce" class="pw-post-body-paragraph iy iz hu ja b jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv hn dt translated">自动观察功能还没有开启。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="d31e" class="jx jy hu kx b fv lb lc l ld le"><strong class="kx hv">$ node app.js</strong></span><span id="9822" class="jx jy hu kx b fv lf lc l ld le">Example app listening on port 3000!</span></pre><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div class="fe ff ll"><img src="../Images/21c9b4cb24fb23d9dd1739bd4b81576c.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*-DlvtisBrm7tGwITA8f3ug.png"/></div></figure><h2 id="56f0" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">3-通过<strong class="ak"> <em class="lm"> nodemon </em> </strong>运行相同的服务器</h2><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="3243" class="jx jy hu kx b fv lb lc l ld le"><strong class="kx hv">$ npm install </strong><strong class="kx hv">--save-dev nodemon<br/>$ </strong><strong class="kx hv">./node_modules/nodemon/bin/nodemon.js app.js</strong></span><span id="03f7" class="jx jy hu kx b fv lf lc l ld le">[nodemon] 1.11.0<br/>[nodemon] to restart at any time, enter `rs`<br/>[nodemon] watching: *.*<br/>[nodemon] starting `node app.js`</span><span id="c6ad" class="jx jy hu kx b fv lf lc l ld le">Example app listening on port 3000!</span></pre><h2 id="f23c" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">4-使用配置文件运行nodemon</h2><p id="9018" class="pw-post-body-paragraph iy iz hu ja b jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv hn dt translated">Nodemon支持本地和全局配置文件。这些通常被命名为<code class="eh ln lo lp kx b">nodemon.json.</code></p><p id="e15f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">可以用<code class="eh ln lo lp kx b">--config &lt;file&gt;</code>选项指定一个替代的本地配置文件。</p><p id="cc80" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">参见<a class="ae jw" href="https://github.com/remy/nodemon/blob/master/doc/sample-nodemon.md" rel="noopener ugc nofollow" target="_blank">样本nodemon.json </a>，</p><h2 id="1c0d" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">使用示例nodemon.json运行</h2><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="97ca" class="jx jy hu kx b fv lb lc l ld le"><strong class="kx hv">$ ./node_modules/nodemon/bin/nodemon.js app.js --config nodemon.json</strong></span><span id="8bff" class="jx jy hu kx b fv lf lc l ld le">[nodemon] 1.11.0</span><span id="c8dc" class="jx jy hu kx b fv lf lc l ld le">[nodemon] reading config /Users/userA/nodemon-example/nodemon.json</span><span id="d02f" class="jx jy hu kx b fv lf lc l ld le">[nodemon] to restart at any time, enter `rs`</span><span id="396b" class="jx jy hu kx b fv lf lc l ld le">[nodemon] ignoring: .git .nyc_output .sass-cache bower_components coverage /Users/userA/nodemon-example/node_modules/**/* .git node_modules/**/node_modules</span><span id="0c64" class="jx jy hu kx b fv lf lc l ld le">[nodemon] watching: test/fixtures/**/* test/samples/**/*</span><span id="9bf4" class="jx jy hu kx b fv lf lc l ld le">[nodemon] watching extensions: js,json</span><span id="71d1" class="jx jy hu kx b fv lf lc l ld le">[nodemon] bind restart -&gt; `osascript -e 'display notification "App restarted due to:</span><span id="d168" class="jx jy hu kx b fv lf lc l ld le">'$FILENAME'" with title "nodemon"'`</span><span id="9025" class="jx jy hu kx b fv lf lc l ld le">[nodemon] starting `node --harmony app.js`</span><span id="2ff0" class="jx jy hu kx b fv lf lc l ld le">[nodemon] child pid: 6166</span><span id="c12c" class="jx jy hu kx b fv lf lc l ld le">[nodemon] watching 3 files</span><span id="454c" class="jx jy hu kx b fv lf lc l ld le">Example app listening on port 3000!</span></pre><h2 id="4677" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">5-使用nodemon脚本安装package.json</h2><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="ffd7" class="jx jy hu kx b fv lb lc l ld le">//package.json</span><span id="b621" class="jx jy hu kx b fv lf lc l ld le">"scripts": {<br/>   "start": "node app.js",<br/>   "dev": "echo 'run dev' &amp; npm start",<br/>   "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",<br/>   "nodemon": "./node_modules/nodemon/bin/nodemon.js --config nodemon.json --exec npm run dev "<br/>},</span></pre><h2 id="c43b" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">奔跑</h2><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="e103" class="jx jy hu kx b fv lb lc l ld le">$ npm run nodemon</span></pre></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><h1 id="3af6" class="lx jy hu bd jz ly lz ma kd mb mc md kh me mf mg kk mh mi mj kn mk ml mm kq mn dt translated">备注:</h1><h2 id="5d2d" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">execMap</h2><p id="ef33" class="pw-post-body-paragraph iy iz hu ja b jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv hn dt translated">在<code class="eh ln lo lp kx b">nodemon.json</code>配置文件中，定义你自己的可执行文件:</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="af6e" class="jx jy hu kx b fv lb lc l ld le">{<br/>  "execMap": {<br/>     "pl": "perl"<br/>  }<br/>}</span></pre><h2 id="3bd7" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">nodemon状态改变时触发事件</h2><p id="be56" class="pw-post-body-paragraph iy iz hu ja b jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv hn dt translated">在<code class="eh ln lo lp kx b">nodemon.json</code>配置文件中，定义事件的动作(阅读更多<a class="ae jw" href="https://github.com/remy/nodemon/wiki/Events#states" rel="noopener ugc nofollow" target="_blank">事件列表</a>):</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="88d1" class="jx jy hu kx b fv lb lc l ld le">{<br/>  "events": {<br/>    "restart": "osascript -e 'display notification \"app restarted\" with title \"nodemon\"'"<br/>  }<br/>}</span></pre><h1 id="5fd9" class="lx jy hu bd jz ly mo ma kd mb mp md kh me mq mg kk mh mr mj kn mk ms mm kq mn dt translated">参考:</h1><p id="7155" class="pw-post-body-paragraph iy iz hu ja b jb lg jd je jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv hn dt translated"><a class="ae jw" href="https://github.com/remy/nodemon#nodemon" rel="noopener ugc nofollow" target="_blank">https://github.com/remy/nodemon#nodemon</a></p><p id="4026" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><a class="ae jw" href="https://github.com/wahengchang/nodemon-example" rel="noopener ugc nofollow" target="_blank">https://github.com/wahengchang/nodemon-example</a></p><div class="ks kt ku kv fq ab cb"><figure class="mt iv mu mv mw mx my paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mt iv mu mv mw mx my paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mt iv mu mv mw mx my paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mz na nb"><p id="f922" class="iy iz nc ja b jb jc jd je jf jg jh ji nd jk jl jm ne jo jp jq nf js jt ju jv hn dt translated"><a class="ae jw" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jw" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jw" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jw" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="iy iz nc ja b jb jc jd je jf jg jh ji nd jk jl jm ne jo jp jq nf js jt ju jv hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jw" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jw" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ks kt ku kv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="fe ff ng"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>