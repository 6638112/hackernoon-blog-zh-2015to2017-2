<html>
<head>
<title>Playing with React Native Animations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React本机动画</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/playing-with-react-native-animations-d065e7e97391?source=collection_archive---------3-----------------------#2017-01-04">https://medium.com/hackernoon/playing-with-react-native-animations-d065e7e97391?source=collection_archive---------3-----------------------#2017-01-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="a4e2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于我今年的第一个帖子，我想保持简洁，尝试一下<a class="ae jp" href="https://facebook.github.io/react-native/docs/animations.html" rel="noopener ugc nofollow" target="_blank"> React本地动画API </a>。我们将创建一些动画栏，并不断改变它们的大小。这是我们的最终结果</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/ecbfea7846a61cb554d53816e318d824.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*d5fJtuzFIq6-hH5M4UTshw.gif"/></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">Please note that any choppiness is a result of recording the GIF (video at end of post as well).</figcaption></figure><p id="7068" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有兴趣试试吗？我们开始吧。</p><h2 id="54a7" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">项目设置</h2><p id="b057" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">所有的代码都可以在Github 上找到，但是如果你想继续下去，这里是你需要开始做的事情。</p><pre class="jr js jt ju fq lc ld le lf aw lg dt"><span id="87e0" class="kc kd hu ld b fv lh li l lj lk">react-native init RNBarGraphExample</span></pre><p id="5683" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后创建一个<code class="eh ll lm ln ld b">app/index.js</code>和<code class="eh ll lm ln ld b">app/AnimatedBar.js</code>并将下面的内容复制粘贴到它们中开始。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="21de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这两个文件都非常简单，会在你的应用程序中产生一个浅蓝色的屏幕(没有别的)。让他们快速浏览一遍，了解发生了什么。</p><p id="e5f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，我们希望在我们的应用程序中实际使用这些文件——为此，用以下内容替换<code class="eh ll lm ln ld b">index.ios.js</code>和<code class="eh ll lm ln ld b">index.android.js</code>。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="f866" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后一步，纯粹是为了方便，是通过npm安装<code class="eh ll lm ln ld b">randomcolor</code>。</p><h2 id="d042" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">创建数据</h2><p id="ae31" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">在渲染之前，我们需要一些数据。我们将保持简单，创建10个宽度在0和屏幕宽度之间的数据元素——这将全部发生在<code class="eh ll lm ln ld b">app/index.js</code></p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="aeca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我们的组件安装时，它将创建10个不同宽度的元素。现在让我们快速创建一些静态条，这样我们就可以开始看到一些东西。在<code class="eh ll lm ln ld b">app/AnimatedBar.js</code>中，我们将设置一些静态样式并将它们应用到我们的视图中。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="9814" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，每个条的背景颜色来自状态，这将是一个随机的颜色，并在组件的任何重新呈现之间保持不变。您现在应该会看到类似这样的内容</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/533043a68c62df5faddb4b878579e054.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*DOk_wbjFyugYh4Yz-pRDHA.png"/></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">Your colors will vary.</figcaption></figure><p id="3fb9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">酷——我们看到了一些东西！但是很无聊…</p><h2 id="98bd" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">进入时的动画</h2><p id="104b" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">所以现在我们想在第一次渲染时动画显示条形的宽度。这是视觉上的愉悦和快速的胜利。要做到这一点，我们需要在<code class="eh ll lm ln ld b">app/AnimatedBar.js</code>中创建一个新的动画值，然后使用该值来指定我们的条的宽度。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="dab7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这样，我们的bar的值将总是为0，所以现在我们需要将它从0动画化为您传递到<code class="eh ll lm ln ld b">AnimatedBar</code>实例中的值——我们将在<code class="eh ll lm ln ld b">AnimatedBar</code>中的componentDidMount中这样做。我们利用<code class="eh ll lm ln ld b">Animated.timing</code>函数将值从0更改为传入的值。如果您愿意，也可以使用<code class="eh ll lm ln ld b">Animated.spring</code>。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="c55b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个函数将我们的动画值作为第一个参数，将配置对象作为第二个参数。最初宽度是0，我们告诉它逐渐从0到X(其中X是通过props传递给组件的随机宽度值)。当重新加载应用程序时，您应该会看到类似这样的内容。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/919d0aa5e42662e6b43ccdaa9d312baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*eFtIPC4qJKhzn5uoUIsSDA.gif"/></div></figure><h2 id="318f" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">延迟动画</h2><p id="2a01" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">我们上面所做的可能有点忙——有很多事情同时发生。让我们将它设置为逐级向下，在渲染每个条形之间有一点延迟，好吗？</p><p id="df0e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您还记得前面的内容，我们还向我们的<code class="eh ll lm ln ld b">AnimatedBar</code>发送了一个延迟，它只是一个静态数字(本例中为100)*该值在该区域中的索引。因此第一个元素的延迟是<code class="eh ll lm ln ld b">100 * 0 = 0</code>，第二个是<code class="eh ll lm ln ld b">100 * 1 = 100</code>，…，<code class="eh ll lm ln ld b">100 * 9 = 900</code>。因此，第一个元素将立即开始，最后一个元素直到近一秒钟后才开始。</p><p id="e62a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">记住这一点，让我们使用延迟值！同样，我们将在组件中工作，除了<code class="eh ll lm ln ld b">Animated.timing</code>，我们还将使用<code class="eh ll lm ln ld b">Animated.sequence</code>和<code class="eh ll lm ln ld b">Animated.delay</code>。</p><p id="f3a5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ll lm ln ld b">Animated.sequence</code>允许我们对各种动画功能进行排序，而<code class="eh ll lm ln ld b">Animated.delay</code>只是让我们延迟连续的动画事件。</p><blockquote class="lr ls lt"><p id="9c27" class="ir is lu it b iu iv iw ix iy iz ja jb lv jd je jf lw jh ji jj lx jl jm jn jo hn dt translated">Animated.timing实际上有一个延迟选项，你可以通过它来做同样的事情，而且更简洁，但我想尝试不同的功能来了解它们，并与你分享。</p></blockquote><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="cd69" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，您可以看到，我们将一组动画函数传递给Animated.sequence，它将按顺序调用这些函数。对于延迟，我们使用传递给组件的延迟。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/42e919cea14e866660dcb19d9a8c3790.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*-cX_Il8lZCAIwW9gdTvPMg.gif"/></div></figure><p id="ae14" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这里，我们看到的是和之前一样的动画，只是层叠而下，两者之间稍有延迟！简单的变化，但我认为它增加了很多动画…而且我们学了更多的API！</p><h2 id="ed00" class="kc kd hu bd ke kf kg kh ki kj kk kl km jc kn ko kp jg kq kr ks jk kt ku kv kw dt translated">恒定动画</h2><p id="41a8" class="pw-post-body-paragraph ir is hu it b iu kx iw ix iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo hn dt translated">目前，我们的应用程序只在最初加载数据时进行渲染——对于许多应用程序来说，这已经足够了，但让我们玩得更开心一点，让它不断更新。核心动画已经就绪——我们只需要抽象一些<code class="eh ll lm ln ld b">AnimatedBar</code>代码，以便在组件更新时也能运行。我们将为此创建一个新函数，并在组件第一次挂载以及componentWillReceiveProps被调用时调用它。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="292f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">太好了！现在，我们将设置一个间隔，每1秒生成一次新数据。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="d087" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是我们完整的动画！下面的视频更好地展示了这一运动</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ly lp l"/></div></figure></div><div class="ab cl lz ma hc mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hn ho hp hq hr"><blockquote class="mg"><p id="b88f" class="mh mi hu bd mj mk ml mm mn mo mp jo ek translated">想看看React Native中动画的真实应用吗？报名参加我的<a class="ae jp" href="https://learn.handlebarlabs.com/p/react-native-basics-build-a-currency-converter" rel="noopener ugc nofollow" target="_blank">免费React本土课程</a>！</p></blockquote><p id="9dce" class="pw-post-body-paragraph ir is hu it b iu mq iw ix iy mr ja jb jc ms je jf jg mt ji jj jk mu jm jn jo hn dt translated">问题/评论？请回复我，一定要推荐这篇文章！</p><div class="jr js jt ju fq ab cb"><figure class="mv jv mw mx my mz na paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mv jv mw mx my mz na paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mv jv mw mx my mz na paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lr ls lt"><p id="f922" class="ir is lu it b iu iv iw ix iy iz ja jb lv jd je jf lw jh ji jj lx jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is lu it b iu iv iw ix iy iz ja jb lv jd je jf lw jh ji jj lx jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="fe ff nb"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>