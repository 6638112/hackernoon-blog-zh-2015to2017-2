<html>
<head>
<title>Test Coverage: Going From Bad to Good, and Knowing When To Do It</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">测试覆盖率:从差到好，并且知道什么时候做</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/test-coverage-going-from-bad-to-good-and-knowing-when-to-do-it-3f4a93a58a82?source=collection_archive---------19-----------------------#2017-11-27">https://medium.com/hackernoon/test-coverage-going-from-bad-to-good-and-knowing-when-to-do-it-3f4a93a58a82?source=collection_archive---------19-----------------------#2017-11-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/337d9b1c5024c9ed81227e92c182659a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lpxYx2uC2XKujZd12YDSXg.jpeg"/></div></div></figure><p id="ae59" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">拥有具有良好测试覆盖率的产品代码对开发团队非常有益。</p><p id="c2ba" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">广泛的覆盖可以捕获进入代码库的bug和意外行为，每个人晚上都可以睡得更好，但是当一个代码库没有太多覆盖(或者根本没有覆盖)时，引入它可能真的很难。</p><p id="918c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将讨论您何时应该引入或增加测试覆盖率，并深入探讨它对您和您的团队有益的方式。</p><h1 id="1273" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">遗留代码库的覆盖率？</h1><p id="34ca" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">作为一个对测试深信不疑的人，我会齐心协力地为我参与的每个项目增加覆盖率。然而实际上，有时候测试并没有那么有益。</p><p id="29af" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，当处理遗留代码库(很少更新的内部API)时，增加覆盖范围会降低回报。</p><p id="b766" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您的遗留代码库在生产中工作可靠，几乎没有回归，那么追溯性地添加测试可能只是为了验证已经在生产中验证的内容。</p><p id="3656" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通常，应用程序的遗留部分充当依赖关系，所以我建议您将精力集中在利用旧代码测试新API上。</p><h1 id="4afd" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">仍然不确定保险的好处？</h1><p id="c101" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">以下是增加测试覆盖率的一些好处:</p><ul class=""><li id="5876" class="ld le hu je b jf jg jj jk jn lf jr lg jv lh jz li lj lk ll dt translated">确保您的代码按预期工作</li><li id="6416" class="ld le hu je b jf lm jj ln jn lo jr lp jv lq jz li lj lk ll dt translated">更加自信地部署代码</li><li id="c240" class="ld le hu je b jf lm jj ln jn lo jr lp jv lq jz li lj lk ll dt translated">降低凌晨1点打电话的可能性</li></ul><h2 id="e397" class="lr kb hu bd kc ls lt lu kg lv lw lx kk jn ly lz ko jr ma mb ks jv mc md kw me dt translated">确保您的代码按预期工作</h2><p id="e8f1" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">添加测试鼓励你概念化你想要你的程序如何运行，并考虑到边缘情况。</p><h2 id="a01a" class="lr kb hu bd kc ls lt lu kg lv lw lx kk jn ly lz ko jr ma mb ks jv mc md kw me dt translated">更加自信地部署代码</h2><p id="f962" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">您的覆盖范围越大，您就越有信心新特性不会引入回归。如果部署引入了一个bug，测试可以作为追踪bug和消灭它的文档。</p><h2 id="457d" class="lr kb hu bd kc ls lt lu kg lv lw lx kk jn ly lz ko jr ma mb ks jv mc md kw me dt translated">降低凌晨1点打电话的可能性</h2><p id="9468" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">传呼机任务并不好玩。说真的。</p><p id="05b5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对给你打电话的人来说也不好玩。</p><p id="980a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">增加覆盖率将有助于防止那些习惯在半夜把你吵醒的bug。<br/>未来你会感激的。</p><blockquote class="mf"><p id="e35b" class="mg mh hu bd mi mj mk ml mm mn mo jz ek translated">好吧，我被说服了！我如何开始添加保险？</p></blockquote><p id="850e" class="pw-post-body-paragraph jc jd hu je b jf mp jh ji jj mq jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">一旦你的团队开始增加测试覆盖率，我建议首先为新的特性工作编写测试。<br/>通过这种方式，代码库的新变化被覆盖，良好的习惯将开始在团队成员中形成(反过来，新员工也是)。</p><p id="242f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您的下一个优先事项应该是增加现有代码(非遗留)的覆盖率，但是这必须非常小心地完成。</p><p id="ebf6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通常有两种方法:</p><ul class=""><li id="b64c" class="ld le hu je b jf jg jj jk jn lf jr lg jv lh jz li lj lk ll dt translated">放弃现有的实现，一次一个独立的模块，并测试其代码的重建</li><li id="0553" class="ld le hu je b jf lm jj ln jn lo jr lp jv lq jz li lj lk ll dt translated">添加测试来验证现有代码。</li></ul><h2 id="dd18" class="lr kb hu bd kc ls lt lu kg lv lw lx kk jn ly lz ko jr ma mb ks jv mc md kw me dt translated">报废和试驾</h2><p id="4c80" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">优点:</p><ul class=""><li id="678b" class="ld le hu je b jf jg jj jk jn lf jr lg jv lh jz li lj lk ll dt translated">废弃和测试驱动可能会带来更好的设计和代码清晰度。</li><li id="e3e9" class="ld le hu je b jf lm jj ln jn lo jr lp jv lq jz li lj lk ll dt translated">这些测试将作为你的队友和未来自己的一种文档形式。</li></ul><p id="c962" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">缺点:</p><ul class=""><li id="065f" class="ld le hu je b jf jg jj jk jn lf jr lg jv lh jz li lj lk ll dt translated">丢弃现有代码可能会导致您错过在实现中不清楚的特定业务案例。</li></ul><h2 id="1f03" class="lr kb hu bd kc ls lt lu kg lv lw lx kk jn ly lz ko jr ma mb ks jv mc md kw me dt translated">向预先存在的代码添加覆盖率</h2><p id="3dbd" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">优点:</p><ul class=""><li id="e585" class="ld le hu je b jf jg jj jk jn lf jr lg jv lh jz li lj lk ll dt translated">通常比报废和试驾更快</li><li id="f071" class="ld le hu je b jf lm jj ln jn lo jr lp jv lq jz li lj lk ll dt translated">覆盖现有的API可以使重构更容易</li></ul><p id="b80f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">缺点:</p><ul class=""><li id="ab2f" class="ld le hu je b jf jg jj jk jn lf jr lg jv lh jz li lj lk ll dt translated">可能只是为了验证糟糕的设计。</li></ul><h1 id="aa41" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">副作用</h1><p id="44cd" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">测试当然有一个学习曲线，所以你的团队可能会提前花时间弄清楚如何最好地测试新的和旧的代码。</p><p id="941e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这可能会导致冲刺速度的降低，并可能在故事评估中需要更多的复杂性点。</p><p id="edf3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">也就是说，向新功能添加测试将减少bug，从而降低以后必须消除bug的成本，并且向现有代码添加覆盖范围将偿还技术债务，如果不偿还，这些债务可能会造成严重后果。</p><h1 id="31c4" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">摘要</h1><p id="74b6" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">总而言之，增加测试覆盖率将会改进设计，增加团队的信心和凝聚力，并减少与回归相关的压力。</p><p id="7af3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mu">原贴于</em> <a class="ae mv" href="https://www.stridenyc.com/blog/test-coverage-going-from-bad-to-good-and-knowing-when-to-do-it" rel="noopener ugc nofollow" target="_blank"> <em class="mu">跨步博客</em> </a> <em class="mu">。</em> <a class="ae mv" href="https://www.stridenyc.com/blog/author/michael-nunez" rel="noopener ugc nofollow" target="_blank"> <em class="mu">迈克尔努内斯</em> </a>撰写</p></div></div>    
</body>
</html>