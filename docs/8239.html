<html>
<head>
<title>The Android Boot Process</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android启动过程</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/the-android-boot-process-2ce4c498615b?source=collection_archive---------3-----------------------#2017-11-25">https://medium.com/hackernoon/the-android-boot-process-2ce4c498615b?source=collection_archive---------3-----------------------#2017-11-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="1606" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上述报价百分之百恰当。从表面上看，Android似乎是一个过于简单的操作系统。然而，相比之下，大多数智能手机消费者使用的操作系统的流程和功能要复杂得多。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/a84e63a3304f8d3eec9ed186f1d4979b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*yMojnmLY9K1NgH_8rI2BDA.jpeg"/></div></figure><p id="0dc6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于初学者来说，引导过程对最终用户来说不过是一堆花哨的图像和动画。这篇文章旨在为那些终端用户分解引导过程。我保证你只要通读一遍就能理解这个过程。如果解释正确，没有什么是太复杂的。</p><h1 id="b371" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">基本过程的梗概</h1><p id="e65b" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated"><strong class="it hv">Boot ROM-&gt;Boot loader-&gt;Kernel-&gt;init-&gt;Zygote-&gt;dal vik VM-&gt;系统服务器- &gt;管理器</strong></p><p id="c098" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以上恰好是Android开机的核心流程。它看起来肯定比简单的按下电源按钮要复杂得多。让我们从现在开始探索每一步，包括并行操作(如果有的话)。</p><h1 id="9d3c" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">引导rom</h1><p id="2c4d" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">只要按住电源按钮，就会执行负责“Boot ROM”部分的代码。代码的起点恰好是一个预定义的硬编码位置。该代码将引导加载程序加载到RAM中，并自行执行。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/8c7940aca5efda4b081a518b7a858bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*KBwgOOpWbfqZ9s3r3kjoNQ.jpeg"/></div></figure><h1 id="4a74" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">引导装载程序</h1><p id="5aaf" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">bootloader是Android系统的一个很小的组件，尽管这个术语很重。您可能听说过OEM或制造商设置了某些限制和规则——这正是所有这些“规则”存储的地方。在框架中被称为“引导装载程序”的过程包括两个阶段:</p><p id="8593" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">第一阶段——检测内存。引导加载程序检测RAM并执行启动第二步所需的应用程序。</p><p id="cbb3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">第二步——设置好一切。引导加载程序现在开始设置网络、低级内存管理和安全选项。</p><p id="ee11" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这一步对于内核的执行至关重要。位于<strong class="it hv">/bootable/boot loader/legacy/</strong>的引导程序包含两个非常重要的文件，即<strong class="it hv"> init.s </strong>和<strong class="it hv"> main.c </strong></p><p id="8fbc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> init.s </strong>文件主要初始化堆栈、零和BSS段。然后继续初始化<strong class="it hv"> main.c </strong>中的<strong class="it hv"> call_main() </strong>。文件<strong class="it hv"> main.c </strong>初始化硬件，特别是时钟、控制台和键盘，同时并行创建Linux标签。</p><p id="c10f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将尽量不去深究极端的细节。没有人愿意阅读一篇字数为1000字的帖子，用“简短”来解释一些技术性的东西。这就是删除评论有帮助的地方。</p><h1 id="790d" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">内核</h1><p id="691a" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">Android内核的初始化过程模拟了Linux内核的初始化。当内核执行时，它设置缓存、受保护的内存并调度不同的加载驱动程序。当设置好一切并成功调度驱动程序的过程结束时，内核在系统文件中寻找init。</p><h1 id="c796" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">初始化进程</h1><p id="4733" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">初始化过程被认为是非常重要的一步。不仅像<strong class="it hv"> /sys </strong>和<strong class="it hv"> /dev </strong>这样的目录或分区被挂载，init.rc脚本也被启动。init进程位于<strong class="it hv"> /init </strong>，而init.rc脚本位于<strong class="it hv"> /rootdir </strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/bfad7a0206960f0ce21167b748cfa9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*unA4-gSFOXS9Gm1QLRSq9g.jpeg"/></div></figure><h1 id="05b7" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">合子和达尔维克</h1><p id="948d" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">Zygote是一个虚拟机进程，在系统启动时启动。它支持跨Dalvik VM的代码共享，这有助于实现最短的启动时间。Zygote还确保了较低的内存占用，防止Dalvik VM消耗大量内存。此外，它初始化核心库类。</p><p id="3738" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Zygote加载过程的框架看起来与我们所概述的完全一样:<br/><strong class="it hv">Load Zygote init class-&gt;registerZygoteSocket()-&gt;preload classes()-&gt;preload resources()-&gt;用户的眼睛盯着精彩的引导动画</strong></p><h1 id="1372" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">系统服务</h1><p id="9bd1" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">合子现在派生出一个新的过程来启动、处理和执行下面概述的过程。</p><p id="9caf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">启动电源管理器- &gt;创建活动管理器- &gt;启动电话注册- &gt;启动包管理器- &gt;将活动管理器服务设置为系统进程- &gt;启动上下文管理器- &gt;启动系统联系提供者- &gt;启动电池服务- &gt;启动警报管理- &gt;启动- &gt;传感器服务- &gt;启动窗口管理器- &gt;启动蓝牙服务- &gt;启动安装服务- &gt;启动状态栏服务- &gt;启动硬件服务- &gt;启动NetStat服务- &gt;启动连接服务- &gt;启动通知管理器- &gt;启动设备存储监控服务- &gt;启动位置管理器- &gt;启动搜索服务- &gt;启动剪贴板服务- &gt;启动检查服务- &gt;启动壁纸服务- &gt;启动音频服务- &gt;启动HeadsetObserver - &gt;启动AdbSettingsObserver - &gt;击掌 谢谢</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff la"><img src="../Images/7b552c2d9da2165d815466636c582431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*laO8znOQUD40ANGICRgdTw.jpeg"/></div></div></figure><p id="1572" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lf">照片由</em><a class="ae lg" href="http://foter.com/author/b12e00" rel="noopener ugc nofollow" target="_blank"><em class="lf">portal gda</em></a><em class="lf">上</em><a class="ae lg" href="http://foter.com/re/ac49ef" rel="noopener ugc nofollow" target="_blank"><em class="lf">Foter.com</em></a><em class="lf">/</em><a class="ae lg" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="noopener ugc nofollow" target="_blank"><em class="lf">CC由-NC-SA </em> </a></p><h1 id="033f" class="jx jy hu bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dt translated">分析</h1><p id="46a9" class="pw-post-body-paragraph ir is hu it b iu kv iw ix iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo hn dt translated">现在启动已经成功结束，服务已经启动并运行，您可能想要学习创建日志的艺术</p><blockquote class="lh li lj"><p id="8319" class="ir is lf it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">开发商，不客气</p></blockquote><p id="6cf4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用adb从引导过程日志cat中获取事件。按照布局的相应顺序输入下面给出的命令。差点在那打出“凤凰”。</p><p id="fc65" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> adb logcat -d -b事件| grep“启动”</strong></p><p id="5d1c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">亚行log cat-d | grep preload ``</strong></p></div></div>    
</body>
</html>