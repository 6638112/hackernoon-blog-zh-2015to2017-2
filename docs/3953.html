<html>
<head>
<title>How to Build a ToDo App Using React, Redux, and Webpack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用React、Redux和Webpack构建ToDo应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-a-todo-app-using-react-redux-and-webpack-1aa99dc2f45c?source=collection_archive---------0-----------------------#2017-05-03">https://medium.com/hackernoon/how-to-build-a-todo-app-using-react-redux-and-webpack-1aa99dc2f45c?source=collection_archive---------0-----------------------#2017-05-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/d96f1725405c8512f21c821dc064ea42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EV6OOsdHgzYD_8UN.gif"/></div></div></figure><p id="76e8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章最初出现在宇宙JS博客上。</p><p id="68f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本教程中，我将向你展示如何使用React、Redux、一点Node和Cosmic JS创建一个简单的“ToDo”应用程序。为了理解如何使用Restful API，本教程将展示如何向Cosmic JS API发出简单的AJAX请求，以便检索、更新和删除Cosmic JS桶中的数据。让我们开始吧。</p><h1 id="7947" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="42f0" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><a class="ae ka" href="https://github.com/cosmicjs/todo-app" rel="noopener ugc nofollow" target="_blank">下载GitHub回购。</a> <br/> <a class="ae ka" href="https://cosmicjs.com/apps/todo-app" rel="noopener ugc nofollow" target="_blank">查看试玩。</a></p><h1 id="1759" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">开始使用:</h1><p id="422f" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">首先，让我们创建一个新目录来构建我们的项目，并创建一个package.json文件。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f481" class="ln kc hu lj b fv lo lp l lq lr">mkdir cool-cosmic-todo-app</span><span id="6eb6" class="ln kc hu lj b fv ls lp l lq lr">cool-cosmic-todo-app$ touch package.json</span></pre><p id="0400" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，在您的package.json中，复制并粘贴下面的代码，然后运行npm install或yarn(如果您是一个超级酷的yarn用户):</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="3364" class="ln kc hu lj b fv lo lp l lq lr">//cool-cosmic-todo-app/package.json<br/>{<br/>  "name": "cosmicToDo",<br/>  "version": "1.0.0",<br/>  "description": "A simple todo app thet uses the Cosmic JS API",<br/>  <!-- -->"main": "index.js",<br/>  "scripts": {<br/>    "start": "npm run build; node server/index.js",<br/>    "start-dev": "nodemon server/index.js",<br/>    "build": "webpack -p",<br/>    "build-dev": "webpack -w",<br/>    "build-sass": "node-sass -w ./client/styles/main.scss -o ./client/styles/mainSheet",<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "author": "",<br/>  "license": "ISC",<br/>  "dependencies": {<br/>    "axios": "^0.16.1",<br/>    "body-parser": "^1.17.1",<br/>    "css-loader": "^0.28.0",<br/>    "express": "^4.15.2",<br/>    "node-sass": "^4.5.2",<br/>    "react": "^15.5.4",<br/>    "react-addons-css-transition-group": "^15.5.2",<br/>    "react-addons-transition-group": "^15.5.2",<br/>    "react-dom": "^15.5.4",<br/>    "react-redux": "^5.0.4",<br/>    "react-router": "^3.0.0",<br/>    "reactstrap": "^4.5.0",<br/>    "redux": "^3.6.0",<br/>    "redux-logger": "^3.0.1",<br/>    "redux-thunk": "^2.2.0",<br/>    "sass-loader": "^6.0.3",<br/>    "style-loader": "^0.16.1",<br/>    "babel": "^6.5.2",<br/>    "babel-core": "^6.18.0",<br/>    "babel-loader": "^6.2.7",<br/>    "babel-preset-es2015": "^6.18.0",<br/>    "babel-preset-react": "^6.16.0",<br/>    "volleyball": "^1.4.1",<br/>    "webpack": "^2.2.1",<br/>    "webpack-livereload-plugin": "^0.10.0"<br/>  },<br/>  "devDependencies": {<br/>    "chai": "^3.5.0",<br/>    "cross-env": "^3.1.4",<br/>    "mocha": "^3.1.2",<br/>    "nodemon": "^1.11.0",<br/>    "supertest": "^2.0.1",<br/>    "supertest-as-promised": "^4.0.1"<br/>  }<br/>}</span></pre><h1 id="b13c" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">我们正在安装什么，为什么:</h1><ol class=""><li id="02d7" class="lt lu hu je b jf kz jj la jn lv jr lw jv lx jz ly lz ma mb dt translated">我们将使用axios库来处理我们对宇宙JS桶的请求。</li><li id="ff10" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们正在安装react和react-dom来构建我们的react组件。</li><li id="784b" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们将使用redux、react-redux、redux-logger和redux-thunk来帮助我们实现所谓的Flux架构。</li><li id="f628" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">在开发依赖中唯一值得一提的是webpack和排球。Webpack将帮助我们将所有的react和redux文件捆绑到一个大的“捆绑”文件中，该文件将在我们的index.html中使用。排球是一个很酷的小库，它允许我们在控制台中看到传入和传出的HTTP请求。</li></ol><h1 id="bb86" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">构建我们的应用程序:</h1><p id="ce09" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">现在，我们将构建我们的文件结构，以便我们可以组织我们的react组件和redux文件。我们的cool-cosmic-todo-app目录应该是这样的:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="8775" class="ln kc hu lj b fv lo lp l lq lr">cool-cosmic-todo-app<br/>|----client<br/>|       |----components<br/>|                 |----Home.js<br/>|                 |----Section.js<br/>|                 |----Task.js<br/>|       |----index.html<br/>|       |----dist<br/>|----redux<br/>|       |----store.js<br/>|       |----reducer.js<br/>|----server<br/>|       |----index.js<br/>|----webpack.config.js<br/>|----package.json</span></pre><p id="9cbb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我们将在客户目录中设置我们的index.html。将以下代码复制并粘贴到您的index.html文件中:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a436" class="ln kc hu lj b fv lo lp l lq lr">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="UTF-8" /&gt;<br/>    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;<br/>    &lt;title&gt;Cosmic Todo App!&lt;/title&gt;<br/>    &lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"&gt;<br/>    &lt;script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"&gt;&lt;/script&gt;<br/>    &lt;link rel="stylesheet" href="./styles/mainSheet/main.css"&gt;<br/>    &lt;link rel="stylesheet" href="./styles/mainSheet/font-awesome.min.css"&gt;<br/>    &lt;script src="https://code.jquery.com/jquery-3.2.1.min.js"<br/>            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="<br/>            crossorigin="anonymous"&gt;&lt;/script&gt;<br/>    &lt;script src="/dist/bundle.js" defer&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;div id="root"&gt;&lt;/div&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e1fd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这里，我们将“根”div作为目标，稍后在其中放置react组件。位于我们的dist目录中的<a class="ae ka" href="https://cosmicjs.com/blog/bundle.js" rel="noopener ugc nofollow" target="_blank"> bundle.js </a>文件是我们的webpack.config文件在捆绑了我们所有的react组件之后将会显示的内容。现在，设置我们的webpack.config文件来捆绑我们所有的react文件，并将该捆绑文件导出到我们的dist目录中。将以下代码复制到您的<a class="ae ka" href="https://cosmicjs.com/blog/webpack.config.js" rel="noopener ugc nofollow" target="_blank"> webpack.config.js </a>文件中:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="295a" class="ln kc hu lj b fv lo lp l lq lr">let path = require('path');<br/>let LiveReloadPlugin = require('webpack-livereload-plugin');</span><span id="60b4" class="ln kc hu lj b fv ls lp l lq lr">module.exports = {<br/>  entry: './client/index.js',<br/>  output: {<br/>    filename: 'bundle.js',<br/>    path: path.resolve(__dirname, 'client/dist')<br/>  },<br/>  context: __dirname,<br/>  resolve: {<br/>    extensions: ['.js', '.jsx', '.json', '*']<br/>  },<br/>  module: {<br/>    rules: [{<br/>      test: /\.jsx?$/,<br/>      exclude: /(node_modules|bower_components)/,<br/>      loader: 'babel-loader',<br/>      options: {<br/>        presets: ['react', 'es2015']<br/>      }<br/>    },<br/>      {<br/>        test: /\.scss$/,<br/>        use: [<br/>          'style-loader',<br/>          'css-loader',<br/>          'sass-loader'<br/>        ]<br/>      }]<br/>  },<br/>  plugins: [<br/>    new webpack.DefinePlugin({<br/>      'process.env.COSMIC_BUCKET': JSON.stringify(process.env.COSMIC_BUCKET),<br/>      'process.env.COSMIC_READ_KEY': JSON.stringify(process.env.COSMIC_READ_KEY),<br/>      'process.env.COSMIC_WRITE_KEY': JSON.stringify(process.env.COSMIC_WRITE_KEY)<br/>    }),<br/>    new LiveReloadPlugin({appendScriptTag: true})<br/>  ]<br/>};</span></pre><p id="1e4c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里，我们只是告诉webpack将一个<a class="ae ka" href="https://cosmicjs.com/blog/bundle.js" rel="noopener ugc nofollow" target="_blank"> bundle.js </a>文件输出到我们的dist文件夹中，其中还捆绑了我们所有的react组件。babel-loader只是使用babel和webpack传输JavaScript文件。live reload插件允许我们对我们的文件进行更改，并自动让webpack监视和“重新捆绑”我们更新的更改。接下来，我们将使用express的一点点节点来提供我们的index.html文件以及我们的<a class="ae ka" href="https://cosmicjs.com/blog/bundle.js" rel="noopener ugc nofollow" target="_blank"> bundle.js </a>文件。实际上，我们并没有真正向我们自己的节点后端发出请求，但是使用node作为一种方法来为我们提供静态文件是很好的。将下面的代码复制并粘贴到我们服务器目录下的<a class="ae ka" href="https://cosmicjs.com/blog/index.js" rel="noopener ugc nofollow" target="_blank"> index.js </a>文件中。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="8ebd" class="ln kc hu lj b fv lo lp l lq lr">const express = require('express');<br/>const app = express();<br/>const path = require('path');<br/>const volleyball = require('volleyball');</span><span id="92e8" class="ln kc hu lj b fv ls lp l lq lr">app.use(volleyball);</span><span id="10ef" class="ln kc hu lj b fv ls lp l lq lr">//serve up static files<br/>app.use(express.static(path.resolve(__dirname, '..', 'client')));<br/>app.use(express.static(path.resolve(__dirname, '..', 'node_modules')));</span><span id="936a" class="ln kc hu lj b fv ls lp l lq lr">app.use(function (err, req, res, next) {<br/>  console.error(err);<br/>  console.error(err.stack);<br/>  res.status(err.status || 500).send(err.message || 'Internal server error.');<br/>});<br/></span><span id="9216" class="ln kc hu lj b fv ls lp l lq lr">// handle every other route with index.html, which will contain<br/>// a script tag to our application's JavaScript file(s).<br/>app.get('*', function (request, response) {<br/>  response.sendFile(path.resolve(__dirname, '..', 'client', 'index.html'))<br/>});</span><span id="efb3" class="ln kc hu lj b fv ls lp l lq lr">//listen on port 3000<br/>app.listen(process.env.PORT || 3000, function () {<br/>  console.log("Rockin' out on port 3000 homie");<br/>});</span></pre><p id="81db" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里，我们只是告诉我们的服务器从我们的node_modules和客户机目录中提供静态文件。“*”路线基本上是告诉express在我们的应用程序中请求的任何路线上提供我们的index.html。最后，我们告诉express监听端口3000。请随意尝试！运行npm start或yarn start，并查看我们的“在端口3000 homie上摇滚”消息日志放入控制台！接下来，让我们设置位于client/redux文件夹中的redux <a class="ae ka" href="https://cosmicjs.com/blog/store.js" rel="noopener ugc nofollow" target="_blank"> store.js </a>文件。将以下代码复制并粘贴到位于我们的client/redux文件夹中的<a class="ae ka" href="https://cosmicjs.com/blog/store.js" rel="noopener ugc nofollow" target="_blank"> store.js </a>文件中:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a092" class="ln kc hu lj b fv lo lp l lq lr">import { createStore, applyMiddleware } from 'redux';<br/>import reducer from './reducer';<br/>import thunkMiddleware from 'redux-thunk';<br/>import {createLogger} from 'redux-logger';</span><span id="8488" class="ln kc hu lj b fv ls lp l lq lr">const store = createStore(<br/>  reducer,<br/>  applyMiddleware(<br/>    createLogger(),<br/>    thunkMiddleware<br/>  )<br/>);</span><span id="6e61" class="ln kc hu lj b fv ls lp l lq lr">export default store;</span></pre><h1 id="09e8" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这是怎么回事:</h1><ol class=""><li id="396f" class="lt lu hu je b jf kz jj la jn lv jr lw jv lx jz ly lz ma mb dt translated">我们正在设置我们的redux“store ”,以便我们可以通过“props”将数据向下传递到我们想要的任何组件中(我将假设您对flux架构如何工作有一些工作知识，如果您不理解这一点，请检查上面的flux架构链接)。</li><li id="dae0" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们使用redux-thunk中间件来处理对我们的Cosmic JS API的所有异步调用。每当我们分派一个功能而不是一个动作时，就会用到这个中间件。</li><li id="1337" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们还使用“createlogger”中间件来直观地查看我们调度的每个记录的操作。接下来，我们将设置位于客户端目录中的<a class="ae ka" href="https://cosmicjs.com/blog/index.js" rel="noopener ugc nofollow" target="_blank"> index.js </a>文件。复制并粘贴以下代码:</li></ol><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="b1c3" class="ln kc hu lj b fv lo lp l lq lr">import React from 'react';<br/>import ReactDOM from 'react-dom';<br/>import Home from './components/Home';<br/>import {Provider} from 'react-redux';<br/>import store from './redux/store';</span><span id="978c" class="ln kc hu lj b fv ls lp l lq lr">ReactDOM.render(<br/>  &lt;Provider store={store}&gt;<br/>    &lt;Home /&gt;<br/>  &lt;/Provider&gt;,<br/>  document.getElementById('root')<br/>);</span></pre><h1 id="1463" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这是怎么回事:</h1><ol class=""><li id="ee4e" class="lt lu hu je b jf kz jj la jn lv jr lw jv lx jz ly lz ma mb dt translated">我们告诉ReactDOM将index.html文件中的“根”div作为目标，并弹出我们的<Home/> react组件(我们将在下一步中构建)。</li><li id="b46d" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们的react组件通过标签从我们的存储中获取数据。它为其子节点“提供”数据(因此，它被称为“提供者”)。接下来，我们将构建我们的Homecomponent。在我们位于out client/components目录下的<a class="ae ka" href="https://cosmicjs.com/blog/Home.js" rel="noopener ugc nofollow" target="_blank"> Home.js </a>文件中，复制并粘贴以下代码:</li></ol><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="1e7e" class="ln kc hu lj b fv lo lp l lq lr">import React, {Component} from 'react';<br/>import { connect } from 'react-redux';<br/>import { getAllTasks, postNewTask } from '../redux/reducer';<br/>import Task from './Task';</span><span id="83d0" class="ln kc hu lj b fv ls lp l lq lr">class Home extends Component {<br/>  constructor(props){<br/>    super(props);<br/>  }<br/>  componentDidMount(){<br/>    getAllTasks();<br/>  }<br/>  render() {<br/>    return (<br/>      &lt;div&gt;<br/>      &lt;div className="container"&gt;<br/>        &lt;div className="row"&gt;<br/>          &lt;div className="col-xs-12"&gt;<br/>           &lt;h1&gt;Cosmic To-Do App!!&lt;/h1&gt;<br/>            &lt;form onSubmit={evt =&gt; {<br/>               evt.preventDefault();<br/>               this.props.postNewTask(evt.target.taskName.value);<br/>               evt.target.taskName.value = "";<br/>              }<br/>             }&gt;<br/>              &lt;div className="form-group"&gt;<br/>              &lt;label for="exampleInputEmail1"&gt;Add New To-Do&lt;/label&gt;<br/>              &lt;input name="taskName" placeholder="Enter new task" /&gt;<br/>              &lt;/div&gt;<br/>              &lt;button type="submit"&gt;Add&lt;/button&gt;<br/>            &lt;/form&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>      &lt;div className="container"&gt;<br/>        &lt;div className="row"&gt;<br/>          &lt;div className="col-xs-12"&gt;<br/>            &lt;h3&gt;Let's get some work done!&lt;/h3&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>      &lt;div className="container"&gt;<br/>        {<br/>          this.props.tasks &amp;&amp; this.props.tasks.map((task) =&gt; {<br/>            return (<br/>              &lt;Task key={task._id} Obj={task} isComplete={task.metafields[0].value} Name={task.title}/&gt;<br/>            )<br/>          })<br/>        }<br/>      &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="a5c1" class="ln kc hu lj b fv ls lp l lq lr">const mapState = ({tasks}) =&gt; ({tasks});<br/>const mapDispatch = {getAllTasks, postNewTask};<br/>export default connect(mapState, mapDispatch)(Home);</span></pre><h1 id="28af" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">怎么回事(很多！):</h1><ol class=""><li id="7e23" class="lt lu hu je b jf kz jj la jn lv jr lw jv lx jz ly lz ma mb dt translated">我们正在创建一个react组件，并在安装Home组件时获取所有数据(这将是我们的Cosmic JS bucket中的任务)。</li><li id="0b32" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们将“HTML”渲染到我们的虚拟DOM中。</li><li id="49ad" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们正在创建一个表单，该表单将分派一个函数(该函数将通过我们的redux-thunk中间件)，每当用户单击提交<button>时，该函数将任务添加到我们的任务列表中。</button></li><li id="6daf" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们正在做黑客检查，这样我们的应用程序就不会因为所谓的“短路”而中断。我们首先检查我们是否从对我们的Cosmic JS bucket的异步调用中获得了“任务”,如果我们获得了，那么我们将映射它们中的每一个并呈现一个<Task/>组件(我们将在下一步中构建它)。</li><li id="6a36" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">最后，我们将Home组件包装在react-redux库提供的connect函数中。我们正在从我们的商店获取{tasks}以及我们的{getAllTasks，postNewTask}函数。接下来，我们将构建我们的组件来呈现我们从商店获得的每个任务。在我们的客户端/组件目录下的<a class="ae ka" href="https://cosmicjs.com/blog/Task.js" rel="noopener ugc nofollow" target="_blank"> Task.js </a>文件中，复制并粘贴以下代码:</li></ol><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="9aee" class="ln kc hu lj b fv lo lp l lq lr">import React from 'react';<br/>import { connect } from 'react-redux';<br/>import { putChangeStatus, deleteTask } from '../redux/reducers/reducer';</span><span id="d624" class="ln kc hu lj b fv ls lp l lq lr">const Task = (props) =&gt; {<br/>  return (<br/>      &lt;div className="row"&gt;<br/>        &lt;div className="btn-group" role="group" aria-label="Basic example"&gt;<br/>          &lt;button type="button" onClick={() =&gt; {<br/>            props.putChangeStatus(props.Obj, props.isComplete)}} className="btn"&gt;{props.isComplete ? "Undo" : "Complete" }&lt;/button&gt;<br/>          &lt;button type="button" onClick={() =&gt; props.deleteTask(props.Obj.slug)} className="btn"&gt;Delete&lt;/button&gt;<br/>        &lt;/div&gt;<br/>        &lt;h3 style={{textDecoration: props.isComplete ? "line-through" : "none"}}&gt;{props.Name}&lt;/h3&gt;<br/>      &lt;/div&gt;<br/>  );<br/>};</span><span id="8ec6" class="ln kc hu lj b fv ls lp l lq lr">const mapDispatch = {putChangeStatus, deleteTask};<br/>export default connect(null, mapDispatch)(Task);</span></pre><h1 id="bc75" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">发生了什么事:</h1><ol class=""><li id="c18b" class="lt lu hu je b jf kz jj la jn lv jr lw jv lx jz ly lz ma mb dt translated">我们正在创建一个所谓的“哑”react组件，并再次将它包装在我们的connect函数中。</li><li id="015b" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们从我们的reducer(我们将在下一步中最终完成)中获取putChangeStatus和deleteTask，并将其连接到我们的商店。</li><li id="5330" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们连接了“完成”和“删除”按钮来调度onClick上的异步函数，这样我们实际上也更新了我们的宇宙JS桶。接下来，我们将最终制作我们的缩减器，并设置我们所有的异步“redux-thunk”函数。在我们的客户端/redux目录下的<a class="ae ka" href="https://cosmicjs.com/blog/reducer.js" rel="noopener ugc nofollow" target="_blank"> reducer.js </a>文件中，复制并粘贴以下代码:</li></ol><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a221" class="ln kc hu lj b fv lo lp l lq lr">import axios from "axios";<br/>/////////////////CONSTANTS/////////////////////<br/>const GET_ALL_TASKS = "GET_ALL_TASKS";<br/>const POST_TASK = "POST_TASK";<br/>const CHANGE_STATUS = "CHANGE_STATUS";<br/>const DELETE_TASK = "DELETE_TASK";<br/>/////////////////ACTIONS//////////////<br/>const getTasks = (tasks) =&gt; ({type: GET_ALL_TASKS, tasks});<br/>const addTask = (task) =&gt; ({type: POST_TASK, task});<br/>const changeStatus = (task) =&gt; ({type: CHANGE_STATUS, task});<br/>const taskDelete = (slug) =&gt; ({type: DELETE_TASK, slug});<br/>/////////////////REDUCER/////////////////////<br/>//initiate your starting state<br/>let initial = {<br/>  tasks: []<br/>};<br/>const reducer = (state = initial, action) =&gt; {<br/>  switch (action.type) {<br/>    case GET_ALL_TASKS:<br/>      return Object.assign({}, state, {tasks: action.tasks.objects});<br/>    case POST_TASK:<br/>      let updatedTasks = [action.task].concat(state.tasks);<br/>      return Object.assign({}, state, {tasks: updatedTasks});<br/>    case CHANGE_STATUS:<br/>      let newArr = state.tasks.map((task) =&gt; {<br/>        if(task.slug === action.task.slug) task.metafields[0].value = !task.metafields[0].value;<br/>        return task;<br/>      });<br/>      return Object.assign({}, state, {tasks: newArr});<br/>    case DELETE_TASK:<br/>      let arr = state.tasks.filter((task) =&gt; {<br/>        return !(task.slug === action.slug);<br/>      });<br/>      return Object.assign({}, state, {tasks: arr});<br/>    default:<br/>      return state;<br/>  }</span><span id="94f5" class="ln kc hu lj b fv ls lp l lq lr">};</span><span id="0e31" class="ln kc hu lj b fv ls lp l lq lr">export default reducer;<br/></span><span id="b2f3" class="ln kc hu lj b fv ls lp l lq lr">/////////////// ACTION DISPATCHER FUNCTIONS///////////////////</span><span id="d5c5" class="ln kc hu lj b fv ls lp l lq lr">export const getAllTasks = () =&gt; dispatch =&gt; {<br/>  axios.get(`https://api.cosmicjs.com/v1/your-bucket-slug-name/object-type/tasks`)<br/>    .then((response) =&gt; {<br/>      return response.data;<br/>    })<br/>    .then((tasks) =&gt; {<br/>      dispatch(getTasks(tasks))<br/>    })<br/>    .catch((err) =&gt; {<br/>      console.error.bind(err);<br/>    })<br/>};</span><span id="9b2d" class="ln kc hu lj b fv ls lp l lq lr">export const postNewTask = (task) =&gt; dispatch =&gt; {<br/>  dispatch(addTask({title: task, metafields: [{value: false}], slug: formatSlug(task)}));<br/>  axios.post(`https://api.cosmicjs.com/v1/your-bucket-slug-name/add-object`, {type_slug: "tasks", title: task, content: "New Task",<br/>    metafields: [<br/>      {<br/>        title: "Is Complete",<br/>        key: "is_complete",<br/>        value: false,<br/>        type: "text"<br/>      }<br/>    ]})<br/>    .then((response) =&gt; {<br/>      console.log(response.data);<br/>    })<br/>    .catch((err) =&gt; {<br/>      console.error.bind(err);<br/>    })<br/>};</span><span id="fbea" class="ln kc hu lj b fv ls lp l lq lr">export const putChangeStatus = (task, bool) =&gt; (dispatch) =&gt; {<br/>  dispatch(changeStatus(task));<br/>  axios.put(`https://api.cosmicjs.com/v1/your-bucket-slug-name/edit-object`, {slug: task.slug,<br/>    metafields: [<br/>      {<br/>        title: "Is Complete",<br/>        key: "is_complete",<br/>        value: !bool,<br/>        type: "text"<br/>      }<br/>    ]})<br/>    .then((response) =&gt; {<br/>      console.log(response.data);<br/>    })<br/>    .catch((err) =&gt; {<br/>      console.error.bind(err);<br/>    })<br/>};</span><span id="675b" class="ln kc hu lj b fv ls lp l lq lr">export const deleteTask = (slug) =&gt; (dispatch) =&gt; {<br/>  dispatch(taskDelete(slug));<br/>  axios.delete(`https://api.cosmicjs.com/v1/your-bucket-slug-name/${slug}`)<br/>    .then((response) =&gt; {<br/>    console.log(response.data)<br/>    })<br/>    .catch((err) =&gt; {<br/>      console.error.bind(err);<br/>    })<br/>};</span><span id="416d" class="ln kc hu lj b fv ls lp l lq lr">const formatSlug = (title) =&gt; {<br/>  let lower = title.toLowerCase();<br/>  return lower.split(" ").join("-");<br/>};</span></pre><h1 id="aae8" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这是怎么回事？！</h1><p id="9844" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">旁注-&gt;我个人喜欢将我所有的常量、动作和动作调度函数存储在一个文件中，这样我就不会不断地从一个文件跳到另一个文件。将这些分成单独的文件是非常普通和酷的。</p><ol class=""><li id="947c" class="lt lu hu je b jf jg jj jk jn mh jr mi jv mj jz ly lz ma mb dt translated">我们正在拉入axios(我们的库，它将为我们发出HTTP请求)。</li><li id="2203" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们正在定义我们的常数。</li><li id="7255" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们正在设置要调度的操作。</li><li id="0a16" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们定义了我们的存储所使用的reducer函数，我们从一个对象开始，这个对象的tasks键以一个空数组作为值(这个数组将被从我们的Cosmic JS bucket中检索的task对象填充)。</li><li id="d249" class="lt lu hu je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb dt translated">我们定义了我们的动作分派器函数，这些函数向Cosmic JS API(特别是我们的个人存储桶)发出我们的axios请求。我们完了。运行npm run build或yarn build，并在不同的选项卡中运行npm start或yarn start，看看我们做了什么！如果你想看我的实现(不必使用react-router)来了解所有这些是如何一起工作的，请查看我的github repo</li></ol><h1 id="f198" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论:</h1><p id="21e2" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">我们能够使用我们的动作和调度程序函数来消费Cosmic JS API。如果你对所有文件如何与我们的商店协同工作有点不确定，请查看这张gif，以更好地了解redux如何在应用程序中传递数据。我希望你和我一样喜欢这个教程，如果你有任何问题<a class="ae ka" href="https://twitter.com/cosmic_js" rel="noopener ugc nofollow" target="_blank">在Twitter上联系我们</a>和<a class="ae ka" href="https://cosmicjs.com/community" rel="noopener ugc nofollow" target="_blank">加入我们的Slack社区</a>。</p><div class="le lf lg lh fq ab cb"><figure class="mk iv ml mm mn mo mp paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mk iv ml mm mn mo mp paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mk iv ml mm mn mo mp paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mq mr ms"><p id="f922" class="jc jd mt je b jf jg jh ji jj jk jl jm mu jo jp jq mv js jt ju mw jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ka" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd mt je b jf jg jh ji jj jk jl jm mu jo jp jq mv js jt ju mw jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mx"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>