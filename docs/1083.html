<html>
<head>
<title>A Finite State Machine Helper for Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux的有限状态机助手</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-finite-state-machine-helper-for-redux-c18519643719?source=collection_archive---------0-----------------------#2016-09-03">https://medium.com/hackernoon/a-finite-state-machine-helper-for-redux-c18519643719?source=collection_archive---------0-----------------------#2016-09-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="9bca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我注意到<a class="ae jp" href="http://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>应用程序经常嵌入特别的<a class="ae jp" href="https://en.wikipedia.org/wiki/Finite-state_machine#Example:_coin-operated_turnstile" rel="noopener ugc nofollow" target="_blank">有限状态机</a>，关于当前状态的信息散布在<a class="ae jp" href="http://redux.js.org/docs/basics/Reducers.html" rel="noopener ugc nofollow" target="_blank">Redux</a>中。我在<a class="ae jp" href="https://hackernoon.com/tagged/redux" rel="noopener ugc nofollow" target="_blank"> Redux </a>中写了一个使用有限状态机的小助手叫做<a class="ae jp" href="https://www.npmjs.com/package/redux-machine" rel="noopener ugc nofollow" target="_blank"> redux-machine </a>。在这篇文章中，我将深入探讨:</p><ul class=""><li id="3b86" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">一个有限状态机的例子以及如何用redux-machine实现<a class="ae jp" href="https://hackernoon.com/tagged/implement" rel="noopener ugc nofollow" target="_blank"/></li><li id="e11b" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">使用冗余机的优势</li></ul><h1 id="1be7" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">redux-机器示例</h1><p id="61a1" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">这是一个非常简单的处理数据获取的状态机的例子，它将有助于展示如何使用redux-machine:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lh"><img src="../Images/6a2285703673392aa77a8f42a0c53e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPzWXvKir7VX9u4ggvL-eQ.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">finite state machine for handling API call state in Redux</figcaption></figure><p id="4b99" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用语言来说:</p><ul class=""><li id="cbd3" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">INIT是初始状态</li><li id="106c" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">当状态为“初始化”且动作类型为“获取用户”时，机器转换到“进行中”状态。</li><li id="1311" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">当状态为“进行中”且动作类型为“获取用户响应”或“获取用户失败”时，机器转换到“初始”状态。</li></ul><blockquote class="lx ly lz"><p id="ee83" class="ir is ma it b iu iv iw ix iy iz ja jb mb jd je jf mc jh ji jj md jl jm jn jo hn dt translated">我使用术语“状态”而不是“状态”,以避免与“状态”混淆。所以<em class="hu"> INIT </em>和<em class="hu"> IN_PROGRESS </em>是状态。</p></blockquote><p id="1c7b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是如何用redux-machine实现状态机:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff me"><img src="../Images/71896d6910294afe9006279ebeb207cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zbzcnXfB9RIsBX5lQp4Gbg.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">state machine implemented with redux-machine</figcaption></figure><p id="0770" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">特殊部分是<strong class="it hv">变成</strong>符号，它将减速器转换到不同的状态。当状态为<strong class="it hv"> INIT </strong>时，<strong class="it hv"> fetchUsersReducer </strong>的作用类似于<strong class="it hv"> initReducer </strong>。当状态为<strong class="it hv"> IN_PROGRESS </strong>时，<strong class="it hv"> fetchUsersReducer </strong>的作用类似于<strong class="it hv"> inProgressReducer </strong>。</p><p id="fc22" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Redux-machine以一种非特定和显式的方式在存储中保持当前状态。它用状态键将当前状态存储在存储器中。例如，当状态为<strong class="it hv">进行中</strong>时，“状态”的值为“进行中”</p><p id="6517" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一个app可以有任意多个redux-machine创建的减速器，这些减速器可以嵌套。这很有帮助，因为任何重要的应用程序都会在状态机中包含状态机。例如，如果app的主要流程是:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mf"><img src="../Images/dffaabb92306cf40dcd3d38d15999e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RyhDgyoUB5RM3y6wFtYJ8w.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">a simplified main flow for an app</figcaption></figure><p id="a756" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那么fetchUsers中的状态仅在主应用程序状态为LOGGED_IN时相关。</p><h1 id="2f8a" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated"><a class="ae jp" href="https://www.npmjs.com/package/redux-machine" rel="noopener ugc nofollow" target="_blank">冗余机</a>的优点</h1><p id="56e6" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">redux-machine将当前状态显式化，并将您的状态保存在redux存储中。将所有状态保存在存储区中有助于:</p><ul class=""><li id="9b48" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">调试:整个状态很容易检查。redux-machine还兼容<a class="ae jp" href="https://www.youtube.com/watch?v=xsSnOQynTHs" rel="noopener ugc nofollow" target="_blank">时间旅行调试</a>。</li><li id="61de" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">向用户传达状态。例如，当请求被激活时使用加载微调器，或者当用户登录时使用“已登录”指示器。</li></ul><p id="29eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://yelouafi.github.io/redux-saga/docs/api/index.html" rel="noopener ugc nofollow" target="_blank"> redux-saga </a>和<a class="ae jp" href="https://redux-observable.js.org/" rel="noopener ugc nofollow" target="_blank"> redux-observable </a>擅长建模用户工作流，但是在redux商店之外存储状态。</p><h1 id="d620" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">请求反馈</h1><p id="520a" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">我还没有广泛使用过<a class="ae jp" href="https://www.npmjs.com/package/redux-machine" rel="noopener ugc nofollow" target="_blank"> redux-machine </a>，所以欢迎反馈和建议。</p><div class="li lj lk ll fq ab cb"><figure class="mg lm mh mi mj mk ml paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mg lm mh mi mj mk ml paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mg lm mh mi mj mk ml paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="lx ly lz"><p id="f922" class="ir is ma it b iu iv iw ix iy iz ja jb mb jd je jf mc jh ji jj md jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is ma it b iu iv iw ix iy iz ja jb mb jd je jf mc jh ji jj md jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="li lj lk ll fq lm fe ff paragraph-image"><a href="https://goo.gl/Ahtev1"><div class="fe ff mm"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></a></figure><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="mn mo l"/></div></figure></div></div>    
</body>
</html>