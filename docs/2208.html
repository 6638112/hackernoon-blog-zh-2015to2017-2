<html>
<head>
<title>I was losing emails for years without knowing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我不知不觉地丢失了好几年的电子邮件</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/i-was-loosing-emails-for-years-without-knowing-424ed02c8d60?source=collection_archive---------6-----------------------#2017-01-12">https://medium.com/hackernoon/i-was-loosing-emails-for-years-without-knowing-424ed02c8d60?source=collection_archive---------6-----------------------#2017-01-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="81de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">昨天我意识到发送到我的@pedro.si邮箱的邮件经常被延迟，有时甚至会丢失。在我意识到事情不对劲之前，我已经用我自己的域名发邮件两年多了。丢失传入邮件的原因是我的裸域名的CNAME记录。</p><p id="e5df" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那我是怎么发现的呢？我开发的一个应用程序<a class="ae jp" href="http://www.zatresi.si/" rel="noopener ugc nofollow" target="_blank"> zatresi.si </a>，每当网站上的一些数据发生变化时，它就会给我发一封电子邮件。我使用Mailgun发送这些电子邮件，这是一种电子邮件跟踪服务。Mailgun还显示电子邮件何时成功发送。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/a877068b415f5e84232c45dd85feba21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q82DiqfjOhkdivtM0Gb2Zg.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Mailgun allows me to monitor email deliveries and tracking.</figcaption></figure><p id="7d1a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上周，当我偷看Mailgun时，我看到一些电子邮件正在重试。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kg"><img src="../Images/e950d0763c66341824c7c505ff57c6c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hxb-sPxEV1cNI-kM7hxUag.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">MailGun was reporting delays in delivering emails to my domain.</figcaption></figure><p id="8bd8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为什么他们被耽搁了这么多次？我给自己发了几次电子邮件，每次都没有延迟。然后有一次…延迟发生了。</p><p id="8800" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我检查了MX记录，他们似乎很好。然而，我的DNS托管服务支持注意到一些问题。他们给我指了指intodns.com/pedro.si的T2，那里挂着红色的警告旗。该工具报告说，域名服务器是蹩脚的。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kh"><img src="../Images/968004ca8d32e8b39920c0b09a7989c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RWS6g8JXSsBhirrTJ4FsEw.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">intodns was telling that I had lame nameservers</figcaption></figure><p id="39c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">到这个时候，我意识到有时MX设置显示正确，但其他时候，它们无法注册。我用<a class="ae jp" href="http://mxtoolbox.com/" rel="noopener ugc nofollow" target="_blank"> MXToolbox </a>来检查我的MX设置。偶尔会出现以下警告:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ki"><img src="../Images/a1811541c7bc1f709f3a457adff2afd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDCFQS1uhFKPeYGl88XRLw.png"/></div></div></figure><p id="73ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我还注意到，当我在MXToolbox中看到这个警告时，intodns报告说域名服务器是蹩脚的。</p><p id="7eba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我请求DNS托管服务支持来帮助我找出为什么域名服务器被报告与我的DNS设置不匹配。他们没有回答问题，而是让我反转MX记录的<em class="kj">名称</em>和<em class="kj">值</em>字段。他们的建议一点帮助都没有，所以我在等待记录传播超过24小时后才解开。我最初的MX配置是有效的。</p><p id="1e3b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这段时间里，我不断地给自己发电子邮件，检查延迟是否还在发生。有一次，我注意到在多次不成功的发送尝试后，邮件被完全丢弃了。我正在丢失电子邮件！我想知道在过去的两年里，我因为这个问题丢失了多少封邮件！</p><p id="1b5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一位同事随后指出pedro.si上的SOA记录丢失了，他建议我调查一下。到目前为止，我忽略了这个错误，因为我不熟悉SOA记录，并将错误归咎于蹩脚的名称服务器。</p><p id="864d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后，我向DNS托管服务支持提到了丢失的SOA记录。他们回答说<strong class="it hv"> SOA记录有困难，因为根域pedro.si有一个到亚马逊S3服务器的CNAME </strong>。我用亚马逊S3托管我的网站。他们建议我使用A记录来代替将根域转发到www标签。</p><p id="1bcf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">删除提到的CNAME记录后，我的电子邮件开始正常工作。</p><p id="11ef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">intodns.com不再报告域名服务器是蹩脚的，SOA记录也不再丢失。</p><p id="79a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，虽然我很高兴我的电子邮件重新上线，但我会了解更多关于每种DNS记录类型的含义。我对我的DNS配置所犯的错误是因为我无知地遵循了教程和文档中的说明，而没有真正理解发生了什么。</p><p id="c4eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">总之，<strong class="it hv">避免了将根域名转发到www标签</strong>的CNAME记录。使用A记录，或<a class="ae jp" href="https://devcenter.heroku.com/articles/apex-domains" rel="noopener ugc nofollow" target="_blank">更好的别名或一个名字记录</a>代替。如果您的DNS主机服务不支持它们，并且您不想使用另一个DNS主机，您可能想要查看一下<a class="ae jp" href="http://wwwizer.com/naked-domain-redirect" rel="noopener ugc nofollow" target="_blank"> wwwizer的裸域重定向</a>。如果您将您的裸域A记录指向一个IP，此服务会将访问者从您的根域重定向到您的www域。</p><div class="jr js jt ju fq ab cb"><figure class="kk jv kl km kn ko kp paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="kk jv kl km kn ko kp paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="kk jv kl km kn ko kp paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="kq kr ks"><p id="f922" class="ir is kj it b iu iv iw ix iy iz ja jb kt jd je jf ku jh ji jj kv jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is kj it b iu iv iw ix iy iz ja jb kt jd je jf ku jh ji jj kv jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kw"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>