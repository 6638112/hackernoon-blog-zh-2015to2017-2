<html>
<head>
<title>Classifying Tweets with Amazon ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Amazon ML对推文进行分类</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/classifying-tweets-with-amazon-ml-146e5f0d99b1?source=collection_archive---------3-----------------------#2017-01-29">https://medium.com/hackernoon/classifying-tweets-with-amazon-ml-146e5f0d99b1?source=collection_archive---------3-----------------------#2017-01-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><h1 id="ad3d" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">前言</h1><p id="4d99" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我最近看了一个AWS新服务之一——Amazon ML的精彩视频概述/演示。如果你手头有大约50分钟的时间来看上面的视频，我强烈建议你跟着看，如果没有的话，请阅读我博客的其余部分以获得更简短的总结。</p><p id="bc38" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">那么什么是亚马逊ML呢？</p><blockquote class="kt ku kv"><p id="d77a" class="jp jq kw jr b js ko ju jv jw kp jy jz kx kq kc kd ky kr kg kh kz ks kk kl km hn dt translated">亚马逊机器学习(Amazon Machine Learning)是一项服务，可以让所有技能水平的开发者轻松使用机器学习技术。亚马逊机器学习提供可视化工具和向导，指导您创建机器学习(ML)模型的过程，而不必学习复杂的ML算法和技术。一旦您的模型准备就绪，Amazon Machine Learning就可以使用简单的API轻松获得您的应用程序的预测，而不必实现自定义预测生成代码，或管理任何基础架构。</p></blockquote><p id="026a" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">换句话说，这是<strong class="jr hv">机器学习即服务</strong>。对于那些熟悉机器学习的人来说，亚马逊的服务还没有提供任何类型的深度学习模型，只有回归和分类模型。尽管如此，你可以用这些<em class="kw">浅层学习</em>模型做一些相当强大的东西。</p><h1 id="f9a8" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">概观</h1><p id="db3a" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在上面链接的视频中，演讲者讲述了一个例子，他建立了一个模型来<strong class="jr hv">自动将针对AWS客户支持的推文分类为可操作或不可操作</strong>。您可能会为这样的模型设想一些不同的用例，其中一个是节省客户支持代理时间的好方法，通过过滤垃圾社交媒体数据来找到实际的客户问题。下面我用我自己公司的(<a class="ae kn" href="http://www.weebly.com" rel="noopener ugc nofollow" target="_blank"> Weebly </a> ) twitter数据来举一个同样的例子。</p><p id="9fb0" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">创建ML模型的整个过程可以归结为4个简单的步骤:</p><ol class=""><li id="66a0" class="la lb hu jr b js ko jw kp ka lc ke ld ki le km lf lg lh li dt translated">收集我们的数据</li><li id="1b99" class="la lb hu jr b js lj jw lk ka ll ke lm ki ln km lf lg lh li dt translated">对我们的数据进行分类</li><li id="6d35" class="la lb hu jr b js lj jw lk ka ll ke lm ki ln km lf lg lh li dt translated">把我们的分类数据输入亚马逊的ML引擎</li><li id="fa74" class="la lb hu jr b js lj jw lk ka ll ke lm ki ln km lf lg lh li dt translated">测试一下！</li></ol><h1 id="9182" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">收集我们的数据</h1><p id="9a49" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">首先，我们需要一些实际数据。因为我们将使用twitter数据，所以我们可以利用Twitter API来获得满足我们要求的大量tweet子集(即tweets directed @ weebly)。这意味着你必须在twitter上注册一个<a class="ae kn" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank">开发者应用</a>来获得相关的API密钥和令牌。一旦你这样做了，你就可以开始从twitter获取你需要的数据。下面是一个小ruby脚本，用来获取我们关心的所有推文，并将其保存到一个CSV文件中。</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="1be0" class="lx is hu lt b fv ly lz l ma mb"># Twitter client gem - <a class="ae kn" href="https://github.com/sferik/twitter" rel="noopener ugc nofollow" target="_blank">https://github.com/sferik/twitter</a><br/>client = Twitter::REST::Client.new do |config|<br/>  config.consumer_key        = "API_KEY"<br/>  config.consumer_secret     = "SECRET"<br/>  config.access_token        = "ACCESS_TOKEN"<br/>  config.access_token_secret = "ACCESS_TOKEN_SECRET"<br/>end</span><span id="348f" class="lx is hu lt b fv mc lz l ma mb">CSV.open("weebly_tweets", "wb") do |csv|<br/>  csv &lt;&lt; ["username", "tweet"] # first row<br/>  client.search("<a class="ae kn" href="http://twitter.com/weebly" rel="noopener ugc nofollow" target="_blank">@weebly</a>", lang: "en").collect do |tweet|<br/>    csv &lt;&lt; [tweet.user.screen_name, tweet.text]<br/>  end<br/>end</span></pre><p id="2783" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">太棒了，现在我们有了一个有成千上万条推文的CSV。分类时间到了。</p><h1 id="45b6" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">数据分类</h1><p id="50ad" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">现在我们已经把所有的推文都放在一个CSV中了，我们需要把它们分为可操作的和不可操作的。我们可以这样做的一个方法是在我们的CSV中创建第三个专栏，手动浏览所有的tweets，并自己对它们进行分类…尽管这听起来很可怕。幸运的是，亚马逊还有另一项非常方便的服务，叫做<a class="ae kn" href="https://www.mturk.com/mturk/welcome" rel="noopener ugc nofollow" target="_blank">亚马逊土耳其机器人</a>。使用这项服务，我们可以雇人帮我们分类这些推文，价格由我们决定(通常低至每条推文几美分)。你可以选择雇佣多少不同的人来对你的推文进行分类，费用是多少，以及其他各种配置。以下是机械土耳其人界面的一些截图:</p><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff md"><img src="../Images/bd38216ff3615f88800095d7a8720152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UYXyOinMjlnafVBlUTEvhQ.png"/></div></div><figcaption class="ml mm fg fe ff mn mo bd b be z ek">configure HIT (Human Intelligence Task)</figcaption></figure><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mp"><img src="../Images/a0c7c4a4dd20d6474c41c3e669c61aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1V_XntCYc8vVEUhue2ku8Q.png"/></div></div><figcaption class="ml mm fg fe ff mn mo bd b be z ek">HIT instructions</figcaption></figure><p id="1bc2" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">在创建机器学习模型时，很容易忘记的一件重要事情是确保你有一个良好的<strong class="jr hv">干净的数据集</strong>。我在创建ML模型方面还是个新手，几乎在我处理模型的每一个实例中，由于事后我做了一些数据清理，我最终都要不断地回到原始数据集并重新运行模型。对您的数据进行一些早期过滤可能会大大提高您的模型性能，并为您节省大量时间。举个例子——我第一次获取所有这些推特数据时，我注意到很多推特都是中文的。除非我们的客服人员会说中文，否则这些数据只会污染我们的模型。另一个例子是，我注意到Weebly博客平台的“分享”功能自动生成了许多推文——这些推文可以通过简单地检查某些文本(通过@weebly分享的博客帖子)而很容易地从数据集中过滤出来。我们的模型可以很容易地学会对这些进行适当的分类，但我们可以通过事先过滤掉这些推文来节省计算我们模型的时间，更重要的是，如果我们支付第三方分类服务来对我们的数据进行分类，我们可以节省资金。</p><h1 id="b763" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">创建我们的模型</h1><p id="352f" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">一旦我们对所有的数据进行了分类，并在csv中增加了一列带标签的数据，我们就可以开始实际创建模型了。在我写这篇文章的时候，亚马逊ML模型需要从S3或者红移中提取数据。我很快创建了一个新的s3存储桶，放在<code class="eh mq mr ms lt b">weebly_tweets.csv</code>旁边。</p><p id="921b" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">从Amazon ML <a class="ae kn" href="https://console.aws.amazon.com/machinelearning" rel="noopener ugc nofollow" target="_blank">控制台</a>中，您可以选择“创建新模型和数据源”。从那里，我们可以按照相当简单的步骤来创建我们的模型。注意——我们可以通过Amazon的API完成以下所有操作，但是为了清晰和更容易可视化，我将使用控制台。</p><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mt"><img src="../Images/59a877e98f4c770e2fa5dfe7883e2023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17VJJYQv4RJTC8DXIwG3tw.png"/></div></div></figure><p id="03d6" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">在第一步中，我们只需输入数据的位置，并将这个新的数据源命名为。接下来的步骤只是让您确认您的列和它们的数据类型，以及识别目标列(输出)。在创建了我们的数据源之后，我们将最终能够创建我们的模型。</p><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mu"><img src="../Images/b168551af0d475a9f3d3130241a9e94c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zj4iytVUbcUw_e4Y_4ASaw.png"/></div></div></figure><p id="7894" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">上面的屏幕截图是创建模型时您将看到的初始屏幕。选择默认的训练和评估设置基本上意味着你让Amazon配置你的模型的一切。如果选择“自定义”,您可以更改诸如正则化参数、训练数据与评估数据分割、是随机还是按顺序选择训练数据等内容。第一次，我会建议选择默认，让亚马逊为你配置——如果你对结果不满意，那么你可以开始尝试一些定制。</p><p id="b245" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">一旦你完成创建你的模型- <strong class="jr hv">嘣</strong>！亚马逊将开始使用它的服务器来训练你的模型。根据您输入的数据量，这一步可能需要一段时间。对几千条推文进行二元分类大约需要7分钟左右。一旦完成，我们可以检查我们的模型表现如何。</p><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mt"><img src="../Images/9ce2604a3d10aafdea6697f196a2180a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_jR6buuQYMw5EpRqq2Z5w.png"/></div></div></figure><p id="7a2c" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">亚马逊会给你一个漂亮的小图表，解释你的模型在评估数据集上的表现。正如你从上面的截图中看到的，我们的模型分类推文有88%的正确率，这很酷。从这个模型性能屏幕，你也可以修改你的模型的阈值，给你或多或少的误报/漏报。在可操作的推文的情况下，我认为最好有更多的误报(一条推文被标记为可操作，而它不是)，而不是误报(一条推文被标记为不可操作，但它是可操作的)，所以我修改了我的模型，以避免误报。</p><h1 id="a831" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">测试我们的模型/我们将何去何从？</h1><p id="0d15" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">酷，我们已经有了一个运行良好的模型…现在该怎么办？首先，我们可以在亚马逊控制台上尝试实时预测。</p><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mt"><img src="../Images/7baef9ca1b756e39963c84d41d9b1f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjYXhyiwKGioYLHCPs_dng.png"/></div></div></figure><p id="35f0" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">在这个例子中(如上)，我测试了“@weebly我如何修复我的网站？”并且正确的得到了一个可操作的预测(1是可操作的，0不是)。在“predicted scores”blob中，您可以更仔细地了解模型实际上是如何对您的数据进行评分的。我们的分数越接近1，模型就越有信心是可行的，零分也是一样。</p><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff mt"><img src="../Images/ec2d90e2385a483b97ef8a82f4908320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8BXTx00UUgtmj6MnPA1uMA.png"/></div></div></figure><p id="1f33" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">正如你在这个例子中看到的(“@weebly我爱狗！”)模型非常自信地预测，这不是一条可操作的推文。</p><p id="39ec" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">我们还可以通过Amazons API与这个模型进行交互(可能会在另一篇文章中讨论这个问题),所以它在生产环境中非常有用。</p><h1 id="be63" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">结论</h1><p id="4c36" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">亚马逊ML极其好用。它仍处于起步阶段，所以与使用像<a class="ae kn" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> tensorflow </a>或<a class="ae kn" href="http://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>这样的服务相比，你对你的模型的定制和洞察力仍然很少。总的来说，这是一个很好的方法，可以轻松地计算基本的ML模型，并快速地将您的模型集成到应用层代码中。</p><div class="lo lp lq lr fq ab cb"><figure class="mv me mw mx my mz na paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mv me mw mx my mz na paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mv me mw mx my mz na paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="kt ku kv"><p id="f922" class="jp jq kw jr b js ko ju jv jw kp jy jz kx kq kc kd ky kr kg kh kz ks kk kl km hn dt translated"><a class="ae kn" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kn" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kn" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kn" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jp jq kw jr b js ko ju jv jw kp jy jz kx kq kc kd ky kr kg kh kz ks kk kl km hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kn" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kn" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="lo lp lq lr fq me fe ff paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="fe ff nb"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>