<html>
<head>
<title>How Angular Protects Us From XSS Attacks?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular如何保护我们免受XSS的攻击？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-angular-protects-us-from-xss-attacks-3cb7a7d49d95?source=collection_archive---------1-----------------------#2017-08-08">https://medium.com/hackernoon/how-angular-protects-us-from-xss-attacks-3cb7a7d49d95?source=collection_archive---------1-----------------------#2017-08-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="1eba" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">有角度的跨站点脚本攻击和杀毒过程</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff jj"><img src="../Images/7f10c71fb0ab1f7c055cf4189c82cbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Qgep9Jff_SPYkBppBnXIvg.png"/></div></figure><p id="fb0f" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><strong class="jt hv"> <em class="kn">本</em>条</strong> <strong class="jt hv"> <em class="kn">原本出现在</em></strong><a class="ae ko" href="https://dormoshe.io/articles/how-angular-protects-us-from-xss-attacks-19" rel="noopener ugc nofollow" target="_blank"><strong class="jt hv"><em class="kn">dormoshe . io</em></strong></a></p><p id="f503" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">XSS是可能影响您网站的攻击之一。为了应对这种攻击，Angular实现了一些概念，防止开发人员犯错误，并为安全漏洞打开了一扇窗。</p><p id="3740" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在本文中，我们将了解什么是XSS攻击，如何在Angular应用中进行这种攻击，Angular如何保护我们的安全，以及如何禁用这种保护。</p></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="a828" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">什么是XSS攻击？</h1><p id="e738" class="pw-post-body-paragraph jr js hu jt b ju lo iv jw jx lp iy jz ka lq kc kd ke lr kg kh ki ls kk kl km hn dt translated">跨站点脚本(XSS)攻击是一种注入类型，在这种攻击中，恶意脚本被注入到良性和可信的网站中。当攻击者使用web应用程序向不同的最终用户发送恶意代码(通常以浏览器端脚本的形式)时，就会发生XSS攻击。允许这些攻击成功的缺陷非常普遍，并且出现在web应用程序在其生成的输出中使用来自用户的输入而没有对其进行验证或编码的任何地方。</p><h1 id="4ef2" class="kw kx hu bd ky kz lt lb lc ld lu lf lg ja lv jb li jd lw je lk jg lx jh lm ln dt translated">如何在角度应用中实现XSS？</h1><p id="7c85" class="pw-post-body-paragraph jr js hu jt b ju lo iv jw jx lp iy jz ka lq kc kd ke lr kg kh ki ls kk kl km hn dt translated">在角度应用中有一些攻击方法:</p><ul class=""><li id="ab86" class="ly lz hu jt b ju jv jx jy ka ma ke mb ki mc km md me mf mg dt translated"><strong class="jt hv"> HTML </strong> —将值解释为HTML时</li><li id="88c9" class="ly lz hu jt b ju mh jx mi ka mj ke mk ki ml km md me mf mg dt translated"><strong class="jt hv">样式</strong> —绑定CSS时</li><li id="0c30" class="ly lz hu jt b ju mh jx mi ka mj ke mk ki ml km md me mf mg dt translated"><strong class="jt hv"> URL </strong> —使用URL属性时</li></ul><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mm mn l"/></div><figcaption class="mo mp fg fe ff mq mr bd b be z ek">XSS attacks examples</figcaption></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="8c5f" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">角度如何防止这种攻击？</h1><p id="001a" class="pw-post-body-paragraph jr js hu jt b ju lo iv jw jx lp iy jz ka lq kc kd ke lr kg kh ki ls kk kl km hn dt translated">为了阻止XSS攻击，您必须防止恶意代码进入DOM。当一个值通过属性、特性、样式、类绑定或插值从模板插入到DOM中时，Angular清理并转义不可信的值。</p><blockquote class="ms"><p id="3b9a" class="mt mu hu bd mv mw mx my mz na nb km ek translated">净化是对不可信值的检查，将它转换成可以安全插入DOM的值</p></blockquote><p id="aa48" class="pw-post-body-paragraph jr js hu jt b ju nc iv jw jx nd iy jz ka ne kc kd ke nf kg kh ki ng kk kl km hn dt translated">下面是<code class="eh nh ni nj nk b">BrowserModule</code>中<code class="eh nh ni nj nk b">sanitization providers</code>的声明</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mm mn l"/></div><figcaption class="mo mp fg fe ff mq mr bd b be z ek">Browser sanitization providers</figcaption></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h2 id="4e25" class="nl kx hu bd ky nm nn no lc np nq nr lg ka ns nt li ke nu nv lk ki nw nx lm ny dt translated">DOM清理服务</h2><p id="a755" class="pw-post-body-paragraph jr js hu jt b ju lo iv jw jx lp iy jz ka lq kc kd ke lr kg kh ki ls kk kl km hn dt translated">DomSanitizer的目标是清除值中不可信的部分。这个类的框架看起来像:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mm mn l"/></div><figcaption class="mo mp fg fe ff mq mr bd b be z ek">The DOM sanitizer skeleton</figcaption></figure><p id="059b" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">如您所见，有两种方法模式。第一个是<code class="eh nh ni nj nk b">bypassSecurityTrustX</code>方法，根据值的用法得到不可信的值，返回一个可信的对象(后面会讲到)。第二个是<code class="eh nh ni nj nk b">sanitize</code>方法，它获取安全上下文和不可信值，并返回一个可信值。安全上下文是值的使用。</p><p id="eeb9" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">如果一个值对于上下文是可信的，这个<code class="eh nh ni nj nk b">sanitize</code>方法将打开包含的安全值并直接使用它。否则，该值将根据安全上下文被清理为安全的。下面是功能代码:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mm mn l"/></div><figcaption class="mo mp fg fe ff mq mr bd b be z ek">The sanitize method</figcaption></figure><p id="4bfe" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">该方法的核心部分是<code class="eh nh ni nj nk b">switch-case</code>块。根据安全上下文检查的值。<code class="eh nh ni nj nk b">SafeXImpl</code>对象只是拥有<code class="eh nh ni nj nk b">getTypeName</code>方法的对象，能够使用<code class="eh nh ni nj nk b">instanceof</code>功能。<br/>有三个主要的辅助函数用于净化这些值。<code class="eh nh ni nj nk b"><a class="ae ko" href="https://github.com/angular/angular/blob/5293794316cc1b0f57d5d88b3fefdf6ae29d0d97/packages/platform-browser/src/security/html_sanitizer.ts" rel="noopener ugc nofollow" target="_blank">sanitizeHtml</a></code>函数通过解析值并检查其标记来净化不受信任的HTML值。<code class="eh nh ni nj nk b"><a class="ae ko" href="https://github.com/angular/angular/blob/5293794316cc1b0f57d5d88b3fefdf6ae29d0d97/packages/platform-browser/src/security/style_sanitizer.ts" rel="noopener ugc nofollow" target="_blank">sanitizeStyle</a></code> <a class="ae ko" href="https://github.com/angular/angular/blob/5293794316cc1b0f57d5d88b3fefdf6ae29d0d97/packages/platform-browser/src/security/style_sanitizer.ts" rel="noopener ugc nofollow" target="_blank"> </a>和<code class="eh nh ni nj nk b"><a class="ae ko" href="https://github.com/angular/angular/blob/5293794316cc1b0f57d5d88b3fefdf6ae29d0d97/packages/platform-browser/src/security/url_sanitizer.ts" rel="noopener ugc nofollow" target="_blank">sanitizeUrl</a></code>函数通过正则表达式净化不可信的样式/URL值。</p></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="9c15" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">我们如何禁用清理逻辑？</h1><p id="8490" class="pw-post-body-paragraph jr js hu jt b ju lo iv jw jx lp iy jz ka lq kc kd ke lr kg kh ki ls kk kl km hn dt translated">在特定情况下，可能有必要禁用清理，例如，如果应用程序确实需要生成一个带有动态值的<code class="eh nh ni nj nk b">`javascript:`</code>样式的链接。用户可以通过用<code class="eh nh ni nj nk b">bypassSecurityTrustX</code>方法之一构造一个值，然后从模板绑定到那个值，从而绕过安全性。</p><blockquote class="ms"><p id="49a5" class="mt mu hu bd mv mw mx my mz na nb km ek translated">用不受信任的用户数据调用<code class="eh nh ni nj nk b">bypassSecurityTrustX</code>方法会使您的应用程序面临XSS安全风险</p></blockquote><p id="42a3" class="pw-post-body-paragraph jr js hu jt b ju nc iv jw jx nd iy jz ka ne kc kd ke nf kg kh ki ng kk kl km hn dt translated">这种方法的一个例子是HTML值的<code class="eh nh ni nj nk b">bypassSecurityTrustHtml</code>。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mm mn l"/></div><figcaption class="mo mp fg fe ff mq mr bd b be z ek">The bypassSecurityTrustHtml method</figcaption></figure><p id="2316" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们可以看到该方法使用的接口。该方法只是获取一个值，并在包装的对象中原样返回该值。</p></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="74f8" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">结论</h1><p id="8c03" class="pw-post-body-paragraph jr js hu jt b ju lo iv jw jx lp iy jz ka lq kc kd ke lr kg kh ki ls kk kl km hn dt translated">XSS攻击在web浏览器中很常见。在这些攻击中，受害者是用户而不是应用程序。恶意值大多来自HTML、CSS或URL。有了Angular，你就自动处于一个安全的地方。这是由清除不可信值的DOM杀毒程序完成的。您可以禁用此角度保护。当你决定做这件事时，要注意其中的危险，谨慎而明智地去做。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff nz"><img src="../Images/522b2e4ace3cfcecd43bba30fcf0a317.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*cA1Y2VmIvRnUJUvjUPNZ2A.png"/></div></figure><p id="44e2" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><strong class="jt hv"> <em class="kn">您可以关注我的</em></strong><a class="ae ko" href="https://www.dormoshe.io" rel="noopener ugc nofollow" target="_blank"><strong class="jt hv"><em class="kn">dormo she . io</em></strong></a><strong class="jt hv"><em class="kn">或</em></strong><a class="ae ko" href="https://twitter.com/DorMoshe" rel="noopener ugc nofollow" target="_blank"><strong class="jt hv"><em class="kn">Twitter</em></strong></a><strong class="jt hv"><em class="kn">了解更多关于Angular、JavaScript和web开发的内容。</em> </strong></p></div></div>    
</body>
</html>