<html>
<head>
<title>JavaScript: Do you like games? (part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript:你喜欢游戏吗？(第一部分)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/javascript-do-you-like-games-part-1-c1320c2c52ec?source=collection_archive---------6-----------------------#2016-10-17">https://medium.com/hackernoon/javascript-do-you-like-games-part-1-c1320c2c52ec?source=collection_archive---------6-----------------------#2016-10-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="7b68" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">关于这个话题:第1部分| <a class="ae jp" href="https://blog.hellojs.org/javascript-do-you-like-games-part-2-9d4141ca2493" rel="noopener ugc nofollow" target="_blank">第2部分</a> | <a class="ae jp" href="https://blog.hellojs.org/javascript-do-you-like-games-part-3-6225ec264902" rel="noopener ugc nofollow" target="_blank">第3部分</a> | <a class="ae jp" rel="noopener" href="/@radu.bogdan.gaspar/javascript-do-you-like-games-part-4-9d6e8adb5626">第4部分</a> | <a class="ae jp" rel="noopener" href="/@radu.bogdan.gaspar/javascript-do-you-like-games-part-5-a79bb69ad9e1">第5部分</a> | <a class="ae jp" rel="noopener" href="/@radu.bogdan.gaspar/javascript-do-you-like-games-part-6-7bff0b8ce05e">第6部分</a></p><p id="e664" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">也许我应该问你是否曾经思考过游戏是如何工作的，甚至是从零开始构建一个游戏？如果不是，现在就转身离开；我在你的未来看到了很多数学！</p><p id="e521" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">童年时，我对马里奥和其他类似的游戏非常着迷。他们非常简单<em class="jq">但</em>玩起来非常有趣。随着Wii U上的超级马里奥制造器的出现，马里奥正在卷土重来，这实际上一点也没有让我感到惊讶。</p><p id="3186" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在多年的编程之后，我尝试制作一些自己的游戏，我很快意识到方法、工作环境、策略、计划、测试和思维方式完全不同。</p><p id="883a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我仍然想学习…使用一个框架是不够的；我想知道足够的信息来从头开始建造一个。纯粹的愚蠢，对吗？我更喜欢像维托尔德·冈布罗维茨一样思考这个问题</p><blockquote class="jr js jt"><p id="7fc9" class="ir is jq it b iu iv iw ix iy iz ja jb ju jd je jf jv jh ji jj jw jl jm jn jo hn dt translated">愚蠢是智慧的孪生姐妹。</p></blockquote></div><div class="ab cl jx jy hc jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hn ho hp hq hr"><p id="abf7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这部分没有代码(抱歉)；我们需要先解决一些事情…</p><p id="2f0d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那么一个人如何开始构建一个游戏呢？事情是这样的，一场比赛通常不是一个人在没有团队的情况下进行的。你需要几样东西:一个故事/想法，一个游戏流派，游戏平台(网络，桌面，移动，主机)，一个程序员和一个最起码的设计师。目前这个团队包括:我，我自己和我……让我们看看结果如何。</p><p id="3fdd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想做一个迷你引擎/框架/库/包，让我能够构建游戏。它需要具备一些基本功能，如:</p><ul class=""><li id="ad3d" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">游戏循环</li><li id="90fc" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">通用屏幕绘制和刷新逻辑</li><li id="f42f" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">多个屏幕容器(就像你在双人分屏游戏中看到的一样)</li><li id="509d" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">屏幕容器剪辑</li><li id="f215" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">屏幕分层</li><li id="7afe" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">输入事件处理(通过键盘和/或鼠标)</li><li id="b414" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">自定义事件调度</li><li id="7405" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">资产加载(用于游戏中的媒体文件，如声音和精灵表)</li><li id="f5cf" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">显示和动画小精灵(blit ing a . k . a .<a class="ae jp" href="https://en.wikipedia.org/wiki/Bit_blit" rel="noopener ugc nofollow" target="_blank">bit blit</a></li><li id="2873" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">动画帧速率控制</li><li id="f812" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">路径查找(这可能很好)</li><li id="3566" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">2D物理引擎(2D保持事情“简单”，因为它应该有碰撞检测支持和其他功能)</li></ul><p id="bd4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可能会认为这是一个庞大的列表，但理想的引擎不应该固执己见的游戏类型，你可以建立；此外，这个列表实际上很小，我想走出我的舒适区一点。</p><p id="1d99" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想在ES6中写所有的东西，所以我准备了一个<a class="ae jp" href="https://github.com/raduGaspar/babel-gulp-webpack-sass-boilerplate" rel="noopener ugc nofollow" target="_blank"><strong class="it hv"><em class="jq">babel-gulp-webpack-sass</em></strong></a>样板文件。它与live reload扩展一起工作，以促进开发，所以请确保在浏览器中安装它。按照<a class="ae jp" href="https://github.com/raduGaspar/babel-gulp-webpack-sass-boilerplate/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">指示</a>让它运行。</p><p id="2239" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我将在另一个GIT库中完成所有的编码，以保持样板文件的完整性。</p><p id="73f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了渲染，我决定使用画布元素。它不是交互式的(我将在后面详细介绍)，所以它可能会增加更多的编码挑战，这是完美的。它通常是网页游戏的首选，因此符合要求。</p><p id="5325" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">方法很简单，我们将有一个双重用途的代码库:</p><ul class=""><li id="4b3d" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">一部分是引擎</li><li id="032e" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated">另一个将是使用该引擎的游戏。</li></ul><p id="361b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用一个不成熟的引擎创建迷你游戏会很快让我们知道它缺少什么以及如何改进它。</p><p id="c43d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们从第一件事开始:</p><p id="bc60" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">游戏循环</strong>。这是什么？我们为什么需要它？</p><p id="2855" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我认为游戏循环是游戏的心跳。它保持一切更新和正确渲染。如果我们想要确定性的行为，那么在屏幕上绘制的所有东西都需要与单个游戏循环一起工作。</p><p id="691e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你不想创建一个射击游戏，让子弹穿过玩家而不造成伤害，或者让玩家穿过地图，因为玩家、子弹和地图更新在不同的循环中。</p><p id="4eae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在旧的浏览器中，<strong class="it hv"><em class="jq">setInterval()</em></strong>方法是可行的，因为你可以每隔<em class="jq"> n </em>毫秒调用一次。如今，这是一个糟糕的做法，只有在<strong class="it hv"><em class="jq">requestAnimationFrame()</em></strong>不可用时才作为后备。<strong class="it hv"><em class="jq">requestAnimationFrame()</em></strong>方法会触发~60 fps。这是一个近似值，因为它通常会匹配刷新率；更多<a class="ae jp" href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="d61e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我通常喜欢在开始编码之前有一个小的类图，至少突出主要的类容器。目前来看，这种思路应该足够了:</p><figure class="kt ku kv kw fq kx fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff ks"><img src="../Images/7ea221486abbdc10951c855b43b7d5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QToCqeq4cPpmbUGNE3vlew.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek">game engine diagram v.1.0</figcaption></figure><p id="51a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个图表是不完整的，这很好，我们只是需要一些东西来开始，但首先一些解释:</p><ul class=""><li id="979f" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">在一切的核心，我们有一个<strong class="it hv"> <em class="jq"> EventDispatcher </em> </strong>，我们可以用它来监听和发出(触发)事件；这可能应该是一个单一的，它将像一个全球发布和订阅。</li><li id="0e0f" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated"><strong class="it hv"> <em class="jq">键盘</em> </strong>将帮助我们确定按键何时被按下和释放。现在，虽然它确实扩展了<strong class="it hv"><em class="jq">event dispatcher</em></strong>，但是我们不应该使用它的特性来实现<strong class="it hv"> <em class="jq">键盘</em> </strong>逻辑，因为我们不想来回传播事件，我们只是想在需要时拥有那个选项。</li><li id="d164" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated"><strong class="it hv"> <em class="jq"> Canvas </em> </strong>只有两个任务:创建并存储对Canvas标签及其上下文的引用，在调整屏幕大小时更新其属性。一切都将被绘制在一个<strong class="it hv"> <em class="jq">画布上</em> </strong>实例中。</li><li id="38ca" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated"><strong class="it hv"> <em class="jq">场景</em> </strong>扩展了<strong class="it hv"> <em class="jq">画布</em> </strong>你可以把它想象成一个视口/摄像机/屏幕。我们可以有多个<strong class="it hv"> <em class="jq">场景</em> </strong>实例，用于我们想要做的事情，比如分屏。它的工作还包括调用其中所有元素的<strong class="it hv"><em class="jq"/></strong><strong class="it hv"><em class="jq">render()</em></strong>方法。</li><li id="bf9d" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated"><strong class="it hv"><em class="jq">display object</em></strong>是保存我们想要渲染的任何项目。其他类会对它进行扩展，添加更多的属性；例如，我们可能想要设置像<em class="jq">是固体</em>、<em class="jq">有重力</em>和其他被物理引擎消耗的东西。</li><li id="7e83" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated"><strong class="it hv"> <em class="jq">游戏</em> </strong>类将保存主游戏循环、所有场景以及一些游戏播放和暂停功能。</li><li id="27cf" class="ke kf hu it b iu kn iy ko jc kp jg kq jk kr jo kj kk kl km dt translated"><strong class="it hv"> <em class="jq">资产加载器</em> </strong>是不言自明的。</li></ul><p id="2616" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个结构可能并不完美，但它很好地满足了我们的需求，因为任何与<strong class="it hv"> <em class="jq"> Canvas </em> </strong>直接或间接相关的类都将能够:分派事件、监听键盘输入并绘制到漂亮的屏幕上。</p><p id="5242" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可能会问自己，我们是否真的需要事件调度程序；实际上，我打算以后用它来促进单向数据流。</p><p id="4433" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们将开始所有这些类的工作，也许实现一个迷你游戏的基础，看看一些实际的进展。</p><figure class="kt ku kv kw fq kx"><div class="bz el l di"><div class="li lj l"/></div></figure></div></div>    
</body>
</html>