<html>
<head>
<title>Javascript for Automation in macOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于macOS自动化的Javascript</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/javascript-for-automation-in-macos-3b499da40da1?source=collection_archive---------2-----------------------#2017-08-24">https://medium.com/hackernoon/javascript-for-automation-in-macos-3b499da40da1?source=collection_archive---------2-----------------------#2017-08-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/d24cc495e48f4e301a002030ec1c8b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GoNA2On0zx0vhEz6n_s5xQ.png"/></div></div></figure><div class=""/><div class=""><h2 id="4891" class="pw-subtitle-paragraph jc ie if bd b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ek translated">我是如何自动完成一项长期的文件夹和重命名任务的？</h2></div><p id="cd2e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">有时我们会遇到由许多相似的小步骤组成的简单任务。过了一点，手动操作就不合理了。这是您需要开始使用自动化工具的地方。</p><p id="03c0" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在macOS中，有两种方法可以让你不用安装任何东西，或者你可以使用第三方工具。</p><p id="61f1" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">最简单的方法是使用<strong class="jw ig"> Automator app </strong>。它有一个拖放界面，允许您通过组合预定义的操作来轻松设置工作流。可能性几乎是无限的，但是建立真正复杂的、多步骤的、非线性的工作流程并不容易。</p><p id="a576" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">更难但真正高级的方法是使用<strong class="jw ig">JXA(</strong><a class="ae kq" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"><strong class="jw ig">Javascript</strong></a><strong class="jw ig">进行自动化)</strong>。这是一种基于Javascript的编程语言。从苹果电脑约塞米蒂开始，它取代了AppleScript。<strong class="jw ig">你几乎可以自动完成任何事情，从按特定顺序点击按钮，到说出命令时打开一组应用程序。你也可以在Automator应用程序中使用JXA，这将是一个不错的组合。</strong></p><h1 id="e05a" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">我的案子需要自动化</h1><p id="ee88" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">在我的年度订阅期内，我从Tutsplus下载了很多视频课程。下载的文件没有分组，而且文件名很长。所以它们需要被重命名和折叠。我本来可以一个一个地做，但这会花费不合理的长时间。所以我决定让它自动化。</p><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/93c9654671797858dbd4117f9537adfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B63VGCll00XPG978EowWeQ.png"/></div></div></figure><h1 id="538d" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">剧本解释说</h1><p id="8505" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">这真的很简单，而且基本上不言自明。让我们一起过一遍。</p><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/11adf26ce1371f776d77a93a9fb498db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SxWfDsCXWKnH76rvypPOQ.png"/></div></div></figure><p id="5b13" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">首先，我们创建两个经常使用的变量:<code class="eh lt lu lv lw b">currentApp</code>用于提示当前应用程序中的某些内容，<code class="eh lt lu lv lw b">finder</code>用于创建和移动文件，<code class="eh lt lu lv lw b">systemEvents</code>用于访问文件。</p><p id="c6a9" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">该操作系统有一套标准的脚本附加功能，提供朗读文本、显示用户交互对话框等功能。要使用它们，应用程序必须显式地将<code class="eh lt lu lv lw b">includeStandardAdditions</code>标志设置为<code class="eh lt lu lv lw b">true</code>。第三行代表那个。我们声明我们想要使用这些附加物。</p><p id="2c13" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">之后，我们提示一个文件夹选择器面板来获取要处理的文件夹。然后，我们在同一个目录中创建一个新文件夹，将已处理的文件移动到其中。</p><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/8e7022c046f88a5bbd9758e4b56430e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJsnHZqWSaLn8LHW6IsmVA.png"/></div></div></figure><p id="ce7f" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">稍后，我们使用for语句遍历文件夹，并根据文件名创建一个数组。目的是以后通过使用它们的名字再次访问这些文件。因为当我们将已处理的文件移出时，文件夹的内容会动态变化。使用文件名将确保我们访问正确的文件。</p><p id="b7a0" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">正常情况下，我们应该能够不使用文件名来完成这项工作。我试图那样做，但做不到。必须有一种方法来创建指向文件的指针，当文件夹的内容改变时，这些指针不会损坏。如果有人告诉我如何做，我会更新这一部分。</p><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/5c8d5f6b48fdaf766bcc784443877299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gVx6WRsGyBTVajkIfaoPCA.png"/></div></div></figure><p id="6d31" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">最后，我们处理数组中的每个文件。首先，我们通过使用文件名获得文件，并使用正则表达式将文件名分为两部分:连字符前和连字符后。第一部分是文件夹名，第二部分是文件名。</p><p id="e98d" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">之后，我们用这个名字创建一个新的文件夹，如果还没有的话，把文件移动到里面并重新命名。</p><p id="f15b" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">仅此而已！</p><blockquote class="lx ly lz"><p id="c668" class="ju jv ma jw b jx jy jg jz ka kb jj kc mb ke kf kg mc ki kj kk md km kn ko kp hn dt translated"><a class="ae kq" href="https://cl.ly/mA3J" rel="noopener ugc nofollow" target="_blank">下载脚本文件。</a></p></blockquote><h1 id="4f56" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">提示和技巧</h1><h2 id="b8c5" class="me ks if bd kt mf mg mh kx mi mj mk lb kd ml mm ld kh mn mo lf kl mp mq lh mr dt translated">使用<a class="ae kq" href="https://atom.io" rel="noopener ugc nofollow" target="_blank"> Atom </a>编辑器编写并运行脚本</h2><p id="9ece" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">JXA的默认编辑器是苹果的脚本编辑器。但是真的很基础，没那么好用。我推荐你通过安装两个写和运行JXA的包来使用<a class="ae kq" href="https://atom.io" rel="noopener ugc nofollow" target="_blank"> Atom </a>。</p><p id="d41a" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">第一个包是用于自动解/重编译<code class="eh lt lu lv lw b">.scpt</code>文件的<a class="ae kq" href="https://atom.io/packages/language-javascript-jxa" rel="noopener ugc nofollow" target="_blank">语言-javascript-jxa </a>，第二个包是用于在包括jxa在内的Atom编辑器中运行脚本的<a class="ae kq" href="https://atom.io/packages/script" rel="noopener ugc nofollow" target="_blank">脚本</a>包。我应该补充一点，我不完全确定脚本包是否能像脚本编辑器一样提供广泛的输出，但是对我来说，这已经足够了。</p><p id="d03c" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我还想提一下我在Atom中使用的主题:<a class="ae kq" href="https://atom.io/themes/new-moon-atom-syntax" rel="noopener ugc nofollow" target="_blank">新月-atom-syntax </a>。我真的很喜欢它的颜色和对比度！</p><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/c367e5cc242dce42db7ffc6154bb156a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5JkA0PLTGKsl9Lq1dfgfQ.png"/></div></div></figure><h2 id="313c" class="me ks if bd kt mf mg mh kx mi mj mk lb kd ml mm ld kh mn mo lf kl mp mq lh mr dt translated">应用程序脚本字典/属性列表</h2><p id="cbf7" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">脚本编辑器中有一个面板，用于查看应用程序的属性列表。这是为了帮助你弄清楚如何通过JXA命令macOS应用程序。你可以通过打开脚本编辑器并点击其中一个菜单项来查看:<code class="eh lt lu lv lw b">File &gt; Open Dictionary</code>或<code class="eh lt lu lv lw b">Window &gt; Library</code>。</p><figure class="lp lq lr ls fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lo"><img src="../Images/eaaaed37ef1a5900525449c3015cb8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9ku0G2NQfUHKSJecQHsYg.png"/></div></div></figure><h1 id="72b1" class="kr ks if bd kt ku kv kw kx ky kz la lb jl lc jm ld jo le jp lf jr lg js lh li dt translated">资源</h1><p id="388b" class="pw-post-body-paragraph ju jv if jw b jx lj jg jz ka lk jj kc kd ll kf kg kh lm kj kk kl ln kn ko kp hn dt translated">由于资源不足，编写这个脚本的时间比我预期的要长。大多数教程和书籍都是针对AppleScript的，尽管JXA问世已有多年。</p><p id="3f7a" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在这个链接 有一个很棒的资源列表<a class="ae kq" href="https://apple-dev.groups.io/g/jxa/wiki/JXA-Resources" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ig">。除此之外，我会推荐你去<strong class="jw ig">搜索Github </strong>中的代码片段。有许多公共脚本，有时你会遇到一些非常接近你想要做的事情。</strong></a></p><p id="0aa4" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">希望这些能帮助你开始自动化的事情，并帮助你节省一些时间！<strong class="jw ig">请点击或按住</strong>👏<strong class="jw ig">能扣多少扣多少！</strong>🙂</p><figure class="lp lq lr ls fq hw"><div class="bz el l di"><div class="ms mt l"/></div></figure></div></div>    
</body>
</html>