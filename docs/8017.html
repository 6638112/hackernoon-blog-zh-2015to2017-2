<html>
<head>
<title>Angular Application Performance Fixes — Story #1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度应用程序性能修复—故事#1</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/angular-application-performance-fixes-story-1-9bfa353d0fc4?source=collection_archive---------7-----------------------#2017-11-16">https://medium.com/hackernoon/angular-application-performance-fixes-story-1-9bfa353d0fc4?source=collection_archive---------7-----------------------#2017-11-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="6bd2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你知道，从事编程工作意味着——偶尔——你会遇到一个Bug——我称之为<strong class="it hv"> <em class="jp">幻影Bug </em> </strong>。解决这样的错误实际上是编程故障排除的乐趣之一——剔除所有误报并锁定真正的罪魁祸首的有趣旅程。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/8b21a37fc86b10784eda62c74457d559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzekYRwiBeAQ7Tc1Tp5pHA.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">The mirage… by <a class="ae kg" href="https://flic.kr/p/556Uvk" rel="noopener ugc nofollow" target="_blank">Michael</a></figcaption></figure><p id="20ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今天我有幸遇到并解决了一个这样的海市蜃楼bug..所以我想我也会和你一起分享这段旅程。</p><p id="a135" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今天，我的一个团队成员联系我，说他们的应用程序——使用<a class="ae kg" href="https://www.primefaces.org/primeng/#/datatable" rel="noopener ugc nofollow" target="_blank">预处理数据表</a>在IE11 <em class="jp">上速度慢得不合理,“一旦数据表呈现</em>！</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kh"><img src="../Images/a6a5ea1bb36c3c2375dc00a2ba803b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ceCZFZ9NGVvkRfa-gtf2KA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Demo of PrimeNg Datatable Angular Component..</figcaption></figure><p id="4370" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他向我展示了他的分析，其中引用了大量github问题，声称PrimeNg Datatable存在性能问题(即使行数和列数较少)。这是一个IE11角度性能问题的季节，这个特殊的分析让我担心。我已经爱上了PrimeNg图书馆和它的简单。这大大打击了我对图书馆信念！</p><p id="873a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在一次屏幕分享会上，开发者向我展示了他的IE窗口令人难以置信的困境..在呈现一个简单的数据表的负荷下，简直是晕头转向..而且……我相信这个错误确实存在于数据表中，不知何故PrimeNg一个非常好的库——不知何故在设计他们的数据表时做了一个超级劣质的工作——它甚至不能加载20行x 6列的表而不阻塞浏览器！！</p><p id="5f4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当他演示这个问题时，我忽略了我应该注意的其他迹象。例如，在点击为数据表带来数据的按钮之前，他必须选择几个下拉菜单..当他试图打开下拉菜单从中选择一个项目时，应用程序似乎有点迟钝。如果我质疑这种行为——我可能会节省3-4个小时的时间..但是我想我最后不会像现在这样兴奋！</p><p id="fdad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此..因为我在IE上找不到数据表这种行为的任何问题/原因..我请求我的开发者允许我在我的小角落里做我自己的调试。在花了2-3个小时阅读了各种github问题描述以准备数据表并分析了数据表性能问题之后..所有的问题似乎都在4.1.0版中解决了，而我们已经在4.1.2版中了，这就是困扰我的地方。</p><p id="5a00" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后我拿出了我武器库中的最后一个工具——<strong class="it hv"><em class="jp">分而治之</em> </strong>。我知道如果这个不行，那就没什么可以了！我开始清除数据表的所有特性，复选框列，内嵌编辑，选择..怀疑其中一个导致IE绊倒！但是不管我在做什么，IE都在口吃，我的机器的CPU使用率也在飙升。甚至在我没有碰IE的时候！<strong class="it hv"> <em class="jp">哒哒！几分钟后，我突然意识到..如果我找错了人，找错了地方怎么办？如果是IE的高CPU使用率(由于其他原因)导致的呢<em class="jp">是影响IE中数据表渲染的</em>罪魁祸首吗？</em></strong></p><p id="0b04" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我开始检查触发IE高CPU使用率的确切事件，我很害怕看到IE在主页渲染中的高CPU使用率——几乎没有2个按钮以及一堆静态文本和图像(除了页眉和页脚)。忘记PrimeNg数据表吧，我现在真的开始怀疑Angular本身在IE11上的表现了！！</p><p id="3157" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，我继续我的<em class="jp">分而治之</em>策略，最终将问题隔离在我整个应用程序中最差劲的组件——页脚组件——一个只有4-5个链接的组件！如果我注释掉这个组件..世界又变成了一个快乐的地方！</p><p id="3feb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上帝，世界上正在发生什么！我们究竟能在无害的页脚组件中写些什么呢？！我开始焦急地查看页脚的模板和组件代码..它就在那里…耐心地坐着等我，发现他在嘲笑我。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff km"><img src="../Images/9084d206aaa08f2b22de3704eeb6cda9.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*GGgkdL-G3H3qwVzm3j9mZw.png"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">The Angular Lifecycle hooks!</figcaption></figure><p id="1e7c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ki kj kk kl b">ngAfterViewChecked</code>如果组件属性改变，角度渲染引擎会自动调用。这个特定的实现通过<code class="eh ki kj kk kl b">setTimeout()</code>改变了一个组件属性，从而触发了对<code class="eh ki kj kk kl b">ngAfterViewChecked</code>的另一个调用..这又引起了另一个对<code class="eh ki kj kk kl b">ngAfterViewChecked</code>的呼叫，如此等等..无限循环！</p><p id="6342" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我只是简单地调整了实现，使其在没有<code class="eh ki kj kk kl b">ngAfterViewChecked</code>的情况下也能工作，然后，我们就开始工作了！世界又变成了一个快乐的地方！角度应用程序在IE中运行良好，没有任何故障！PrimeNG Datatable是一个高质量的组件，对于像我们这样的简单用例来说没有呈现问题！是我们自己的6行代码让我们的生活变得痛苦不堪！</p><p id="19d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在解决这个问题的过程中得到了乐趣，我希望你也一样！</p><p id="717d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我会回来为Angular App带来更多这样的性能提升/修复的故事..继续读。订阅我的频道，了解我的新故事！</p><p id="6960" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">哦，尽你所能地打<strong class="it hv"><em class="jp"/></strong>来鼓励我多写点！</p></div></div>    
</body>
</html>