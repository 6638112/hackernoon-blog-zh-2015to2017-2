<html>
<head>
<title>Universal JavaScript Console for Browser, Electron, NW.js, Node.js and Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">适用于浏览器、电子、NW.js、Node.js和Windows的通用JavaScript控制台</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/universal-javascript-console-for-browser-electron-nw-js-node-js-and-windows-272e4bd6f9d9?source=collection_archive---------3-----------------------#2017-01-20">https://medium.com/hackernoon/universal-javascript-console-for-browser-electron-nw-js-node-js-and-windows-272e4bd6f9d9?source=collection_archive---------3-----------------------#2017-01-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="adcc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我喜欢JavaScript，也喜欢好的命令行界面带来的生产力和灵活性。如果你在这里读过我以前的文章:</p><div class="jq jr fm fo js jt"><a href="https://hackernoon.com/@mikeptweet" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">迈克·帕森斯-黑客正午</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">阅读麦克·帕森斯在《黑客正午》中的文章。软件研究极客。每天，迈克·帕森斯和成千上万的其他人…</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">hackernoon.com</p></div></div><div class="kc l"><div class="kd l ke kf kg kc kh ki jt"/></div></div></a></div><p id="d17e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您知道，我非常喜欢用几行代码完成大量工作。我大部分时间都在浏览器控制台中度过，虽然我喜欢开发工具的强大功能和表现力，但它们对我来说往往是多余的。我也喜欢有一个一致的JavaScript控制台界面，可以在任何地方使用，而不仅仅是在浏览器中。例如，有时我想在浏览器外使用JavaScript来自动化Window的Office应用程序或脚本<a class="ae jp" href="https://hackernoon.com/tagged/node-js" rel="noopener ugc nofollow" target="_blank"> Node.js </a>，或者将浏览器与SQL Server等本机应用程序结合使用，以执行一些在浏览器沙箱内不可用的数据任务。我经常遇到的一个常见用例是从网页中抓取一些数据，并将其插入到Microsoft Excel等本地应用程序中，以便进行进一步的数据分析。</p><p id="2ca6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然标题中列出的每个环境都有自己的控制台环境和REPL环境，但我发现命令行界面在与主机操作系统的集成方面受到了限制。大多数都在一个沙箱中运行，这个沙箱对于普通用户来说很有意义，但是实际上限制了我作为超级用户或系统工程师想要的能力。</p><p id="124e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该控制台的另一个用途是在演示或现场编码会议期间，当您想要快速演示想法时。我经常用它来构建想法的原型，并验证浏览器或底层操作系统中的可用功能。</p><p id="0aae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我的通用JavaScript控制台基于Remy Sharp出色的工作</p><div class="jq jr fm fo js jt"><a href="https://github.com/remy/jsconsole" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">remy/jsconsole</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">jsconsole -基于Web的控制台-用于演示和研讨会</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">github.com</p></div></div><div class="kc l"><div class="kj l ke kf kg kc kh ki jt"/></div></div></a></div><p id="e5c2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我采用了Remy的优秀控制台，并对其进行了扩展，增加了一些允许我在多种环境中托管控制台的功能。</p><p id="93fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们从浏览器界面开始，它位于:</p><div class="jq jr fm fo js jt"><a href="https://s3.amazonaws.com/mparsons/jsconsole/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">安慰</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">通用JavaScript控制台</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">s3.amazonaws.com</p></div></div></div></a></div><p id="7fa5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您第一次导航到控制台时，您会看到以下界面:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff kk"><img src="../Images/d3103e1ad1b73d73318b96464f2a2f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HUnNgOM3qtPEIpZp0pN0kw.png"/></div></div></figure><p id="ed8e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以开始输入任何有效的JavaScript命令，并立即看到输出。尝试输入几个命令:</p><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="78f4" class="la lb hu kw b fv lc ld l le lf">Date()<br/>location<br/>navigator.userAgent<br/>1+1</span></pre><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff kk"><img src="../Images/b632cfa2d37a2fee7ba1720036a9465a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gVfshR_69COMJjxwaRJTRA.png"/></div></div></figure><p id="17ed" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以输入任何有效的JavaScript，包括设置变量和/或创建新函数。</p><p id="5966" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很多时候，您希望利用现有的JavaScript库，如jQuery、lodash或令人惊叹的ALASQL，它们允许您在浏览器中使用SQL。您可以通过库的URL简单地加载库，例如:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff kk"><img src="../Images/6bdbec71d69918e9b1ca93438f91f9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oP22dZ_4E-7AuTyDXXSZeQ.png"/></div></div></figure><p id="cf53" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我为我经常使用的库添加了一些快捷方式:</p><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="cede" class="la lb hu kw b fv lc ld l le lf">jquery<br/>prototype<br/>dojo<br/>mootools<br/>underscore<br/>lodash<br/>moment<br/>yui<br/>alasql</span></pre><p id="d44a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除了加载JavaScript库，您还可以从另一个网站加载HTML内容。这在抓取网页时很有用，例如:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff kk"><img src="../Images/ad2a88e4ce9d84b2d67f6d43864aeec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcLWNrHLE3Wpl1dvtlIGrQ.png"/></div></div></figure><p id="1d71" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上述示例演示了如何在独立模式下使用控制台。</p><p id="68d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这很有用，但我对控制台的第一个用途是在现有网页或网站的上下文中利用它。在这种模式下，您基本上是在现有的Web页面中插入控制台，它获取页面的上下文，这样您就可以编写页面的内容，就像打开浏览器开发工具一样。然而，与通过网站设置沙箱化的浏览器控制台不同，通用控制台在将现有库引入现有网页和/或通过扩展的网络功能(如WebSockets或跨域XMHttpRequest调用)方面提供了更大的能力。这是通过使用一个Bookmarklet来完成的，您可以通过<strong class="it hv"> :help </strong>命令来访问它。简单地从帮助页面拖动书签到你的浏览器书签，它就可以在任何网站上使用了。</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff lg"><img src="../Images/54816cd72861bee9cffce9a662c4d8cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pI0mGg_3ulc2rVA6KJBXpA.png"/></div></div></figure><p id="de7f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了说明这一功能，我们将导航到https://news.ycombinator.com/newest的<a class="ae jp" href="https://news.ycombinator.com/newest" rel="noopener ugc nofollow" target="_blank"/>和将控制台注入到该页面中的<strong class="it hv">，这样我们就可以编写其内容了。在这个例子中，我们将使用控制台和我最喜欢的库之一(ALASQL)来获取HackerNews网站上所有新的链接列表，并将它们导出到Excel。我们将用两行代码来实现这一点:</strong></p><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="791c" class="la lb hu kw b fv lc ld l le lf">:load alasql</span><span id="52cc" class="la lb hu kw b fv lh ld l le lf">alasql("select href,innerText INTO XLSX('news.xlsx',{headers:true}) from ? where className='storylink'",[[...page.document.all]])</span></pre><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff li"><img src="../Images/5d7e2bd21c09a7b974f0617c494ef108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aaDPnAs8U6kDcE6sspD15g.png"/></div></div></figure><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff lj"><img src="../Images/e00c375b8d40292fdb6a91d5fe7c09a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsqmKPAXUIu8RA1jlvUNiA.png"/></div></div></figure><p id="3336" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那很酷！</p><p id="35b9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您将控制台插入页面时，它会加载一个外部页面(<strong class="it hv">确保您允许弹出窗口！</strong>)并在控制台内创建一个新的变量<strong class="it hv">页面</strong>。该变量是对宿主页面的JavaScript window对象的引用，因此您可以访问该页面的任何属性或方法(即<strong class="it hv"> <em class="lk"> page.document、page.location </em> </strong>等)。</p><p id="1920" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，与主机页面的沙盒设置不同，控制台可以访问任何网页、JavaScript库或网络端点(通过WebSockets或XMLHttpRequest)。</p><p id="a441" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">希望这能让你对通用控制台的威力有所了解。</p><h1 id="1878" class="ll lb hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">电子托管</h1><p id="50b8" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">在本文的标题中，我提到了控制台也可用于除浏览器之外的环境。首先，让我们看看如何在电子版中托管它。你需要做的第一件事是通过</p><div class="jq jr fm fo js jt"><a href="http://electron.atom.io/" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">电子</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">使用JavaScript、HTML和CSS构建跨平台桌面应用。</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">电子.原子. io</p></div></div><div class="kc l"><div class="mn l ke kf kg kc kh ki jt"/></div></div></a></div><p id="c14f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦您安装并运行了Electron，您需要创建一个新的Electron应用程序，在这种情况下，只需在您的机器上创建一个文件夹(称之为console或您喜欢的任何名称),并将这3个文件添加到该文件夹中:</p><h2 id="4bce" class="la lb hu bd lm mo mp mq lq mr ms mt lu jc mu mv ly jg mw mx mc jk my mz mg na dt translated">package.json</h2><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="9fe6" class="la lb hu kw b fv lc ld l le lf">{<br/>  "name": "console",<br/>  "version":"1.0.0",<br/>  "main": "index.js"<br/>}</span></pre><h2 id="4660" class="la lb hu bd lm mo mp mq lq mr ms mt lu jc mu mv ly jg mw mx mc jk my mz mg na dt translated">索引. js</h2><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="8481" class="la lb hu kw b fv lc ld l le lf">const {app, BrowserWindow} = require('electron')<br/>const path = require('path')<br/>const url = require('url')</span><span id="e4a4" class="la lb hu kw b fv lh ld l le lf">let win</span><span id="530d" class="la lb hu kw b fv lh ld l le lf">function createWindow () {<br/>  win = new BrowserWindow({width: 800, height: 600})<br/>  win.loadURL(url.format({<br/>    pathname: path.join(__dirname, 'console.html'),<br/>    protocol: 'file:',<br/>    slashes: true<br/>  }))</span><span id="cadd" class="la lb hu kw b fv lh ld l le lf">win.on('closed', () =&gt; {<br/>    win = null<br/>  })<br/>}</span><span id="d194" class="la lb hu kw b fv lh ld l le lf">app.on('ready', createWindow)</span><span id="5179" class="la lb hu kw b fv lh ld l le lf">app.on('window-all-closed', () =&gt; {<br/>  if (process.platform !== 'darwin') {<br/>    app.quit()<br/>  }<br/>})</span><span id="ed83" class="la lb hu kw b fv lh ld l le lf">app.on('activate', () =&gt; {<br/>  if (win === null) {<br/>    createWindow()<br/>  }<br/>})</span></pre><h2 id="2d53" class="la lb hu bd lm mo mp mq lq mr ms mt lu jc mu mv ly jg mw mx mc jk my mz mg na dt translated">console.html</h2><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="8373" class="la lb hu kw b fv lc ld l le lf">&lt;html&gt;<br/>&lt;meta http-equiv="X-UA-Compatible" content="IE=Edge"&gt;<br/>&lt;head&gt;<br/>&lt;title&gt;Console&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;/body&gt;<br/>&lt;script src="<a class="ae jp" href="https://s3.amazonaws.com/mparsons/jsconsole/js/inject.js" rel="noopener ugc nofollow" target="_blank">https://s3.amazonaws.com/mparsons/jsconsole/js/inject.js</a>"&gt;&lt;/script&gt;<br/>&lt;/html&gt;</span></pre><p id="1866" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦创建了这些文件，只需拖动电子可执行文件上的文件夹来运行它:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div class="fe ff nb"><img src="../Images/096540c0e1e74b336d1c53fc0e0fd706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*OeU9oJ_-YRb2-AZdEsB5Zw.png"/></div></figure><p id="9b21" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您应该会看到如下所示的内容:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nc"><img src="../Images/3f9db8e020f243377794015d4cdfa984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovMD88dq1SZtfrQkmmwx7A.png"/></div></div></figure><p id="d58e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后，您可以开始键入任何引用Electron、Chrome浏览器或Node.js对象的命令:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nd"><img src="../Images/edd214d7d3f9021b99ed5e04b5913881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AANM3j-UslexLviVA212vA.png"/></div></div></figure><h1 id="1751" class="ll lb hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">NW.js托管</h1><p id="31eb" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">在NW.js中托管也一样简单。从这里下载应用程序:</p><div class="jq jr fm fo js jt"><a href="https://nwjs.io/" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">西北大学</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">nwjs</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">nwjs.io</p></div></div><div class="kc l"><div class="ne l ke kf kg kc kh ki jt"/></div></div></a></div><p id="3844" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">与电子示例一样，创建一个本地文件夹并添加这两个文件:</p><h2 id="70fb" class="la lb hu bd lm mo mp mq lq mr ms mt lu jc mu mv ly jg mw mx mc jk my mz mg na dt translated">package.json</h2><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="7252" class="la lb hu kw b fv lc ld l le lf">{<br/>  "name": "console",<br/>  "version":"1.0.0",<br/>  "main": "console.html"<br/>}</span></pre><h2 id="8d52" class="la lb hu bd lm mo mp mq lq mr ms mt lu jc mu mv ly jg mw mx mc jk my mz mg na dt translated">console.html</h2><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="809d" class="la lb hu kw b fv lc ld l le lf">&lt;html&gt;<br/>&lt;meta http-equiv="X-UA-Compatible" content="IE=Edge"&gt;<br/>&lt;head&gt;<br/>&lt;title&gt;Console&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;/body&gt;<br/>&lt;script src="<a class="ae jp" href="https://s3.amazonaws.com/mparsons/jsconsole/js/inject.js" rel="noopener ugc nofollow" target="_blank">https://s3.amazonaws.com/mparsons/jsconsole/js/inject.js</a>"&gt;&lt;/script&gt;<br/>&lt;/html&gt;</span></pre><p id="d313" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，只需将文件夹拖到<strong class="it hv"> <em class="lk"> nw </em> </strong>可执行文件上运行它，并开始键入命令来访问nw。JS环境:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nf"><img src="../Images/eedeba4dde87560d7ce50f5098f8b4ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a02glq5waQvm6n7RD8Ursg.png"/></div></div></figure><p id="9bd1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意都是NW。JS和Electron host Node.js，因此您可以使用通用控制台在这两个应用程序中针对Node.js上下文编写脚本:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nf"><img src="../Images/effca54de7bb75d6d7bc8e85fa7f39eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCKCyVW6OLYjRMLtgooDfg.png"/></div></div></figure><p id="3fa1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，我们来看看我最常使用的通用控制台…</p><h1 id="ba4d" class="ll lb hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated"><strong class="ak">在一个窗口的应用程序中托管控制台。</strong></h1><p id="a21b" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">你可能会说两者都是NW。JS和Electron是Window的应用程序，你是对的。然而，在许多情况下，Electron、NW.js和Node.js在原生窗口功能方面都有所欠缺，特别是COM自动化和Microsoft Office集成。大多数企业仍在运行微软的Excel、Word、Outlook等软件，我想用我最喜欢的语言JavaScript来编写这些应用程序。虽然Window的开发者生态系统有大量的方法来构建和扩展Office应用程序，但它们通常需要大量的依赖关系和使用C#或Visual Studio的技能，对我来说，如果我只想快速轻松地完成一些事情，这就有些过头了。因此，我们将在一个窗口的应用程序中托管通用控制台，使用一种已经存在于每个窗口的机器上的技术——窗口的脚本主机，特别是HTML应用程序，或HTA:</p><div class="jq jr fm fo js jt"><a href="https://en.wikipedia.org/wiki/HTML_Application" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">HTML应用程序-维基百科</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">另一方面，HTA作为完全受信任的应用程序运行，因此比普通的HTML文件拥有更多的特权…</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">en.wikipedia.org</p></div></div><div class="kc l"><div class="ng l ke kf kg kc kh ki jt"/></div></div></a></div><p id="a8df" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就像在本地机器上创建一个名为console.hta的文本文件一样简单:</p><h2 id="1dfa" class="la lb hu bd lm mo mp mq lq mr ms mt lu jc mu mv ly jg mw mx mc jk my mz mg na dt translated">console.hta</h2><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="f973" class="la lb hu kw b fv lc ld l le lf">&lt;html&gt;<br/>&lt;meta http-equiv="X-UA-Compatible" content="IE=Edge"&gt;<br/>&lt;head&gt;<br/>&lt;title&gt;Console&lt;/title&gt;<br/>&lt;HTA:APPLICATION ID="oHTA"<br/>     APPLICATIONNAME="Console"<br/>     BORDERSTYLE="normal"<br/>     CAPTION="yes"<br/>     CONTEXTMENU="no"  <br/>     ICON="favicon.ico"<br/>     INNERBORDER="no"<br/>     MAXIMIZEBUTTON="yes"<br/>     MINIMIZEBUTTON="yes"<br/>     NAVIGABLE="yes"<br/>     SELECTION="yes"<br/>     SHOWINTASKBAR="yes"<br/>     SCROLL="no"<br/>     SCROLLFLAT="yes"<br/>     SINGLEINSTANCE="yes"<br/>     SYSMENU="yes"<br/>     VERSION="1.0"<br/>     WINDOWSTATE="normal"/&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&lt;/body&gt;<br/>&lt;script src="<a class="ae jp" href="https://s3.amazonaws.com/mparsons/jsconsole/js/inject.js" rel="noopener ugc nofollow" target="_blank">https://s3.amazonaws.com/mparsons/jsconsole/js/inject.js</a>"&gt;&lt;/script&gt;<br/>&lt;/html&gt;</span></pre><p id="4bc3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！将此文件保存在本地计算机上，双击运行它:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nh"><img src="../Images/e358651bd017c74a0b28c5370467133c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zauokTZAzHfqkLso-KBdgw.png"/></div></div></figure><p id="6bd2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它与其他环境中的工作方式相同，重要的区别是它现在可以通过COM集成访问整个窗口的生态系统。这意味着，你可以使用Excel、Word、编写Internet Explorer脚本来抓取网站，或者使用具有COM(或OLE自动化风格界面)的第三方应用程序，如Adobe、AutoDesk、Microsoft Dynamics等。的确，你会发现大多数Window的应用程序都可以这样访问和编程。在这个简单的例子中，我将加载Excel并使用Excel对象模型读取和写入一些简单的值。作为一项安全措施，Window请求允许这样做:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff ni"><img src="../Images/78d42cc2b49b4bba96595ffa695a84e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQ47Bx5195ZKX7zFGn6M0g.png"/></div></div></figure><p id="4922" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这显示了编写Excel脚本是多么容易:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nj"><img src="../Images/1b185489c44309edf0cf95283f0e6e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4rz8_4MeqMCe45tHiF-YA.png"/></div></div></figure><p id="f4e3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，在下一个示例中，我将从外部网站加载内容，并将值粘贴到电子表格中:</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nk"><img src="../Images/ecb9a4d8c3c8f1dd519268e465d64711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2ftxCLKXu7DWioeWsgA9g.png"/></div></div></figure><p id="3424" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，执行此任务只需要以下6行代码:</p><pre class="kl km kn ko fq kv kw kx ky aw kz dt"><span id="5368" class="la lb hu kw b fv lc ld l le lf">//Load our data from the web<br/><strong class="kw hv"><em class="lk">:load </em></strong><a class="ae jp" href="https://news.ycombinator.com/newest" rel="noopener ugc nofollow" target="_blank"><strong class="kw hv"><em class="lk">https://news.ycombinator.com/newest</em></strong></a></span><span id="20b8" class="la lb hu kw b fv lh ld l le lf">//Assign it to a variable for easy reference [Optional]<br/><strong class="kw hv"><em class="lk">var doc=docs["</em></strong><a class="ae jp" href="https://news.ycombinator.com/newest" rel="noopener ugc nofollow" target="_blank"><strong class="kw hv"><em class="lk">https://news.ycombinator.com/newest</em></strong></a><strong class="kw hv"><em class="lk">"]</em></strong></span><span id="9bb8" class="la lb hu kw b fv lh ld l le lf">//load our web page scaping library<br/><strong class="kw hv"><em class="lk">:load alasql</em></strong></span><span id="14b7" class="la lb hu kw b fv lh ld l le lf">//Run our query to scrape the data<br/><strong class="kw hv"><em class="lk">var data=alasql("select href,innerText INTO TAB({headers:true}) from ? where className='storylink'",[[].slice.call(doc.all)])</em></strong></span><span id="5d79" class="la lb hu kw b fv lh ld l le lf">//copy it to the clipboard<br/><strong class="kw hv"><em class="lk">clipboardData.setData ("Text", data);</em></strong></span><span id="2044" class="la lb hu kw b fv lh ld l le lf">//Paste it into Excel<br/><strong class="kw hv"><em class="lk">wb.ActiveSheet.Range("A1").PasteSpecial()</em></strong></span></pre><p id="6fcf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">希望这展示了我们通用控制台的力量。你可以在这里获得一个早期版本，我希望能尽快在Github上记录和分享这些代码。</p><div class="jq jr fm fo js jt"><a href="https://s3.amazonaws.com/mparsons/jsconsole/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab ej"><div class="jv ab jw cl cj jx"><h2 class="bd hv fv z el jy eo ep jz er et ht dt translated">通用控制台</h2><div class="ka l"><h3 class="bd b fv z el jy eo ep jz er et ek translated">迈克·帕森斯</h3></div><div class="kb l"><p class="bd b gc z el jy eo ep jz er et ek translated">s3.amazonaws.com</p></div></div></div></a></div><p id="be6a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢这篇文章，请给它一个推荐！</p><p id="b749" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">谢谢大家！</p><div class="kl km kn ko fq ab cb"><figure class="nl kp nm nn no np nq paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nl kp nm nn no np nq paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nl kp nm nn no np nq paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nr ns nt"><p id="f922" class="ir is lk it b iu iv iw ix iy iz ja jb nu jd je jf nv jh ji jj nw jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is lk it b iu iv iw ix iy iz ja jb nu jd je jf nv jh ji jj nw jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff nx"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="kl km kn ko fq kp"><div class="bz el l di"><div class="ny nz l"/></div></figure></div></div>    
</body>
</html>