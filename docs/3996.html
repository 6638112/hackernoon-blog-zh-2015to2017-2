<html>
<head>
<title>Boil your eggs in parallel in BASH</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在BASH中并行煮鸡蛋</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/boil-your-eggs-in-parallel-in-bash-758bc12d2c1e?source=collection_archive---------5-----------------------#2017-05-05">https://medium.com/hackernoon/boil-your-eggs-in-parallel-in-bash-758bc12d2c1e?source=collection_archive---------5-----------------------#2017-05-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="8615" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们正处于一个机器拥有众多内核的时代。我们也有能以简单的方式使用这些核心的语言。</p><p id="e327" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">想象一下你想用Go这样的新语言并行煮鸡蛋:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="a351" class="jy jz hu ju b fv ka kb l kc kd">var wg sync.WaitGroup</span><span id="2fb8" class="jy jz hu ju b fv ke kb l kc kd">func boilAnEgg(i int) {<br/>    time.Sleep(time.Second)<br/>    fmt.Println("Your egg is ready: ",i)<br/>    wg.Done()<br/>}</span><span id="36f9" class="jy jz hu ju b fv ke kb l kc kd">func main(){<br/>   wg.Add(10)<br/>   for i:=1;i&lt;=10;i++ {<br/>      go biolAnEgg(i) # Adding "go" here simply will run the function as a goroutine here<br/>   }<br/>   wg.Wait()<br/>   fmt.Println("All eggs are ready")<br/>}</span></pre><p id="f62a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是我们40岁的狂欢会怎么样呢？</p><p id="46b6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们在bash中并行煮鸡蛋。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="757f" class="jy jz hu ju b fv ka kb l kc kd">boil_an_egg() {<br/>    sleep 1<br/>    printf "Your egg is ready: $1\n"<br/>}</span><span id="fe17" class="jy jz hu ju b fv ke kb l kc kd">for i in $(seq 1 10)<br/>do<br/>    boil_an_egg $i &amp;<br/>done<br/>wait<br/>printf "All eggs are ready\n"</span></pre><p id="a7c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在命令末尾添加“&amp;”会将它推入后台并行运行。</p><p id="a98b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">命令“wait”等待所有后台进程完成。</p><p id="136c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就这么简单。</p><p id="4bf1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，当我出于某种原因需要在<a class="ae kf" href="https://travis-ci.com/" rel="noopener ugc nofollow" target="_blank"> travis-ci </a>中克隆大约40个github库时，仅仅使用这种方法，我就能够将克隆时间从120秒降低到大约18秒。</p><p id="7785" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是多么简单:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="730c" class="jy jz hu ju b fv ka kb l kc kd">OUT=$(mktemp)<br/>for i in garbage queue prime<br/>do<br/>  (git clone git@github.com:kavehmz/$i.git || echo "cloning failed for: $i" &gt;&gt; $OUT ) &amp;<br/>done<br/>wait<br/>[ -s $OUT ] &amp;&amp; cat $OUT &amp;&amp; exit 255<br/>echo "Git repositories are ready"</span></pre><h1 id="1415" class="kg jz hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">奖金</h1><p id="3ead" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">列出正在运行的作业:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="b40a" class="jy jz hu ju b fv ka kb l kc kd">sleep 10 &amp;<br/>sleep 15 &amp;<br/>jobs</span><span id="a7c4" class="jy jz hu ju b fv ke kb l kc kd">[2] + Running                    sleep 15<br/>[1] - Running                    sleep 10</span></pre><p id="9d47" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下一个通知第一个不在列表中！你可以利用大括号:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="433d" class="jy jz hu ju b fv ka kb l kc kd">(sleep 10 &amp;)<br/>sleep 15 &amp;<br/>jobs</span><span id="7255" class="jy jz hu ju b fv ke kb l kc kd">[1] + Running                    sleep 15</span></pre><p id="95fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是这次包括了第一份工作！：</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="ed50" class="jy jz hu ju b fv ka kb l kc kd">(sleep 10) &amp;<br/>sleep 15 &amp;<br/>jobs</span><span id="bb4b" class="jy jz hu ju b fv ke kb l kc kd">[2] + Running                    sleep 15<br/>[1] - Running                    sleep 10</span></pre><p id="85da" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在让我们只等待第二个作业完成(%2):</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="af01" class="jy jz hu ju b fv ka kb l kc kd">sleep 10 &amp; <br/>sleep 5 &amp; <br/>sleep 15 &amp; <br/>wait %2</span><span id="a994" class="jy jz hu ju b fv ke kb l kc kd">[2] - Done                       sleep 5</span></pre><p id="a576" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然你不能用bash走得太远，但是作为一个简单的工具，它在很多地方都为你准备好了，不需要努力或者安装，你就可以在很多任务中使用它。</p><p id="2ad5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">更多信息请访问:<a class="ae kf" href="https://www.gnu.org/software/bash/manual/html_node/Job-Control-Builtins.html#Job-Control-Builtins" rel="noopener ugc nofollow" target="_blank">https://www . GNU . org/software/bash/manual/html _ node/Job-Control-builtins . html</a></p><blockquote class="li lj lk"><p id="b514" class="ir is ll it b iu iv iw ix iy iz ja jb lm jd je jf ln jh ji jj lo jl jm jn jo hn dt translated"><a class="ae kf" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae kf" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae kf" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae kf" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="dca4" class="ir is ll it b iu iv iw ix iy iz ja jb lm jd je jf ln jh ji jj lo jl jm jn jo hn dt translated">要了解更多信息，请<a class="ae kf" href="https://goo.gl/4ofytp" rel="noopener ugc nofollow" target="_blank">阅读我们的“关于”页面</a>、<a class="ae kf" href="http://bit.ly/HackernoonFB" rel="noopener ugc nofollow" target="_blank">在脸书上给我们点赞/发消息</a>，或者简单地说，<a class="ae kf" href="https://goo.gl/k7XYbx" rel="noopener ugc nofollow" target="_blank"> tweet/DM @HackerNoon。</a></p><p id="708a" class="ir is ll it b iu iv iw ix iy iz ja jb lm jd je jf ln jh ji jj lo jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae kf" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae kf" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote></div></div>    
</body>
</html>