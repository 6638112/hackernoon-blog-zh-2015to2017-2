<html>
<head>
<title>Mapping Tutorial: Combining Victory Charts and React-Simple-Maps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">地图教程:结合胜利图表和反应简单地图</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/mapping-tutorial-combining-victory-charts-and-react-simple-maps-4e839d803865?source=collection_archive---------13-----------------------#2017-08-14">https://medium.com/hackernoon/mapping-tutorial-combining-victory-charts-and-react-simple-maps-4e839d803865?source=collection_archive---------13-----------------------#2017-08-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="c298" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">在地图上使用圆环图创建瑞士语言分布的精美地图。</h2></div><h2 id="f549" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">注意:我已经把我的博客搬到了zcreativelabs.com/blog/。你可以在那里找到这篇文章的更新版本。以后的文章只会在那里发表。请订阅z creative labs时事通讯，以便在您的收件箱中收到我的最新文章。</h2><figure class="kj kk kl km fq kn fe ff paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="fe ff ki"><img src="../Images/38459b55b4f8c2b973c7eda4c2e3a2a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zwa9vLSbzdYM3OuSYTYeyg.png"/></div></div><figcaption class="ku kv fg fe ff kw kx bd b be z ek">This is the end result of this tutorial.</figcaption></figure><p id="b2ef" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt lr translated"><span class="l ls lt lu bm lv lw lx ly lz di">R</span><a class="ae kh" href="https://www.react-simple-maps.io" rel="noopener ugc nofollow" target="_blank">eact-simple-maps</a>是一个<a class="ae kh" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"> react </a>组件库，有助于使用d3-geo、TopoJSON和react更轻松地进行SVG映射。使用<code class="eh ma mb mc md b">react-simple-maps</code>的优势之一是它让React完全控制DOM，并且不会将SVG地图视为黑盒。这意味着<code class="eh ma mb mc md b">react-simple-maps</code>可以轻松利用整个React生态系统以及随之而来的所有好东西。</p><p id="203c" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated"><code class="eh ma mb mc md b">React-simple-maps</code>的部分灵感来自于<code class="eh ma mb mc md b">Victory</code>图表的声明式api。如果你没听说过<code class="eh ma mb mc md b">Victory</code>，那就看看<a class="ae kh" href="https://github.com/FormidableLabs/victory" rel="noopener ugc nofollow" target="_blank"> github </a>，或者看看他们<a class="ae kh" href="http://formidable.com/open-source/victory/" rel="noopener ugc nofollow" target="_blank">网站</a>上的<a class="ae kh" href="http://formidable.com/open-source/victory/gallery" rel="noopener ugc nofollow" target="_blank">示例</a>和<a class="ae kh" href="http://formidable.com/open-source/victory/guides" rel="noopener ugc nofollow" target="_blank">指南</a>。</p><p id="e9df" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">关于<code class="eh ma mb mc md b">Victory</code> charts的伟大之处在于它不必单独使用，而是可以嵌入到现有的SVG容器中。这使得将<code class="eh ma mb mc md b">Victory</code>图表与任何SVG视觉效果(如地图)结合起来成为可能；)</p><p id="8d5d" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">本教程将介绍如何组合这两个库，并创建本文封面所示的地图。如果你只是对最终代码感兴趣，那就去看看github repo。</p><p id="ee52" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">以下是本教程将涵盖的内容:</p><ol class=""><li id="8361" class="me mf hu la b lb lc le lf ju mg jy mh kc mi lq mj mk ml mm dt translated">关于观想</li><li id="4a54" class="me mf hu la b lb mn le mo ju mp jy mq kc mr lq mj mk ml mm dt translated">回购和应用程序结构</li><li id="d6d8" class="me mf hu la b lb mn le mo ju mp jy mq kc mr lq mj mk ml mm dt translated">设置基本地图(地形、投影、样式)</li><li id="ce59" class="me mf hu la b lb mn le mo ju mp jy mq kc mr lq mj mk ml mm dt translated">数据</li><li id="97c4" class="me mf hu la b lb mn le mo ju mp jy mq kc mr lq mj mk ml mm dt translated">在<code class="eh ma mb mc md b">&lt;Marker /&gt;</code>组件内渲染<code class="eh ma mb mc md b">&lt;VictoryPie /&gt;</code></li></ol><p id="5181" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">让我们开始吧。</p><h1 id="7c4b" class="ms jk hu bd jl mt mu mv jp mw mx my jt ja mz jb jx jd na je kb jg nb jh kf nc dt translated">关于观想</h1><p id="5fcc" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">本教程的可视化显示了瑞士各州的语言分布。尽管瑞士人口略多于800万，但它有四种官方语言:德语、法语、意大利语和罗曼语。这导致瑞士被分成三个不同的语言区域，每个区域都有自己的文化。罗曼语是一个特殊的例子，因为只有0.5%的瑞士人说罗曼语，主要是在格劳宾登州。</p><p id="f103" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">虽然大多数州主要认同一种语言，但也有一些州(弗里堡、瓦莱州、伯尔尼州和格劳宾登州)的语言环境相当多样化。</p><h1 id="8d0f" class="ms jk hu bd jl mt mu mv jp mw mx my jt ja mz jb jx jd na je kb jg nb jh kf nc dt translated">回购和应用程序结构</h1><p id="df25" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">为了简化本教程的设置，我将使用next.js创建一个app scaffold。要开始，请安装这些依赖项:</p><pre class="kj kk kl km fq ni md nj nk aw nl dt"><span id="fdcc" class="jj jk hu md b fv nm nn l no np">$ npm install react react-dom react-simple-maps victory next --save</span></pre><p id="8fec" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">就搭建而言，下面是应用程序结构的样子:</p><pre class="kj kk kl km fq ni md nj nk aw nl dt"><span id="1f56" class="jj jk hu md b fv nm nn l no np">┬ app<br/>├─┬ data<br/>│ └── index.js<br/>├─┬ pages<br/>│ └── index.js<br/>├─┬ static<br/>│ └── cantons.json<br/>├── node_modules<br/>└── package.json</span></pre><p id="9aba" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">别忘了在<code class="eh ma mb mc md b">package.json</code>中添加下一个<code class="eh ma mb mc md b">dev</code>剧本。</p><pre class="kj kk kl km fq ni md nj nk aw nl dt"><span id="5323" class="jj jk hu md b fv nm nn l no np">// ./package.json<br/>...<br/>scripts: {<br/>  "dev": "next",<br/>  ...<br/>}<br/>...</span></pre><h1 id="7151" class="ms jk hu bd jl mt mu mv jp mw mx my jt ja mz jb jx jd na je kb jg nb jh kf nc dt translated">设置基本地图</h1><p id="9b43" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">每一个地图可视化都是从一个好的底图和一个坚实的地形文件开始的。如果你是TopoJSON的新手，请在这里查看<a class="ae kh" href="https://github.com/topojson/topojson" rel="noopener ugc nofollow" target="_blank">文档</a>。如果您是创建自己的TopoJSON文件的新手，您可以查看我的文章<a class="ae kh" href="https://hackernoon.com/how-to-convert-and-prepare-topojson-files-for-interactive-mapping-with-d3-499cf0ced5f" rel="noopener ugc nofollow" target="_blank">如何使用d3 </a>转换和准备TopoJSON文件以进行交互式制图。</p><p id="9c60" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">用于创建TopoJSON文件的原始shapefile来自<a class="ae kh" href="http://www.gadm.org/country" rel="noopener ugc nofollow" target="_blank">gadm.org</a>。</p><p id="4e43" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">瑞士地图的投影来自于迈克·博斯托克制作的这块积木。为了将<a class="ae kh" href="https://github.com/d3/d3-geo-projection#geoAlbers" rel="noopener ugc nofollow" target="_blank">阿尔伯斯投影</a>与<code class="eh ma mb mc md b">react-simple-maps</code>一起使用，我们需要加载<a class="ae kh" href="https://github.com/d3/d3-geo" rel="noopener ugc nofollow" target="_blank"> d3-geo </a>。由于<code class="eh ma mb mc md b">react-simple-maps</code>内部使用d3-geo，应该已经安装了。使用d3-geo中的<code class="eh ma mb mc md b">geoAlbers</code>，您可以轻松地创建一个自定义投影，并将其传递到<code class="eh ma mb mc md b">&lt;ComposableMap /&gt;</code>的<code class="eh ma mb mc md b">projection</code> prop中。</p><figure class="kj kk kl km fq kn"><div class="bz el l di"><div class="nq nr l"/></div></figure><p id="a5e1" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">您现在可以运行该应用程序。只需在终端中键入<code class="eh ma mb mc md b">$ npm run dev</code>，然后转到<code class="eh ma mb mc md b"><a class="ae kh" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>。</p><h1 id="589b" class="ms jk hu bd jl mt mu mv jp mw mx my jt ja mz jb jx jd na je kb jg nb jh kf nc dt translated">数据</h1><p id="93d8" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated"><a class="ae kh" href="https://www.bfs.admin.ch/asset/fr/je-f-21.03.02" rel="noopener ugc nofollow" target="_blank">本教程的数据集</a>来自<a class="ae kh" href="https://www.bfs.admin.ch/bfs/en/home.html" rel="noopener ugc nofollow" target="_blank">瑞士联邦统计局</a>。为了不影响异步数据加载，这个小数据集可以很容易地转换成一个<a class="ae kh" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> javascript </a>对象，并作为普通脚本加载。以下是摘录:</p><pre class="kj kk kl km fq ni md nj nk aw nl dt"><span id="77a7" class="jj jk hu md b fv nm nn l no np">// ./data/index.js</span><span id="82db" class="jj jk hu md b fv ns nn l no np">export const cantons = [<br/>  {<br/>    id: 25,<br/>    canton: "Zurich",<br/>    coordinates: [ 8.6356, 47.3595 ],<br/>    languages: [<br/>      { name: "German", value: 83.1 },<br/>      { name: "French", value: 3 },<br/>      { name: "Italian", value: 5.9 },<br/>      { name: "Romansh", value: 0.4 },<br/>    ]<br/>  },<br/>...</span></pre><p id="cc22" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">现在，数据可以轻松导入应用程序:</p><pre class="kj kk kl km fq ni md nj nk aw nl dt"><span id="22a6" class="jj jk hu md b fv nm nn l no np">// ./pages/index.js</span><span id="2440" class="jj jk hu md b fv ns nn l no np">import { cantons } from "../data"<br/>...</span></pre><h1 id="9429" class="ms jk hu bd jl mt mu mv jp mw mx my jt ja mz jb jx jd na je kb jg nb jh kf nc dt translated">将胜利图表渲染为标记</h1><p id="3b49" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">最后一步是使用数据渲染出<code class="eh ma mb mc md b">react-simple-maps</code> <code class="eh ma mb mc md b">&lt;Marker /&gt;</code>组件，并将<code class="eh ma mb mc md b">&lt;VictoryPie /&gt;</code>图表渲染到这些标记中。</p><figure class="kj kk kl km fq kn"><div class="bz el l di"><div class="nq nr l"/></div></figure><p id="4b96" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated"><strong class="la hv"> <em class="nt">注:</em> </strong>线条<code class="eh ma mb mc md b">67-68</code>上增加的两个<code class="eh ma mb mc md b">&lt;circle /&gt;</code>元素，只是起装饰作用。</p><h1 id="9bc5" class="ms jk hu bd jl mt mu mv jp mw mx my jt ja mz jb jx jd na je kb jg nb jh kf nc dt translated">结论</h1><p id="829c" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">本教程讲述了如何使用<code class="eh ma mb mc md b">react-simple-maps</code>和<code class="eh ma mb mc md b">Victory</code>图表创建一个瑞士各州语言分布的小地图。这两个库配合得很好，不妨试一试。感谢阅读，并愉快的映射！；)</p><h2 id="8412" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">资源</h2><p id="e87e" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">完整的代码示例见<a class="ae kh" href="https://github.com/zcreativelabs/react-simple-maps/tree/master/examples/with-victory" rel="noopener ugc nofollow" target="_blank">这个github repo </a>。</p><p id="416d" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">有关声明式映射的更多信息，请查看<a class="ae kh" rel="noopener" href="/@zimrick/how-to-create-pure-react-svg-maps-with-topojson-and-d3-geo-e4a6b6848a98">如何使用topojson和d3-geo创建纯react SVG地图</a>。</p><p id="bca8" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">有关如何将shapefiles转换为TopoJSON以便与<code class="eh ma mb mc md b">react-simple-maps</code>或d3一起使用的信息，请查看<a class="ae kh" href="https://hackernoon.com/how-to-convert-and-prepare-topojson-files-for-interactive-mapping-with-d3-499cf0ced5f" rel="noopener ugc nofollow" target="_blank">如何转换和准备TopoJSON文件以便与d3 </a>进行交互映射。</p><p id="fa0c" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated"><a class="ae kh" href="https://www.react-simple-maps.io" rel="noopener ugc nofollow" target="_blank">更多关于react-simple-maps的信息</a></p><p id="77e2" class="pw-post-body-paragraph ky kz hu la b lb lc iv ld le lf iy lg ju lh li lj jy lk ll lm kc ln lo lp lq hn dt translated">关于胜利的更多信息。</p><h2 id="8668" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">提及</h2><p id="348a" class="pw-post-body-paragraph ky kz hu la b lb nd iv ld le ne iy lg ju nf li lj jy ng ll lm kc nh lo lp lq hn dt translated">感谢<a class="nu nv gr" href="https://medium.com/u/900ee8ad3db9?source=post_page-----4e839d803865--------------------------------" rel="noopener" target="_blank">令人敬畏的</a>的人们，感谢他们创造了<code class="eh ma mb mc md b">Victory</code>的精彩，当然还有<a class="nu nv gr" href="https://medium.com/u/c918c478bb49?source=post_page-----4e839d803865--------------------------------" rel="noopener" target="_blank">迈克·博斯托克</a>，以及<a class="ae kh" href="https://twitter.com/jasondavies" rel="noopener ugc nofollow" target="_blank">杰森·戴维斯</a>为d3所做的工作，感谢他们一直以来的灵感来源。</p><figure class="kj kk kl km fq kn"><div class="bz el l di"><div class="nw nr l"/></div></figure></div></div>    
</body>
</html>