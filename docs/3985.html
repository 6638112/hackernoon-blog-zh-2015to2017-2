<html>
<head>
<title>Rails 5 Imgur Clone Tutorial…Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rails 5 Imgur克隆教程…第1部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/rails-5-imgur-clone-tutorial-part-1-8fa6e08d5d?source=collection_archive---------12-----------------------#2017-05-04">https://medium.com/hackernoon/rails-5-imgur-clone-tutorial-part-1-8fa6e08d5d?source=collection_archive---------12-----------------------#2017-05-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/10f0204380183dc76e829c3a0391737f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T_hnqYrj61dyo1TVPrDolw.jpeg"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Rails 5 Imgur Clone</figcaption></figure><div class=""/><p id="34cc" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt ke translated">使用载波和Cloudinary无痛上传和管理图片，并部署在Heroku上，快速与世界分享您的照片。</p><p id="2960" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">大家好，今天我将向大家展示如何在Rails 5应用程序中轻松分享和上传图片。这是我通过浏览几个过时的教程，博客帖子和一堆文档了解到的。大多数文章都是老版本的Rails 4，所以我把集成到Rails 5的步骤拼凑在一起，我目前在一些项目中使用它，并会继续使用更多。另外，在这个过程中，我们今天将通过添加所有CRUD(创建、读取、更新、删除)功能来构建一个imgur克隆。</p><p id="c1cd" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这将是一个由两部分组成的系列，解释每一个细节。本教程对初学者非常友好，也适合中级到高级用户。</p><blockquote class="ko"><p id="f217" class="kp kq ij bd kr ks kt ku kv kw kx kd ek translated">现在，让我们开始编码，好吗？</p></blockquote><p id="e7f3" class="pw-post-body-paragraph jg jh ij ji b jj ky jl jm jn kz jp jq jr la jt ju jv lb jx jy jz lc kb kc kd hn dt translated">首先，让我们在您的终端中创建一个新的rails项目，方法是:</p><blockquote class="ld le lf"><p id="2773" class="jg jh lg ji b jj jk jl jm jn jo jp jq lh js jt ju li jw jx jy lj ka kb kc kd hn dt translated">rails新rimgur</p></blockquote><p id="ffcc" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">立即开始使用Git总是一种好的做法，因此，我们在这里将遵循相同的做法:</p><blockquote class="ld le lf"><p id="7e48" class="jg jh lg ji b jj jk jl jm jn jo jp jq lh js jt ju li jw jx jy lj ka kb kc kd hn dt translated">git初始化</p><p id="3158" class="jg jh lg ji b jj jk jl jm jn jo jp jq lh js jt ju li jw jx jy lj ka kb kc kd hn dt translated">git添加。</p><p id="cd12" class="jg jh lg ji b jj jk jl jm jn jo jp jq lh js jt ju li jw jx jy lj ka kb kc kd hn dt translated">git commit -m '项目初始化'</p></blockquote><p id="56df" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们使用这个命令启动服务器，在浏览器中测试我们的应用程序。</p><blockquote class="ld le lf"><p id="0854" class="jg jh lg ji b jj jk jl jm jn jo jp jq lh js jt ju li jw jx jy lj ka kb kc kd hn dt translated">rails服务器</p></blockquote><p id="4a4b" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后在你的浏览器里转到<em class="lg"> localhost:3000。你会看到这个。</em></p><figure class="ll lm ln lo fq hw fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/bd5f3e6838ed68c54a5f635290a6885b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*5rXDFCXMNuJqPakpckB5-g.png"/></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Rails default home</figcaption></figure><p id="6e5e" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">太好了，你的应用正在成功运行。在您喜欢的IDE或文本编辑器中打开项目。</p><p id="633b" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在我们要创建一个控制器。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="6c96" class="lu lv ij lq b fv lw lx l ly lz">rails generate <!-- -->controller pics</span></pre><p id="1280" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">打开文件<strong class="ji ik"><em class="lg">pics _ controller . Rb</em></strong><em class="lg"/>和一个动作<strong class="ji ik"> <em class="lg">索引</em> </strong></p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="3d86" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">class PicsController &lt; ApplicationController<br/>    def <em class="lg">index <br/>    </em>end<br/>end</strong></span></pre><p id="41e3" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在<strong class="ji ik"><em class="lg">app/views/pics/index . html . erb</em></strong>中为我们的索引操作创建一个视图文件</p><p id="3a9a" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">打开<em class="lg"> index.html.erb </em>，写一些类似<em class="lg">“Hello”</em>的虚拟文本</p><p id="e463" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，我们将创建一个路由来显示页面。</p><p id="32f8" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">转到<strong class="ji ik"><em class="lg">config/routes . Rb</em></strong>写这个。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="0f90" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">Rails</strong>.<strong class="lq ik">application</strong>.<strong class="lq ik">routes</strong>.<strong class="lq ik">draw do<br/>    root 'pics#index'<br/>end</strong></span></pre><p id="40c8" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">好的，这一行简单的表示你正在设置<em class="lg">根</em>路径到<em class="lg"> pic </em>控制器和<em class="lg">索引</em>动作。</p><p id="0de3" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">而且你应该<em class="lg"/>“你好”或者随便你写什么。</p><p id="d8e0" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，我们将像这样创建我们的模型。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="190a" class="lu lv ij lq b fv lw lx l ly lz">rails generate model Pic</span></pre><p id="7abd" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt ke translated">好了，现在我们有了一些路线和模型设置，现在我们可以开始整合我们的图像处理系统了。</p><p id="68d6" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">首先，打开你的<strong class="ji ik"> <em class="lg"> Gemfile </em> </strong>然后把它们放在中间的任何地方。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="1325" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">gem 'carrierwave'<br/>gem 'cloudinary'</strong></span></pre><p id="7005" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">其次，在你的终端中运行<strong class="ji ik"> <em class="lg"> bundle </em> </strong>来安装gems，然后重启你的服务器。</p><p id="19f3" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">第三，我们将像这样生成我们的图像上传程序。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="c730" class="lu lv ij lq b fv lw lx l ly lz">rails generate uploader Image</span></pre><p id="7898" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">去<strong class="ji ik"><em class="lg">app/uploaders/image _ uploader . Rb</em></strong>把这个加到我们的类里面。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="cec5" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">include Cloudinary::CarrierWave</strong></span></pre><p id="f149" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">并注释掉文件中的其他内容。重要！</p><p id="91ae" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，在<strong class="ji ik"><em class="lg">config/initializer</em></strong>目录名<strong class="ji ik"><em class="lg">cloud inary . Rb</em></strong>中创建一个新文件，然后添加这个文件。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="d882" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">Cloudinary</strong>.<strong class="lq ik">config do |<em class="lg">config</em>|<br/>    <em class="lg">config</em></strong>.<strong class="lq ik">cloud_name = ENV</strong>[<strong class="lq ik">'CLOUDINARY_CLOUD_NAME'</strong>]<br/>    <strong class="lq ik"><em class="lg">config</em></strong>.<strong class="lq ik">api_key = ENV</strong>[<strong class="lq ik">'CLOUDINARY_API_KEY'</strong>]<br/>    <strong class="lq ik"><em class="lg">config</em></strong>.<strong class="lq ik">api_secret = ENV</strong>[<strong class="lq ik">'CLOUDINARY_API_SECRET'</strong>]<br/><strong class="lq ik">end<br/></strong></span></pre><p id="2feb" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">好吧，让我解释一下。我们正在动态安全地添加所有配置变量。我稍后会更详细地解释。</p><p id="ea93" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">打开<strong class="ji ik"><em class="lg">app/models/pic . Rb</em></strong>然后把这个。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="e5dc" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">class Pic &lt; ApplicationRecord<br/>    mount_uploader :image</strong>, <strong class="lq ik">ImageUploader<br/>end</strong></span></pre><p id="0192" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后运行<code class="eh ma mb mc lq b">rails db:migrate</code>来添加我们的模式。你的<strong class="ji ik"> <em class="lg"> db/schema.rb </em> </strong>应该是这样的:</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="20d3" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">create_table "pics"</strong>, <strong class="lq ik">force</strong>: <strong class="lq ik">:cascade do |<em class="lg">t</em>|<br/>  <em class="lg">t</em></strong>.<strong class="lq ik">datetime "created_at"</strong>, <strong class="lq ik">null</strong>: <strong class="lq ik">false<br/>  <em class="lg">t</em></strong>.<strong class="lq ik">datetime "updated_at"</strong>, <strong class="lq ik">null</strong>: <strong class="lq ik">false<br/>end</strong></span></pre><p id="e783" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在我们将生成一个迁移，将我们的<em class="lg">图像上传器</em>添加到<em class="lg"> pic模型中。</em></p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="edce" class="lu lv ij lq b fv lw lx l ly lz">rails generate <!-- -->migration add_image_to_pic</span></pre><p id="47d4" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">打开你的<strong class="ji ik"> <em class="lg"> &lt;时间戳&gt;_ add _ image _ to _ pic . Rb</em></strong>加上这个。</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="25ea" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">class AddImageToPic &lt; ActiveRecord</strong>::<strong class="lq ik">Migration</strong>[<strong class="lq ik">5.0</strong>]<br/>    <strong class="lq ik">def <em class="lg">change<br/>        </em>add_column :pics</strong>, <strong class="lq ik">:image</strong>, <strong class="lq ik">:string<br/>    end<br/>end</strong></span></pre><p id="a974" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后运行<code class="eh ma mb mc lq b">rails db:migrate</code>将其添加到我们的模式中。</p><p id="17d2" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">太好了，我们的数据库部分已经完成，现在我们要将CRUD功能添加到我们的应用程序中。</p><p id="2715" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这样打开你的<strong class="ji ik"> <em class="lg"> routes.rb </em> </strong>文件</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="d223" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">resources :pics</strong></span></pre><p id="390f" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们通过在您的终端中执行<strong class="ji ik"> <em class="lg">铁路路线</em> </strong>来检查我们的路线。你应该知道所有的行动路线。</p><p id="4363" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在你的<strong class="ji ik"><em class="lg">pics _ controller . Rb</em></strong>中创建所有这样的动作方法</p><pre class="ll lm ln lo fq lp lq lr ls aw lt dt"><span id="d95e" class="lu lv ij lq b fv lw lx l ly lz"><strong class="lq ik">class PicsController &lt; ApplicationController<br/>  def <em class="lg">index<br/>  </em>end<br/><br/>  def new<br/>  end<br/><br/>  def <em class="lg">create<br/>  </em>end<br/><br/>  def <em class="lg">edit<br/>  </em>end<br/><br/>  def <em class="lg">show<br/>  </em>end<br/><br/>  def <em class="lg">update<br/>  </em>end<br/><br/>  def <em class="lg">destroy<br/>  </em>end<br/>end</strong></span></pre><blockquote class="ld le lf"><p id="b747" class="jg jh lg ji b jj jk jl jm jn jo jp jq lh js jt ju li jw jx jy lj ka kb kc kd hn dt translated">谢谢大家到目前为止的阅读，希望你们喜欢。在下一部分中，我们将完成我们的应用程序并将其投入使用。下次再见。</p></blockquote></div><div class="ab cl md me hc mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hn ho hp hq hr"><figure class="ll lm ln lo fq hw"><div class="bz el l di"><div class="mk ml l"/></div></figure><figure class="ll lm ln lo fq hw"><div class="bz el l di"><div class="mk ml l"/></div></figure></div></div>    
</body>
</html>