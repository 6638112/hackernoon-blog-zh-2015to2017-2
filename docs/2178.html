<html>
<head>
<title>Tutorial: Creating and managing a Node.js server on AWS, part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:在AWS上创建和管理Node.js服务器，第2部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/tutorial-creating-and-managing-a-node-js-server-on-aws-part-2-5fbdea95f8a1?source=collection_archive---------0-----------------------#2017-01-11">https://medium.com/hackernoon/tutorial-creating-and-managing-a-node-js-server-on-aws-part-2-5fbdea95f8a1?source=collection_archive---------0-----------------------#2017-01-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="4f2d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第1部分中，我们启动了一个服务器，在端口3000上响应HTTP请求。在本教程中，我们将看4个概念</p><ul class=""><li id="a043" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">在标准端口上提供HTTP流量，<code class="eh jz ka kb kc b">80</code></li><li id="7459" class="jq jr hu it b iu kd iy ke jc kf jg kg jk kh jo jv jw jx jy dt translated">保持Node.js进程运行</li><li id="7d86" class="jq jr hu it b iu kd iy ke jc kf jg kg jk kh jo jv jw jx jy dt translated">将代码部署到服务器中</li><li id="9fd0" class="jq jr hu it b iu kd iy ke jc kf jg kg jk kh jo jv jw jx jy dt translated">提供一些HTML</li></ul><h1 id="a1fa" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">在标准端口上提供HTTP流量，80</h1><p id="b019" class="pw-post-body-paragraph ir is hu it b iu lg iw ix iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo hn dt translated">将此URL粘贴到新选项卡的URL栏中。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="d753" class="lt kj hu kc b fv lu lv l lw lx"><a class="ae jp" href="http://imgur.com:80/" rel="noopener ugc nofollow" target="_blank">http://imgur.com:80/</a></span></pre><p id="188b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你会注意到<code class="eh jz ka kb kc b">80</code>被放到了地址栏中。这是因为端口<code class="eh jz ka kb kc b">80 </code>是HTTP流量的默认端口。</p><p id="1771" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">HTTPS交通用港<code class="eh jz ka kb kc b">443</code>。试试黑客新闻。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="0acd" class="lt kj hu kc b fv lu lv l lw lx"><a class="ae jp" href="https://news.ycombinator.com/" rel="noopener ugc nofollow" target="_blank">https://news.ycombinator.com</a><a class="ae jp" href="https://www.google.com:443/" rel="noopener ugc nofollow" target="_blank">:443/</a></span></pre><p id="bb65" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因为这些端口通常是公共的，所以您需要特殊权限来运行使用它们的进程。此外，在端口<code class="eh jz ka kb kc b">80</code>或<code class="eh jz ka kb kc b">443</code>上直接运行Node.js并不好，因为你可能想在这些端口上打开一些不同的应用程序。有了路由器，你将能够从端口<code class="eh jz ka kb kc b">80</code>或<code class="eh jz ka kb kc b">443</code>向任何你想要的程序发送流量，这取决于传入的HTTP请求的报头。</p><p id="76f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于路由器来说，很少有很好的选择，但是我发现nginx对于大多数事情来说是最好的工具。它非常适合构建您的第一个应用程序，或者当您需要扩展到数百万访问者时。</p><p id="99b9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在开始之前，如果你的服务器已经停止，启动它并SSH进入(如上一个教程所示<a class="ae jp" href="https://hackernoon.com/tutorial-creating-and-managing-a-node-js-server-on-aws-part-1-d67367ac5171" rel="noopener ugc nofollow" target="_blank">)。一旦登录，我们就可以安装<strong class="it hv"> <em class="ly"> nginx </em> </strong>。</a></p><p id="7d57" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Ubuntu自带包管理器，<strong class="it hv"> <em class="ly"> apt-get </em> </strong>。使用<strong class="it hv"> <em class="ly"> apt-get </em> </strong>，我们可以在一个命令中安装<strong class="it hv"> <em class="ly"> nginx </em> </strong>。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="b66a" class="lt kj hu kc b fv lu lv l lw lx">sudo apt-get install nginx</span></pre><p id="9667" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">大多数Linux发行版都有一个包管理器，所以如果<strong class="it hv"> <em class="ly"> apt-get </em> </strong>不起作用，就用谷歌搜索你的版本。<strong class="it hv"> <em class="ly"> apt-get </em> </strong>在安装后会自动运行nginx，所以你现在应该让它在端口<code class="eh jz ka kb kc b">80</code>上运行，通过在浏览器中输入你的公共DNS URL进行检查。</p><figure class="ll lm ln lo fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff lz"><img src="../Images/067a9576b2b84a06a418504ab3be369f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUYY-2e61Rm8ZgYZ-0WKaQ.png"/></div></div><figcaption class="mh mi fg fe ff mj mk bd b be z ek">Default nginx page</figcaption></figure><p id="97da" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果这不起作用，您可能需要手动启动它。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="ba8d" class="lt kj hu kc b fv lu lv l lw lx">sudo /etc/init.d/nginx start</span></pre><p id="0231" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你仍然不能到达服务器，那么检查堆栈溢出或在这里发表评论。</p><p id="4aa7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们需要配置<strong class="it hv"> <em class="ly"> nginx </em> </strong>将端口<code class="eh jz ka kb kc b">80</code>的流量路由到端口<code class="eh jz ka kb kc b">3000</code>。<strong class="it hv"> <em class="ly"> nginx </em> </strong>将config放在了<code class="eh jz ka kb kc b">/etc/nginx/sites-available</code>文件夹中，那里已经有一个默认的config服务于我们之前看到的<strong class="it hv"> <em class="ly"> nginx </em> </strong>欢迎页面。</p><p id="1c44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以使用cat查看这个配置。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="d75f" class="lt kj hu kc b fv lu lv l lw lx">cat /etc/nginx/sites-<!-- -->available<!-- -->/default</span></pre><p id="9f4f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如何设置<strong class="it hv"> <em class="ly"> nginx </em> </strong>配置？配置以任何名称存储在<code class="eh jz ka kb kc b">sites-available</code>的纯文本文件中。将它们链接到<code class="eh jz ka kb kc b">sites-enabled</code>文件夹会导致它们在<strong class="it hv"> <em class="ly"> nginx </em> </strong>启动时被读取和使用。所有的配置通过<strong class="it hv"> <em class="ly"> nginx </em> </strong>组合在一起。</p><p id="e468" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们首先从<code class="eh jz ka kb kc b">sites-enabled</code>中删除默认配置，我们将把它留在<code class="eh jz ka kb kc b">sites-available</code>中以供参考。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="9893" class="lt kj hu kc b fv lu lv l lw lx">sudo rm /etc/nginx/sites-<!-- -->enabled<!-- -->/default</span></pre><p id="7b4e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<code class="eh jz ka kb kc b">sites-available</code>中创建一个配置文件，并随意命名。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="3e90" class="lt kj hu kc b fv lu lv l lw lx">sudo nano /etc/nginx/sites-<!-- -->available<!-- -->/tutorial</span></pre><p id="03fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是我们将要使用的配置。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="d0c5" class="lt kj hu kc b fv lu lv l lw lx">server {<br/>  listen 80;<br/>  server_name tutorial;<br/>  location / {<br/>    proxy_set_header  X-Real-IP  $remote_addr;<br/>    proxy_set_header  Host       $http_host;<br/>    proxy_pass        <a class="ae jp" href="http://127.0.0.1:3000;" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:3000;</a><br/>  }<br/>}</span></pre><p id="5662" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将把所有HTTP流量从端口<code class="eh jz ka kb kc b">80</code>转发到端口<code class="eh jz ka kb kc b">3000</code>。</p><p id="4a08" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">链接<code class="eh jz ka kb kc b">sites enabled</code>中的配置文件(这将使文件看起来像是在<code class="eh jz ka kb kc b">sites-enabled</code>中实际复制的)。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="0b0e" class="lt kj hu kc b fv lu lv l lw lx">sudo ln -s /etc/nginx/sites-available/tutorial /etc/nginx/sites-enabled/tutorial</span></pre><p id="25f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果不熟悉符号链接，请在此阅读更多相关内容。</p><p id="c945" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">重启<strong class="it hv"> <em class="ly"> nginx </em> </strong>让新配置生效。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="10e5" class="lt kj hu kc b fv lu lv l lw lx">sudo service nginx restart</span></pre><p id="667a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果自上一教程以来您没有停止/启动服务器，那么您的节点应用程序可能仍在运行。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="9880" class="lt kj hu kc b fv lu lv l lw lx"># list background jobs<br/>jobs</span></pre><p id="8870" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您的应用程序出现，那么没有必要再次运行它。如果它没有运行，那么您需要启动它。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="eee5" class="lt kj hu kc b fv lu lv l lw lx">node tutorial/index.js</span></pre><p id="9843" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦服务器开始运行，按下<code class="eh jz ka kb kc b">ctrl+z</code>，然后作为后台任务恢复运行。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="cc61" class="lt kj hu kc b fv lu lv l lw lx">bg %1</span></pre><p id="3d80" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在使用端口<code class="eh jz ka kb kc b">80</code>访问您的服务器的公共DNS URL。</p><figure class="ll lm ln lo fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff lz"><img src="../Images/ad1456ad835670ef39d7ae76269bf8ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJuDpQ6q_gH8xohJtOf35w.png"/></div></div></figure><p id="07e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">服务器正在端口<code class="eh jz ka kb kc b">80</code>上运行！</p><h1 id="f168" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">保持Node.js进程运行</h1><p id="d6c4" class="pw-post-body-paragraph ir is hu it b iu lg iw ix iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo hn dt translated">使用<code class="eh jz ka kb kc b">ctrl+z</code>暂停一个进程，然后在后台运行它，这相当繁琐。此外，这样做不会允许Node.js进程在更新或崩溃后重新启动服务器时重新启动。</p><p id="484a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在继续之前，停止正在运行的节点进程</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="fe02" class="lt kj hu kc b fv lu lv l lw lx"># Nukes all Node processes<br/>killall -9 node</span></pre><p id="14f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了保持这些进程的运行，我们将使用一个名为<a class="ae jp" href="http://pm2.keymetrics.io/" rel="noopener ugc nofollow" target="_blank"> PM2 </a>的伟大的NPM包。在SSH会话中，全局安装PM2。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="0492" class="lt kj hu kc b fv lu lv l lw lx">npm i -g pm2</span></pre><p id="3a5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要启动您的服务器，只需使用<code class="eh jz ka kb kc b">pm2</code>来执行<code class="eh jz ka kb kc b">index.js</code>。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="f25c" class="lt kj hu kc b fv lu lv l lw lx">pm2 start tutorial/index.js</span></pre><p id="3ca6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">若要确保PM2在服务器重新启动时重新启动</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="7f6b" class="lt kj hu kc b fv lu lv l lw lx">pm2 startup</span></pre><p id="1385" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将打印出一行代码，根据您使用的服务器，您需要运行这些代码。运行它输出的代码。</p><p id="1a15" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，保存当前正在运行的进程，以便它们在PM2重新启动时运行。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="9dd3" class="lt kj hu kc b fv lu lv l lw lx">pm2 save</span></pre><p id="eca2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！您可以注销/登录SSH，甚至重启您的服务器，它将继续在端口80上运行。</p><p id="549e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要列出所有进程，请使用</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="f398" class="lt kj hu kc b fv lu lv l lw lx">pm2 ls</span></pre><p id="b140" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您的进程将有一个非常通用的名字，类似于<code class="eh jz ka kb kc b">index</code>，如果服务器上还运行着其他一些微服务，这将很难区分。让我们停止这个过程，删除它，用一个更好的名字重新开始。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="84e3" class="lt kj hu kc b fv lu lv l lw lx"># Use the number listed in pm2 ls<br/># to stop the daemon<br/>pm2 stop index</span><span id="e64f" class="lt kj hu kc b fv ml lv l lw lx"># Remove it from the list<br/>pm2 delete index</span><span id="fff9" class="lt kj hu kc b fv ml lv l lw lx"># Start it again, but give it a<br/># catchy name<br/>pm2 start tutorial/index.js --name “Tutorial”</span></pre><p id="c539" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">太好了！查看<a class="ae jp" href="http://pm2.keymetrics.io/" rel="noopener ugc nofollow" target="_blank"> PM2文档</a>,看看你还能用流程管理做些什么。</p><h1 id="2917" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">将代码部署到服务器中</h1><p id="8d56" class="pw-post-body-paragraph ir is hu it b iu lg iw ix iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo hn dt translated">让我们不要在SSH会话中编写代码，而是将代码推送到Github中的git repo，SSH到服务器中并拉入新代码。</p><p id="4031" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">去<a class="ae jp" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> Github </a>或者你最喜欢的源码控制网站，登录并创建一个新的存储库，命名为你喜欢的。如果你不能保密，那就公开吧(没关系，反正没人会看)。</p><figure class="ll lm ln lo fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mm"><img src="../Images/9986a644ffa6548933a889c706a32a58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-J63Z8cg_--d91hiUVvoQ.png"/></div></div></figure><p id="3be7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本地创建一个新的目录，放入你喜欢的代码项目<strong class="it hv">(顺便说一下，要退出一个SSH会话，只需键入<code class="eh jz ka kb kc b">exit</code>)。我兴致勃勃又充满想象力地给我的命名为“tutorial-pt-2”。</strong></p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="97a1" class="lt kj hu kc b fv lu lv l lw lx">cd ~/Code<br/>mkdir tutorial-pt-2<br/>cd tutorial-pt-2</span></pre><p id="7a7a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在设置您的源，进行一次空提交并将其向上推，将您的上游分支设置为主分支。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="2dd1" class="lt kj hu kc b fv lu lv l lw lx">git init<br/>git commit --allow-empty -m "Well this is my first commit, *yay*"</span><span id="098e" class="lt kj hu kc b fv ml lv l lw lx"># Use your repo's origin URL here<br/>git remote add origin <a class="ae jp" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:roberttod/tutorial-pt-2.git<br/>git push -u origin master</span></pre><p id="2f41" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://coderwall.com/p/m_pgbg/start-git-repos-with-an-empty-commit" rel="noopener ugc nofollow" target="_blank">从一个空的提交开始很好</a>:)。</p><p id="50b2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">像我们在服务器上做的那样，运行<code class="eh jz ka kb kc b">npm init</code>，然后使用上一篇教程中的相同代码创建一个<code class="eh jz ka kb kc b">index.js</code>文件。<strong class="it hv"> <em class="ly"> P.S .我故意漏掉了</em> </strong> <code class="eh jz ka kb kc b"><strong class="it hv"><em class="ly">;</em></strong></code> <strong class="it hv"> <em class="ly"> s，检出了</em> </strong> <a class="ae jp" href="https://github.com/feross/standard" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv"> <em class="ly">标准样式</em> </strong> </a> <strong class="it hv"> <em class="ly">。</em> </strong></p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="003d" class="lt kj hu kc b fv lu lv l lw lx">const express = require('express')<br/>const app = express()<br/>app.get('/', (req, res) =&gt; {<br/>  res.send('HEY!')<br/>})</span><span id="6bc0" class="lt kj hu kc b fv ml lv l lw lx">app.listen(3000, () =&gt; console.log('Server running on port 3000'))</span></pre><p id="fa96" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">NPM快速安装</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="24c0" class="lt kj hu kc b fv lu lv l lw lx">npm install express --save</span></pre><p id="4433" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">另外，让我们添加一个<code class="eh jz ka kb kc b">.gitignore</code>文件，这样我们就不会签入<code class="eh jz ka kb kc b">node_modules</code>目录。<code class="eh jz ka kb kc b">.DS_Store</code>文件总是被OSX添加到目录中，它们包含文件夹元数据。我们也想忽略这些。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="105a" class="lt kj hu kc b fv lu lv l lw lx">node_modules<br/>.DS_Store</span></pre><p id="a93e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一般来说，最好只签入你真正需要签入的代码，如果你发现自己的git repo中有大量复制的或库代码，那么可能有更好的方法。</p><p id="6b6a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在添加你所有的代码并把它推上来</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="9f78" class="lt kj hu kc b fv lu lv l lw lx">git add .<br/>git commit -m "Ze server."<br/>git push</span></pre><p id="7562" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们需要将代码放入服务器。这就是事情有点棘手的地方。</p><p id="3411" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们需要SSH进入服务器，生成一个SSH私有/公共密钥对，然后将其作为部署密钥添加到源代码控制中(即Github)。只有当服务器被允许访问远程repo时，它才能够克隆代码并下载更改。</p><p id="1f3d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">SSH到您的服务器并生成密钥对。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="a082" class="lt kj hu kc b fv lu lv l lw lx"># When prompted, use the default name.<br/># No need for a pass phrase.<br/>ssh-keygen -t rsa</span></pre><p id="30f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">显示文件的内容</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="3dd5" class="lt kj hu kc b fv lu lv l lw lx">cat ~/.ssh/id_rsa.pub</span></pre><p id="ce9a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">选择密钥的内容并将其复制到Github中。部署键添加到repo设置中的<strong class="it hv"> <em class="ly">部署键</em> </strong>部分。</p><figure class="ll lm ln lo fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mn"><img src="../Images/8d5b6f8b9c72e79876ddbeff6ee2fe64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HMWr0HE17bceQknNVZEOg.png"/></div></div></figure><p id="6418" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">粘贴您的密钥，并将其命名为有意义的内容。</p><p id="22ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每当您通过SSH登录时，您都希望添加密钥，以便使用它们对Github进行认证。为此，将这些行添加到您的<code class="eh jz ka kb kc b">~/.bashrc</code>文件的顶部。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="5d95" class="lt kj hu kc b fv lu lv l lw lx"># Start the SSH agent<br/>eval `ssh-agent -s`</span><span id="c423" class="lt kj hu kc b fv ml lv l lw lx"># Add the SSH key<br/>ssh-add</span></pre><p id="60c6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将确保您在登录服务器时使用这些密钥。要在不注销的情况下运行代码，请执行<code class="eh jz ka kb kc b">.bashrc</code>文件</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="86fb" class="lt kj hu kc b fv lu lv l lw lx">source ~/.bashrc</span></pre><p id="10db" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们可以克隆回购协议了！删除服务器和用户目录中以前的任何代码，克隆repo</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="e390" class="lt kj hu kc b fv lu lv l lw lx"># You should use your own git URL.<br/>git clone git@github.com:roberttod/tutorial-pt-2.git</span></pre><p id="b466" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果成功的话，它会允许你输入“yes”将github添加为一个已知的主机，然后回购将被下载。</p><p id="832e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在一个美好的世界里，我们喜欢完全避免使用SSH。对于部署，我们将使用PM2，以便在服务器上克隆git，并提供一些额外的功能。</p><p id="74b0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在使用PM2之前，将刚刚从git中提取的代码删除到服务器中。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="9f53" class="lt kj hu kc b fv lu lv l lw lx">rm -rf ~/tutorial-pt-2</span></pre><p id="891f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您仍在SSH会话中时，请确保PM2上没有正在运行的进程，如果有，请删除它们。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="11b2" class="lt kj hu kc b fv lu lv l lw lx">pm2 ls</span><span id="b9aa" class="lt kj hu kc b fv ml lv l lw lx"># Only do this if a task is still running<br/>pm2 delete tutorial</span></pre><p id="8274" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在项目的本地版本中，全局安装PM2</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="6101" class="lt kj hu kc b fv lu lv l lw lx">npm i -g pm2</span></pre><p id="e73a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们需要添加一个PM2可以读取的配置文件，以便它知道如何部署。</p><p id="c03c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">PM2配置在<a class="ae jp" href="http://pm2.keymetrics.io/docs/usage/application-declaration/" rel="noopener ugc nofollow" target="_blank"> PM2文档</a>中有完整解释。配置文件可以自动生成，但我更喜欢从头开始创建自己的文件，避免任何我不需要的配置。</p><p id="262e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">配置文件应该被命名为<code class="eh jz ka kb kc b">ecosystem.config.js</code>，看起来应该像这样</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="6d37" class="lt kj hu kc b fv lu lv l lw lx">module.exports = {<br/>  apps: [{<br/>    name: 'tutorial-2',<br/>    script: './index.js'<br/>  }],<br/>  deploy: {<br/>    production: {<br/>      user: 'ubuntu',<br/>      host: 'ec2-52-209-166-225.eu-west-1.compute.amazonaws.com',<br/>      key: '~/.ssh/tutorial-2.pem',<br/>      ref: 'origin/master',<br/>      repo: '<a class="ae jp" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:roberttod/tutorial-pt-2.git',<br/>      path: '/home/ubuntu/tutorial-2',<br/>      'post-deploy': 'npm install &amp;&amp; pm2 startOrRestart ecosystem.config.js'<br/>    }<br/>  }<br/>}</span></pre><p id="f5ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您需要在配置文件中添加您自己的主机。</p><p id="25ef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">PM2如何使用这个配置文件？当您运行<code class="eh jz ka kb kc b">pm2 deploy ...</code>时，PM2 ssh到您的服务器，将您的repo克隆到<code class="eh jz ka kb kc b">path</code>中指定的目录，然后它在服务器上运行<code class="eh jz ka kb kc b">post-deploy</code>(因此它使用服务器上全局安装的PM2启动您的服务器)。部署之后，您将能够在服务器上运行<code class="eh jz ka kb kc b">pm2 ls</code>来查看所有正在运行的应用程序，它们的名称将与配置文件中指定的名称相同。</p><p id="235d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">文件保存后，在遥控器上设置目录</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="516e" class="lt kj hu kc b fv lu lv l lw lx">pm2 deploy ecosystem.config.js production setup</span></pre><p id="c859" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果遇到任何认证问题，回头看看SSH代理的设置，确保没有遗漏任何东西。</p><p id="e74c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">设置完成后，提交并推送你的更改到Github，这样当它克隆时就会得到你的<code class="eh jz ka kb kc b">ecosystem.config.js</code>文件，这个文件将被用来在服务器上使用PM2启动你的应用。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="22f7" class="lt kj hu kc b fv lu lv l lw lx">git add .<br/>git commit -m "Setup PM2"<br/>git push</span></pre><p id="d14f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在您可以运行部署命令了</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="82f4" class="lt kj hu kc b fv lu lv l lw lx">pm2 deploy ecosystem.config.js production</span></pre><p id="47c3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这应该会出现一个错误，那就是没有找到<code class="eh jz ka kb kc b">npm</code>。</p><p id="2562" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">出现这种情况的原因是因为服务器的<code class="eh jz ka kb kc b">.bashrc</code>文件中的一些代码。如果shell不是<strong class="it hv"> <em class="ly">交互</em> </strong>，这段代码会停止文件的运行。与使用<code class="eh jz ka kb kc b">ssh</code>不同，PM2使用<strong class="it hv"> <em class="ly">非交互式</em> </strong>外壳登录服务器。NVM设置在<code class="eh jz ka kb kc b">.bashrc</code>文件中，所以PM2没有运行NVM，这增加了<code class="eh jz ka kb kc b">npm</code>可执行文件(因此出现了PM2的错误)。阅读更多关于交互式/非交互式外壳的信息。</p><p id="efd0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">SSH进入您的服务器并打开<code class="eh jz ka kb kc b">~/.bashrc</code>文件。排除<strong class="it hv"> <em class="ly">非交互</em> </strong>会话的代码在顶部附近。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="5d3b" class="lt kj hu kc b fv lu lv l lw lx"># If not running interactively, don't do anything</span><span id="9935" class="lt kj hu kc b fv ml lv l lw lx">case $- in<br/>  *i*) ;;<br/>  *) return;;<br/>esac</span></pre><p id="ea97" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个代码是一些神奇的巴什狗屎。我们所要做的就是将NVM代码移动到这个代码上面，这样它总是会执行。找到下列行，并将其移动到case语句的上方</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="a58a" class="lt kj hu kc b fv lu lv l lw lx">export NVM_DIR="/home/ubuntu/.nvm"<br/>[ -s "$NVM_DIR/nvm.sh" ] &amp;&amp; . "$NVM_DIR/nvm.sh"  # This loads nvm</span></pre><p id="f6c5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">保存并退出。</p><p id="bdbe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回到本地终端，再次尝试运行PM2部署</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="023c" class="lt kj hu kc b fv lu lv l lw lx">pm2 deploy ecosystem.config.js production</span></pre><p id="bc21" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这次应该管用！并且当您在浏览器中签入时，您的服务器应该仍在运行。</p><p id="f194" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在服务器上使用全局PM2，在客户机上使用全局PM2有点麻烦。如果我们的代码使用PM2包的本地版本会更好。为此，向您的<code class="eh jz ka kb kc b">package.json</code>添加一个<code class="eh jz ka kb kc b">deploy</code>和<code class="eh jz ka kb kc b">restart</code>脚本</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="9ed0" class="lt kj hu kc b fv lu lv l lw lx">...<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "restart": "pm2 startOrRestart ecosystem.config.js",<br/>    "deploy": "pm2 deploy ecosystem.config.js production",<br/>    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"<br/>  },<br/>  "repository": {<br/>...</span></pre><p id="e22b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用<code class="eh jz ka kb kc b">--save-dev</code>在本地安装PM2并保存</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="7b38" class="lt kj hu kc b fv lu lv l lw lx">npm i pm2 --save-dev</span></pre><p id="77b9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于那些不太熟悉NPM的人来说，添加<code class="eh jz ka kb kc b">--save</code>或<code class="eh jz ka kb kc b">--save-dev</code>会添加这个包，以及<code class="eh jz ka kb kc b">package.json</code>的版本号。<code class="eh jz ka kb kc b">package.json</code>文件中的任何包都会在运行<code class="eh jz ka kb kc b">npm install</code>时被安装，这发生在PM2 <code class="eh jz ka kb kc b">post-deploy</code>。</p><p id="af55" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在部署之前，提交您的所有更改并推送到git。</p><p id="cfb9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当你运行<code class="eh jz ka kb kc b">npm deploy</code>时，它将使用PM2的本地版本。整洁！</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="893f" class="lt kj hu kc b fv lu lv l lw lx">npm run-script deploy</span></pre><p id="4fff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你发现你的应用没有运行，检查你服务器上的PM2日志，位于<code class="eh jz ka kb kc b">~/.pm2/logs/</code>。</p><p id="2de5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要确保应用程序在服务器重启时重启，请使用SSH重新进入服务器并运行</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="b387" class="lt kj hu kc b fv lu lv l lw lx">pm2 save</span></pre><p id="d2c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">唯一运行的PM2进程应该是您部署的服务器，因此PM2将确保它始终保持运行。</p><h1 id="4b13" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">提供HTML</h1><p id="101a" class="pw-post-body-paragraph ir is hu it b iu lg iw ix iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo hn dt translated">在结束本教程之前，让我们使用我们的部署设置来更改服务器，使其服务于HTML，而不只是用“嘿”来响应。</p><p id="74f4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">删除<code class="eh jz ka kb kc b">/</code>的路由处理程序，并设置一个静态目录，express将使用该目录来提供静态文件。</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="b41d" class="lt kj hu kc b fv lu lv l lw lx">const express = require('express')<br/>const app = express()</span><span id="f4e9" class="lt kj hu kc b fv ml lv l lw lx">app.use(express.static('public'))<br/>app.listen(3000, () =&gt; console.log('Server running on port 3000'))</span></pre><p id="d0b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通过用“public”调用<code class="eh jz ka kb kc b">express.static</code>，静态文件将从<code class="eh jz ka kb kc b">public</code>目录提供。如果我们在<code class="eh jz ka kb kc b">/public</code>中添加一个<code class="eh jz ka kb kc b">index.html</code>，那么这将由express在<code class="eh jz ka kb kc b">/</code>中自动提供(如果我们留下一个自定义的<code class="eh jz ka kb kc b">/</code>处理程序，那么它将覆盖这个功能)。</p><p id="2916" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<code class="eh jz ka kb kc b">public/index.html</code>中保存一个简单的HTML文件</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="43a3" class="lt kj hu kc b fv lu lv l lw lx">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;Erm hey.&lt;/title&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;img src="<a class="ae jp" href="https://media.giphy.com/media/3o6Zt7aSSZLX6U5WtW/source.gif" rel="noopener ugc nofollow" target="_blank">https://media.giphy.com/media/3o6Zt7aSSZLX6U5WtW/source.gif</a>"&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="4759" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">提交这些更改(也许您可以通过在本地运行<code class="eh jz ka kb kc b">node index.js</code>并访问<a class="ae jp" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>来检查服务器是否仍然工作)。</p><p id="203f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">部署变更</p><pre class="ll lm ln lo fq lp kc lq lr aw ls dt"><span id="0334" class="lt kj hu kc b fv lu lv l lw lx">npm run-script deploy</span></pre><p id="ef4f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您的服务器现在将使用您的静态HTML页面进行响应。</p><figure class="ll lm ln lo fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mo"><img src="../Images/44300877e5b9f63402f22e875562472a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eVufB3ETrKZiZVr4nH__6g.png"/></div></div></figure><h1 id="d8d9" class="ki kj hu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dt translated">结论</h1><p id="5896" class="pw-post-body-paragraph ir is hu it b iu lg iw ix iy lh ja jb jc li je jf jg lj ji jj jk lk jm jn jo hn dt translated">您现在应该有一个简单的express应用程序，它很容易部署在EC2上，运行在端口<code class="eh jz ka kb kc b">80</code>上。我公开了我的源代码，以防你想看一看<a class="ae jp" href="https://github.com/roberttod/tutorial-pt-2" rel="noopener ugc nofollow" target="_blank">https://github.com/roberttod/tutorial-pt-2</a>。</p><p id="da26" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢这个教程，我正在做更多的解释<a class="ae jp" rel="noopener" href="/@bobtodski/setting-up-node-js-with-a-database-part-1-3f2461bdd77f">如何用MySQL </a>设置节点。</p><div class="ll lm ln lo fq ab cb"><figure class="mp ma mq mr ms mt mu paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mp ma mq mr ms mt mu paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mp ma mq mr ms mt mu paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mv mw mx"><p id="f922" class="ir is ly it b iu iv iw ix iy iz ja jb my jd je jf mz jh ji jj na jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>，并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is ly it b iu iv iw ix iy iz ja jb my jd je jf mz jh ji jj na jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="ll lm ln lo fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff nb"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>