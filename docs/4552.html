<html>
<head>
<title>Performance Testing in a Distributed Computing World — From Mobile and Beyond</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分布式计算世界中的性能测试——从移动到其他</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/performance-testing-in-a-distributed-computing-world-from-mobile-and-beyond-aa411461a7e0?source=collection_archive---------9-----------------------#2017-06-07">https://medium.com/hackernoon/performance-testing-in-a-distributed-computing-world-from-mobile-and-beyond-aa411461a7e0?source=collection_archive---------9-----------------------#2017-06-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c5eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">自从数字手表、电视、电话和阿波罗飞船的时代以来，计算已经发生了很大的变化——在那些时代，软件组件(称为嵌入式软件)仅仅是作为一种控制专门硬件的手段而存在，而这些硬件通常不被认为是计算机。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/3facd37ad0706045f734f82e2a9191dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_0P-bb25mm-NuFhKF6m5Q.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Apollo Guidance Computer. <em class="kg">Photo credit: Wikimedia.</em></figcaption></figure><h1 id="3242" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">前浏览器时代的测试</h1><p id="9268" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">就在几十年前，计算还是一个仅限于个人电脑(PC)的术语，人们用它来处理电子表格(VisiCalc、Lotus)和其他桌面应用程序，例如人们偶尔通过局域网或互联网连接的电子邮件客户端。考虑到有限的内存和计算能力，软件应用程序是轻量级的。这些软件本应在少数专用硬件/计算机上运行，因此，测试主要意味着<strong class="it hv">功能测试</strong> <strong class="it hv">而不是性能测试</strong>——尽管开发人员不得不将性能作为开发的一个组成部分，甚至让软件在有限的资源上工作。</p><h1 id="aa1d" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">互联网时代的测试</h1><p id="8f79" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">浏览器的引入和互联网连接的发展大规模地开启了客户机-服务器计算。新的SaaS软件公司为每一个垂直行业而生CRM的Salesforce，文件共享的Dropbox，GMail而不是电子邮件客户端。更成熟、更实惠的海量存储和面向服务的架构的出现见证了云计算在各个领域的正式建立。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff lk"><img src="../Images/1fe8a600e4b831f5b04ce3f1707170af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CDaEs24lH97choQeKdQBMA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek"><em class="kg">Photo credit: Google.</em></figcaption></figure><p id="afa9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试和分析工具随着互联网的发展而发展。</p><p id="05bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">服务器端更加集中化和客户端的轻量级计算(通常是执行javascript代码的web浏览器)意味着服务器端可以使用更加复杂的工具——从应用程序监控(AppDynamics，New Relic)，机器数据分析(Splunk)到云监控(Amazon CloudWatch)。有了来自这些工具的如此丰富的数据以及与客户端交互的解耦，通过持续集成(CI)构建和部署来理解代码更改在现实世界(生产环境)中的表现只是时间问题。连续交付意味着除了成本和效率优势之外的可靠性。</p><p id="30ff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">CI有助于根本原因分析和数据支持的精确性。这个想法是减少受控环境中的变量，以观察新代码更改的效果。例如，脸书开发了一个工具，它能以95%的置信度准确测量页面加载时间内小到20毫秒的变化。值得注意的是，客户端通常是简单呈现javascript函数的web浏览器，因此可以假定以确定的方式工作。</p><h1 id="5bc2" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated"><strong class="ak">转向移动</strong></h1><p id="c025" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">作为平台的<a class="ae jp" href="https://hackernoon.com/tagged/mobile" rel="noopener ugc nofollow" target="_blank">移动</a>应用的引入是走向<strong class="it hv">分布式计算</strong>的起点。然而，它确实释放了一个资源能力有限且分散的高度可变环境。仅仅有一个功能性的应用程序是不够的，还需要了解代码更改对性能的影响，这与它在PC/笔记本电脑上的工作方式不同。</p><blockquote class="ll"><p id="156d" class="lm ln hu bd lo lp lq lr ls lt lu jo ek translated">随着时间的推移，移动应用程序变得越来越复杂，即使影响性能的小变化也会无害地增加，直到它使应用程序交互变得缓慢，并消耗更多的数据、内存和电池。</p></blockquote><p id="d8d1" class="pw-post-body-paragraph ir is hu it b iu lv iw ix iy lw ja jb jc lx je jf jg ly ji jj jk lz jm jn jo hn dt translated">在一个高度碎片化的世界里，应用速度、数据使用和电池效率通常很难衡量。应用程序依赖于硬件组件，如运行不同操作系统版本(有些是定制版本)的不同OEM组装的来自不同制造商的蓝牙、信标和网络适配器，这使得隔离问题变得非常困难。现在，想象一下做A/B测试的复杂性。是在线(拉动测试资产)还是离线(硬编码到应用程序中)A/B测试，运行一组新的测试场景有多容易，以及如何解决冲突？</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ma"><img src="../Images/626487b1fc683ff7ebd1e502a153da0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5-pkwmMkIXgfe0TNpmO5A.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek"><em class="kg">Photo credit: Google.</em></figcaption></figure><p id="2acd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">构建一个系统来保持或提高开发速度，同时最大限度地减少性能(如速度、数据使用、电池消耗和内存占用)的倒退需要专门的过程。</p><h2 id="8284" class="mb ki hu bd kj mc md me kn mf mg mh kr jc mi mj kv jg mk ml kz jk mm mn ld mo dt translated">设计原理</h2><p id="ba61" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">虽然不可能在第一天就获得自动化的性能基础架构，但仅仅依靠生产分析数据来提高性能指标是不负责任的。构建一个复杂的系统需要时间，重要的是设计一个平台，在发布生命周期的每个阶段反映出<strong class="it hv">检测</strong>和<strong class="it hv">分析</strong>:</p><ol class=""><li id="8b92" class="mp mq hu it b iu iv iy iz jc mr jg ms jk mt jo mu mv mw mx dt translated"><strong class="it hv">模式(检测)</strong>:如果有可能早期捕获正确的指标，执行统计分析，并可能应用一些机器学习技术来预测任何潜在的问题，这将节省大量的时间和复杂性。</li><li id="0c09" class="mp mq hu it b iu my iy mz jc na jg nb jk nc jo mu mv mw mx dt translated"><strong class="it hv">诊断(分析)</strong>:一旦检测到模式，并且有了正确的数据，就更容易缩小根本原因的范围，并归因于特定的代码更改。</li></ol><p id="537e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每个发布生命周期——即开发、试运行和生产——都有一个基础的解决过程——检测和分析。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nd"><img src="../Images/1f3e67f46b5d62e44ba9cb7ead967f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OG3PkvHHBw0_hEcwV4Keog.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek"><em class="kg">Photo credit: New Media Labs.</em></figcaption></figure><h1 id="6b1f" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">移动发布生命周期</h1><p id="db73" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">运行在移动设备上的移动应用与设备硬件(网络适配器、固态硬盘磨损等)紧密相关，而不是明显的硬件规格或操作系统版本影响。在应用程序投入使用之前，通过群集设备(即使所有设备都是iPhones，但往往在SSD磨损等小细节上有所不同，从而对I/O密集型应用程序产生重大影响)来控制环境至关重要。</p><h2 id="813b" class="mb ki hu bd kj mc md me kn mf mg mh kr jc mi mj kv jg mk ml kz jk mm mn ld mo dt translated">发展</h2><p id="f3cf" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">这一阶段意味着开发人员要指定所需的配置(设备类型、操作系统版本、网络条件)并安排实验。系统运行A/B测试风格的实验——有和没有新的代码修订——并通知返回结果。实验时间的校准、预测准确性和对数据/结果的理解对于及时和可行的反馈至关重要。</p><p id="503a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">性能试验通常计算量大且耗时。此过程通常需要大约30-60分钟，其中可能受影响的场景/交互并行运行，作业在动态设备池上调度，尽可能共享足够的工件。这个过程并不意味着以一种全面的方式来捕捉回归或证明改进，因为它被设计为仅在关键场景下运行。目标主要是帮助开发人员快速迭代变更。</p><p id="cbee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要注意的是，性能实验通常是有噪声的，并且在快速周转时间的环境中很难得到确定性的结果。每次运行的数据点的分布视图和图表比绝对统计数据或分数更有助于理解(因为它们会受到小样本集中异常值的严重影响)。</p><h2 id="aae5" class="mb ki hu bd kj mc md me kn mf mg mh kr jc mi mj kv jg mk ml kz jk mm mn ld mo dt translated">脚手架</h2><p id="2daf" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">这个阶段需要两个组成部分——<strong class="it hv">连续实验</strong>和<strong class="it hv">分类。</strong></p><p id="4cc5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于进入主分支的每个提交，系统通过运行所有可能受影响的与代表性配置(设备类型和网络条件)的交互来完成繁重的工作。这些被称为连续实验的运行是计算密集型的，并且通常以每<em class="ne"> N </em>个差异运行(作为代码更改的结果)——取决于排队的作业和资源可用性。这里的目标是将性能指标变化归因于原子提交。</p><p id="4288" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">三元组和跟踪回归是一个计算量更大的过程，但对于确保应用程序的性能质量很重要。以上连续运行中的任何显著变化都会自动反馈到该阶段，并且会对给定范围内的每个修订(即N个差异)运行更多的分析实验。自定义分析脚本(通过stacktrace和其他元数据增强)通常用于帮助更好地诊断问题。</p><h2 id="7f86" class="mb ki hu bd kj mc md me kn mf mg mh kr jc mi mj kv jg mk ml kz jk mm mn ld mo dt translated">生产</h2><p id="b69a" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">实际上，不可能在受控环境中检测到所有性能指标变化。需要在现实世界中收集性能指标，以便进行更深入的分析。这里的目标不是针对市场上的每一款设备进行优化，而是确定那些具有统计学意义的性能指标。一个高效和有效的系统将在一小部分集群用户中随机抽取样本(根据设备的功能和应用程序在他们身上的功能)，以便在不影响用户体验的情况下获取指标。</p><h1 id="0cff" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">构建可扩展和可扩展的系统</h1><p id="4af0" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">为移动perf系统构建一个复杂的系统是一个漫长而艰难的过程。在能够以更全面的方式检测回归之前，将对连续的实验、诊断和分析运行进行逐步添加。还需要通过向设备机架/场添加不同的移动设备来支持它们。必须部署机器学习算法来构建更智能的分析和回归模型——一种是在适用时构建新的流，一种是自动比较对现有流的影响，一种是以模拟现实世界的方式优先考虑每个流的重要性，并相应地确定这些运行的频率。随着时间的推移，系统需要尽可能接近真实世界。一个持续学习的测试系统不仅能使每个版本稳定，同时也是面向未来的。</p><h2 id="0fac" class="mb ki hu bd kj mc md me kn mf mg mh kr jc mi mj kv jg mk ml kz jk mm mn ld mo dt translated">未来的计算设备</h2><p id="6110" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">越来越多的设备通过非凡的计算能力连接到互联网，例如能够在GPU上运行复杂的机器学习算法。如今，联网汽车上的无线软件更新已经成为常态。过去十年服务器端的集中计算能力现在正慢慢移回到客户端，以便能够以更自主的方式行动(例如自动驾驶汽车)，并充当智能代理(例如车对车通信)。在交叉路口模拟自我衍生的人工智能场景是一回事，另一方面，看看汽车如何与其他自动驾驶汽车一起协调不同的功能是完全不同的。当涉及到性能时，精度和可靠性必须成为基准规范，绝对不允许出现错误。不仅仅是自动驾驶汽车，分散式系统正在跨领域扩散——由复杂的传感器/硬件、人工智能、区块链技术实现——走向更加分布式的计算世界。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nf"><img src="../Images/deb49e1a8ece37845a20c9a039810954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rp5tep9Ma6as6SUKOjq1FQ.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek"><em class="kg">Photo credit: Google.</em></figcaption></figure><p id="ef2d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">性能测试需要并会适应这些变化，而非主动的测试最终会被淘汰。也许用不了多久，我们就会看到性能测试人工智能代理与人工智能代理协同工作，并在这些分布式计算设备中帮助彼此发展和共存。</p><p id="6117" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您需要问的问题是，您目前拥有什么样的系统。随着分布式设备增加了更多的计算能力，您的公司准备好应对这一阻碍性的结构性转变了吗？</p><p id="566f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意:上面提倡的设计原则不是我可以邀功的，它来自于<a class="ae jp" href="https://techcrunch.com/2016/07/13/facebook-lifts-the-veil-on-its-mobile-device-lab/" rel="noopener ugc nofollow" target="_blank"> CT-Scan </a>(由脸书开发)和其他公开来源。</p><div class="jr js jt ju fq ab cb"><figure class="ng jv nh ni nj nk nl paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="ng jv nh ni nj nk nl paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="ng jv nh ni nj nk nl paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="nm nn no"><p id="f922" class="ir is ne it b iu iv iw ix iy iz ja jb np jd je jf nq jh ji jj nr jl jm jn jo hn dt translated"><a class="ae jp" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae jp" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae jp" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jp" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="ir is ne it b iu iv iw ix iy iz ja jb np jd je jf nq jh ji jj nr jl jm jn jo hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jp" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jp" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ns"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="nt nu l"/></div></figure></div></div>    
</body>
</html>