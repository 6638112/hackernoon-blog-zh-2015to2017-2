<html>
<head>
<title>How to Build a Mobile Product Catalog App Using Angular JS, Ionic and Cosmic JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Angular JS、Ionic和Cosmic JS构建移动产品目录App</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-a-mobile-product-catalog-app-using-angular-js-ionic-and-cosmic-js-ca939517aba1?source=collection_archive---------7-----------------------#2017-05-18">https://medium.com/hackernoon/how-to-build-a-mobile-product-catalog-app-using-angular-js-ionic-and-cosmic-js-ca939517aba1?source=collection_archive---------7-----------------------#2017-05-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/ff58f76689e18c5a3debf4109be9751f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3b5lwg3jdqrKS9XNpOz0dA.jpeg"/></div></div></figure><p id="b917" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章最初出现在宇宙JS博客上。</p><h1 id="9fa8" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated"><strong class="ak">TL；博士</strong></h1><p id="eb36" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><a class="ae ka" href="https://github.com/cosmicjs/ionic-angular-app" rel="noopener ugc nofollow" target="_blank">在GitHub上查看代码库并遵循安装说明。</a></p><p id="aee7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本教程中，我将向您展示如何使用Cosmic JS和Ionic Framework创建一个简单的目录移动应用程序。</p><h1 id="83c6" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">先决条件</h1><p id="34b2" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">您需要预先安装node.js、npm和ionic cli。在开始之前确保你已经有了它们。请参考ionic docs如何做到这一点。你需要Ionic framework &gt;= 2.0来运行这个例子，所以要确保你有正确的Ionic版本:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="da53" class="ln kc hu lj b fv lo lp l lq lr">ionic -v</span></pre><h1 id="4135" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">入门指南</h1><p id="2c28" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">首先，我们需要创建一个离子项目。我们将使用标准选项卡模板，并将修改一个选项卡以保留我们的目录组件。因此，一旦安装了所有的先决条件，就需要设置新的Ionic项目:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="e71e" class="ln kc hu lj b fv lo lp l lq lr">ionic start cosmic-demo tabs --v2</span></pre><p id="cff8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">设置好这个项目后，您就可以运行了</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="0e03" class="ln kc hu lj b fv lo lp l lq lr">ionic serve</span></pre><p id="8573" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在浏览器中玩你的应用程序</p><h1 id="83c0" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">建立宇宙JS库</h1><p id="3319" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">首先安装Cosmic JS Angular/JavaScript库</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="06df" class="ln kc hu lj b fv lo lp l lq lr">npm install cosmicjs --save</span></pre><p id="d077" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在你应该能够导入宇宙对象并执行宇宙JS API调用，如下所示:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="25bd" class="ln kc hu lj b fv lo lp l lq lr">import Cosmic from 'cosmicjs';<br/>const bucket = { slug: 'your-bucket-slug' };</span><span id="208b" class="ln kc hu lj b fv ls lp l lq lr">Cosmic.getObjects({ bucket }, (err, res) =&gt; {<br/>  console.log(res.objects);<br/>});</span></pre><h1 id="bcd7" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">用宇宙JS设置事物</h1><p id="deff" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">创建桶并记住桶名(在我们的例子中是“宇宙离子”):</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lt"><img src="../Images/e481fe20a2c5e3963513556dd14d2aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l0lrfrrMG8RwkTlh.png"/></div></div></figure><p id="00c3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后创建一个名为“Category”的新对象类型，请记住对象类型slug(“categories”)。</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lu"><img src="../Images/c055a30b66cd8e023c48c1a18221ec40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZwPiaqM8GXlvdUS7.png"/></div></div></figure><p id="aa0c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们现在不需要任何额外的设置，所以只需设置名称和保存对象类型。保存后，您将被重定向到“新类别”页面。使用此页面创建一些类别并保存它们。</p><p id="4abb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在使用与类别相同的方法创建产品对象类型。但是我们有一个不同之处——请进入“图元字段模板”选项卡，并添加“图像/文件”类型的图元字段，关键字为“图像”。这个元字段将存储产品图像。</p><p id="dc07" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您需要添加的第二个元字段是“单个对象关系”。请创建这样的元字段，并将类别选择为“可供选择的对象类型”。</p><p id="abc1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这样的产品结构允许我们在产品和类别之间建立一对多的关系。</p><p id="175f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建产品对象类型后，请添加一些演示产品，并将它们分配到不同的类别。确保你在一个类别中有5个以上的产品——这让我们可以测试无限滚动。</p><h1 id="89e7" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">应用程序的离子部分</h1><p id="63ad" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">使用以下内容创建src/pages/categories _ list/categories _ list . ts文件:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="162c" class="ln kc hu lj b fv lo lp l lq lr">import { Component } from '@angular/core';<br/>import { NavController } from 'ionic-angular';<br/>import Cosmic from 'cosmicjs';<br/>import { ProductsList } from '../products_list/products_list';</span><span id="8b97" class="ln kc hu lj b fv ls lp l lq lr">@Component({<br/>    selector: 'page-categories',<br/>    templateUrl: 'categories_list.html'<br/>})<br/>export class CategoriesList {<br/>    public categories;</span><span id="52e7" class="ln kc hu lj b fv ls lp l lq lr">    constructor(<br/>        public navCtrl: NavController<br/>    ) {<br/>        this.categories = [];</span><span id="320f" class="ln kc hu lj b fv ls lp l lq lr">        Cosmic.getObjectType({<br/>            bucket: {<br/>                slug: 'cosmic-ionc'<br/>            }<br/>        }, {<br/>            type_slug: 'categories'<br/>        }, (err, res) =&gt; {<br/>            this.categories = res.objects.all;<br/>        });<br/>    }<br/>    navToCategory(category) {<br/>        this.navCtrl.push(ProductsList, { title: category.title, id: category._id });<br/>    }<br/>}</span></pre><p id="3ce2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后为CategoriesList组件创建模板:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="488c" class="ln kc hu lj b fv lo lp l lq lr">&lt;ion-header&gt;<br/>  &lt;ion-navbar&gt;<br/>    &lt;ion-title&gt;<br/>      Categories<br/>    &lt;/ion-title&gt;<br/>  &lt;/ion-navbar&gt;<br/>&lt;/ion-header&gt;<br/>&lt;ion-content padding&gt;<br/>    &lt;ion-list&gt;<br/>        &lt;button ion-item *ngFor="let category of categories" (click)="showProducts()"&gt;<br/>            {{ category.title }}<br/>        &lt;/button&gt;<br/>    &lt;/ion-list&gt;<br/>&lt;/ion-content&gt;</span></pre><p id="4f13" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">向app.module.ts添加CategoriesList组件，就像对HomePage等其他组件一样，并将其设置为TabsPage组件的第一个选项卡。</p><h1 id="245e" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这里发生了什么？</h1><p id="5be5" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">我们的类别列表组件在其构造函数中使用了Cosmic JS API来接收我们拥有的类别列表。它使用两种方法来实现所需的功能:</p><ul class=""><li id="baf5" class="lv lw hu je b jf jg jj jk jn lx jr ly jv lz jz ma mb mc md dt translated">通过宇宙JS桶过滤对象</li><li id="d01e" class="lv lw hu je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">按对象类型过滤对象</li></ul><p id="82fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">类别列表组件引用产品列表组件—一旦用户单击类别项目，它就会导航到产品列表页面。因此，我们需要ProductsList —组件，它将为我们显示每个特定类别的产品列表。来介绍一下吧！</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="bbc2" class="ln kc hu lj b fv lo lp l lq lr">import { Component } from '@angular/core';<br/>import { NavController, NavParams } from 'ionic-angular';<br/>import {Http} from '@angular/http';<br/>import { DomSanitizer } from '@angular/platform-browser'<br/>@Component({<br/>    selector: 'page-products-list',<br/>    templateUrl: 'products_list.html'<br/>})<br/>export class ProductsList {<br/>    public products;<br/>    public category_title;<br/>    constructor(<br/>        public navCtrl: NavController,<br/>        public params: NavParams,<br/>        public http: Http,<br/>        private sanitizer: DomSanitizer<br/>    ) {<br/>        this.products = [];<br/>        this.category_title = this.params.get('title');        this.http.get(`https://api.cosmicjs.com/v1/cosmic-ionc/object-type/products/search?metafield_key=category&amp;metafield_value=${this.params.get('id')}`).subscribe((resp) =&gt; {<br/>            let data = resp.json();<br/>            if (data.objects) {<br/>                this.products = data.objects;<br/>            }<br/>            else {<br/>                this.products = [];<br/>            }<br/>        });<br/>    }<br/>    getImageUrl(product) {<br/>        let url = product.metafields.find((v) =&gt; { return (v.key == 'image') }).value;<br/>        return `https://cosmicjs.imgix.net/${url}`;<br/>    }<br/>    sanContent(product): any {<br/>        return this.sanitizer.bypassSecurityTrustHtml(product.content);<br/>    }</span><span id="d712" class="ln kc hu lj b fv ls lp l lq lr">}</span></pre><p id="41d1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里我们有产品列表模板:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="8e39" class="ln kc hu lj b fv lo lp l lq lr">&lt;ion-header&gt;<br/>  &lt;ion-navbar&gt;<br/>    &lt;ion-title&gt;<br/>      {{ category_title }}<br/>    &lt;/ion-title&gt;<br/>  &lt;/ion-navbar&gt;<br/>&lt;/ion-header&gt;<br/>&lt;ion-content padding&gt;<br/>    &lt;ion-card ion-item *ngFor="let product of products"&gt;<br/>        &lt;img [src]="getImageUrl(product)" alt=""&gt;<br/>        &lt;ion-card-content&gt;<br/>            &lt;ion-card-title&gt;{{ product.title }}&lt;/ion-card-title&gt;<br/>            &lt;div class="white-space-normal" [innerHTML]="sanContent(product)"&gt;&lt;/div&gt;<br/>        &lt;/ion-card-content&gt;<br/>    &lt;/ion-card&gt;<br/>&lt;/ion-content&gt;</span></pre><h1 id="4dfc" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这里发生了什么事？</h1><p id="839e" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Cosmic JS JavaScript库没有提供任何根据属性过滤对象的方法，但是REST API提供了。这就是为什么我们使用Angular Http模块向Cosmic JS API发出HTTP请求。</p><p id="f93e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这种情况下，请求URL应该如下所示:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="89e0" class="ln kc hu lj b fv lo lp l lq lr"><a class="ae ka" href="https://api.cosmicjs.com/v1/BUCKET_NAME/object-type/OBJECT_TYPE_SLUG/search?metafield_key=CATEGORY_OBJECT_TYPE_SLUG&amp;metafield_value=CATEGORY_OBJECT_ID" rel="noopener ugc nofollow" target="_blank">https://api.cosmicjs.com/v1/BUCKET_NAME/object-type/OBJECT_TYPE_SLUG/search?metafield_key=CATEGORY_OBJECT_TYPE_SLUG&amp;metafield_value=CATEGORY_OBJECT_ID</a></span></pre><p id="701c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们要看的第二个有趣的东西是getImageUrl函数。图像是产品元数据的一部分，这就是为什么它将是每个API响应对象的元字段数组的一项。我们的目标是提取所需的metafieldsarray项(键字段等于‘image’—我们在创建元字段时输入的键)。这个数组项也有值键——它是图像文件名，我们需要在它前面加上<a class="ae ka" href="https://cosmicjs.imgix.net/" rel="noopener ugc nofollow" target="_blank">https://cosmicjs.imgix.net/</a>来获得完整的图像URL。</p><p id="e72e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们在这里使用Angular 4，这就是为什么我们必须使用DomSanitizer来显示从Cosmic JS API接收的HTML标记。</p><h1 id="d0c7" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="9950" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Cosmic JS让我们不用过多考虑后端和API就可以快速开始移动应用开发。一般来说，一切都可以使用你的Ionic/Angular developer来完成，这将为你节省大量的时间和金钱。可以快速添加/删除或修改任何后端/API实体，以满足您的项目需求。</p><div class="le lf lg lh fq ab cb"><figure class="mj iv mk ml mm mn mo paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="mj iv mk ml mm mn mo paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="mj iv mk ml mm mn mo paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="mp mq mr"><p id="f922" class="jc jd ms je b jf jg jh ji jj jk jl jm mt jo jp jq mu js jt ju mv jw jx jy jz hn dt translated"><a class="ae ka" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是<a class="ae ka" href="http://bit.ly/atAMIatAMI" rel="noopener ugc nofollow" target="_blank"> @AMI </a>家庭的一员。我们现在<a class="ae ka" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae ka" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>机会。</p><p id="708a" class="jc jd ms je b jf jg jh ji jj jk jl jm mt jo jp jq mu js jt ju mv jw jx jy jz hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae ka" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae ka" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mw"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></div></figure></div></div>    
</body>
</html>