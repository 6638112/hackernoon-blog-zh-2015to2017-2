<html>
<head>
<title>Subdomain takeover of blog.snapchat.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">子域接管blog.snapchat.com</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/subdomain-takeover-of-blog-snapchat-com-60860de02fe7?source=collection_archive---------3-----------------------#2016-10-05">https://medium.com/hackernoon/subdomain-takeover-of-blog-snapchat-com-60860de02fe7?source=collection_archive---------3-----------------------#2016-10-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="c3ad" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">TL；博士:https://hackerone.com/reports/171942</h2></div><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div class="fe ff jk"><img src="../Images/7d664bb410a7210fa4a4e6748b1a7faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*PNJD_XMfP27f73wbPD6qNg.jpeg"/></div><figcaption class="js jt fg fe ff ju jv bd b be z ek">My dog waiting for the FBI to show up</figcaption></figure><h1 id="8f85" class="jw jx hu bd jy jz ka kb kc kd ke kf kg ja kh jb ki jd kj je kk jg kl jh km kn dt translated">问题</h1><p id="2da9" class="pw-post-body-paragraph ko kp hu kq b kr ks iv kt ku kv iy kw kx ky kz la lb lc ld le lf lg lh li lj hn dt translated"><a class="ae jj" href="https://hackernoon.com/tagged/snapchat" rel="noopener ugc nofollow" target="_blank"> Snapchat </a>没有很多面向公众的子域名，截至目前，对pentest-tools.com<a class="ae jj" href="https://pentest-tools.com" rel="noopener ugc nofollow" target="_blank">的基本子域名扫描显示只有13个子域名(相比之下，脸书有799个)。我认为像Snapchat这样高调的赏金程序会很难测试，所以决定不去打扰。然而，我最近一直在做一些黑客工作，blog.snapchat.com引起了我的注意。</a></p><h1 id="da69" class="jw jx hu bd jy jz ka kb kc kd ke kf kg ja kh jb ki jd kj je kk jg kl jh km kn dt translated">这里什么都没有。</h1><p id="5a30" class="pw-post-body-paragraph ko kp hu kq b kr ks iv kt ku kv iy kw kx ky kz la lb lc ld le lf lg lh li lj hn dt translated"><a class="ae jj" href="http://blog.snapchat.com" rel="noopener ugc nofollow" target="_blank">blog.snapchat.com</a>的DNS记录显示一个CNAME记录和一些指向<a class="ae jj" href="http://snapchat-blog.com" rel="noopener ugc nofollow" target="_blank">snapchat-blog.com</a>的逻辑，解析到下页。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lk"><img src="../Images/13cd9b9c1a7ad3d36b3cf8c13b67aa89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYHelt67Tx_ZcXOV9kSW-A.png"/></div></div><figcaption class="js jt fg fe ff ju jv bd b be z ek">Tumblr 404 page</figcaption></figure><p id="9a07" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">我对Tumblr的经验有限，但我认为这是一个无人认领的博客页面。我的第一个猜测是，在后台他们指向一些网站，如<a class="ae jj" href="http://snapchat.tumblr.com" rel="noopener ugc nofollow" target="_blank">snapchat.tumblr.com</a>，但那个博客已经被占用，所以这是错误的。</p><p id="5eac" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">经过一番挖掘，我发现Tumblr和许多其他网站有相同的自定义域名设置:</p><ul class=""><li id="60a8" class="lu lv hu kq b kr lp ku lq kx lw lb lx lf ly lj lz ma mb mc dt translated">通过域名记录将您的域名指向他们的IP地址</li><li id="1578" class="lu lv hu kq b kr md ku me kx mf lb mg lf mh lj lz ma mb mc dt translated">让网站处理CNAME的事情。</li></ul><p id="3293" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">我能够通过nslookup验证这一点，看到snapchat-blog.com指向66.6.32.21，这是Tumblr拥有的自定义域名路由的IP。</p><pre class="jl jm jn jo fq mi mj mk ml aw mm dt"><span id="ceef" class="mn jx hu mj b fv mo mp l mq mr"># nslookup snapchat-blog.com</span><span id="6a6a" class="mn jx hu mj b fv ms mp l mq mr">Non-authoritative answer:<br/>Name: snapchat-blog.com<br/>Address: 66.6.32.21</span></pre><p id="9e34" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">查看谷歌缓存的该页面副本显示，该域名在前一天(9月24日)被正确声明。Snapchat一定是在过去24小时内不小心从他们的Tumblr账户中删除了自定义域名声明，这可能是为了准备切换到<a class="ae jj" href="http://snap.com/news" rel="noopener ugc nofollow" target="_blank">snap.com/news</a>进行他们最近的品牌重塑。</p><p id="c51d" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">在我弄清楚Tumblr如何处理CNAMEs之后，就像进入我的帐户设置并申请域名一样简单。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div class="fe ff mt"><img src="../Images/5a89b1476406102255cbdf269b8cb654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*mlV-NwqLBxWvn2NwA99zCg.png"/></div><figcaption class="js jt fg fe ff ju jv bd b be z ek">Tumblr custom domain settings</figcaption></figure><h1 id="3d33" class="jw jx hu bd jy jz ka kb kc kd ke kf kg ja kh jb ki jd kj je kk jg kl jh km kn dt translated">我的第一个Tumblr</h1><p id="2876" class="pw-post-body-paragraph ko kp hu kq b kr ks iv kt ku kv iy kw kx ky kz la lb lc ld le lf lg lh li lj hn dt translated">访问<a class="ae jj" href="http://blog.snapchat.com" rel="noopener ugc nofollow" target="_blank">blog.snapchat.com</a>(它重定向到<a class="ae jj" href="http://snapchat-blog.com" rel="noopener ugc nofollow" target="_blank">snapchat-blog.com</a>)然后显示如下</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff mu"><img src="../Images/e703e89c90a7f3f68ba139aefdce9b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RQm5yZ9N8SLh3u9KBRdZQ.png"/></div></div><figcaption class="js jt fg fe ff ju jv bd b be z ek">Snapchat blog page</figcaption></figure></div><div class="ab cl mv mw hc mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hn ho hp hq hr"><p id="2586" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">我决定将我的名字放在这个子域上作为有效的PoC，这样他们就知道威胁参与者的活动不是原因，并且如果他们没有首先看到Hackerone报告，就可以帮助Snapchat修复漏洞。这最终导致我没有得到奖金，因为我没有以更安静的方式处理这件事。这不是我的初衷，但我能理解他们的立场。</p><h1 id="b9ad" class="jw jx hu bd jy jz ka kb kc kd ke kf kg ja kh jb ki jd kj je kk jg kl jh km kn dt translated">解决时间线</h1><p id="56a6" class="pw-post-body-paragraph ko kp hu kq b kr ks iv kt ku kv iy kw kx ky kz la lb lc ld le lf lg lh li lj hn dt translated"><strong class="kq hv">2016年9月25日</strong></p><ul class=""><li id="6db4" class="lu lv hu kq b kr lp ku lq kx lw lb lx lf ly lj lz ma mb mc dt translated">下午3:08 CDT:在Hackerone上向Snapchat报告了问题</li><li id="03c1" class="lu lv hu kq b kr md ku me kx mf lb mg lf mh lj lz ma mb mc dt translated">下午7:18 CDT:Snapchat确认了漏洞，并要求我重定向到真实博客进行临时修复。他们还将blog.snapchat.com的<a class="ae jj" href="http://blog.snapchat.com" rel="noopener ugc nofollow" target="_blank">重新定向到snap.com/news</a>的<a class="ae jj" href="http://snap.com/news" rel="noopener ugc nofollow" target="_blank">进行更强的修复。</a></li><li id="c80d" class="lu lv hu kq b kr md ku me kx mf lb mg lf mh lj lz ma mb mc dt translated">CDT晚上8:33:电子邮件联系开始帮助转让snapchat-blog.com Tumblr的所有权</li></ul><p id="41f0" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated"><strong class="kq hv">2016年9月26日</strong></p><ul class=""><li id="d4f6" class="lu lv hu kq b kr lp ku lq kx lw lb lx lf ly lj lz ma mb mc dt translated">美国中部时间上午9:59:Tumblr所有权转移至Snapchat</li></ul><p id="5d92" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated"><strong class="kq hv"> 10/4/16 </strong></p><ul class=""><li id="2bb7" class="lu lv hu kq b kr lp ku lq kx lw lb lx lf ly lj lz ma mb mc dt translated">CDT晚上9:37:报告结束</li></ul><p id="d1c9" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated"><strong class="kq hv"> 10/5/16 </strong></p><ul class=""><li id="7203" class="lu lv hu kq b kr lp ku lq kx lw lb lx lf ly lj lz ma mb mc dt translated">下午1:41 CDT:批准公开披露请求</li></ul></div><div class="ab cl mv mw hc mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hn ho hp hq hr"><p id="b286" class="pw-post-body-paragraph ko kp hu kq b kr lp iv kt ku lq iy kw kx lr kz la lb ls ld le lf lt lh li lj hn dt translated">感谢Snapchat快速的响应时间和运行如此伟大的bug bounty程序。如果你对他们的节目感兴趣，请访问https://hackerone.com/snapchat。</p><div class="jl jm jn jo fq ab cb"><figure class="nc jp nd ne nf ng nh paragraph-image"><a href="http://bit.ly/HackernoonFB"><img src="../Images/50ef4044ecd4e250b5d50f368b775d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0hqOaABQ7XGPT-OYNgiUBg.png"/></a></figure><figure class="nc jp nd ne nf ng nh paragraph-image"><a href="https://goo.gl/k7XYbx"><img src="../Images/979d9a46439d5aebbdcdca574e21dc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vgw1jkA6hgnvwzTsfMlnpg.png"/></a></figure><figure class="nc jp nd ne nf ng nh paragraph-image"><a href="https://goo.gl/4ofytp"><img src="../Images/2930ba6bd2c12218fdbbf7e02c8746ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gKBpq1ruUi0FVK2UM_I4tQ.png"/></a></figure></div><blockquote class="ni nj nk"><p id="f922" class="ko kp nl kq b kr lp iv kt ku lq iy kw nm lr kz la nn ls ld le no lt lh li lj hn dt translated"><a class="ae jj" href="http://bit.ly/Hackernoon" rel="noopener ugc nofollow" target="_blank">黑客中午</a>是黑客如何开始他们的下午。我们是阿妹家庭的一员。我们现在<a class="ae jj" href="http://bit.ly/hackernoonsubmission" rel="noopener ugc nofollow" target="_blank">接受投稿</a>并乐意<a class="ae jj" href="mailto:partners@amipublications.com" rel="noopener ugc nofollow" target="_blank">讨论广告&amp;赞助</a>的机会。</p><p id="708a" class="ko kp nl kq b kr lp iv kt ku lq iy kw nm lr kz la nn ls ld le no lt lh li lj hn dt translated">如果你喜欢这个故事，我们推荐你阅读我们的<a class="ae jj" href="http://bit.ly/hackernoonlatestt" rel="noopener ugc nofollow" target="_blank">最新科技故事</a>和<a class="ae jj" href="https://hackernoon.com/trending" rel="noopener ugc nofollow" target="_blank">趋势科技故事</a>。直到下一次，不要把世界的现实想当然！</p></blockquote><figure class="jl jm jn jo fq jp fe ff paragraph-image"><a href="https://goo.gl/Ahtev1"><div class="fe ff np"><img src="../Images/be0ca55ba73a573dce11effb2ee80d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35tCjoPcvq6LbB3I6Wegqw.jpeg"/></div></a></figure><figure class="jl jm jn jo fq jp"><div class="bz el l di"><div class="nq nr l"/></div></figure></div></div>    
</body>
</html>